var bs;!function(e){var s;!function(e){var s;!function(e){e.Templates={appDetails:'<div class="header"></div>    <div class="content bs-app-versioning-container" ng-init-"isLoading = true">        <bs-loader is-loading="isLoading">        </bs-loader>        <div class="bs-app-details-header">            <div class="row">                <div class="col-xs-6">                    <div class="bs-app-heading-large clearfix">                        <div class="app-icon pull-left">                            <img class="bs-app-icon" ng-src="{{ app | appIconHref : \'large\' }}" width="82" height="82" />                        </div>                        <hgroup>                            <h4>{{ app.Name }}</h4>                            <h5>{{ app.CompanyName }} <a class="bs-app-website-link" target="_blank" ng-if="app.HomepageUri" ng-href="{{ app.HomepageUri }}">More info &raquo;</a></h5>                        </hgroup>                        <div class="bs-app-free-container" ng-if="!app.IsBillingActivated || (areProductsLoaded && products.length < 1)">                            <span class="bs-app-free">Free</span>                        </div>                    </div>                    <div class="bs-util-inline-block bs-app-categories" ng-if="appMetadata">                        <label>categories</label>                        <span ng-repeat="classification in app.Classifications" class="bs-app-categories-item" ng-cloak ng-bind-template="{{ getClassificationDescription(classification) }}">{{ classification }}</span>                    </div>                </div>                <div class="col-xs-6">                    <div class="bs-app-launcharea">                        <bs-app-version-launch ng-if="appLaunchOptions.versions" options="appLaunchOptions"></bs-app-version-launch>                        <bs-new-app-alert ng-if="app && !isLoading" current-version="app"></bs-new-app-alert>                    </div>                </div>            </div>        </div>                <div class="bs-app-deprecated-state" ng-if="app.Status === \'Deprecated\'">            <div class="bs-app-deprecated-border">                <div class="bs-app-deprecated-icon"></div>                deprecated            </div>            <div ng-model="selectedVersion.DeprecatedOn" class="bs-app-state-label">                Version {{ app.VersionNumber }} of this app is deprecated.            </div>        </div>        <div class="bs-app-disabled-state" ng-if="app.Status === \'Disabled\'">            <div class="bs-app-disabled-border">                <div class="bs-app-disabled-icon"></div>                disabled            </div>            <div ng-model="selectedVersion.DeprecatedOn" class="bs-app-state-label">                Version {{ app.VersionNumber }} of this app is disabled.            </div>        </div>        <div class="bs-app-details">            <div class="row bs-app-details-row">                <div class="col-xs-3 bs-app-details-col-left">                    <section ng-if="app.IsBillingActivated && (areProductsLoaded && products.length > 0)">                        <h3 class="bs-section-heading">Pricing info</h3>                        <div>                            <bs-app-pricing-info products="products"></bs-app-pricing-info>                        </div>                    </section>                    <section>                        <h3 class="bs-section-heading">License Info</h3>                        <div ng-if="!agreements || !agreements.length"><em>This app has no agreements to view.</em></div>                        <div ng-if="agreements" class="bs-util-padding-left bs-util-padding-right bs-util-padding-vertical agreements-content">                            <div ng-repeat="agreement in agreements">                                <a ng-href="/agreements/view?agreementid={{agreement.Id}}" target="_blank">{{ agreement.Title }}</a>                            </div>                        </div>                    </section>                </div>                <div class="col-xs-9 bs-app-details-col-right">                    <section>                        <h3 class="bs-section-heading">Description</h3>                        <div ng-if="!app.LongDescription"><em>This app has no description.</em></div>                        <div ng-if="app.LongDescription" bs-truncate="375" class="bs-user-html paragraph-text-large" style="margin-bottom:20px;" marked="app.LongDescription"></div>                    </section>                                        <section ng-if="app.WhatsNew">                        <h3 class="bs-section-heading">What\'s New</h3>                        <div ng-if="!app.WhatsNew"><em>This app has no information about what\'s new.</em></div>                        <div marked="app.WhatsNew" class="bs-user-html paragraph-text-large"></div>                    </section>                    <section class="clearfix" ng-if="screenshots && screenshots.length > 0">                        <div class="bs-app-screenshot-container" width="100%">                            <div class="bs-app-screenshot-carousel">                                <div class="nav-control nav-control-left" ng-if="screenshots.length > 1">                                    <button class="previous-btn" ng-click="prevImage()" ng-disabled="currentScreenShotIndex == 0">                                        <span class="bs-arrow" ng-class="{ \'disabled\' : currentScreenShotIndex == 0 }"></span>                                    </button>                                </div>                                <div class="bs-app-screenshot-img">                                    <a class="carousel-frame" ng-href="{{ screenshotImage }}">                                        <img ng-src="{{ screenshotImage }}" />                                    </a>                                </div>                                <div class="nav-control nav-control-right" ng-if="screenshots.length > 1">                                    <button class="next-btn" ng-click="nextImage()" ng-disabled="currentScreenShotIndex == screenshots.length - 1">                                        <span class="bs-arrow right" ng-class="{ \'disabled\' : currentScreenShotIndex == screenshots.length - 1 }"></span>                                    </button>                                </div>                            </div>                        </div>                    </section>                    <section>                        <h3 class="bs-section-heading">Release Notes</h3>                        <span ng-if="app" class="bs-app-version-subheading">                            <span class="version-container">Version {{ app.VersionNumber }}</span>                            <span class="published-container">                                <span ng-if="app.DatePublished">                                    {{ app.DatePublished | date: \'mediumDate\' }}                                </span>                                <span ng-if="!app.DatePublished && app.Status != \'Published\' ">                                    Not Published                                </span>                            </span>                        </span>                        <div ng-if="!app.ReleaseNotes"><em>This app has no release notes.</em></div>                        <div ng="app.ReleaseNotes" marked="app.ReleaseNotes" class="bs-user-html paragraph-text-large"></div>                    </section>                </div>            </div>        </div>    </div>',newAppAlert:'<p class="alert alert-warning bs-apps-alert" ng-if="latestVersion && isNotificationNeeded" ng-class="{ \'visible\' : isNotificationNeeded }">        <small>A newer version of this app (v{{latestVersion.VersionNumber}}) is available.</small> <span ng-click="onClickDismiss()" class="icomoon icon-close"></span>    </p>',appList:'<div class="header row">        <div class="col-xs-6">            <div class="title-and-breadcrumb-container">                <h1 class="page-title">Applications</h1>            </div>        </div>    </div>    <div class="content">        <div class="row">            <div ng-if="isLoading" class="bs-loader-wrapper">                <div class="bs-loader">                    <div class="bs-bar"></div>                    <div class="bs-bar"></div>                    <div class="bs-bar"></div>                </div>            </div>            <div class="col-xs-8">                <ul class="bs-apps">                    <li ng-repeat="(key, app) in apps | filter:query" class="bs-app-card" ng-show="isSelectedCategory(app)">                        <div class="bs-card">                            <a ng-href="{{ app | preferredAppHref }}">                                <div class="bs-card-content">                                    <div class="app-icon">                                        <img class="bs-app-icon" ng-src="{{ app | appIconHref : \'large\' }}" width="100" height="100" />                                    </div>                                    <hgroup>                                        <h5>{{app.Name}}</h5>                                        <h6>{{app.CompanyName}}</h6>                                    </hgroup>                                </div>                            </a>                        </div>                    </li>                </ul>            </div>            <div class="col-xs-4">                <div class="apps-search-container">                    <input type="text" class="pull-right search-query col-md-5" id="dataset-search" ng-model="query" placeholder="Search Apps">                </div>                <div class="bs-categories">                    <div class="header">                        <h3 class="nav-section-header">Categories</h3>                    </div>                    <div class="col-xs-6" ng-repeat="(key, cat) in classifications | filter: { Name: \'!None\'} | orderBy: \'Name\' ">                        <a ng-click="setCategory(cat)" class="btn btn-default btn-app-cat btn-block"                        ng-class="{\'btn-primary active\': cat == selectedCategory}" type="button" ng-disabled="getCategoryAppCount(cat)===0" >{{cat.Description}} ({{getCategoryAppCount(cat)}})</a>                    </div>                </div>            </div>        </div>    </div>',appPricingInfo:'<ul class="bs-app-product-price-list">        <li ng-repeat="product in products">            <hgroup class="clearfix">                <h2 class="bs-price-amount pull-right">                    {{ product.Price }}                    <ng-pluralize count="product.Price" when="{\'0\': \'iCredits\', \'one\': \'iCredit\', \'other\': \'iCredits\'}">                    </ng-pluralize>                </h2>                <h1 class="bs-price-label">{{ product.Name }}</h1>            </hgroup>            <p class="bs-product-description">                <span ng-if="product.PersistenceDays != 0 && product.PersistenceDays != 10000">                    {{ product.PersistenceDays | formatPersistenceLabel }}                    <span class="bs-text-delimiter-pipe">&nbsp;</span>                </span>                {{ product.Description }}            </p>        </li>    </ul>'}}(s=e.Apps||(e.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));var bs;!function(e){var s;!function(s){var i;!function(s){s.moduleName="bs.Areas.Apps",s.appsModule=angular.module(s.moduleName,["ngAnimate","ngRoute",e.Common.commonModuleName]),s.appRouteServiceName="appRouteService",s.appsModule.service(s.appRouteServiceName,function(){return new i});var i=function(){function e(){}return e}();s.AppRouteService=i,s.appsModule.config(["$routeProvider","$locationProvider",function(e,i){e.when("/:id/:name?",{template:s.Templates.appDetails,controller:s.appDetailsVersionControllerName}).otherwise({template:s.Templates.appList,controller:s.appListControllerName}),i.html5Mode({enabled:!0,requireBase:!0}).hashPrefix("!")}])}(i=s.Apps||(s.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));var bs;!function(e){var s;!function(e){var s;!function(e){e.newAppAlertServiceName="newAppAlert",e.NEW_APP_ALERT_STORAGE_PREFIX="bs.apps.new-app-version-alert-dismissed",e.appsModule.service(e.newAppAlertServiceName,function(){return new s});var s=function(){function s(){}return s.prototype.getNewerVersions=function(e,s,i,t){void 0===i&&(i=null),void 0===t&&(t=null);var a=[];return s.forEach(function(s){if(s.Id!=e.Id&&s.DatePublished){var n=!1;if(e.DatePublished){var r=new Date(e.DatePublished),o=new Date(s.DatePublished);n=o>r}if(n||!e.DatePublished){var p=t?moment(t):moment(),c=moment.duration(p.diff(moment(s.DatePublished))),l=c.asDays();(null==i||i>l)&&a.push(s)}}}),a},s.prototype.getMostRecentVersion=function(e){var s=null,i=null;return e.filter(function(e){return e.DatePublished?!0:!1}).forEach(function(e){if(null==s)s=e,i=new Date(s.DatePublished);else{var t=new Date(e.DatePublished);t>i&&(s=e,i=t)}}),s},s.prototype.getUndismissedVersions=function(e,s){var i=this,t=[];return e.forEach(function(e){i.isDismissed(e,s)||t.push(e)}),t},s.prototype.isDismissed=function(e,s){return JSON.parse(localStorage.getItem(this._getStorageKey(e,s)))?!0:!1},s.prototype.dismiss=function(e,s){localStorage.setItem(this._getStorageKey(e,s),JSON.stringify(!0))},s.prototype._getStorageKey=function(s,i){var t=[e.NEW_APP_ALERT_STORAGE_PREFIX,s.Id,i.Id].join("-"),a=$.md5(t);return a},s}();e.NewAppAlertService=s}(s=e.Apps||(e.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));var bs;!function(e){var s;!function(s){var i;!function(s){s.newAppAlertDirective="bsNewAppAlert",s.appsModule.directive(s.newAppAlertDirective,[e.Common.Services.Api.apiServiceName,s.newAppAlertServiceName,e.Common.Services.ServerConfig.serverConfigServiceName,function(e,s,t){return new i(e,s,t)}]);var i=function(){function e(e,i,t){var a=this;this.api=e,this.template=s.Templates.newAppAlert,this.restrict="E",this.scope={currentVersion:"=",maxAge:"@?"},this.newAppAlertService=i,this.serverConfig=t,this.controller=["$scope","$rootScope",function(e,s){if(e.isNotificationNeeded=!1,e.currentVersion.DatePublished){var i={Id:a.serverConfig.currentUserId};a.api.Application.getVersions({Id:e.currentVersion.Id,sortby:"datepublished",sortdir:"desc"},function(t){if(e.allVersions=t.Response.Items,e.latestVersion=e.allVersions[0],s.$on("dismiss-new-app-alert"+e.latestVersion.Id,function(){e.isNotificationNeeded&&(e.isNotificationNeeded=!1)}),e.latestVersion.DatePublished&&e.latestVersion.Id!=e.currentVersion.Id){var n=a.newAppAlertService.isDismissed(e.latestVersion,i);e.isNotificationNeeded=!n}else e.isNotificationNeeded=!1}),e.onClickDismiss=function(){a.newAppAlertService.dismiss(e.latestVersion,i),e.isNotificationNeeded=!1,s.$broadcast("dismiss-new-app-alert"+e.latestVersion.Id)}}}]}return e}();s.NewAppAlertDirective=i}(i=s.Apps||(s.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));var bs;!function(e){var s;!function(s){var i;!function(s){s.appListControllerName="bsAppListController",s.appsModule.controller(s.appListControllerName,["$scope","$filter","$timeout",e.Common.Services.Api.apiServiceName,s.appRouteServiceName,e.Common.Services.ServerConfig.appStartConfigServiceName,e.Common.Services.siteNavigationServiceName,function(e,s,t,a,n,r,o){return new i(e,s,t,a,n,r,o)}]);var i=function(){function e(e,s,i,t,a,n,r){if(e.isLoading=!1,r.setCurrentLocation("apps"),a.appList)e.apps=a.appList;else{var o=i(function(){return e.isLoading=!0},250);t.Application.query({Limit:1e3,SortBy:"Name",SortDir:"Asc"},function(s){i.cancel(o),e.apps=a.appList=s.Response.Items,e.isLoading=!1})}t.Application.getMetadata({},function(s){s.Response&&s.Response.Classifications&&(e.classifications=s.Response.Classifications)}),e.setCategory=function(s){e.selectedCategory=e.selectedCategory===s?null:s},e.isSelectedCategory=function(s){var i=!1;return e.selectedCategory?(angular.forEach(s.Classifications,function(s){s===e.selectedCategory.Name&&(i=!0)}),i):!0},e.getCategoryAppCount=function(s){var i=0;return angular.forEach(e.apps,function(e){e.Classifications.indexOf(s.Name)>-1&&i++}),i}}return e}();s.AppListController=i}(i=s.Apps||(s.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));var bs;!function(e){var s;!function(s){var i;!function(s){s.appDetailsVersionControllerName="bsAppDetailsVersionController",s.appDetailsPreferredVersionControllerName="bsAppDetailsPreferredVersionController",s.appsModule.controller(s.appDetailsVersionControllerName,["$scope","$routeParams","$timeout","$q","$filter",e.Common.Services.Api.apiServiceName,e.Common.Services.Api.apiHrefParserServiceName,s.appRouteServiceName,function(e,s,t,a,n,r,o,p){return new i(e,s,t,a,n,r,o,p)}]);var i=function(){function e(e,s,i,t,a,n,r,o){var p=this;this.$scope=e,this.$routeParams=s,this.$timeout=i,this.$q=t,this.api=n,this.apiHrefParser=r,this.appRouteService=o,this.isRoutePreferredVersion=!1;for(var c in s)if(s.hasOwnProperty(c)&&"preferredversion"===c.toLowerCase()){this.isRoutePreferredVersion=!0;break}o.app&&(e.app=o.app),o.agreements&&(e.agreements=o.agreements),o.screenshots&&(e.screenshots=o.screenshots),o.appLaunchOptions&&(e.appLaunchOptions=o.appLaunchOptions),e.isLoading=!1,e.areProductsLoaded=!1,this._initScreenshotCarousel(),this.fetchApp().then(function(e){return p._onAppFetched(e)}),e.getClassificationDescription=function(s){var i=a("filter")(e.appMetadata.Classifications,{Name:s},!0);return i.length?i[0].Description:s},e.getCategoryDescription=function(s){var i=a("filter")(e.appMetadata.Categories,{Name:s},!0);return i.length?i[0].Description:s}}return e.prototype._onAppFetched=function(e){var s=this;this.$scope.app=this.appRouteService.app=e,this.$scope.isLoading=!1;var i=this.api.Application.getMetadata({},function(e){s.$scope.appMetadata=e.Response}),t=this.api.Application.getVersions({Id:this.$scope.app.Id,SortBy:"versionnumber",SortDir:"desc",Limit:500},function(e){});this.$q.all([i.$promise,t.$promise]).then(function(){var e=s.$scope.app;s.$scope.appLaunchOptions=s.appRouteService.appLaunchOptions={versions:t.Response.Items,selectedVersion:e,navigateToVersion:!0,applicationMetadata:s.$scope.appMetadata}}),this.api.Application.getAgreements({Id:this.$scope.app.Id},function(e){s.$scope.agreements=s.appRouteService.agreements=e.Response.Items}),this.api.Application.getScreenshots({Id:this.$scope.app.Id},function(e){s.$scope.screenshots=s.appRouteService.screenshots=e.Response.Items,s.$scope.screenshots.length>0&&(s.$scope.screenshotImage=s.$scope.screenshots[0],s.$scope.currentScreenShotIndex=0)}),this.$scope.app.IsBillingActivated&&this.api.Application.getProductsProxy({Id:this.$scope.app.Id},function(e){s.$scope.areProductsLoaded=!0,s.$scope.products=s.appRouteService.products=e.Response.Products})},e.prototype.fetchApp=function(){var e=this,s=this.$q.defer(),i=s.promise;return this.isRoutePreferredVersion?(this.api.Application.get({Id:this.$routeParams.id},function(t){return t.Response.Id===e.apiHrefParser.hrefToId(t.Response.HrefUserVersion)?(s.resolve(t.Response),i):void e.api.getFromResourceUrl(t.Response.HrefUserVersion).then(function(e){s.resolve(e)},function(){s.reject()})},function(){s.reject()}),i):this.$scope.app&&this.$scope.app.Id&&this.$scope.app.Id===this.$routeParams.id?(s.resolve(this.$scope.app),i):(this.api.Application.get({Id:this.$routeParams.id},function(e){s.resolve(e.Response)},function(){s.reject()}),i)},e.prototype._initScreenshotCarousel=function(){var e=this;this.$scope.setImage=function(s){e.$scope.screenshotImage=s;for(var i=0;i<e.$scope.screenshots.length;i++)if(e.$scope.screenshots[i]===s){e.$scope.currentScreenShotIndex=i;break}},this.$scope.prevImage=function(){if(0!=e.$scope.screenshots.length){if(e.$scope.currentScreenShotIndex-1==-1)return e.$scope.currentScreenShotIndex=e.$scope.screenshots.length-1,void(e.$scope.screenshotImage=e.$scope.screenshots[e.$scope.currentScreenShotIndex]);e.$scope.currentScreenShotIndex--,e.$scope.screenshotImage=e.$scope.screenshots[e.$scope.currentScreenShotIndex]}},this.$scope.nextImage=function(){if(0!=e.$scope.screenshots.length){if(e.$scope.currentScreenShotIndex+1>=e.$scope.screenshots.length)return e.$scope.currentScreenShotIndex=0,void(e.$scope.screenshotImage=e.$scope.screenshots[e.$scope.currentScreenShotIndex]);e.$scope.currentScreenShotIndex++,e.$scope.screenshotImage=e.$scope.screenshots[e.$scope.currentScreenShotIndex]}}},e}();s.AppDetailsController=i}(i=s.Apps||(s.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));var bs;!function(e){var s;!function(e){var s;!function(e){e.appPricingInfoDirectiveName="bsAppPricingInfo";var s=function(){function s(){this.scope={products:"="},this.replace=!0,this.template=e.Templates.appPricingInfo}return s}();e.AppPricingInfoDirective=s,e.appsModule.directive(e.appPricingInfoDirectiveName,[function(){return new s}])}(s=e.Apps||(e.Apps={}))}(s=e.Areas||(e.Areas={}))}(bs||(bs={}));
//# sourceMappingURL=bs.tang.apps.min.js.map
