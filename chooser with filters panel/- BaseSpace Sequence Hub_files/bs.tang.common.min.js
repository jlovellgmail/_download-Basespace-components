var bs;!function(e){var t;!function(e){e.Templates={accordion:"<div ng-transclude>    </div>",accordionItem:"<div ng-transclude>    </div>",accordionHeader:'<div class="bs-accordion-header" ng-click="onToggleCollapse()">        <span class="icomoon bs-accordion-toggle-arrow"></span>        <div ng-transclude>        </div>    </div>',accordionBody:'<div class="bs-accordion-body" ng-transclude>    </div>',appVersionForm:'<form name="form" class="app-version-creation-form" novalidate>        <p>To create a new version of <strong>{{ options.sourceApp.Name }}</strong>, please specify a new version number. This new version will be copied from version <strong>{{ options.sourceApp.VersionNumber }}</strong>.</p>                <p ng-if="options.sourceApp.IsBillingActivated">Please note that all fields, forms, and report templates associated with version {{ options.sourceApp.VersionNumber }} will be copied with the exception of billing products. To enable billing in the new version, please submit your app for billing, create new products for this version, and modify your billing specification script in Form Builder.</p>        <br/>        <div class="form-group">            <label for="new-version-number">New Version Number</label>            <input name="new-version-number" type="text" class="form-control bs-form-control" ng-model="options.newVersionNumber" required />        </div>        <div ng-if="options.serverError" class="alert alert-danger">{{ options.serverError }}</div>    </form>',appVersionCellDateCreated:"<time>{{ rowData.DateCreated | twitterTime }}</time>",appVersionCellVersionNumber:'<div><a ng-href="/apps/{{rowData.Id}}/details"><img ng-src="{{ rowData | appIconHref : \'thumb\' }}" height=30 width=30 /> {{ rowData.VersionNumber }}</a></div>',appVersionCellStatus:"<div>{{ rowData.PublishStatus | appStatusToDescription : $parent.$parent.$parent.$parent.statuses }}</div>",appVersionLaunch:'<div class="bs-app-version-dropdown" ng-click="isOpen = !isOpen" ng-init="isOpen = false" ng-class="{ \'open\' : isOpen }">        <span class="bs-app-version-selection">            <div class="version-label">                version {{ options.selectedVersion.VersionNumber }}                <span class="bs-app-dropdown-base-icon {{ getIconClass(options.selectedVersion.PublishStatus) }}"></span>                <span class="publish-status" ng-hide="isPublished(options.selectedVersion.PublishStatus)">                    {{ getStatusDescription(options.selectedVersion.PublishStatus) }}                </span>            </div>            <span class="glyphicon ng-scope glyphicon-chevron-down"></span>        </span>        <ul class="dropdown-menu">            <li ng-repeat="version in getVersionsForDropdown()" ng-click="selectItem(version)" selected="options.selectedVersion.Id == version.Id" ng-class="{selected : options.selectedVersion.Id == version.Id}">                <a ng-if="options.navigateToVersion" ng-href="{{ { Application : version } | uiHref : \'application\' }}">                    <div class="row dropdownItem">                        <div class="bs-app-tick-mark  col-xs-1">                            <span class="glyphicon glyphicon-ok" ng-if="options.selectedVersion.Id == version.Id"></span>                        </div>                        <div class="col-xs-11 bs-app-state-label">                            <span>                                <span class="bs-app-version-number">                                    {{ version.VersionNumber }}                                </span>                                <span class="bs-app-dropdown-base-icon {{ getIconClass(version.PublishStatus) }}"></span>                                <span ng-hide="isPublished(version.PublishStatus)">{{ getStatusDescription(version.PublishStatus) }}</span>                            </span>                        </div>                    </div>                </a>            </li>        </ul>    </div>    <button class="bs-btn-launch-app" ng-click="onClickLaunchButton()"><span class="icomoon icon-rocket"></span>Launch</button>',appVersionAccordion:'<div>        <div class="bs-accordion-item" ng-repeat="app in apps">            <div class="bs-accordion-header" ng-click="expand(app)">                <span class="icomoon bs-accordion-toggle-arrow" ng-class="{                      \'icon-triangle-down\' : expandedApp.Id === app.Id,                      \'icon-triangle-right\' : expandedApp.Id != app.Id                      }"></span>                <strong> {{ app.Name }}</strong>            </div>            <div class="bs-accordion-body" ng-class="{ \'open\' : expandedApp.Id === app.Id }">                <div ng-if="expandedApp.Id === app.Id">                    <div class="clearfix">                        <div>                            <button class="btn bs-toolbar-btn btn-large" bs-app-version-creator-dialog-trigger ng-disabled="newVersionOptions.sourceApp == null" options="newVersionOptions">                                <span class="icomoon icon-plus"></span> <label>New Version</label>                            </button>                        </div>                    </div>                    <bs-tang-grid grid-options="gridOptions" selections="selections"></bs-tang-grid>                </div>            </div>        </div>    </div>',bioSamplePicker:'<div class="bioSamplePickerContainer" ng-click="launchPicker()">        <span class="samplePlaceholder" ng-if="!biologicalSample">Select Sample</span>        <span class="sampleValue" ng-if="biologicalSample" ng-bind="biologicalSample.UserSampleId" title="{{ biologicalSample.UserSampleId }}"></span>        <div class="sh-icon-file"></div>    </div>',donutChart:'<div class="bs-chart-donut">    </div>',stackedBarChart:'<div class="bs-chart-stackedbar-container">        <span ng-if="options" class="bs-chart-stackedbar-segment segment-{{$index}}" ng-repeat="segment in options.segments track by $index" ng-style="segment.segmentStyles"></span>    </div>    <div class="bs-chart-stackedbar-legend-container" ng-if="showLegend">        <div ng-if="options" class="bs-chart-stackedbar-legend-row">            <span class="bs-chart-stackedbar-legend-item" ng-repeat="segment in options.segments track by $index" ng-style="segment.legendStyles">                <span class="bs-chart-stackedbar-swatch segment-{{$index}}" ng-style="segment.swatchStyles"></span>                <div class="bs-chart-legend-label">{{ segment.label }}</div>                <div class="bs-chart-legend-value">{{ segment.valueFormatted }}</div>            </span>        </div>    </div>',storageDonutChart:'<div class="bs-chart-donut-storage">        <bs-donut-chart options="options"></bs-donut-chart>        <h5 class="text-center">{{ title }}</h5>        <a ng-href="{{ linkHref }}" target="_self">Manage {{ title }} &raquo;</a>    </div>',storageTotalsChart:'<div class="bs-charts-storage" style="position: relative">        <div ng-show="showLegend">            <bs-loader is-loading="isLoading"></bs-loader>            <p ng-bind-html="messageLead" class="lead" ng-if="messageLead"></p>            <small ng-bind-html="messageSub" ng-if="messageSub"></small>        </div>        <bs-stacked-bar-chart ng-class="{ \'bs-charts-storage-quota-exceeded\' : isQuotaExceeded }" ng-if="options && options.segments.length" options="options" show-legend="showLegend"></bs-stacked-bar-chart>        <div ng-hide="showLegend">            <div class="shortMessage" ng-bind-html="shortMessage"></div>        </div>    </div>',trendLineChartDirective:'<div class="bs-chart-line-title">{{ graphTitle }}</div>    <div>    </div>    <div class="bs-chart-line-y-title">{{ graphYTitle }}</div>    <div class="bg-title-line-style" ng-style="bgTitleLineStyle">        <div class="bs-chart-line-x-title">            <span>{{ graphXTitle }}</span>        </div>    </div>',chooserDialog:'<div class="bs-chooser" ng-show="dialogScope.isVisible">        <div class="bs-chooser-header" ng-class="{ \'drop-shadow\' : filtersVisible }">            <div class="row">                <div class="col-xs-12">                    <div class="bs-chooser-title"><h3 class="bs-section-heading">{{ dialogScope.message }}</h3></div>                    <div class="bs-chooser-total-count" ng-if="gridDataSource.totalCount"><div class="bs-chooser-badge">{{ gridDataSource.totalCount | number }}</div></div>                    <div class="bs-chooser-btn-selected" ng-if="dialogScope.selections.length && dialogScope.multiSelect">                        <div class="bs-btn-selected-count bs-btn-selected">{{ dialogScope.selections.length | number }} Selected<button ng-click="onClearSelectionClick()" class="bs-btn-selected bs-btn-selected-cancel"><small><span class="icomoon icon-close"></span></small></button>                        </div>                    </div>                </div>            </div>            <div class="bs-chooser-search-box-container">                <input class="form-control bs-form-control bs-chooser-search-field" placeholder="Search..." type="text" ng-model="searchQuery" ng-model-options="{ debounce: 250 }" />            </div>            <search-filter></search-filter>        </div>        <div class="bs-chooser-body">            <bs-search-table resource-type="{{ dialogScope.resourceType }}"                             is-row-selectable="rowSelectableCallback"                             row-template="chooserRow"                             multiselect="dialogScope.multiSelect"                             listdata="gridDataSource"                             selections="dialogScope.selections"                             confirmed-selections="dialogScope.confirmedSelections"                             base-query="dialogScope.baseQuery"                                                          <!--                             search-filters="dialogScope.searchFilters"                             -->                                                          panel-visible="dialogScope.panelVisible"                             accordion-items="dialogScope.accordionItems"                             class="chooser-body"></bs-search-table>        </div>        <div class="bs-chooser-footer">            <button id="new-btn" ng-if="isResourceCreatable" class="btn btn-lg btn-secondary pull-left" ng-click="requestNewResource()">New...</button>            <button id="cancel-btn" class="btn btn-lg btn-default" ng-click="clickCancel()">                Cancel            </button>            <button id="save-btn" class="btn btn-lg btn-primary" ng-click="clickConfirm()">                <span>Confirm</span>            </button>        </div>        <div class="clearfix"></div>    </div>',chooserFormControl:'<div class="chooser-multiselect">         <div class="choose-button">             <button class="btn" ng-disabled="disabled" ng-click="showDialog()" type="button">{{ message }}</button>         </div>         <table class="selected-resource-list">            <thead style="display:none;">                <tr class="header-row"><td class="first-col"></td><td class="last-col"></td></tr>                <tr class="select-all-row"><td class="first-col">Select All</td><td class="last-col"></tr>            </thead>            <tbody>                <tr ng-repeat="selectedItem in confirmedSelectionViewItems" data-bs-resource-id="{{ selectedItem.id }}">                    <td class="first-col">{{ selectedItem.name }}</td>                    <td class="last-col">                        <a class="remove ignore-link" href="#" rel="tooltip" title="Remove" ng-if="!disabled" ng-click="$event.preventDefault();removeItem(selectedItem)">×</a>                    </td>                </tr>            </tbody>         </table>     </div>',analysisDownloader:'<div class="row">        <div class="col-md-12">            <h5>Select files to be downloaded</h5>                   <div>                                <label for="allAnalysis" class="local-checkbox-label">                    <input id="allAnalysis" type="radio" name="analysis" ng-model="downloadFileTypeFilter" value="allFiles" />                    All analysis data files including Variant data (VCF), Aligned data (BAM), and FASTQ                </label>            </div>                     <div>                <input id="variantFiles" type="radio" name="analysis" ng-model="downloadFileTypeFilter" value="vcfFiles" class="local-checkbox" />                <label for="variantFiles" class="local-checkbox-label">                    Variant Data (VCF files)                </label>            </div>                      <div>                <input id="bamFilesChk" name="analysis" type="radio" ng-model="downloadFileTypeFilter" value="bamFiles" class="local-checkbox" />                <label for="bamFilesChk" class="local-checkbox-label">                    Aligned data (BAM files)                </label>            </div>                        <div class="row">                &nbsp;            </div>            <div class="row">                <div class="col-md-12">                    <button ng-disabled="!downloadBtnEnabled" class="btn btn-primary bs-btn-primary modal-confirm" ng-click="onTriggerDownloadUriClick()" type="button">Download your files</button>                </div>           </div>        </div>    </div>',downloader:'<div class="container-fluid">        <div class="row">            <div class="col-md-12"><h3>Download</h3></div>        </div>        <div class="row">            <div class="col-md-12">                BaseSpace utilizes a desktop client that allows for fast, reliable downloads transferred securely over SSL.                </div>            </div>        <div class="row">            &nbsp;        </div>        <div class="row animate-hide" ng-if="settings.dontShowDownloaderMessage">            <div class="col-md-12">                <a ng-click="onShowMessageClicked()" href="#">                    Need to install the downloader first?                </a>            </div>            <div class="col-md-12">                &nbsp;            </div>        </div>        <div class="row">            <div class="col-md-12">                <div class="alert alert-warning animate-hide" ng-hide="settings.dontShowDownloaderMessage">                    <h5>Install the BaseSpace downloader</h5>                    <div class="row">                        <div class="col-md-12">                            The downloader requires a one-time installation. Click to install the downloader on this machine. If the downloader is already installed, you can skip this step.                        </div>                    </div>                      <div ng-show="showAlternateDownload" class="row">                        <div class="col-md-12">                           If you are having trouble installing, try the alternative option <a ng-click="onInstallDownloaderAltClick()" href="#">here</a>                        </div>                    </div>                    <div class="row">                        &nbsp;                    </div>                    <div class="row">                        <div class="col-xs-6">                            <button class="btn btn-secondary modal-confirm" ng-click="onInstallDownloaderClick()" type="button">Install the Downloader</button>                        </div>                        <div class="col-xs-6">                            <a ng-click="onDontShowMessageClicked()" href="#">                                Don\'t show me this again                            </a>                        </div>                    </div>                </div>            </div>            </div>        <div ng-if="downloadType  == \'Run\'">            <bs-run-downloader></bs-run-downloader>        </div>        <div ng-if="downloadType == \'AppSession\'">            <bs-analysis-downloader></bs-analysis-downloader>        </div>        <div ng-if="downloadType == \'Project\'">            <bs-project-downloader></bs-project-downloader>            </div>        <div ng-if="downloadType == \'Sample\' || downloadType == \'SampleFile\'">            <bs-sample-downloader></bs-sample-downloader>            </div>    </div>',projectDownloader:'<div class="row">        <div class="col-md-12">            <button ng-disabled="!downloadBtnEnabled" class="btn btn-primary bs-btn-primary modal-confirm" ng-click="onTriggerDownloadUriClick()" type="button">Download your files</button>        </div>       </div>',runDownloader:'<div class="row">        <div class="col-md-12">            <h5>Select files to be downloaded</h5>            <div>                <input ng-disabled="!fastqDownloadEnabled" id="fastqFilesRdo" type="radio" name="run" ng-model="downloadFileTypeFilter" value="fastqFiles" class="local-checkbox" />                <label for="fastqFilesRdo" class="local-checkbox-label">                    All FASTQ files for this run                </label>            </div>            <div>                <input id="savFilesRdo" type="radio" name="run" ng-model="downloadFileTypeFilter" value="savFiles" class="local-checkbox" />                <label for="savFilesRdo" class="local-checkbox-label">                    SAV file <a ng-href="{{ savInfoUrl }}" target="_blank">Learn more about SAV</a>                </label>            </div>            <div ng-show="analysisLinkEnabled">                <div>                    <img data-help-text="Download analysis files." src="/public/images/information.png" />                    Analysis files including VCF and BAM can be downloaded from the Analysis page <a ng-href="{{ runAnalysisUrl }}" target="_top">here</a>                </div>            </div>            <div ng-show="!analysisLinkEnabled">                <div>                    <img data-help-text="Download analysis files." src="/public/images/information.png" />                    No analysis files are available for this run                </div>            </div>                        <div class="row">                &nbsp;            </div>            <div class="row">                <div class="col-md-12">                    <button ng-disabled="!downloadBtnEnabled" class="btn btn-primary bs-btn-primary modal-confirm" ng-click="onTriggerDownloadUriClick()" type="button">Download your files</button>                </div>           </div>        </div>    </div>',sampleDownloader:'<div class="row">        <div class="col-md-12">            <button ng-disabled="!downloadBtnEnabled" class="btn btn-primary bs-btn-primary modal-confirm" ng-click="onTriggerDownloadUriClick()" type="button">Download your files</button>        </div>       </div>',dragMask:'<div class="drag-mask" style="display:none;position:absolute;opacity:0.1;background-color: white;z-index:1000;top:0;left:0;width:100%;height:100%"></div>',dragSpreadsheet:'<div class="dragdrop-empty-container" ng-init="isTrayExpanded = false" ng-class="{ \'tray-expanded\' : isTrayExpanded }">                      <div ng-repeat="column in matrix.columns track by $index" style="height:100%"             class="col-xs-{{ 12 / matrix.columns.length | number:0 }}"             ng-init="initDragDropOptions($index, 0)">            <div class="dragdrop-empty-droparea"                 ng-class="{ first: $first, last: $last, even:$even, odd:$odd, middle:$middle, \'targeted\': matrix.targetedCells[$index][0]}"                 ng-show="!column.isLocked && column.nonEmptyItems.length == 0"                 bs-droppable                 drop-options="dropOptionsMatrix[$index][0]"                 drop-group="matrix">                <div class="dragdrop-empty-message">                    Drag and drop<br />items here                </div>            </div>        </div>    </div>    <div class="row bs-drag-spreadsheet-container" ng-class="{ \'tray-expanded\' : isTrayExpanded }" ng-click="clickSpreadsheet()" tabindex="1" ng-keyup="onKeyUp($event)">        <header>            <div class="col-count"></div>            <div class="col-content">                <div ng-repeat="column in matrix.columns" class="col-xs-{{ 12 / matrix.columns.length | number:0 }}" ng-class="{ first: $first, last: $last, even:$even, odd:$odd, middle:$middle}">                    <div class="bs-matrix-col-header" ng-class="{ \'with-actions\' : !column.isLocked && column.nonEmptyItems.length > 0 }">                        <h5 class="bs-section-heading">                            {{ column.title }} <div class="label label-default bs-chooser-badge" style="display:none">{{column.items.length}}</div>                        </h5>                        <span class="bs-matrix-clear-col" ng-if="!column.isLocked && column.nonEmptyItems.length > 0">                            <a href="#" ng-click="$event.preventDefault();clickSort($index)">                                Sort                                <span ng-show="column.isSorted" class="glyphicon" ng-class="{\'glyphicon-chevron-up\': column.isSortAsc, \'glyphicon-chevron-down\': !column.isSortAsc }"></span>                            </a> |                            <a href="#" ng-click="$event.preventDefault();clearColumnCells($index)">Clear all</a>                        </span>                    </div>                </div>                <div class="clearfix"></div>            </div>            <div class="clearfix"></div>        </header>        <div class="bs-spreadsheet-body">            <div class="col-count" ng-show="matrix.columns[0].isLocked || matrix.nonEmptyItems.length > 0">                <div ng-repeat="row in getRowCount() track by $index" ng-class="{ first: $first, last: $last, even:$even, odd:$odd, middle:$middle}">                    <span>{{ $index + 1 }}</span>                </div>            </div>            <div class="col-content">                <div ng-repeat="column in matrix.columns" class="col-xs-{{ 12 / matrix.columns.length | number:0 }}" ng-class="{ first: $first, last: $last, even:$even, odd:$odd, middle:$middle}">                    <div class="bs-matrix-col-body">                        <ul ng-show="column.isLocked || column.nonEmptyItems.length > 0">                            <li ng-init="initDragDropOptions($parent.$index, $index)" ng-repeat="item in column.items track by $index"                                ng-class="{                                        \'selected\' : matrix.selectedCells[$parent.$index][$index],                                        first: $first,                                        last: $last,                                        even: $even,                                        odd: $odd,                                        middle: $middle,                                        \'invalid\' :                                            matrix.invalidCells[$parent.$index][$index],                                        \'highlighted\' :                                            highlightedInvalidCell.columnNumber == $parent.$index &&                                            highlightedInvalidCell.rowNumber == $index,                                        \'targeted\' :                                            !matrix.selectedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index],                                        \'targeted-interior\' :                                            !matrix.selectedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index-1]                                            && matrix.targetedCells[$parent.$index][$index+1],                                        \'targeted-top\' :                                            !matrix.selectedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index]                                            && !matrix.targetedCells[$parent.$index][$index-1]                                            && matrix.targetedCells[$parent.$index][$index+1],                                        \'targeted-bottom\' :                                            !matrix.selectedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index-1]                                            && !matrix.targetedCells[$parent.$index][$index+1],                                        \'targeted-single\' :                                            !matrix.selectedCells[$parent.$index][$index]                                            && matrix.targetedCells[$parent.$index][$index]                                            && !matrix.targetedCells[$parent.$index][$index-1]                                            && !matrix.targetedCells[$parent.$index][$index+1],                                    }">                                <div bs-droppable                                     draggable="{{ !matrix.isLocked }}"                                     drop-options="dropOptionsMatrix[$parent.$index][$index]"                                     drop-group="matrix"                                     ng-click="toggleSelected($event, $parent.$index, $index, item)"                                     ng-mousedown="onMouseDown($event)">                                    <div bs-draggable                                         drag-options="dragOptionsMatrix[$parent.$index][$index]"                                         drag-group="matrix"                                         class="drag">                                        <span ng-if="!isResourceLinkEnabled || (isResourceLinkEnabled && item == null)" data-resource-id="{{item.id}}">                                            <span ng-if="matrix.invalidCells[$parent.$parent.$index][$index]">                                                <img src="/public/images/error.png" ng-title="{{matrix.invalidCells[$parent.$parent.$index][$index]}}" />                                                <bs-tooltip can-open-if="angular.isString(matrix.invalidCells[$parent.$parent.$index][$index])">                                                    <div class="bs-tooltip-content light">                                                        {{ matrix.invalidCells[$parent.$parent.$parent.$parent.$index][$parent.$parent.$index] }}                                                    </div>                                                </bs-tooltip>                                            </span> {{ item.name }}                                        </span>                                        <a ng-if="isResourceLinkEnabled && item != null" data-resource-id="{{item.id}}" ng-href="{{ item | mapDataType : 1 : 0 | uiHref : item.type }}">                                            {{ item.name }}                                        </a>                                        <span class="close" style="" ng-if="item && !column.isLocked" ng-click="$event.stopPropagation(); clearCell($parent.$parent.$index, $index)">&times;</span>                                    </div>                                </div>                            </li>                        </ul>                    </div>                    <div class="clearfix"></div>                </div>                <div class="clearfix"></div>            </div>            <div class="clearfix"></div>        </div>        <footer>            <bs-tray ng-show="isTrayVisible"                     attachment="bottom"                     is-expanded="isTrayExpanded"                     messages="matrix.errors"                     status-summary="matrix.statusSummary"                     on-click-read-more="onClickReadMore"                     on-mouse-enter-read-more="onMouseEnterReadMore"                     on-mouse-leave-read-more="onMouseLeaveReadMore">            </bs-tray>        </footer>    </div>',dropdownAction:'<div class="bs-dropdown-action" ng-class="{\'dropdown-visible\': dropDown.isVisible }">        <button class="btn btn-default btn-xs" type="button" ng-click="onActionClick($event)">            {{ actionLabel }}            <span class="caret"></span>        </button>        <ng-transclude></ng-transclude>    </div>',ellipsisTooltip:'<div class="modal-tooltip" ng-click="killClickPropagation($event)" tabindex="-1">        <span class="tooltip-ellipsis-trigger"></span>        <div class="tooltip-body">            <span ng-transclude></span>        </div>    </div>',fileDropBox:'<div class="bs-drag-container" droppable="true">        <div class="bs-drag-mask" style="display:none;"></div>        <div class="bs-drag-inset-box">            <div ng-transclude></div>            <input type="file" ng-disabled="isDisabled" multiple="multiple" id="files-to-upload" style="display:none" />        </div>    </div>',fileInputButton:'<div class="bs-file-input-container">        <label class="filename-label"></label>        <span class="bs-file-input-button">            {{buttonText}}            <input type="file" />        </span>        <label class="bs-file-input-label">{{defaultLabelText}}</label>    </div>',dropdown:'<select ng-model="selectedItemId" ng-options="choice.value as choice.label for choice in choices" class="form-control" ng-disabled="isDisabled">        <option ng-if="emptyMessage" value="">{{ emptyMessage }}</option>    </select>',grouperDialog:'<div class="bs-chooser-matrix" ng-show="dialogScope.isVisible">        <div class="bs-chooser-matrix-body">            <div class="col-xs-4 bs-search" ng-class="{ \'filter-tray-expanded\' : dialogScope.isFilterTrayExpanded }">                <div class="bs-chooser-header">                    <div class="row">                        <div class="col-xs-12">                            <div class="bs-chooser-title">                                <h3 class="bs-section-heading">{{ dialogScope.manager.message }}</h3>                                <div class="clearfix"></div>                            </div>                        </div>                    </div>                    <div class="bs-chooser-search-box-container">                        <input class="form-control bs-form-control bs-chooser-search-field" placeholder="Search..." type="text" ng-model="dialogScope.manager.searchQuery" ng-model-options="{ debounce: 250 }" />                    </div>                </div>                <div class="bs-chooser-body">                    <bs-search-table resource-type="{{ dialogScope.manager.resourceConfig.key }}"                                     is-row-selectable="dialogScope.manager.rowSelectableCallback"                                     grid-rows="dialogScope.manager.gridRows"                                     row-template="grouperRow"                                     multiselect="true"                                     listdata="dialogScope.manager.gridDataSource"                                     selections="dialogScope.manager.selections"                                     confirmed-selections="dialogScope.confirmedSelections"                                     base-query="dialogScope.manager.baseQuery"                                     search-filters="dialogScope.manager.searchFilters"                                     panel-visible="dialogScope.panelVisible"                                     accordion-items="dialogScope.accordionItems"                                     show-selection-control="false"                                     show-filters="true"                                     show-badge-data="true"                                     show-selected-items-list="false"                                     show-select-all-label="true"                                     drag-options="dialogScope.manager.searchListDragOptions"                                     max-pagination-buttons="5"                                     class="chooser-body">                    </bs-search-table>                </div>                <div class="clearfix"></div>            </div>            <div class="col-xs-8 bs-matrix">                <bs-drag-spreadsheet matrix="dialogScope.manager.dialogMatrix"                                     drag-options="dialogScope.manager.matrixDragOptions"                                     on-item-removed="dialogScope.manager.onMatrixItemRemoved"                                     on-column-items-cleared="dialogScope.manager.onMatrixItemRemoved"                                     class="bs-drag-spreadsheet"></bs-drag-spreadsheet>            </div>            <div class="clearfix"></div>        </div>        <div class="bs-chooser-matrix-footer">            <button id="cancel-btn" class="btn btn-default bs-btn-default-bordered modal-cancel" ng-click="clickCancel()">                Cancel            </button>            <button id="save-btn" class="btn btn-primary bs-btn-primary modal-confirm" ng-disabled="!isConfirmEnabled()" ng-click="clickConfirm()">                <span>Confirm</span>            </button>        </div>        <div class="clearfix"></div>    </div>',
uiAllGrouperRow:'<div ng-switch="rowData.Type" class="bs-search-table-item">        <div ng-switch-when="sample">            <div class="bs-search-table-item"                 bs-draggable                 drag-options="column.dragOptions"                 drag-group="column.dragGroup">                <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mouseenter="tooltipEnabled=true">                    {{ rowData.Sample.SampleId }}                    <span class="bs-item-info-icon">                        <img ng-src="/public/images/information.png" />                        <bs-tooltip ng-if="tooltipEnabled" placement="ne">                            <bs-preview type="sample" sample="{ Response: rowData.Sample }" id="{{ rowData.Sample.Id }}"></bs-preview>                        </bs-tooltip>                    </span>                </div>            </div>        </div>        <div ng-switch-when="appresult">            <div class="bs-search-table-item"                 bs-draggable                 drag-options="column.dragOptions"                 drag-group="column.dragGroup">                <div class="bs-item-title">                    {{ rowData.AppResult.Name }}                    <span class="icomoon icon-ellipsis bs-item-info-icon">                        <bs-tooltip placement="ne">                            <bs-preview type="appresult" appresult="{ Response: rowData.AppResult }" id="{{ rowData.AppResult.Id }}"></bs-preview>                        </bs-tooltip>                    </span>                </div>            </div>        </div>    </div>',sampleGrouperRow:'<div class="bs-search-table-item"            bs-draggable            drag-options="column.dragOptions"            drag-group="column.dragGroup">        <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mouseenter="tooltipEnabled=true">            {{ rowData.Sample.SampleId }}            <span class="bs-item-info-icon">                <img ng-src="/public/images/information.png" />                <bs-tooltip ng-if="tooltipEnabled" placement="ne">                    <bs-preview type="sample" sample="{ Response: rowData.Sample }" id="{{ rowData.Sample.Id }}"></bs-preview>                </bs-tooltip>            </span>        </div>    </div>',appresultGrouperRow:'<div class="bs-search-table-item"            bs-draggable            drag-options="column.dragOptions"            drag-group="column.dragGroup">        <div class="bs-item-title">            {{ rowData.AppResult.Name }}            <span class="icomoon icon-ellipsis bs-item-info-icon">                <bs-tooltip placement="ne">                    <bs-preview type="appresult" appresult="{ Response: rowData.AppResult }" id="{{ rowData.AppResult.Id }}"></bs-preview>                </bs-tooltip>            </span>        </div>    </div>',grouperFormControl:'<div class="bs-matrix-form-control-container">        <div class="choose-button" ng-if="!isReadOnly">            <button class="btn" ng-disabled="isDisabled" ng-click="manager.showDialog()" type="button">{{ manager.message }}</button>        </div>        <div class="bs-matrix-form-control">            <bs-drag-spreadsheet matrix="manager.confirmedMatrix" class="bs-drag-spreadsheet" is-tray-visible="isTrayVisible" is-resource-link-enabled="isReadOnly"></bs-drag-spreadsheet>        </div>        <textarea json id="{{ inputFieldId }}" name="{{ inputFieldId }}" style="display:none;" ng-bind="manager.confirmedMatrix.columns | json"></textarea>    </div>',grouperDragElement:'<div class="payload-container"><div class="payload"><div class="payload-count-badge"><div class="payload-count-badge-text">{{ matrix.getNumSelectedItems() }}</div></div><div class="payload-staggered-box-graphics-container"><span ng-if="matrix.getNumSelectedItems() <= 3"><span ng-if="matrix.getNumSelectedItems() > 2"><div class="payload-box-graphic-staggered2"></div></span><span ng-if="matrix.getNumSelectedItems() > 1"><div class="payload-box-graphic-staggered1"></div></span><div class="payload-box-graphic"></div></span><span ng-if="matrix.getNumSelectedItems() > 3"><div class="payload-box-graphic-staggered3-for-many-items"></div><div class="payload-box-graphic-staggered2-for-many-items"></div><div class="payload-box-graphic-staggered1-for-many-items"></div><div class="payload-box-graphic"></div></span></div></div></div>',manifestImportForm:'<form name="importForm" class="clearfix" novalidate>        <div class="bs-uploader">            <div class="card">                <div class="card-left-area">                    <div class="heading1">Import type:</div>                    <div class="heading2">Manifest</div>                    <div class="line-over-filetype"></div>                    <div class="stack-page-import-type-sign">                        <div class="stack-page-import-type-sign-icon">                            <div class="drop-area-icon-font">                                                                    <span class="icomoon icon-default-file"></span>                            </div>                        </div>                        <div class="stack-page-import-type-sign-right-text">                            <div class="text1">File type:</div>                            <div class="text2">.txt</div>                        </div>                    </div>                    <div class="bs-form-section card-left-area-form-container">                        <div class="bs-form-section-group">                            <div class="spacer1"></div>                            <input class="bs-form-field-input" type="text" ng-model="taskManager.metadata.appResult.Name" name="appresultid" ng-maxlength="{{appresultNameMaxLength}}" maxlength="{{appresultNameMaxLength}}" ng-required="true" placeholder="Enter a name for your analysis" style="width:100%;" ng-disabled="taskManager.finishAsap" />                            <div class="spacer2"></div>                            <div class="buttons-group">                                <button class="btn btn-default" ng-click="clickCancelButton()" ng-disabled="isNotCancellable()">Cancel</button>                                <button class="btn btn-primary" ng-click="taskManager.onRequestComplete()" ng-disabled="importForm.$invalid || taskManager.finishAsap || !taskManager.isCompletable">Add to BaseSpace</button>                            </div>                            <div class="session-data-group">                                <div class="heading">Stats:</div>                                <div class="values-group">                                    <div class="form-group">                                        <dl>                                            <dt>                                                Total File Size                                            </dt>                                            <dd>                                                {{ taskManager.metadata.totalFileSize | bytes : 2 }}                                            </dd>                                            <div ng-repeat="(key, val) in taskManager.metadata.manifestTypeSummary">                                                <dt>{{key}}</dt>                                                <dd><ng-pluralize count="val" when="{\'0\': \'No files\', \'one\': \'1 file\', \'other\': \'{} files\'}"></ng-pluralize></dd>                                            </div>                                        </dl>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="card-right-area">                    <div class="alert alert-warning" ng-if="importForm.$invalid">                        <p ng-if="importForm.appresultid.$invalid">Please enter a name for this manifest.</p>                    </div>                      <bs-progress-item task="taskManager"></bs-progress-item>                    <div class="drop-area-container" ng-show="importerOptions.isFileSelectionEnabled">                        <div class="drop-area-box">                            <div class="stack-page-drop-area-signage-group">                                <div class="stack-page-drop-area-signage-inner-container">                                    <div class="stack-page-drag-and-drop-text">                                        <span class="heavy">Drag and drop</span> or <a href="#" class="bs-select-file" ng-click="onRequestFileDialog($event)">select files</a>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>            <div class="clearfix"></div>        </div>    </form>',analysisImportForm:'<form name="importForm" class="clearfix" novalidate>        <div class="bs-uploader">            <div class="card">                <div class="card-left-area">                    <div class="heading1">Import type:</div>                    <div class="heading2">Analysis</div>                    <div class="line-over-filetype"></div>                    <div class="stack-page-import-type-sign">                        <div class="stack-page-import-type-sign-icon">                            <div class="drop-area-icon-font">                                                                    <span class="icomoon icon-vcf"></span>                            </div>                        </div>                        <div class="stack-page-import-type-sign-right-text">                            <div class="text1">File types:</div>                            <div class="text2">.vcf</div>                            <div class="text2">.vcf.gz</div>                        </div>                    </div>                    <div class="bs-form-section card-left-area-form-container">                        <div class="bs-form-section-group">                            <div class="spacer1"></div>                            <input class="bs-form-field-input" type="text" ng-model="taskManager.metadata.appResult.Name" name="appresultid" ng-maxlength="{{appresultNameMaxLength}}" maxlength="{{appresultNameMaxLength}}" ng-required="true" placeholder="Enter a name for your analysis" style="width:100%;" ng-disabled="taskManager.finishAsap" />                            <bs-chooser-form-control resource-type="sample" confirmed-selections="selectedSamples" initial-selections="{{ initialChooserSelections }}" disabled="taskManager.finishAsap"></bs-chooser-form-control>                            <div class="spacer2"></div>                            <div class="buttons-group">                                <button class="btn btn-default" ng-click="clickCancelButton()" ng-disabled="isNotCancellable()">Cancel</button>                                <button class="btn btn-primary" ng-click="taskManager.onRequestComplete()" ng-disabled="importForm.$invalid || taskManager.finishAsap || !taskManager.isCompletable">Add to BaseSpace</button>                            </div>                            <div class="line-over-session-data"></div>                            <div class="session-data-group">                                <div class="heading">Stats:</div>                                <div class="values-group">                                    <div class="form-group">                                        <dl>                                            <dt>                                                Total File Size                                            </dt>                                            <dd>                                                {{ taskManager.metadata.totalFileSize | bytes : 2 }}                                            </dd>                                        </dl>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="card-right-area">                    <div class="alert alert-warning" ng-if="importForm.$invalid">                        <p ng-if="importForm.appresultid.$invalid">Please enter a name for this analysis.</p>                    </div>                      <bs-progress-item task="taskManager"></bs-progress-item>                    <div class="drop-area-container" ng-show="importerOptions.isFileSelectionEnabled">                        <div class="drop-area-box">                            <div class="stack-page-drop-area-signage-group">                                <div class="stack-page-drop-area-signage-inner-container">                                    <div class="stack-page-drag-and-drop-text">                                        <span class="heavy">Drag and drop</span> or <a href="#" class="bs-select-file" ng-click="onRequestFileDialog($event)">select files</a>                                    </div>                                </div>                            </div>                            <div class="bs-uploader-size-limit-piechart-group">                                <div class="pieContainer">                                    <div class="pieBackground"></div>                                    <div id="pie-slice" class="hold">                                        <div class="pie" ng-style="{ \'transform\': getRotationDegrees().under180 }"></div>                                    </div>                                    <div id="pie-slice2" class="hold">                                        <div class="pie" ng-style="{ \'transform\': getRotationDegrees().over180 }"></div>                                    </div>                                    <div class="whitecenter"></div>                                </div>                                <div class="bs-uploader-size-limit-piechart-text-container">                                    <div class="bs-uploader-size-limit-piechart-key">Total Import Size:</div>                                    <div style="display: inline; ">                                        <div class="bs-uploader-size-limit-piechart-value">{{ taskManager.metadata.totalFileSize | bytes : 2 }}<span class="bs-uploader-size-limit-piechart-value-light"> / {{ taskManager.maxFileSize | bytes }} max</span></div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>            <div class="clearfix"></div>        </div>    </form>',importer:'<div ng-if="importerOptions.isLoading" class="bs-loader-wrapper">        <div class="bs-loader">            <div class="bs-bar"></div>            <div class="bs-bar"></div>            <div class="bs-bar"></div>        </div>    </div>    <div ng-if="importerOptions.isError" class="bs-page-content-padding">        <p class="alert bs-importer-error">            You aren&#39;t able to resume this import.        </p>    </div>    <div ng-if="!isSupported" class="bs-page-content-padding alert alert-large alert-warning bs-notification-bar">        <p class="alert bs-importer-error">            Uploading files is not currently supported in your browser. In order to use this feature please use the latest version of Firefox, Chrome, IE 10+.        </p>    </div>    <div ng-show="!importerOptions.isError && isSupported" class="bs-page-content-padding">        <bs-file-drop-box id="dropbox" ng-model="files" is-disabled="!importerOptions.isFileSelectionEnabled" on-files-changed="dropBoxChanged">            <div ng-if="!importerOptions.type">                <div class="bs-uploader">                    <div class="drop-area-container initial-page-drop-area-container">                        <div class="drop-area-box initial-drop-area-box">                            <div class="limits-group">                                <div class="limits-heading">                                                Due to browser limitations, imports have the following constraints:                                </div>                                <ul>                                    <li>Maximum of <span class="bold">16 files</span> at a time</li>                                    <li>Maximum of <span class="bold">25 Gb</span> at a time</li>                                    <li><span class="bold">One</span> sample at a time</li>                                    <li>FASTQ Files must adhere to the <a href="#" ng-click="showFastqDetailsModal()">Illumina standard</a></li>                                </ul>                            </div>                            <div class="initial-signage-container">                                <div class="initial-page-drag-and-drop-text">                                    <span class="heavy">Drag and drop</span> or <a href="#" class="bs-select-file" ng-click="onRequestFileDialog($event)">select files</a>                                </div>                                <div id="samples-link" class="import-type-signage-box">                                    <div class="headline">Samples</div>                                    <div class="horizontal-line"></div>                                    <div class="bottom-area">                                        <div class="icon-font">                                            <span class="icomoon icon-fastq"></span>                                        </div>                                        <div class="right-text">                                            <div class="text1">File type:</div>                                            <div class="text2">.fastq.gz</div>                                        </div>                                    </div>                                </div>                                <div id="analyses-link" class="import-type-signage-box">                                    <div class="headline">Analyses</div>                                    <div class="horizontal-line"></div>                                    <div class="bottom-area">                                        <div class="icon-font">                                            <span class="icomoon icon-vcf"></span>                                        </div>                                        <div class="right-text">                                            <div class="text1">File type:</div>                                            <div class="text2">                                                .vcf<br>                                                .vcf.gz                                            </div>                                        </div>                                    </div>                                </div>                                <div id="manifests-link" class="import-type-signage-box">                                    <div class="headline">Manifests</div>                                    <div class="horizontal-line"></div>                                    <div class="bottom-area">                                        <div class="icon-font">                                            <span class="icomoon icon-default-file"></span>                                        </div>                                        <div class="right-text">                                            <div class="text1">File type:</div>                                            <div class="text2">.txt</div>                                        </div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>            <div ng-if="!importerOptions.isError" ng-switch="importerOptions.type">                <bs-sample-import-form class="bs-import-type-sample" ng-switch-when="sample" importer-options="importerOptions" on-import-complete="onImportComplete" on-import-cancelled="onImportCancelled" on-request-file-dialog="onRequestFileDialog"></bs-sample-import-form>                <bs-analysis-import-form class="bs-import-type-analysis" ng-switch-when="analysis" importer-options="importerOptions" on-import-complete="onImportComplete" on-import-cancelled="onImportCancelled" on-request-file-dialog="onRequestFileDialog"></bs-analysis-import-form>                <bs-manifest-import-form class="bs-import-type-manifest" ng-switch-when="manifest" importer-options="importerOptions" on-import-complete="onImportComplete" on-import-cancelled="onImportCancelled" on-request-file-dialog="onRequestFileDialog"></bs-manifest-import-form>            </div>        </bs-file-drop-box>    </div>',fastqDetailsModalBody:"<ul>        <li>The uploader will only support gzipped FASTQ files generated on Illumina instruments</li>        <li>            The name of the FASTQ files must conform the following convention:            <ul>                <li>SampleName_SampleNumber_Lane_Read_FlowCellIndex.fastq.gz (i.e. SampleName_S1_L001_R1_001.fastq.gz / SampleName_S1_L001_R2_001.fastq.gz)</li>                <li>The read descriptor in the FASTQ files must conform to the following convention:</li>                <li>                    @Instrument:RunID:FlowCellID:Lane:Tile:X:Y ReadNum:FilterFlag:0:SampleNumber:                    <ul>                        <li>Read 1 descriptor would look like this: <br /> <code>@M00900:62:000000000-A2CYG:1:1101:18016:2491 1:N:0:13</code></li>                        <li>Read 2 would have a 2 in the ReadNum field, like this:<br /> <code>@M00900:62:000000000-A2CYG:1:1101:18016:2491 2:N:0:13</code></li>                    </ul>                </li>            </ul>        </li>    </ul>    <br/>    <h4>Quality considerations</h4>    <ul>        <li>The number of base calls for each read must equal the number of quality scores</li>        <li>The number of entries for Read 1 must equal the number of entries for Read 2</li>        <li>The uploader will determine if files are paired-end based on the matching file names in which the only difference is the ReadNum</li>        <li>For paired-end reads, the descriptor must match for every entry for both reads 1 and 2</li>        <li>Each read has passed filter</li>    </ul>",sampleImportForm:'<form name="importForm" class="clearfix" novalidate>        <div class="bs-uploader">            <div class="card">                <div class="card-left-area">                    <div class="heading1">Import type:</div>                    <div class="heading2">Sample</div>                    <div class="line-over-filetype"></div>                    <div class="stack-page-import-type-sign">                        <div class="stack-page-import-type-sign-icon">                            <div class="drop-area-icon-font">                                                                    <span class="icomoon icon-fastq"></span>                            </div>                        </div>                        <div class="stack-page-import-type-sign-right-text">                            <div class="text1">File type:</div>                            <div class="text2">.fastq.gz</div>                        </div>                    </div>                    <div class="standards-link-text">                        <a href="#" ng-click="$event.preventDefault();showFastqDetailsModal()">Illumina FASTQ file standard</a>                    </div>                    <div class="bs-form-section card-left-area-form-container">                        <div class="bs-form-section-group">                            <div class="spacer1"></div>                            <input class="bs-form-field-input" type="text" ng-model="taskManager.metadata.sample.SampleId" name="sampleid" ng-maxlength="{{sampleNameMaxLength}}" maxlength="{{sampleNameMaxLength}}" ng-required="true" ng-pattern="/^[a-zA-Z0-9-_]*$/" placeholder="enter Sample ID" style="width:100%;" ng-disabled="taskManager.finishAsap" />                            <div bs-dropdown-menu resource-type="genome" params="{ limit: 100 }" selected-item-id="taskManager.metadata.genome.Id" style="width:100%;" empty-message="-- None --" is-disabled="taskManager.finishAsap"></div>                            <div class="spacer2"></div>                            <div class="buttons-group">                                <button class="btn btn-default" ng-click="clickCancelButton()" ng-disabled="isNotCancellable()">Cancel</button>                                <button class="btn btn-primary" ng-click="taskManager.onRequestComplete()" ng-disabled="importForm.$invalid || taskManager.finishAsap || !taskManager.isCompletable">Add to BaseSpace</button>                            </div>                            <div class="line-over-session-data"></div>                            <div class="session-data-group">                                <div class="heading">Stats:</div>                                <input type="hidden" name="readone" ng-model="taskManager.metadata.sample.Read1" min="1" />                                <input type="hidden" name="readtwo" ng-model="taskManager.metadata.sample.Read2" />                                <input type="hidden" name="pairedend" ng-model="taskManager.metadata.sample.IsPairedEnd" />                                             <div class="values-group">                                    <div class="form-group">                                        <dl>                                            <dt>                                               Read 1:                                            </dt>                                            <dd>                                                {{ taskManager.metadata.sample.Read1 }}                                            </dd>                                            <dt>                                                Read 2:                                            </dt>                                            <dd>                                                {{ taskManager.metadata.sample.Read2 }}                                            </dd>                                            <dt>                                                Paired End:                                            </dt>                                            <dd>                                                {{ taskManager.metadata.sample.IsPairedEnd ? "Yes" : "No" }}                                            </dd>                                            <dt>                                                Reads Passing Filter                                                <span class="badge icomoon icon-info" style="font-size:8px;">                                                    <bs-tooltip placement="e">                                                        <div class="bs-tooltip-content dark">The percentage of reads passing filter for this sample.</div>                                                    </bs-tooltip>                                                </span>                                            </dt>                                            <dd>                                                {{ taskManager.metadata.sample.TotalClustersPF / taskManager.metadata.sample.TotalClustersRaw | fractionToPercent }}                                            </dd>                                            <dt>                                                Total Reads                                            </dt>                                            <dd>                                                {{ taskManager.metadata.sample.TotalClustersRaw | number }}                                            </dd>                                            <dt>                                                Total File Size                                            </dt>                                            <dd>                                                {{ taskManager.metadata.totalFileSize | bytes : 2 }}                                            </dd>                                        </dl>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>                <div class="card-right-area">                    <div class="alert alert-warning" ng-if="importForm.$invalid">                        <p ng-if="importForm.sampleid.$invalid">Please enter an ID for your sample (using only alphanumeric characters, hyphens, or underscores).</p>                        <div ng-if="importForm.readone.$error.read1FileMissing">                            <p ng-repeat="msg in readTwoMissingReadOneMessage">                                {{msg}}                            </p>                        </div>                        <div ng-if="importForm.readtwo.$error.read2FileMissing">                            <p ng-repeat="msg in readOneMissingReadTwoMessage">                                {{msg}}                            </p>                        </div>                    </div>                    <bs-progress-item task="taskManager"></bs-progress-item>                    <div class="drop-area-container" ng-show="importerOptions.isFileSelectionEnabled">                        <div class="drop-area-box">                            <div class="stack-page-drop-area-signage-group">                                <div class="stack-page-drop-area-signage-inner-container">                                    <div class="stack-page-drag-and-drop-text">                                        <span class="heavy">Drag and drop</span> or <a href="#" class="bs-select-file" ng-click="onRequestFileDialog($event)">select files</a>                                    </div>                                </div>                            </div>                            <div class="bs-uploader-size-limit-piechart-group">                                <div class="pieContainer">                                    <div class="pieBackground"></div>                                    <div id="pie-slice" class="hold">                                        <div class="pie" ng-style="{ \'transform\': getRotationDegrees().under180 }"></div>                                    </div>                                    <div id="pie-slice2" class="hold">                                        <div class="pie" ng-style="{ \'transform\': getRotationDegrees().over180 }"></div>                                    </div>                                    <div class="whitecenter"></div>                                </div>                                <div class="bs-uploader-size-limit-piechart-text-container">                                    <div class="bs-uploader-size-limit-piechart-key">Total Import Size:</div>                                    <div style="display: inline; ">                                        <div class="bs-uploader-size-limit-piechart-value">{{ taskManager.metadata.totalFileSize | bytes : 2 }}<span class="bs-uploader-size-limit-piechart-value-light"> /  {{ taskManager.maxFileSize | bytes }} max</span></div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>            <div class="clearfix"></div>        </div>    </form>',launchAppDropDown:'<span class="dropdown {{ appDropdownOpen }}">        <button data-toggle="dropdown" data-target="#" class="btn bs-toolbar-btn btn-large bs-toolbar-main-btn-apps" ng-click="onAppLaunchMenuClick()">            <span class="icomoon icon-rocket"></span> <label>Launch app</label>        </button>        <ul class="dropdown-menu bs-apps-menu" role="menu">            <li ng-hide="applicationsList.length" style="margin-left:20px">Loading <img src="/Content/images/loading-icon-mini.gif" alt="..." /></li>            <li ng-repeat="application in applicationsList">                <a class="btn-launch" href="/apps/{{ application.id }}/start?redirectToPreferredVersion=true&project-id={{ project.Id }}{{ sample && sample.Id ? \'&sample-id=\' + sample.Id : \'\' }}" data-trigger="hover" target="_self">                    <img width="30" height="30" class="app-icon" ng-src="{{ application.hrefLogo }}" alt="">                    {{ application.name }}                    <bs-tooltip placement="e">                        <div class="bs-tooltip-heading light">                            <hgroup class="bs-apps-heading-small">                                <img width="57" height="57" class="bs-apps-icon-medium" ng-src="{{ application.hrefLogo }}" alt="">                                <h1 class="bs-apps-title">{{ application.name }}</h1>                                <h4 class="bs-apps-companyname">{{application.companyName}}</h4>                            </hgroup>                        </div>                        <div class="bs-tooltip-content dark">                            <p>{{application.shortDescription}}</p>                            <div ng-show="application.longDescription.length > 0">                                <hr>                                <p ng-bind-html="application.longDescription"></p>                            </div>                        </div>                    </bs-tooltip>                </a>            </li>        </ul>    </span>',
loader:'<div class="bs-loader-wrapper" ng-if="showLoader">        <div class="bs-loader">            <div class="bs-bar"></div>            <div class="bs-bar"></div>            <div class="bs-bar"></div>        </div>    </div>',bsLogTextAreaTemplate:'<div class="bs-log-textarea">    <textarea id="logTextarea" class="log-textarea" readonly ng-bind="bind()" rows="{{rows}}"></textarea>    <span id="lastUpdateSpan" class="last-update-span" ng-bind="lastUpdateStamp"></span></div>',markdownEditor:'<ul class="nav nav-tabs">        <li ng-class="{ \'active\' : !isPreview }"><a href="#" ng-click="$event.preventDefault();isPreview=false">Write</a></li>        <li ng-class="{ \'active\' : isPreview }"><a href="#" ng-click="$event.preventDefault();isPreview=true">Preview</a></li>    </ul>    <div class="tab-content bs-util-padding-vertical-double">        <div ng-show="!isPreview">            <div ng-transclude></div>        </div>        <div style="height: 200px; overflow: auto;" ng-show="isPreview" class="well">            <div marked="model"></div>        </div>    </div>',analysisConfirmStopModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Are you sure you want to stop analysis?</h4>        </div>                <div class="modal-body" ng-if="errorMessage">            <p class="alert alert-danger">{{errorMessage}}</p>        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-disabled="isStopping" ng-click="onCancelClick()">Cancel</button>            <button class="btn btn-primary bs-btn-primary modal-confirm" ng-disabled="isStopping" type="button" ng-class="{\'bs-btn-loading\': isStopping}" ng-click="onConfirmClick()">{{isStopping && \'Stopping...\' || \'Stop\'}}</button>        </div>    </div>',editAnalysisModal:'<div class="bs-ng-modal-dialog-wrapper">    <div class="bs-ng-modal-dialog-header">            <h4>Edit Analysis</h4>                    </div>    <div class="bs-ng-modal-dialog-body">    <form id="edit-project-form" name="editProjectForm">        <div class="form-group">            <label for="name-input">Name</label><input id="name-input" name="analysisName" class="form-control bs-form-control" ng-model="nameInput" rows="1" placeholder="Name" required />        </div>        <div ng-show="!nameInput.length" class="alert alert-danger">            A name is required for this analysis.        </div>        <div ng-show="nameInput.length >= 100" class="alert alert-warning">        Analysis name must contain less than 100 characters        </div>    </form></div><div ng-show="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>            <button ng-class="{ \'disabled\': !nameInput.length }" ng-disabled="!nameInput.length" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onSaveClick()">Save</button>        </div></div>',bioSampleCreateModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Create Biological Sample</h4>        </div>        <div class="bs-ng-modal-dialog-body">            <form id="create-sample-form" name="formSample">                <div class="form-group sh">                    <label for="id-input">Sample ID <span class="required-mark">*</span></label>                    <input id="id-input" name="sampleID" class="form-control bs-form-control bs-np-form-control-vertical-layout" ng-model="sampleForm.sampleID" rows="1" ng-attr-placeholder="{{sampleIDPlaceholder}}" ng-change="onSampleIDChange()" required />                </div>                <div ng-show="!formSample.sampleID.$pristine && formSample.sampleID.$error.required && userHasEnteredText" class="alert alert-danger">                    Sample ID is not specified                </div>                <div class="form-group sh">                    <label for="name-input">Name <span class="required-mark">*</span></label>                    <input id="name-input" name="sampleName" class="form-control bs-form-control bs-np-form-control-vertical-layout" ng-model="sampleForm.sampleName" rows="1" ng-attr-placeholder="{{sampleNamePlaceholder}}" required />                </div>                <div ng-show="!formSample.sampleName.$pristine && formSample.sampleName.$error.required && userHasEnteredText" class="alert alert-danger">                    Name is not specified                </div>                <div class="form-group sh">                    <label for="bio-sample-species-input">Species</label>                    <select id="bio-sample-species-input"                            name="speciesSelected"                            class="form-control bs-form-control-select"                            ng-class="{\'bs-form-control-selected\': sampleForm.speciesSelected}"                            ng-model="sampleForm.speciesSelected"                            data-ng-options="value.Name for value in species"                            required></select>                </div>                <div ng-show="!formSample.speciesSelected.$pristine && formSample.speciesSelected.$error.required" class="alert alert-danger">                    Species is not specified                </div>                <div class="form-group sh">                    <label for="bio-sample-nucleic-acid-input">Nucleic Acid</label>                    <select id="bio-sample-nucleic-acid-input"                            class="form-control bs-form-control-select"                            ng-class="{\'bs-form-control-selected\': sampleForm.nucleicAcidSelected}"                            name="nucleicAcidSelected"                            ng-model="sampleForm.nucleicAcidSelected">                        <option>DNA</option>                        <option>RNA</option>                    </select>                </div>            </form>        </div>        <div ng-show="errorMessage" class="alert alert-danger">            {{ errorMessage }}        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>            <button class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onCreateClick()">Create</button>        </div>    </div>',bioSamplePickerModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Select a Biological Sample</h4>        </div>        <div class="bs-ng-modal-dialog-body" style="height:490px; overflow: auto;">            <bs-tang-grid grid-options="gridOptions" selections="selections"></bs-tang-grid>        </div>        <div class="modal-footer">            <button id="new-btn" class="btn btn-default bs-btn-default-bordered pull-left" ng-click="onNewClick()">New...</button>            <button class="btn modal-cancel btn-default bs-btn-default" type="button" ng-click="onCancelClick()">Cancel</button>            <button class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onSelectClick()" ng-disabled="selections.length == 0">Select</button>        </div>    </div>',bootstrapModal:'<div class="modal fade in" style="display:block;">        <div class="bs-modal-dialog modal-dialog" ng-class="dialogScope.ngClass">            <div class="modal-content" ng-transclude></div>        </div>    </div>',bootstrapModalHeader:'<div class="modal-header" ng-transclude></div>',bootstrapModalBody:"<div class=\"modal-body\">        <div ng-transclude></div>        <div ng-if=\"showCountdown\">            <ng-pluralize count=\"autoConfirmCountdown\" when=\"{'0': 'Completing...', 'one': 'Completing in 1 second...', 'other': 'Completing in {} seconds...'}\"></ng-pluralize>        </div>    </div>",bootstrapModalFooter:'<div class="modal-footer" ng-transclude></div>',bootstrapModalFooterButtons:'<div class="bs-modal-footer-buttons">        <button class="btn btn-default bs-btn-default modal-confirm" ng-if="options.clickCancel" ng-click="options.clickCancel()" ng-disabled="isLoading">            <span>{{ options.cancelLabel }}</span>        </button>        <button class="btn btn-primary bs-btn-primary modal-confirm" ng-click="options.clickConfirm()" ng-disabled="options.isConfirmDisabled() || isLoading">            <span>{{ options.confirmLabel }}</span>        </button>    </div>',downloadModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-body" style="padding:0;">            <iframe id="download-iframe" class="bs-download-iframe" ng-src="{{ dialogScope.downloadUri }}" />        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Close</button>        </div>    </div>',downloadRunModal:'<div class="bs-ng-modal-dialog-wrapper bs-download-run-modal">        <div class="bs-ng-modal-dialog-header">            <h4>Download Options</h4>            <h5>                <span class="icomoon {{ resource | runInstrumentIcon }}"></span>                {{ resourceName }}            </h5>        </div>        <div class="bs-ng-modal-dialog-body">        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>        </div>    </div>',createProjectModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>New Project</h4>                    </div>    <div class="bs-ng-modal-dialog-body">    <form id="edit-project-form" name="formProject">        <div class="form-group">            <label for="name-input">Name</label>                    <input id="name-input" name="projectName" class="form-control bs-form-control" ng-model="projectForm.projectName" rows="1" ng-attr-placeholder="{{projectNamePlaceholder}}" ng-change="onProjectNameChange()" required />        </div>        <div ng-show="!formProject.projectName.$pristine && formProject.projectName.$error.required && userHasEnteredText" class="alert alert-danger">            A project name is required.        </div>        <div ng-show="projectForm.projectName.length >= 100" class="alert alert-warning">        Project name must contain less than 100 characters        </div>        <div class="form-group">                    <label for="description-input">Description</label><textarea id="description-input" class="form-control bs-form-control" ng-model="projectForm.projectDescription" rows="4" placeholder="Description" />        </div>    </form></div><div ng-show="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>            <button class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onCreateClick()">Create</button>        </div></div>',editProjectModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Edit Project</h4>                    </div>    <div class="bs-ng-modal-dialog-body">    <form id="edit-project-form" name="editProjectForm">        <div class="form-group">            <label for="name-input">Name</label><input id="name-input" name="projectName" class="form-control bs-form-control" ng-model="nameInput" rows="1" placeholder="Name" required />        </div>        <div ng-show="!nameInput.length" class="alert alert-danger">            A name is required for this project.        </div>        <div ng-show="nameInput.length >= 100" class="alert alert-warning">        Project name must contain less than 100 characters        </div>        <div class="form-group">                    <label for="description-input">Description</label><textarea id="description-input" name="projectDescription" class="form-control bs-form-control" ng-model="descriptionInput" rows="4" placeholder="Description" />        </div>    </form></div><div ng-show="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>            <button ng-class="{ \'disabled\': !nameInput.length }" ng-disabled="!nameInput.length" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onSaveClick()">Save</button>        </div></div>',sampleCombineModal:'<div class="bs-ng-modal-dialog-wrapper">        <form name="combineSampleForm">            <div class="bs-ng-modal-dialog-header">                <h4>Combine samples</h4>            </div>            <div class="bs-ng-modal-dialog-body">                <div ng-show="vm.validationLoader" class="bs-loader">                    <div class="bs-bar"></div>                    <div class="bs-bar"></div>                    <div class="bs-bar"></div>                </div>                <div ng-show="vm.serverErrors.length">                    <div class="alert alert-danger" ng-repeat="serverError in vm.serverErrors">                        {{serverError.ErrorMessage}}                    </div>                </div>                <div ng-show="vm.serverWarnings.length && !vm.serverErrors.length">                    <div class="alert alert-warning" ng-repeat="serverWarning in vm.serverWarnings">                        {{ serverWarning.Message }}                    </div>                    <p>Are you sure you want to combine these samples?</p>                </div>                <div ng-show="!vm.serverErrors.length">                    <div>New Sample ID</div>                    <input class="form-control bs-form-control" type="text" ng-model="vm.newSampleIdName" name="newSampleId" required />                </div>            </div>            <div class="bs-ng-modal-dialog-footer">                <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>                <button ng-class="{ \'disabled\': combineSampleForm.$error.required }" ng-disabled="combineSampleForm.$error.required" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onCombineClick()">Combine</button>            </div>        </div>    </form>',sampleCopyModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Copy samples to project</h4>        </div>        <div class="bs-ng-modal-dialog-body" style="min-height:60px;">            <div class="col-sm-padder">                <span class="col-sm-4">Copy samples to:</span>                <div class="col-sm-8">                    <select class="form-control bs-form-control input-sm" ng-class="isLoadingProjects ? \'bs-btn-loading\' : \'\'" ng-model="selectedProject" ng-options="proj as proj.Name for proj in projects | filter:selectItems" ng-change="onSelectChange()">                        <option value="">(Select a Project)</option>                    </select>                </div>            </div>            <div class="alert alert-danger" ng-show="errorMessages.length > 0">            <div ng-repeat="error in errorMessages">                {{error}}            </div>            </div>        </div>        <div class="modal-footer">            <button class="btn modal-cancel btn-default bs-btn-default" type="button" ng-click="cancel()">Cancel</button>            <button class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-class="isSaving ? \'bs-btn-loading\' : \'\'" ng-click="copy()" ng-disabled="isNotValidProject">Copy</button>        </div>    </div>',getLinkModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Share By Link</h4>            <h5>                <span ng-if="dialogScope.resourceType == \'project\'" class="icomoon icon-project"></span>                <span ng-if="dialogScope.resourceType == \'run\'" class="icomoon {{ resource | runInstrumentIcon }}"></span>                {{ resourceName }}            </h5>        </div>        <div class="bs-ng-modal-dialog-body">            <p ng-if="!shareUrl">Click \'Activate\' to generate a new URL for sharing.</p>            <p ng-if="shareUrl">Copy the below URL and send it to anyone you want to share with.</p>            <input ng-if="shareUrl" class="form-control bs-form-control" type="text" value="{{ shareUrl }}" />        </div>        <div class="alert alert-danger" ng-show="errorMessage.length">            {{errorMessage}}        </div>        <div ng-if="warningMessage" class="alert alert-warning">            {{ warningMessage }}        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Close</button>            <button ng-if="!shareUrl" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onActivateClick()">Activate</button>            <button ng-if="shareUrl && !warningMessage" class="btn btn-danger bs-btn-danger modal-confirm" type="button" ng-click="onDeactivateClick()">Deactivate</button>            <button ng-if="warningMessage" class="btn btn-danger bs-btn-danger modal-confirm" type="button" ng-click="onDeactivateConfirmClick()">Yes - Deactivate</button>        </div>    </div>',shareModal:'<div ng-if="isLoading" class="bs-loader-wrapper">        <div class="bs-loader">            <div class="bs-bar"></div>            <div class="bs-bar"></div>            <div class="bs-bar"></div>        </div>    </div>    <div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Share This <span style="text-transform:capitalize">{{dialogScope.resourceType}}</span></h4>            <h5>                <span ng-if="dialogScope.resourceType == \'project\'" class="icomoon icon-project"></span>                <span ng-if="dialogScope.resourceType == \'run\'" class="icomoon {{ resource | runInstrumentIcon }}"></span>                {{ resourceName }}            </h5>        </div>        <form name="shareForm" novalidate>            <div class="bs-ng-modal-dialog-body">                <p>                    Invite A Collaborator                </p>                <input class="form-control bs-form-control" name="email" type="email" ng-model="shareForm.userEmail" ng-minlength="5" required placeholder="{{ usernamePlaceholder }}" autocomplete="off" />                                                                <textarea class="form-control bs-form-control" name="personalMessage" ng-model="shareForm.message" placeholder="Message (optional)" ng-maxlength="140"></textarea>                                <div ng-show="dialogScope.resourceType !== \'project\'">                    <input type="checkbox" ng-model="includeAssociatedResources" class="" style="float:left;" name="chkAssociated" id="chkAssociated">                    <label for="chkAssociated" style="font-weight:normal;margin-left:4px;width:auto;height:auto;">                        Share the associated Project(s) as well (<span style="font-weight:bold">Recommended</span>)<br/>                        Unchecking this box will limit what the receipient will have access to.                    </label>                </div>                <div class="alert alert-danger" ng-show="!shareForm.personalMessage.$valid">                    {{getPersonalMessageError(shareForm.personalMessage.$error)}}                </div>                <div class="alert alert-danger" ng-show="collaboratorError.length > 0">                    {{collaboratorError}}                </div>                <div>                    <button ng-class="{ \'disabled\': !shareForm.$valid }" ng-enabled="myForm.email.$valid && myForm.email.length && !myForm.email.$pristine" class="btn btn-success" ng-click="invite()">Add Collaborator</button>                </div>                <div class="bs-modal-project-collaborator-container" id="collaborators-list" ng-show="collaborators.length > 0">                    <h4 id="collaborator-count">Collaborator Settings</h4>                    <div id="collaborators">                        <ul ng-repeat="collaborator in collaborators">                            <li ng-hide="collaborator.markedForDeletion" class="bs-modal-project-collaborator-item bs-modal-project-collaborator-item-visible">                                <span class="collaborator-user-name" id="collaborator-user-name">{{collaborator.email}}</span>                                <a class="bs-modal-project-collaborator-remove-btn close pull-right" name="remove-btn" ng-click="markForDeletion(collaborator)">×</a>                                <div class="pull-right">                                    <select class="form-control bs-form-control input-sm pull-right bs-modal-project-collaborator-permission-select" name="permissions" id="permission-types" ng-model="collaborator.permission" ng-options="permissionLevel.value as permissionLevel.text for permissionLevel in permissionLevels" ng-change="collaboratorPermissionChanged()">                                        <option value="READ">Read Only</option>                                        <option value="WRITE" ng-show="dialogScope.resourceType === \'project\'">Write</option>                                    </select>                                </div>                                <div ng-show="!collaborator.grantId" class="bs-modal-project-status">pending</div>                            </li>                            <li class="bs-modal-project-collaborator-item bs-modal-project-collaborator-remove-confirmation alert alert-danger" ng-show="collaborator.markedForDeletion == true">                                <span class="bs-modal-project-collaborator-username">{{collaborator.email}}</span>                                <a class="bs-modal-project-collaborator-remove-btn close pull-right" name="remove-btn">×</a>                                <div class="pull-right">                                    <a class="btn btn-mini btn-danger bs-modal-project-collaborator-btn-undo" name="undo-btn" ng-click="cancelMarkForDeletion(collaborator)">Undo</a>                                </div>                            </li>                        </ul>                    </div>                </div>            </div>            <div ng-show="!shouldShowConfirmCancelMessage" class="bs-ng-modal-dialog-footer">                <button class="btn modal-cancel btn-default bs-btn-default" ng-click="cancelClick()">Cancel</button>                <button class="btn btn-primary bs-btn-primary" type="button" ng-click="saveSettings()" ng-disabled="!permissionsChanged && !hasNewInvitees">Save Settings</button>            </div>                        <div ng-show="shouldShowConfirmCancelMessage" class="bs-ng-modal-dialog-footer">                <div id="button-bar-oncancel" class="alert alert-warning bs-modal-confirmation">                    <p id="cancel-message-alert">You will lose any unsaved changes.  Do you want to cancel?</p>                    <button class="btn btn-default bs-btn-default bs-modal-project-btn-confirm-yes modal-close" ng-click="closeModal()">Yes</button>                    <button class="btn btn-primary bs-btn-primary bs-modal-project-btn-confirm-no" ng-click="removeConfirmCancelMessage()">No</button>                </div>            </div>            <div class="alert alert-danger" ng-show="errorMessage.length > 0">{{errorMessage}}</div>                    </form>    </div>',shareToUserContext:'<div class="">        <bs-loader is-loading="isLoading"></bs-loader>        <div>                        <div class="dropdown inline" ng-show=\'contextItems.length > 0\'>                <label>Context to accept invite: </label>                <div class="dropdown-contents">                    <button class="btn btn-dropdown-inline dropdown-toggle" data-toggle="dropdown" type="button">                        {{ selectedShareContext.Name }}                    </button>                    <ul class="dropdown-menu">                        <li ng-repeat="value in contextItems" ng-click="updateShareContext(value.Id)">                            <a>{{value.Name}}</a>                        </li>                    </ul>                </div>            </div>        </div>    </div>',transferModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Transfer Ownership</h4>            <h5>                <span ng-if="dialogScope.resourceType == \'project\'" class="icomoon icon-project"></span>                <span ng-if="dialogScope.resourceType == \'run\'" class="icomoon {{ resource | runInstrumentIcon }}"></span>                {{ resourceName }}            </h5>        </div>        <div class="bs-ng-modal-dialog-body">            <form ng-show="!confirmStep" id="invite-form" name="inviteForm">                <div class="form-group">                    <label for="collaborator-email">New Owner</label>                    <input type="{{ transfereeInputType }}" name="emailAddress" id="transfer-email" class="form-control bs-form-control" ng-model="emailAddress" placeholder="{{ usernamePlaceholder }}" autocomplete="off" />                </div>                <div ng-show="invalidEmailMessage" class="alert alert-danger">                    {{invalidEmailMessage}}                </div>                <div class="form-group">                    <label for="personal-message">Optional Message</label>                    <textarea id="personal-message" class="form-control bs-form-control" name="personalMessage" ng-model="optionalMessage" rows="4" placeholder="Add a personal message (optional)"></textarea>                </div>            </form>                        <div ng-show="confirmStep" class="bs-transfer-confirm-step">                <p><strong>Please confirm you want to transfer ownership to {{ emailAddress }}.</strong></p>                <p> Once the transfer has been completed it cannot be undone.  The recipient of the transfer will be considered the legal owner of this project and its associated data.  Please make sure you are authorized by your organization to make this transfer before proceeding.</p>            </div>        </div>                <div class="alert alert-warning" ng-if="!confirmStep">            <p ng-if="dialogScope.resourceType == \'run\'">                <i class="glyphicon glyphicon-exclamation-sign"></i>                Transferring a Run only transfers ownership of the Run itself. Projects must be transferred individually.            </p>            <p ng-if="dialogScope.resourceType == \'project\'">                <i class="glyphicon glyphicon-exclamation-sign"></i>                Apps in your account that currently use this data may not function properly after the                data is transferred out of your account. Please review the <a href="/agreements/current/details?category=USER" target="_blank">BaseSpace User Terms of Use</a>                for more information.            </p>        </div>                <div class="alert alert-danger" ng-if="errorMessage.length">            {{ errorMessage }}        </div>                <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>            <button ng-if="!confirmStep" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onContinueClick()">Continue</button>            <button ng-if="confirmStep" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onTransferClick()">Transfer Now</button>        </div>    </div>',pendingTransferModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header">            <h4>Transfer Ownership Pending</h4>            <h5>                <span ng-if="dialogScope.resourceType == \'project\'" class="icomoon icon-project"></span>                <span ng-if="dialogScope.resourceType == \'run\'" class="icomoon {{ resourceIcon | runInstrumentIcon }}"></span>                {{ resourceName }}            </h5>        </div>        <div class="bs-ng-modal-dialog-body">            <p ng-if="dialogScope.resourceType == \'project\'">This project is pending transfer of ownership.</p>            <p ng-if="dialogScope.resourceType == \'run\'">This run is pending transfer of ownership.</p>        </div>        <div class="alert alert-danger" ng-if="errorMessage.length">            {{ errorMessage }}        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCloseClick()">Cancel</button>            <button class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onCancelTransferClick()">Cancel Transfer</button>        </div>    </div>',trashModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header"><h4>Moving item to trash</h4></div>        <div class="bs-ng-modal-dialog-body">            <div ng-hide="isDoneLoading" class="bs-loader">                <div class="bs-bar"></div>                <div class="bs-bar"></div>                <div class="bs-bar"></div>            </div>            <div ng-show="isDoneLoading">                <div ng-show="isPromptSectionVisible">                    <div class="alert alert-info" ng-show="dialogScope.resourceType === \'appSession\'">                        Deleting an analysis will delete the associated samples                    </div>                    <div class="alert alert-info" ng-show="dialogScope.resourceType === \'run\' && hasCollaborators">                        <div ng-switch="isOwner">                            <div ng-switch-when="true">There is shared data associated with this run.  Moving this run to the trash will remove collaborators&#39; access to that data.</div>                            <div ng-switch-default="false">You are not the owner of this data.  Moving this item to the trash will remove it from your account.</div>                        </div>                    </div>                    <div class="alert alert-info" ng-show="dialogScope.resourceType === \'project\'">                        <div ng-switch="isOwner">                            <div ng-switch-when="true">                                <div ng-show="hasCollaborators">There is shared data associated with this project.  Moving this run to the trash will remove collaborators&#39; access to that data.</div>                                Deleting a project will delete all associated data, including:                                <ul>                                    <li>Samples</li>                                    <li>Analyses</li>                                </ul>                            </div>                            <div ng-switch-default="false">You are not the owner of this data.  Moving this item to the trash will remove it from your account.</div>                        </div>                    </div>                    Are you sure you want to move the following item to the trash?                    <div class="bs-list-item" ng-repeat="item in itemsToTrash">                        {{item.resourceName}}                    </div>                    <br />                    <p>Total size: {{ totalSize | bytes }}</p>                </div>                <div ng-if="dialogScope.resourceType == \'run\'">                    <div ng-show="isTrashAssociatedAppSessVisible && !isProgressSectionVisible" class="bs-trash-associated-checkbox">                        <input type="checkbox" ng-model="trashAssocAppSession.sendToTrash" id="trash-associated" /> <label for="trash-associated">Include all associated data (analyses, samples, etc.) you own?</label>                    </div>                </div>                <div ng-show="isProgressSectionVisible">                    <div>{{ trashProgress.message }}</div>                    <div class="progress">                        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="{{ trashProgress.percentage }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ trashProgress.percentage }}%">                            <span class="sr-only">{{ trashProgress.percentage }}% Complete</span>                        </div>                    </div>                </div>            </div>        </div>        <div ng-class="{ \'bs-ng-modal-alert-scroll\': errorMessages.length > 2 }">            <div class="alert alert-danger" ng-show="errorMessages.length > 0" ng-repeat="errorMessage in errorMessages track by $index">                {{ errorMessage }}            </div>        </div>        <div ng-show="isWarningSectionVisible">            <div class="alert alert-warning">                <p>                    <i class="glyphicon glyphicon-exclamation-sign"></i>                    Apps in your account that currently use <ng-pluralize count="itemsToTrash.length" when="{\'1\': \'this {{resourceTypeLabelSingular}}\', \'other\' : \'these {{resourceTypeLabelPlural}}\'}"></ng-pluralize> may not function properly after <ng-pluralize count="itemsToTrash.length" when="{\'1\': \'this {{resourceTypeLabelSingular}} is\', \'other\' : \'these {{resourceTypeLabelPlural}} are\'}"></ng-pluralize> deleted.                    Please review the <a href="/agreements/current/details?category=USER" target="_blank">BaseSpace User Terms of Use</a> for more information.                </p>            </div>        </div>        <div class="bs-ng-modal-dialog-footer">            <div ng-hide="isProgressSectionVisible">                <button ng-show="btnCancelVisible" class="btn modal-cancel btn-default bs-btn-default" ng-click="onCancelClick()">Cancel</button>                <button ng-show="btnCloseVisible" class="ng-hide btn btn-primary bs-btn-primary modal-confirm" ng-click="onCancelClick()">Close</button>                <button ng-show="btnConfirmVisible" class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onConfirmClick()">Confirm</button>            </div>        </div>    </div>',
emptyTrashModal:'<div class="bs-ng-modal-dialog-wrapper">        <div class="bs-ng-modal-dialog-header"><h4>Empty Entire Trash</h4></div>        <div class="bs-ng-modal-dialog-body">            <p>Are you sure you want to permanently delete everything (including non-selected items) in the trash?</p>            <p>You can\'t undo this action!</p>            <p>Total size: {{ totalSize | bytes }}</p>        </div>        <div class="bs-ng-modal-dialog-footer">            <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onCancelClick()">Cancel</button>            <button class="btn btn-danger modal-confirm" type="button" ng-click="onDeleteClick()">Delete</button>        </div>    </div>',multiResourceDropdown:'<div ng-if="!resources || resources.length == 0" class="bs-multiresource-container">N/A</div>    <div ng-if="resources.length == 1" class="bs-multiresource-container">        <a ng-href="{{ getHref(resources[0]) }}" ng-bind="getName(resources[0])"></a>    </div>    <div ng-if="resources.length > 1" class="bs-multiresource-container">        <div class="bs-multiresource-badge">            <a href="#" ng-click="onMultipleLinkClick($event)">{{ resources.length | number }} {{ resourceNamePlural }}</a>        </div>        <div class="bs-multiresource-menu" ng-show="menu.isVisible">            <div class="bs-menu-arrow"></div>            <div class="row">                <div class="col-md-10"><h4>{{ resourceNamePlural }}</h4></div>                <div class="col-md-2"><a class="bs-menu-close" href="#" ng-click="onCloseClick($event)"><span class="icomoon icon-close"></span></a></div>            </div>            <div class="bs-multiresource-scrollable">                <ul>                    <li ng-repeat="resource in resources"><a ng-href="{{ getHref(resource) }}" ng-bind="getName(resource)"></a></li>                </ul>            </div>        </div>    </div>',navList:'<ul class="bs-navlist">        <li ng-repeat="li in items" ng-class="{ \'active\' : li.isActive() }">            <span ng-if="!li.href">{{ li.title }}</span>            <a ng-if="li.href" ng-href="{{ li.href }}" ng-attr-target="{{ li.target || undefined }}"><label>{{ li.title }}</label></a>        </li>    </ul>',navTabList:'<ul class="bs-navTablist">        <li ng-repeat="li in items" ng-class="{ \'active\' : li.isActive() }">            <a ng-href="{{ li.href }}" target="{{ li.target || \'_self\' }}">{{ li.title }}</a>            <span ng-if="li.getCount && li.getCount() > -1" class="count">{{ li.getCount() }}</span>        </li>    </ul>',preview:'<div ng-show="isLoading" class="bs-loader-wrapper">        <div class="bs-loader">            <div class="bs-bar"></div>            <div class="bs-bar"></div>            <div class="bs-bar"></div>        </div>    </div>    <div ng-if="!isLoading" ng-switch="type" class="bs-preview">        <div ng-switch-when="run">            <h4 class="metadata-title">                <a ng-href="{{ { Run: run.Response } | uiHref: \'run\' }}">{{ run.Response.ExperimentName }}</a>            </h4>            <table class="table metadata">                <tbody>                    <tr>                        <th>Last Modified</th>                        <td>{{ run.Response.DateModified | date:\'short\'}}</td>                    </tr>                    <tr>                        <th>Owner</th>                        <td>{{ run.Response.UserOwnedBy.Name }}</td>                    </tr>                    <tr>                        <th>Status</th>                        <td>{{ run.Response.Status }}</td>                    </tr>                    <tr>                        <th>Instrument type</th>                        <td>{{ run.Response.InstrumentType }}</td>                    </tr>                </tbody>            </table>            <div style="clear:both">&nbsp;</div>            <div ng-show="isChartVisible">                <h4 class="bs-section-subheading bs-preview-chart-run-title-{{ id }}" style="display: none;">Data by Cycle</h4>                <div class="bs-preview-chart-run-{{ id }} bs-preview-chart" style="width: 400px; height: 300px; position: relative">                    <div ng-show="isLoadingChart" class="bs-loader-wrapper">                        <div class="bs-loader">                            <div class="bs-bar"></div>                            <div class="bs-bar"></div>                            <div class="bs-bar"></div>                        </div>                    </div>                </div>            </div>              </div>        <div ng-switch-when="project">            <h4 class="metadata-title"><a ng-href="{{ { Project: project.Response } | uiHref: \'project\' }}">{{ project.Response.Name }}</a></h4>            <table class="table metadata">                <tr>                    <th>Date Created</th>                    <td>{{ project.Response.DateCreated | date: \'short\' }}</td>                </tr>                <tr>                    <th>Owner</th>                    <td>{{ project.Response.UserOwnedBy.Name }}</td>                </tr>            </table>            <div class="bs-preview-description" ng-if="project.Response.Description">{{ project.Response.Description }}</div>        </div>        <div ng-switch-when="app">            <h4 class="metadata-title"><a ng-href="{{ app.Response | preferredAppHref }}">{{ app.Response.Name }}</a></h4>            <table class="table metadata">                <tr>                    <th>Categories</th>                    <td><span ng-repeat="classification in app.Response.Classifications">{{ classification }}</span></td>                </tr>                <tr>                    <th>Company</th>                    <td>{{ app.Response.CompanyName }}</td>                </tr>            </table>            <div class="bs-preview-description" ng-if="app.Response.ShortDescription" marked="app.Response.ShortDescription" class="bs-user-html"></div>        </div>        <div ng-switch-when="appresult">            <h4 class="metadata-title"><a ng-href="{{ { AppResult: appresult.Response } | uiHref: \'appresult\' }}">{{ appresult.Response.Name }}</a></h4>            <table class="table metadata">                <tr>                    <th>Date Created</th>                    <td>{{ appresult.Response.DateCreated | date:\'short\'}}</td>                </tr>                <tr>                    <th>Owner</th>                    <td>{{ appresult.Response.UserOwnedBy.Name }}</td>                </tr>                <tr>                    <th>Size (bytes)</th>                    <td>{{ appresult.Response.TotalSize | bytes : 2 }}</td>                </tr>                <tr>                    <th>Analysis</th>                    <td>                        <img ng-if="appresult.Response.AppSession.Application"                         ng-src="{{ appresult.Response.AppSession.Application | appIconHref : \'thumb\' }}" width="30" height="30" />                    <a target="_blank" ng-href="{{ appresult.Response | appResultAppSessionHref }}">{{ appresult.Response.AppSession.Name }}</a>                    </td>                </tr>                <tr>                    <th>Project</th>                    <td>                        <a target="_blank" ng-href="{{ { Project : appresult.Response.Projects[0] } | uiHref : \'project\' }}">                            <span class="icomoon icon-project"></span> {{ appresult.Response.Projects[0].Name }}                        </a>                    </td>                </tr>            </table>        </div>        <div ng-switch-when="sample">            <h4 class="metadata-title"><a ng-href="{{ { Sample: sample.Response } | uiHref: \'sample\' }}">{{ sample.Response.SampleId }}</a></h4>            <table class="table metadata">                <tr>                    <th>Date Created</th>                    <td>{{ sample.Response.DateCreated | date:\'short\'}}</td>                </tr>                <tr>                    <th>Owner</th>                    <td>{{ sample.Response.UserOwnedBy.Name }}</td>                </tr>                <tr>                    <th>Read Length</th>                    <td>{{ sample.Response | readLengthString }}</td>                </tr>                <tr>                    <th>Reads PF</th>                    <td>{{ sample.Response.NumReadsPF | number }}</td>                </tr>                <tr>                    <th>Size (bytes)</th>                    <td>{{ sample.Response.TotalSize | bytes : 2 }}</td>                </tr>                <tr>                    <th>Genome</th>                    <td>{{ sample.Response.Genome | genome }}</td>                </tr>                <tr>                    <th>Project</th>                    <td>                        <a target="_blank" ng-href="{{ { Project : sample.Response.Projects[0] } | uiHref : \'project\' }}">                            <span class="icomoon icon-project"></span> {{ sample.Response.Projects[0].Name }}                        </a>                    </td>                </tr>            </table>        </div>        <div ng-switch-when="appresult_file">            <h4 class="metadata-title"><a ng-href="{{ { AppResultFile: file.Response } | uiHref: \'appresultfile\' }}" target="_blank">{{ file.Response.Name }}</a></h4>            <table class="table metadata">                <tr>                    <th>Date Created</th>                    <td>{{ file.Response.DateCreated | date:\'short\'}}</td>                </tr>                <tr>                    <th>Path</th>                    <td>/{{ file.Response | pathWithoutFilename }}</td>                </tr>                <tr>                    <th>Size (bytes)</th>                    <td>{{ file.Response.Size | bytes : 2 }}</td>                </tr>                <tr ng-if="file.Response.ParentProjects">                    <th>Project</th>                    <td>                        <a target="_blank" ng-href="{{ { Project : file.Response.ParentProjects[0] } | uiHref : \'project\' }}">                            <span class="icomoon icon-project"></span> {{ file.Response.ParentProjects[0].Name }}                        </a>                    </td>                </tr>                <tr ng-if="file.Response.ParentAppResult.AppSession">                    <th>Analysis</th>                    <td>                        <a target="_blank" ng-click="$event.stopPropagation()" ng-href="{{ (parentEntity && parentEntity.AppSessionRoot ? parentEntity : file.Response) | fileAppSessionUiHref }}">                            <span ng-if="file.Response.ParentAppResult.AppSession.Name == \'BaseSpace FastQ\'">                                <!-- remove after one native app for generating fastq files -->                                Generate FASTQ                            </span>                            <span ng-if="file.Response.ParentAppResult.AppSession.Name != \'BaseSpace FastQ\'">                                {{ (parentEntity && parentEntity.AppSessionRoot ? parentEntity.AppSessionRoot.Name : null) || (file.Response.ParentAppResult.AppSession.Name ? file.Response.ParentAppResult.AppSession.Name : file.Response.ParentAppResult.Name) }}                            </span>                        </a>                    </td>                </tr>                <tr ng-if="file.Response.ParentAppResult">                    <th>App Result</th>                    <td>                        <a target="_blank" ng-href="{{ { AppResult : file.Response.ParentAppResult } | uiHref : \'appresult\' }}">                            <span class="icomoon icon-analysis-report"></span> {{ file.Response.ParentAppResult.Name }}                        </a>                    </td>                </tr>            </table>            <div ng-if="showImagePreview">                <img ng-src="{{ { AppResultFile : file.Response } | uiHref : \'appresultfile\' }}" style="max-width:100%" />            </div>        </div>        <div ng-switch-when="dataset" class="datasets-preview">            <h4 class="metadata-title">FastQ Files</h4>            <div class="table-container">                <table class="clearfix">                    <tr>                        <th>Name</th>                        <th class="text-right">Size</th>                    </tr>                    <tr ng-if="datasetFiles.length > 0" ng-repeat="file in datasetFiles">                        <td class="name">{{ file.Name }}</td>                        <td class="text-right size">{{ file.Size | bytes : 2 }}</td>                    </tr>                    <tr ng-if="datasetFiles.length == 0">                        <td class="name">No files found</td>                    </tr>                </table>            </div>        </div>    </div>',progressItem:'<div class="list-item">        <div ng-if="task.uiConfig.showTask" class="item-box">            <div class="filename">{{ task.title }} <span class="subtitle" ng-if="task.subtitle">({{ task.subtitle }})</span></div>            <div class="progress-bar-row">                <div class="bs-uploader-progress-bar">                    <div class="percentage-bar" ng-class="progressBarClasses" ng-style="{ width: task.completion * 100 + \'%\' }"></div>                </div>                <div class="progress-bar-right-area">                    <div class="progress-bar-status">                        <div class="left-element">                            <bs-tooltip placement="n" watch="task.statusLabel,task.statusDescription" can-open-if="task.statusLabel ? true : false">                                <div class="bs-tooltip-heading light">{{ task.statusLabel }}</div>                                <div class="bs-tooltip-content dark">{{ task.statusDescription }}</div>                            </bs-tooltip>                            <div class="percentage" ng-switch="task.state">                                <span ng-switch-when="2">Cancelled</span>                                <span ng-switch-when="3">Cancelling</span>                                <span ng-switch-when="6">Failed <span class="icomoon icon-info"></span></span>                                <span ng-switch-when="0"><span class="icomoon icon-check"></span></span>                                <span ng-switch-default title="{{ task.state | stateEnumToString }}">{{ task.completion | fractionToPercent : 0 }}</span>                            </div>                        </div>                        <div class="right-element">                            <div class="action"><span ng-if="canShowCancelButton" ng-click="task.cancel()"><span class="icomoon icon-close"></span></span></div>                        </div>                    </div>                </div>                <div class="clearfix"></div>            </div>        </div>        <div ng-show="task.uiConfig.showSubtasks" class="bs-subtasks imported-items-list"></div>    </div>',searchDialog:'<div class="bs-search-dialog layout20-selector">        <div ng-show="typeaheadOptions.source.isLoading" class="bs-loader-wrapper">            <div class="bs-loader">                <div class="bs-bar"></div>                <div class="bs-bar"></div>                <div class="bs-bar"></div>            </div>        </div>        <div ng-class="{ \'with-preview\' : isItemHighlighted }">            <form method="get" action="/search/" ng-submit="onSubmit($event)">                <bs-typeahead typeahead-options="typeaheadOptions">                </bs-typeahead>                <span class="icomoon icon-search bs-search-input-icon"></span>                <button class="bs-search-dialog-submit bs-btn bs-btn-primary" type="submit">Go</button>            </form>            <div class="bs-search-dialog-empty-message bs-search-dialog-list-container" ng-if="isEmptyMessageVisible()">                <h3>No results found.</h3>            </div>            <div class="bs-search-dialog-empty-message bs-search-dialog-list-container" ng-show="!typeaheadOptions.inputValue">                <h3>You can search for...</h3>                <div class="bs-search-dialog-searchable-types">                    <div class="bs-search-dialog-searchable-item">                        <div class="bs-search-dialog-searchable-icon">                            <span class="illumicons icon-sample bs-search-dialog-empty-message-bullet">                        </div>                        <div class="bs-search-dialog-searchable-label">                            Samples                        </div>                    </div>                    <div class="bs-search-dialog-searchable-item">                        <div class="bs-search-dialog-searchable-icon">                            <span class="illumicons icon-project bs-search-dialog-empty-message-bullet"></span>                        </div>                        <div class="bs-search-dialog-searchable-label">                            Projects                        </div>                    </div>                    <div class="bs-search-dialog-searchable-item">                        <div class="bs-search-dialog-searchable-icon">                            <span class="illumicons icon-MiSeq bs-search-dialog-empty-message-bullet"></span>                        </div>                        <div class="bs-search-dialog-searchable-label">                            Runs                        </div>                    </div>                    <div class="bs-search-dialog-searchable-item">                        <div class="bs-search-dialog-searchable-icon">                            <span class="illumicons icon-file bs-search-dialog-empty-message-bullet"></span>                        </div>                        <div class="bs-search-dialog-searchable-label">                            Files                        </div>                    </div>                    <div class="bs-search-dialog-searchable-item">                        <div class="bs-search-dialog-searchable-icon">                            <span class="illumicons icon-apps bs-search-dialog-empty-message-bullet"></span>                        </div>                        <div class="bs-search-dialog-searchable-label">                            Apps                        </div>                    </div>                </div>            </div>        </div>        <div class="bs-search-dialog-preview-container" ng-show="isItemHighlighted" ng-switch="typeaheadOptions.highlightedItemValue.resourceType">            <div ng-switch-when="project">                <bs-preview type="project" project="{ Response: typeaheadOptions.highlightedItemValue.resource }"></bs-preview>            </div>            <div ng-switch-when="sample">                <bs-preview type="sample" sample="{ Response: typeaheadOptions.highlightedItemValue.resource }"></bs-preview>            </div>            <div ng-switch-when="appresult">                <bs-preview type="appresult" appresult="{ Response: typeaheadOptions.highlightedItemValue.resource }"></bs-preview>            </div>            <div ng-switch-when="appresult_file">                <bs-preview type="appresult_file" file="{ Response: typeaheadOptions.highlightedItemValue.resource }"></bs-preview>            </div>            <div ng-switch-when="app">                <bs-preview type="app" app="{ Response: typeaheadOptions.highlightedItemValue.resource }"></bs-preview>            </div>            <div ng-switch-when="run">                <bs-preview type="run" show-chart-preview="true" run="{ Response: typeaheadOptions.highlightedItemValue.resource }"></bs-preview>            </div>        </div></div>',searchFilter:'<div class="tray" ng-class="{ \'visible\' : isTrayVisible }">        <div class="overlay-for-click" ng-click="toggle()">        </div>        <div class="toggle-tray-visibility-button unselectable" ng-click="toggle()">            <i class="fa fa-sliders"></i>            <div class="tray-header-title">Filters</div>            <div class="downleft-arrow"></div>            <div class="compound-border"></div>        </div>        <div class="tray-body-content" ng-class="{ \'visible\' : isTrayVisible }">            <div class="label-and-control-group">                <div ng-if="isMixed">                    <div class="wrap-select">                        <select ng-model="desiredResourceType"                                ng-init="initResourceTypeSelection()"                                ng-change="onResourceSelectionChange(desiredResourceType)"                                ng-options="resource.value as resource.label for resource in resourceFilterChoices"                                class="form-control bs-form-control"></select>                    </div>                    <hr/><br/>                </div>                <div ng-if="!allFilters.length">No Search Filters Available</div>                <div ng-repeat="filter in allFilters" class="form-group bs-form-section-group" ng-class="{{ filter.ngClass }}" ng-switch="filter.uiType">                    <label>{{ filter.label }}</label>                    <div>                        <div ng-switch-when="dropdown" class="wrap-select">                            <select ng-change="onFilterChoiceChange(filter)" ng-model="filter.currentChoice" ng-options="choice.label for choice in filter.choices track by choice.value" class="form-control bs-form-control" data-filter-id="{{ filter.id }}">                                    <option value="" ng-bind-template="All"></option>                            </select>                        </div>                        <input ng-switch-when="textbox" type="search" ng-change="onFilterChoiceChange(filter)" ng-model="filter.currentChoice.label" ng-model-options="{ debounce: 250 }" class="form-control bs-form-control" data-filter-id="{{ filter.id }}" />                    </div>                </div>            </div>        </div>    </div>',searchTable:'<bs-tang-grid grid-options="gridOptions" grid-rows="gridRows" selections="selections" class="bs-search-table-items" ng-class="{ \'panel-visible\' : panelVisible }"></bs-tang-grid>    <bs-search-filters resource-type="{{ resourceType }}" base-query="{{ baseQuery }}" search-filters="searchFilters"></bs-search-filters>',sampleChooserRow:'<div class="bs-search-table-item">        <div class="bs-item-icon">            <span class="icomoon icon-sample"></span>        </div>        <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mouseenter="tooltipEnabled=true">            {{ rowData.Sample.SampleId }}            <span class="bs-item-info-icon inline">                <img ng-src="/public/images/information.png" />                <bs-tooltip ng-if="tooltipEnabled" placement="ne">                    <bs-preview type="sample" sample="{ Response: rowData.Sample }" id="{{ rowData.Sample.Id }}"></bs-preview>                </bs-tooltip>            </span>        </div>        <div class="bs-item-details">            <div class="bs-item-details-item col-lg-1">{{ rowData.Sample.TotalSize | bytes : 2 }}</div>            <div class="bs-item-details-item col-lg-1">{{ rowData.Sample.DateCreated | date:\'short\' }}</div>            <div class="bs-item-details-item col-lg-2">{{ rowData.Sample.Genome | genome }}</div>            <div class="bs-item-details-item col-lg-2">Read length: {{ rowData.Sample | readLengthString }}</div>            <div class="bs-item-details-item col-lg-2">Reads PF: {{ rowData.Sample.NumReadsPF | number }}</div>            <div class="bs-item-details-item col-lg-2"><span class="icomoon icon-project"></span> {{ rowData.Sample.Projects[0].Name }}</div>            <div class="bs-item-details-item col-lg-2"><img width="20" height="20" ng-src="{{rowData.Sample.UserOwnedBy.GravatarUrl}}" /> {{ rowData.Sample.UserOwnedBy.Name }}</div>        </div>    </div>',appresultChooserRow:'<div class="bs-search-table-item">        <div class="bs-item-icon">            <span class="icomoon icon-analysis-report"></span>        </div>        <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mouseenter="tooltipEnabled=true">            {{ rowData.AppResult.Name }}            <span class="bs-item-info-icon inline">                <img ng-src="/public/images/information.png" />                <bs-tooltip ng-if="tooltipEnabled" placement="ne">                    <bs-preview type="appresult" appresult="{ Response: rowData.AppResult }" id="{{ rowData.AppResult.Id }}"></bs-preview>                </bs-tooltip>            </span>        </div>        <div class="bs-item-details">            <div class="bs-item-details-item col-lg-2">{{ rowData.AppResult.TotalSize | bytes : 2 }}</div>            <div class="bs-item-details-item col-lg-2">{{ rowData.AppResult.DateCreated | date:\'fullDate\' }}, {{ rowData.AppResult.DateCreated | date:\'shortTime\'}}</div>            <div class="bs-item-details-item col-lg-2"><span class="icomoon icon-project"></span> {{ rowData.AppResult.Projects[0].Name }}</div>        </div>    </div>',appresult_fileChooserRow:'<div class="bs-search-table-item">        <div class="bs-item-icon">            <span class="icomoon {{ rowData.AppResultFile | fileIcon }}"></span>        </div>        <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mousedown="tooltipEnabled=true">            {{ rowData.AppResultFile.Name }}            <span class="bs-item-info-icon inline">                <div class="modal-tooltip bottom-left" ng-click="$event.stopPropagation()" tabindex="-1">                    <img ng-src="/public/images/information.png" />                    <div class="tooltip-body" ng-if="tooltipEnabled">                        <div class="tooltip-body-container-lg">                            <bs-preview type="appresult_file" file=" { Response: rowData.AppResultFile } " id="{{ rowData.AppResultFile.Id }}"></bs-preview>                        </div>                    </div>                </div>                            </span>        </div>        <div class="bs-item-details">            <div class="bs-item-details-item col-lg-2">{{ rowData.AppResultFile.Size | bytes : 2 }}</div>            <div class="bs-item-details-item col-lg-3">{{ rowData.AppResultFile.ContentType }}</div>            <div class="bs-item-details-item col-lg-2"><span class="icomoon icon-project"></span> {{ rowData.AppResultFile.ParentProjects[0].Name }}</div>        </div>    </div>',projectChooserRow:'<div class="bs-search-table-item">        <div class="bs-item-icon">            <span class="icomoon icon-project"></span>        </div>        <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mouseenter="tooltipEnabled=true">            {{ rowData.Project.Name }}            <span class="bs-item-info-icon inline">                <img ng-src="/public/images/information.png" />                <bs-tooltip ng-if="tooltipEnabled" placement="ne">                    <bs-preview type="project" project="{ Response: rowData.Project }" id="{{ rowData.Project.Id }}"></bs-preview>                </bs-tooltip>            </span>        </div>        <div class="bs-item-details">            <div class="bs-item-details-item col-lg-3">{{ rowData.Project.DateCreated | date:\'fullDate\' }}, {{ rowData.Project.DateCreated | date:\'shortTime\'}}</div>            <div class="bs-item-details-item col-lg-3"><img width="20" height="20" ng-src="{{rowData.Project.UserOwnedBy.GravatarUrl}}" /> {{ rowData.Project.UserOwnedBy.Name }}</div>        </div>    </div>',genomeChooserRow:'<div class="bs-search-table-item">        <div class="bs-item-title" title="">{{ rowData.Genome.DisplayName }}</div>    </div>',runChooserRow:'<div class="bs-search-table-item">        <div class="bs-item-icon">            <span class="icomoon {{ rowData.Run | runInstrumentIcon }}"></span>        </div>        <div class="bs-item-title" ng-init="tooltipEnabled=false" ng-mouseenter="tooltipEnabled=true">            {{ rowData.Run.ExperimentName }}            <span class="bs-item-info-icon inline">                <img ng-src="/public/images/information.png" />                <bs-tooltip ng-if="tooltipEnabled" placement="ne">                    <bs-preview type="run" run="{ Response: rowData.Run }" id="{{ rowData.Run.Id }}"></bs-preview>                </bs-tooltip>            </span>        </div>        <div class="bs-item-details">            <div class="bs-item-details-item col-lg-2">{{ rowData.Run.Status }}</div>            <div class="bs-item-details-item col-lg-2">{{ rowData.Run.TotalSize| bytes : 2 }}</div>            <div class="bs-item-details-item col-lg-2">{{ rowData.Run.DateCreated | date:\'fullDate\' }}, {{ rowData.Run.DateCreated | date:\'shortTime\'}}</div>            <div class="bs-item-details-item col-lg-2"><img width="20" height="20" ng-src="{{rowData.Run.UserOwnedBy.GravatarUrl}}" /> {{ rowData.Run.UserOwnedBy.Name }}</div>        </div>    </div>',uiAllSearchResultsRow:'<div ng-switch="rowData.Type" class="bs-search-table-item">        <div ng-switch-when="sample">            <div class="bs-item-icon">                <span class="icomoon icon-sample"></span>            </div>            <div class="bs-item-title"><a target="_self" ng-href="{{ rowData | uiHref : SearchApiResourceTypes.SAMPLE }}" title="{{ rowData.Sample.SampleId }}">{{ rowData.Sample.SampleId }}</a></div>            <div class="bs-item-details">                <div class="bs-item-details-item col-sm-1">{{ rowData.Sample.TotalSize | bytes : 2 }}</div>                <div class="bs-item-details-item col-sm-2">{{ rowData.Sample.Genome | genome }}</div>                <div class="bs-item-details-item col-sm-2">Read length: {{ rowData.Sample | readLengthString }}</div>                <div class="bs-item-details-item col-sm-2">Reads PF: {{ rowData.Sample.NumReadsPF | number }}</div>                <div class="bs-item-details-item col-sm-2">                    <a target="_self" ng-href="{{ { Project : rowData.Sample.Projects[0] } | uiHref : \'project\' }}">                        <span class="icomoon icon-project"></span> {{ rowData.Sample.Projects[0].Name }}                    </a>                </div>            </div>        </div>        <div ng-switch-when="application">            <div class="bs-item-icon">                <img ng-src="{{ rowData.Application | appIconHref : \'thumb\' }}" height="30" width="30" />            </div>            <div class="bs-item-title"><a target="_self" ng-href="{{ rowData.Application | preferredAppHref }}" title="{{ rowData.Application.Name }}">{{ rowData.Application.Name }}</a></div>            <div class="bs-item-details">                <div class="bs-item-details-item col-sm-4">{{ rowData.Application.CompanyName }}</div>                <div class="bs-item-details-item col-sm-6">{{ rowData.Application.Classifications ? rowData.Application.Classifications.join(", ") : "" }}</div>            </div>        </div>        <div ng-switch-when="appresult">            <div class="bs-item-icon">                <span class="icomoon icon-analysis-report"></span>            </div>            <div class="bs-item-title"><a target="_self" ng-href="{{ rowData | uiHref : SearchApiResourceTypes.APPRESULT }}" title="{{ rowData.AppResult.Name }}">{{ rowData.AppResult.Name }}</a></div>            <div class="bs-item-details">                <div class="bs-item-details-item col-sm-2">{{ rowData.AppResult.TotalSize | bytes : 2 }}</div>                <div class="bs-item-details-item col-sm-2">{{ rowData.AppResult.DateCreated | date:\'fullDate\' }}, {{ rowData.AppResult.DateCreated | date:\'shortTime\'}}</div>                <div class="bs-item-details-item col-sm-2">                    <a target="_self" ng-href="{{ { Project : rowData.AppResult.Projects[0] } | uiHref : \'project\' }}">                        <span class="icomoon icon-project"></span> {{ rowData.AppResult.Projects[0].Name }}                    </a>                </div>            </div>        </div>        <div ng-switch-when="appresultfile">            <div class="bs-item-icon">                <span class="icomoon {{ rowData.AppResultFile | fileIcon }}"></span>            </div>            <div class="bs-item-title"><a target="_self" ng-href="{{ rowData | uiHref : SearchApiResourceTypes.APPRESULT_FILE }}" title="{{ rowData.AppResultFile.Name }}">{{ rowData.AppResultFile.Name }}</a></div>            <div class="bs-item-details">                <div class="bs-item-details-item col-sm-1">{{ rowData.AppResultFile.Size | bytes : 2 }}</div>                <div class="bs-item-details-item col-sm-2">                    <a target="_self" ng-href="{{ { AppResult : rowData.AppResultFile.ParentAppResult } | uiHref : \'appresult\' }}">                        <span class="icomoon icon-analysis-report"></span> {{ rowData.AppResultFile.ParentAppResult.Name }}                    </a>                </div>                <div class="bs-item-details-item col-sm-2">                    <a target="_self" ng-href="{{ { Project : rowData.AppResultFile.ParentProjects[0] } | uiHref : \'project\' }}">                        <span class="icomoon icon-project"></span> {{ rowData.AppResultFile.ParentProjects[0].Name }}                    </a>                </div>                <div ng-if="rowData.AppResultFile.Path.indexOf(\'/\') > -1" class="bs-item-details-item col-sm-3">                    {{ rowData.AppResultFile | pathWithoutFilename }}                </div>            </div>        </div>        <div ng-switch-when="project">            <div class="bs-item-icon">                <span class="icomoon icon-project"></span>            </div>            <div class="bs-item-title"><a target="_self" ng-href="{{ rowData | uiHref : SearchApiResourceTypes.PROJECT }}" title="{{ rowData.Project.Name }}">{{ rowData.Project.Name }}</a></div>            <div class="bs-item-details">                <div class="bs-item-details-item col-sm-2">{{ rowData.Project.DateCreated | date:\'fullDate\' }}, {{ rowData.Project.DateCreated | date:\'shortTime\'}}</div>                <div class="bs-item-details-item col-sm-2"><img width="20" height="20" ng-src="{{rowData.Project.UserOwnedBy.GravatarUrl}}" /> {{ rowData.Project.UserOwnedBy.Name }}</div>            </div>        </div>        <div ng-switch-when="genome">            <div class="bs-item-title" title="">{{ rowData.Genome.DisplayName }}</div>        </div>        <div ng-switch-when="run">            <div class="bs-item-icon">                <span class="icomoon {{ rowData.Run | runInstrumentIcon }}"></span>            </div>            <div class="bs-item-title"><a target="_self" ng-href="{{ rowData | uiHref : SearchApiResourceTypes.RUN }}" title="{{ rowData.Run.ExperimentName }}">{{ rowData.Run.ExperimentName }}</a></div>            <div class="bs-item-details">                <div class="bs-item-details-item col-sm-2">{{ rowData.Run.Status }}</div>                <div class="bs-item-details-item col-sm-2">{{ rowData.Run.TotalSize| bytes : 2 }}</div>                <div class="bs-item-details-item col-sm-2">{{ rowData.Run.DateCreated | date:\'fullDate\' }}, {{ rowData.Run.DateCreated | date:\'shortTime\'}}</div>                <div class="bs-item-details-item col-sm-2"><img width="20" height="20" ng-src="{{rowData.Run.UserOwnedBy.GravatarUrl}}" /> {{ rowData.Run.UserOwnedBy.Name }}</div>            </div>        </div>    </div>',
significantDigitsWithTooltip:'<bs-tooltip placement="n" ng-if="title"><div class="bs-tooltip-content light">{{title}}</div></bs-tooltip>    <span ng-class="{ \'bs-hastooltip\': title }">{{ value }}</span>',bsSlidePanel:'<div class="ilmn-slide-panel-padding" ng-class="{ \'animate-in\': isPanelVisible }">        <div class="ilmn-slide-panel">            <div class="ilmn-slide-panel-header">                <span class="ilmn-slide-panel-close fa fa-close" ng-click=\'onToggleVisibilityClick()\'></span>                <h4>{{ heading }}</h4>            </div>            <ng-transclude></ng-transclude>        </div>        <div class="ilmn-slide-panel-fader"></div>    </div>',bsOutputProject:'<div ng-if="projects.length == 1" class="bs-multiresource-container no-dropdown">        <a ng-href="{{ siteNavigationService.urlProjectSummary(projects[0].Id) }}" ng-bind="projects[0].Name" title="{{ projects[0].Name }}"></a>    </div>    <div ng-if="projects.length > 1" class="bs-multiresource-container" >        <div class="bs-multiresource-badge">            <a href="#" ng-click="onMultipleLinkClick($event)">{{ projects.length }} Projects</a>        </div>                <div class="bs-multiresource-menu" ng-show="projectsMenu.isVisible">            <div class="bs-menu-arrow"></div>            <div class="row">                <div class="col-md-10"><h4>Projects</h4></div>                <div class="col-md-2"><a class="bs-menu-close" href="#" ng-click="onCloseClick($event)"><span class="icomoon icon-close"></span></a></div>            </div>            <div class="bs-multiresource-scrollable">                <ul>                    <li ng-repeat="project in projects"><a ng-href="{{ siteNavigationService.urlProjectSummary(project.Id) }}" ng-bind="project.Name"></a></li>                </ul>            </div>        </div>    </div>',tangGrid:'<bs-loader is-loading="gridOptions.gridDataSource.isLoading"></bs-loader>    <bs-selection-count-badge ng-if="gridOptions.showBadgeData" badge-data="badgeData"></bs-selection-count-badge>    <table class="bs-table bs-table-full-width table">        <thead>            <tr bs-tang-grid-header></tr>        </thead>        <tbody>            <!-- put "no records" message in a row, so table bottom margin is applied under it -->            <tr ng-if="!gridOptions.gridDataSource.items.length && !gridOptions.gridDataSource.isLoading">                <td colspan="{{ gridOptions.headers.length + (gridOptions.allowSelection ? 1 : 0) }}">{{ gridOptions.noRecordsMessage }}</td>            </tr>            <tr bs-tang-grid-row draggable="true"                ng-repeat="gridRow in gridRows"                ng-class="{ selected: gridRow.itemExistsInSelection, selectable: gridRow.isRowSelectable, disabled: !gridRow.isRowSelectable }"                ng-click="onRowClicked(gridRow, $index, $event)"                ng-mousedown="onMouseDown($event)"></tr>        </tbody>    </table>        <bs-tang-grid-pagination class="bs-tang-grid-pagination"         max-pagination-buttons="gridOptions.maxPaginationButtons"         url-history-enabled="gridOptions.urlHistoryEnabled"         grid-data-source="gridOptions.gridDataSource"        grid-options="gridOptions">    </bs-tang-grid-pagination>',tangGridHeader:'<th ng-if="gridOptions.allowSelection" class="bs-table-checkbox-column" ng-class="{ \'with-label\' : gridOptions.showSelectAllLabel }">        <input ng-if="gridOptions.multiSelection" type="checkbox" ng-model="checkBoxAll.selected" ng-change="onCheckBoxAllChange()" style="display:inline;" />        <label ng-if="gridOptions.showSelectAllLabel" style="font-size:7pt;display:inline;">Select&nbsp;All</label>    </th>    <th ng-repeat="header in gridOptions.headers"         bs-tang-grid-header-column        grid-options="gridOptions"        header="header"        selections="selections"        ng-style="header.thStyle"        ng-class="header.thClass"        colspan=\'{{header.colspan}}\'>    </th>',tangGridHeaderColumn:'<div ng-class="header.divClass" class="header-text">        <a href="#"             ng-if="header.sortable"             ng-click="onClickSort(header.sortBy, $event)"             ng-bind-html="header.displayName">        </a>        <span             ng-if="!header.sortable"             ng-bind-html="header.displayName"></span>        <div             ng-if="header.filter"             class="bs-tang-grid-filter-container">            <bs-tang-grid-filter></bs-tang-grid-filter>        </div>        <span             ng-if="(header.sortBy == gridOptions.gridDataSource.sortBy) && header.sortable"             class="glyphicon"            ng-class="{\'glyphicon-chevron-up\': sortDirection.isSortAsc, \'glyphicon-chevron-down\': sortDirection.isSortDesc }">        </span>        <span            ng-if="(header.sortBy != gridOptions.gridDataSource.sortBy) && header.sortable"            class="glyphicon glyphicon-chevron-up" style="opacity: 0; color: transparent; display: none;">        </span>    </div>',tangGridFilter:'<a href="#" ng-click="onFilterClick($event)" class="bs-tang-grid-filter-toggle">        <span class="icomoon icon-filter"></span>    </a>    <div class="bs-tang-grid-menu-container">        <div ng-show="header.filterMenuVisibility" class="bs-tang-grid-filter-menu">            <div class="row">                <div class="col-xs-12">                    <label>Filter {{ header.filter.filterName }} by</label>                    <select ng-model="filterSelect.selectedVal" ng-options="filter.value as filter.label for filter in header.filter.filterList" class="form-control bs-form-control">                        <option value="">-- No Filter --</option>                    </select>                </div>            </div>            <div class="row">                <div class="col-xs-12">                    &nbsp;                </div>            </div>            <div class="row">                <div class="col-xs-12 text-right">                    <button class="btn modal-cancel btn-default bs-btn-default" ng-click="onFilterMenuCancelClick()">Cancel</button>                    <button class="btn btn-primary bs-btn-primary modal-confirm" type="button" ng-click="onFilterMenuConfirmClick()">Apply</button>                </div>            </div>        </div>    </div>',tangGridRow:'<td ng-if="gridOptions.allowSelection && gridOptions.showSelectionControl" class="bs-table-checkbox-column">        <input ng-if="gridOptions.multiSelection" type="checkbox" ng-model="checkBoxes[$index].selected" ng-click="onCheckBoxClick(gridRow, $parent.$index, $event)" ng-checked="gridRow.itemExistsInSelection" ng-disabled="!gridRow.isRowSelectable" />        <input ng-if="!gridOptions.multiSelection" type="radio" name="grid-selection" ng-click="onRadioClick(gridRow, $event)" ng-checked="gridRow.itemExistsInSelection" ng-disabled="!gridRow.isRowSelectable" />    </td>    <td ng-repeat="column in gridOptions.columns"        colspan="{{ ($index == 0 && !gridOptions.showSelectionControl && gridOptions.allowSelection) ? 2 : 1 }}"        ng-class="column.tdClass">        <bs-tang-grid-row-column grid-options="gridOptions" column="column" row-data="gridRow.item" row-number="$index"></bs-tang-grid-row-column>    </td>',tangGridPagination:'<ul class="pagination" ng-if="paginate.isPageable">        <li><a ng-click="onFirstPageClick($event)" href="#">&laquo;</a></li>        <li ng-class="{ disabled: paginate.isPageBackwardDisabled }">            <a ng-if="!paginate.isPageBackwardDisabled" ng-click="onPageBackwardClick($event)" href="#">&lsaquo;</a>            <a ng-if="paginate.isPageBackwardDisabled" href="#">&lsaquo;</a>        </li>        <li ng-repeat="pageItem in pageableRange.pageItems"            ng-class="{ active : pageItem.isActive }">            <a href="#" ng-click="onPageToClick(pageItem, $event)">{{ pageItem.pageNumber }}</a>        </li>        <li ng-class="{ disabled:  paginate.isPageForwardDisabled }">            <a ng-if="!paginate.isPageForwardDisabled"               ng-click="onPageForwardClick($event)" href="#">&rsaquo;</a>            <a ng-if="paginate.isPageForwardDisabled" href="#">&rsaquo;</a>        </li>        <li><a ng-click="onLastPageClick($event)" href="#">&raquo;</a></li>    </ul>',tooltip:'<div style="display: none">        <div class="bs-tooltip" ng-transclude>        </div>    </div>',trashIcon:'<div ng-class="{\'bs-trash-empty\' : trashCount == \'0\' }" class="bs-trash-count-container">    <a href="/settings/trash" target="_self" class="btn-link pull-right btn-trash">    <span class="bs-trash-label">View Trash</span>        <span class="icomoon icon-trashcan"></span>    </a>    <label class="bs-trash-badge" ng-if="trashCount">{{ trashCount | trashLabel }}</label></div>',tray:'<div class="bs-tray" ng-class="{ \'bottom\' : attachment == \'bottom\' }" ng-show="statusSummary.message">        <p ng-class="{ \'warning\' : statusSummary.type == bs.Common.Interfaces.MessageType[2] }">            <img ng-src="/public/images/error.png" alt="error" ng-if="statusSummary.type == 4" />            <img ng-src="/public/images/warning.png" alt="error" ng-if="statusSummary.type == 2" />            <span ng-if="statusSummary.type == 1">&#x2713;</span>         {{ statusSummary.message }} <a ng-show="messages.length > 0" href="#" class="bs-tray-toggle" ng-click="$event.preventDefault();toggleTray();"><span ng-show="isExpanded">Hide</span><span ng-show="!isExpanded">Show</span></a></p>        <div class="bs-tray-content" ng-class="{ \'expanded\' : isExpanded }">            <ul>                <li ng-repeat="message in messages track by $index">                    <a ng-if="message.readMoreMessage && message.readMorePlacement == 0"                       ng-href="{{readMoreHref}}"                       ng-click="onClickReadMore(message, $index, $event)"                       ng-mouseenter="onMouseEnterReadMore(message, $index, $event)"                       ng-mouseleave="onMouseLeaveReadMore(message, $index, $event)"                       ng-bind-html="message.readMoreMessage"></a>                    <span ng-bind-html="message.message"></span>                    <a ng-if="message.readMoreMessage && message.readMorePlacement == 1"                       ng-href="{{readMoreHref}}"                       ng-click="onClickReadMore(message, $index, $event)"                       ng-mouseenter="onMouseEnterReadMore(message, $index, $event)"                       ng-mouseleave="onMouseLeaveMore(message, $index, $event)"                       bg-bind-html="message.readMoreMessage"></a>                </li>            </ul>        </div>    </div>',truncateExpandLink:'&nbsp;<span class="bs-truncate-expand">...More</span>',typeahead:'<div class="bs-typeahead" >        <input type="text"               class="bs-typeahead-input"               ng-model="typeaheadOptions.inputValue"               ng-model-options="{ debounce : 500 }"               ng-keyup="onKeyUp($event)"               name="{{ typeaheadOptions.inputValueFormControlName }}"               placeholder="{{ typeaheadOptions.placeholder }}"               autocomplete="off" />                <ul class="bs-typeahead-match-list" ng-class="{ \'empty\' : typeaheadOptions.source.matches.length === 0 }">            <li bs-typeahead-match                ng-repeat="item in typeaheadOptions.source.matches"                ng-click="onClick(item)"                ng-mouseenter="onMouseEnter($event, item)"                item="item"                class="bs-typeahead-match"                ng-class="{ \'highlighted\' : isHighlighted(item), \'selected\' : isSelected(item), \'nonselectable\' : !item.selectable, \'selectable\' : item.selectable }"                selected="typeaheadOptions.selectedItemValue == item.value"                highlighted="typeaheadOptions.highlightedItemValue == item.value"                bs-scroll-with-me="typeaheadOptions.highlightedItemValue == item.value && item.selectable"></li>        </ul>        <div class="bs-typeahead-match-list mask" ng-class="{ \'apply\' : isUserScrollingWithKeys === true }" ng-mousemove="onMaskMousemove($event)">            <!-- used to block mouse events (accidental hovers) while user is scrolling with keyboard. -->        </div>    </div>',typeaheadCategoryTitle:"<h5>{{ item.title }}</h5>",appTypeaheadMatch:'<div class="bs-item-icon">        <img ng-src="{{ { Id : item.value.id } | appIconHref : \'thumb\' }}" class="small" width="22" height="22">    </div>    <div><a href="{{ item.href }}?preferredversion" target="_self">{{ item.title }}</a></div>',projectTypeaheadMatch:'<div class="bs-item-icon">        <span class="icomoon icon-project"></span>    </div>    <div><a href="{{ item.href }}" target="_self">{{ item.title }}</a></div>',sampleTypeaheadMatch:'<div class="bs-item-icon">        <span class="icomoon icon-sample"></span>    </div>    <div><a href="{{ item.href }}" target="_self">{{ item.title }}</a></div>',appresultTypeaheadMatch:'<div class="bs-item-icon">        <span class="icomoon icon-analysis-report"></span>    </div>    <div><a href="{{ item.href }}" target="_self">{{ item.title }}</a></div>',appresult_fileTypeaheadMatch:'<div class="bs-item-icon">        <span class="icomoon {{ item.data.AppResultFile | fileIcon }}"></span>    </div>    <div><a href="{{ item.href }}" target="_self">{{ item.title }}</a></div>',runTypeaheadMatch:'<div class="bs-item-icon">        <span class="icomoon {{ item.data.Run | runInstrumentIcon }}"></span>    </div>    <div><a href="{{ item.href }}" target="_self">{{ item.title }}</a></div>',selectionCountBadge:'<div class="bs-grid-scb">        <span class="bs-grid-scb-qty ng-binding">Showing {{ badgeData.getNumRowsDisplayed() }} of {{ badgeData.getTotalNumRows() }}</span>        <span ng-if="badgeData.getNumRowsSelected()" class="bs-grid-scb-num-selected ng-binding ng-scope">{{ badgeData.getNumRowsSelected() }} selected            <span class="bs-grid-scb-deselect" title="De-Select All" ng-click="badgeData.onClearSelectionsClick()">×</span>        </span>    </div>',datasetsLibraryCell:'<span ng-bind-html="gridOptions.dataAccessor.getLibraryCell(rowData)"></span>',datasetsLaneCell:'<span class="bs-numeric" ng-bind-html="gridOptions.dataAccessor.getLaneCell(rowData)"></span>',datasetsAnalysisCell:'<span ng-if="rowData.AppSession">        <a ng-href="{{ { AppSession : rowData.AppSession.AppSessionRoot || rowData.AppSession } | uiHref : \'appsession\' }}">            {{ rowData.AppSession.AppSessionRoot ? rowData.AppSession.AppSessionRoot.Name : rowData.AppSession.Name }}        </a>    </span>    <span ng-if="!rowData.AppSession">--</span>',datasetsProjectCell:'<span ng-if="rowData.Project">        <a target="_self" ng-href="{{ { Project : rowData.Project } | uiHref : \'project\' }}">            {{ rowData.Project.Name }}        </a>    </span>    <span ng-if="!rowData.Project">N/A</span>',datasetsBiosampleCell:'<span ng-bind-html="gridOptions.dataAccessor.getBiosampleCell(rowData)"></span>',datasetsRunCell:'<span ng-bind-html="gridOptions.dataAccessor.getRunCell(rowData)"></span>',datasetsApplicationCell:'<span ng-if="rowData.AppSession.Application">        <a ng-href="{{ { Application : (rowData.AppSession.AppSessionRoot && rowData.AppSession.AppSessionRoot.Application) || rowData.AppSession.Application } | uiHref : \'application\' }}" target="_self">            {{ rowData.AppSession.AppSessionRoot ? rowData.AppSession.AppSessionRoot.Application.Name : rowData.AppSession.Application.Name }}            (v{{ rowData.AppSession.AppSessionRoot ? rowData.AppSession.AppSessionRoot.Application.VersionNumber : rowData.AppSession.Application.VersionNumber }})        </a>    </span>    <span ng-if="!rowData.AppSession.Application">--</span>',fastqDatasetNameCell:'<span ng-if="rowData.dataset.Name">        <span class="dataset-name">            <span class="bs-grid-fastq-name">{{ rowData.dataset.Name }}</span>            <bs-tooltip placement="ne" ng-if="rowData.files">                <bs-preview type="dataset" dataset-files="rowData.files" view="files"></bs-preview>            </bs-tooltip>        </span>    </span>    <span ng-if="!rowData.dataset.Name"><a href="">{{ rowData.dataset.Id }}</a></span>',fastqDatasetsQcStatusCell:'<div ng-switch="rowData.dataset.QcStatus">        <div ng-switch-when="QcPassed">            <span class="status-text">QC Passed</span>        </div>        <div ng-switch-when="QcFailed">            <span class="status-text is-error">QC Failed</span>        </div>        <div ng-switch-when="Undefined">            <span class="status-text">--</span>        </div>        <div ng-switch-default>            <span class="status-text" ng-bind="rowData.dataset.QcStatus"></span>        </div>    </div>',generalDatasetNameCell:'<a ng-href="/datasets/{{ rowData.dataset.Id }}" target="_self">        <span ng-if="rowData.dataset.Name">            <span class="dataset-name">{{ rowData.dataset.Name }}</span>        </span>        <span ng-if="!rowData.dataset.Name">{{ rowData.dataset.Id }}</span>    </a>',analysisDeliveryStatusColumn:"<span ng-class=\"{ 'is-error': (rowData.DeliveryStatus | enumIsError : 'appSessionDeliveryStatus') }\"        >{{ rowData.DeliveryStatus | enumDisplayName : \"appSessionDeliveryStatus\" }}</span>",cancelAnalysesForm:'<form name="form" class="cancel-analyses-form" novalidate>        <div class="context-box">            <table class="table">                <thead>                    <tr>                        <th>ANALYSIS NAME</th>                    </tr>                </thead>                <tbody>                    <tr ng-repeat="selection in options.selections">                        <td ng-bind="selection.Name" title="{{selection.Name}}" class="cancel-analysis-name"></td>                    </tr>                </tbody>            </table>        </div>        <div>            <p>Do you want to cancel the selected analysis?</p>        </div>        <div class="alert alert-danger" ng-if="options.serverError">            <span ng-bind="options.serverError"></span>        </div>    </form>',updateDeliveryForm:'<form name="form" class="update-delivery-form" novalidate>        <div class="context-box">            <table class="table">                <thead>                    <tr>                        <th>Analyses</th>                        <th class="delivery-column">Delivery</th>                    </tr>                </thead>                <tbody>                    <tr ng-repeat="item in options.selections">                        <td ng-bind="item.Name"></td>                        <td><span ng-class="{ \'is-error\': (item.DeliveryStatus | enumIsError : \'appSessionDeliveryStatus\') }"                            >{{ item.DeliveryStatus | enumDisplayName : \'appSessionDeliveryStatus\' }}</span></td>                    </tr>                </tbody>            </table>        </div>                <div ng-if="options.areAllDeliveryStatusesAlike">            <br />                        <label for="new-status">Change status to</label><span class="error-text">*</span>            <select name="new-status" class="form-control bs-form-control"                     ng-model="options.deliveryStatus"                    ng-options="opt.value as opt.label for opt in availableOptions"                     required>                <option value="" disabled selected hidden>Please Select</option>            </select>        </div>                <br />                <div class="alert alert-warning" ng-if="!options.areAllDeliveryStatusesAlike">            <span>All items must have the identical delivery status in order to change them at the same time.</span>        </div>        <div class="alert alert-danger" ng-if="options.serverError">            <span ng-bind="options.serverError"></span>        </div>    </form>',appSessionCombinedStatus:'<div ng-class="ngClass" tabindex="-1" class="bs-app-session-combined-status">        <span ng-click="$event.stopPropagation()"             ng-class="{ \'is-error\': (appSession | appSessionCombinedStatusIsError),                         \'tooltip-text-trigger\': (appSession.StatusSummary | isNotEmptyString) }"             >{{ appSession | appSessionCombinedStatus }}</span>        <div ng-if="(appSession.StatusSummary | isNotEmptyString)" class="tooltip-body">            <div class="tooltip-body-container-sm">                <p>{{ appSession.StatusSummary }}</p>            </div>        </div>     </div>',updateQcStatusForm:'<form name="form" novalidate>        <div class="context-box">            <table class="table">                <thead>                    <tr>                        <th>{{ columnHeaderLabel }}</th>                        <th class="qc-status-column">QC Status</th>                    </tr>                </thead>                <tbody>                    <tr ng-repeat="item in options.selections">                        <td ng-bind="item.Name"></td>                        <td ng-switch="item.QcStatus">                            <span ng-switch-when="QcPassed">QC Passed</span>                            <span ng-switch-when="QcFailed" class="color-danger">QC Failed</span>                            <span ng-switch-when="Undefined">--</span>                            <span ng-switch-default ng-bind="item.QcStatus"></span>                        </td>                    </tr>                </tbody>            </table>        </div>        <br />        <div class="form-group" ng-if="options.areAllQcStatusesAlike">            <label for="new-status">Change status to</label><span class="error-text">*</span>            <select name="new-status" class="form-control bs-form-control"                     ng-model="options.status"                    ng-options="opt.value as opt.label for opt in availableOptions | filter: filterCurrentQcStatusOption track by opt.value"                     required>                <option value="" disabled selected hidden>Please Select</option>            </select>        </div>        <div class="alert alert-warning" ng-if="!options.areAllQcStatusesAlike">            <span>All items must have the identical status in order to change them at the same time.</span>        </div>        <div class="alert alert-danger" ng-if="options.serverError">            <span ng-bind="options.serverError"></span>        </div>    </form>',contextSwitch:'<bs-loader is-loading="isLoading"></bs-loader>    <div ng-if="!hasOrgs">         <div class="name">         {{::selectedContext.Name }}         </div>    </div>    <div ng-if="hasOrgs">        <div class="dropdown inline">            <button class="btn btn-dropdown-inline dropdown-toggle" data-toggle="dropdown" type="button">                {{::selectedContext.Name }}            </button>            <ul class="dropdown-menu">                <li ng-repeat="value in contextItems" ng-click="onClickContextSwitch(value.Id)">                    <a>{{::value.Name}}</a>                </li>            </ul>        </div>    </div>',toolbarDropdown:'<div class="dropdown icon" ng-init="isActionGroup = action.items ? true : false">        <a type="button" class="btn btn-icon"                ng-class="{\'dropdown-toggle\' : isActionGroup, \'disabled\' : !action.isEnabled() }"                data-toggle="dropdown" aria-expanded="true"                ng-click="isActionGroup || onClick(action)">            <span ng-if="action.iconClass" class="icon fa fa-fw {{:: action.iconClass }}"></span>            <span ng-if="action.iconTemplate" class="icon custom" ng-bind-html="sce.trustAsHtml(action.iconTemplate)"></span>            <br>            {{:: action.label }} <span ng-if="isActionGroup" class="fa fa-angle-down"></span>        </a>        <ul ng-if="isActionGroup" class="dropdown-menu pull-right">            <li ng-repeat="item in action.items" ng-class="{ \'disabled\' : !item.isEnabled(), \'dropdown-submenu\' : item.items }">                <span ng-if="!item.items" class="menu-action" ng-click="onClick(item)">{{:: item.label }}</span>                <a ng-if="item.items" class="account-option">{{:: item.label }}</a>                <ul ng-if="item.items" class="dropdown-menu">                    <li ng-repeat="subitem in item.items" ng-class="{ \'disabled\' : !subitem.isEnabled() }">                        <span class="menu-action" ng-click="onClick(subitem)">{{:: subitem.label }}</span>                    </li>                </ul>            </li>        </ul>    </div>',appSwitcherDesktop:'<ul class="nav navbar-nav product-dropdown">        <li class="dropdown">            <a class="dropdown-toggle product-button" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">                <span class="product-name"><span ng-bind-html="currentSite.title"></span><span class="fa fa-angle-down fa-lg"></span></span>            </a>            <ul class="dropdown-menu dropdown-menu-left product-links">                <li class="product-item" ng-repeat="site in dropdownSites">                    <a ng-href="{{ site.href }}">                        <div class="product-lens {{ site.class }}">                            <div class="el-1"></div>                            <div class="el-2"></div>                            <div class="el-3"></div>                            <div class="el-4"></div>                            <div class="el-5"></div>                            <div class="el-6"></div>                        </div>                        <span class="product-name {{ site.class }}" ng-bind-html="site.title"></span>                    </a>                </li>            </ul>        </li>    </ul>',appSwitcherMobile:'<li class="responsive-app-chooser">        <div class="panel">            <div class="panel-heading">                <a class="" href="#app-chooser-menu-tablet" data-toggle="collapse" data-parent="#accordion" aria-expanded="true" ng-click="toggleSubMenu($event, \'app-switcher\')">                BaseSpace<span class="fa fa-caret-down pull-right"></span>                </a>            </div>            <div id="app-chooser-menu-tablet" class="panel-collapse" aria-expanded="true" ng-class="{ \'collapse\' : !subMenuState[\'app-switcher\'] }">            <div class="panel-body">                <ul class="responsive-app-chooser-dropdown product-links">                    <li class="product-item" ng-repeat="site in dropdownSites">                        <a ng-href="{{ site.href }}">                            <div class="product-lens {{site.class}}">                                <div class="el-1"></div>                                <div class="el-2"></div>                                <div class="el-3"></div>                                <div class="el-4"></div>                                <div class="el-5"></div>                                <div class="el-6"></div>                            </div>                            <span class="product-name ac" ng-bind-html="site.title"></span>                        </a>                    </li>                </ul>            </div>        </div>    </li>',globalHeader:'<!-- ======================================= Desktop Navbar ======================================= -->    <div class="navbar-desktop">        <nav class="navbar navbar-default">            <div class="container-fluid">                <div class="navbar-header">                    <a class="navbar-brand">BaseSpace</a>                    <div class="product-lens sh">                        <div class="el-1"></div>                        <div class="el-2"></div>                        <div class="el-3"></div>                        <div class="el-4"></div>                        <div class="el-5"></div>                        <div class="el-6"></div>                    </div>                    <bs-app-switcher-desktop></bs-app-switcher-desktop>                </div><!-- /.navbar-header -->                        <!-- Menu Items -->                <div class="collapse navbar-collapse" id="navbar-menu-items">                    <!-- Main Navigation -->                    <ul class="nav navbar-nav navbar-menu-ul" id="navbar-menu-list">                        <li                                ng-repeat="li in globalHeaderListItems track by li.id"                                 id="navbar-menu-item-{{ $index + 1 }}"                                ng-mouseover="moveMarker($event)"                                data-ng-mouseleave="slideToActive()"                                ng-class="{ active : isMenuButtonActive(li.id),                                            dropdown: globalHeaderSecondaryListItems.hasOwnProperty(li.id) }"                                ng-switch="secondaryMenuData.hasOwnProperty(li.id)">                            <!-- non dropdown menu content -->                            <a ng-if="!globalHeaderSecondaryListItems.hasOwnProperty(li.id)" ng-href="{{ li.href }}" target="{{ li.target || \'_self\' }}">{{ li.title }}</a>                                                        <!-- drop down menu content -->                            <a ng-if="globalHeaderSecondaryListItems.hasOwnProperty(li.id)" href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">                                {{ li.title }}&ensp;<span class="fa fa-caret-down"></span>                            </a>                            <ul ng-if="globalHeaderSecondaryListItems.hasOwnProperty(li.id)" class="dropdown-menu">                                <li ng-repeat="dd in globalHeaderSecondaryListItems[li.id] track by dd.id"                                        ng-class="{ active : isMenuButtonActive(dd.id) }">                                    <a ng-href="{{ dd.href }}" target="{{ dd.target || \'_self\' }}">{{ dd.title }}</a>                                </li>                            </ul>                        </li>                                                <li id="navbar-menu-item-marker" ng-style="markerStyle" class="hidden-xs marker"></li>                    </ul>                        <!-- Utility Bar -->                    <ul class="nav navbar-nav navbar-right navbar-utility-bar-ul">                        <li ng-if="!disableSearch" bs-search-dialog-trigger>                            <a href=""><span class="fa fa-search"></span></a>                        </li>                        <li>                            <a href="https://help.basespace.illumina.com" target="_blank"><span class="fa fa-question fa-lg"></span></a>                        </li>                        <li ng-if="!disableTrash" ng-class="{ \'red-circle\' : trashCount > 0 }">                            <a ng-href="{{basespaceUrl}}/settings/trash" target="_self"><span class="fa fa-trash-o fa-lg"></span></a>                        </li>                        <li class="navbar-right-account account-dropdown dropdown">                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">                                <span class="fa fa-user fa-lg fa-fw pull-left"></span>                                <span class="navbar-username">&ensp;{{ user.Name }}</span>                                &ensp;<span class="fa fa-angle-down pull-right"></span>                              </a>                            <ul class="dropdown-menu dropdown-menu-left">                                <li ng-if="!user"><a><img src="/public/cdn/basespace/libraries/bootstrap/images/loading-small.gif" /></a></li>                                <li><span class="dropdown-user-name">{{ user.Name }}</span></li>                                <li><span class="dropdown-email">{{ user.Email }}</span></li>                                <li ng-if="user.StoreInfo"><a ng-href="{{storeWebsiteBaseUrl}}/myAccount/wallet"><span class="dropdown-icredits">iCredits: {{ user.StoreInfo.ICreditBalance | number }}</span></a></li>                                <li><a href="https://my.illumina.com" target="_self">MyIllumina Dashboard</a></li>                                                                <li ng-if=\'organizations === null || organizations.length > 0\' role="separator" class="divider"></li>                                <li ng-if=\'organizations === null\'><a><img src="/public/cdn/basespace/libraries/bootstrap/images/loading-small.gif" /></a></li>                                <li ng-if=\'organizations.length > 0\' ng-repeat="value in organizations track by value.Id" ng-click="onClickContextSwitch(value.Id)">                                    <a href="">{{value.Name}}</a>                                </li>                                <li ng-if=\'organizations === null || organizations.length > 0\' role="separator" class="divider"></li>                                                                <li><a ng-href="{{basespaceUrl}}/settings" target="_self">Settings</a></li>                                <li><a ng-href="{{basespaceUrl}}/agreements/toc" target="_self">Terms</a></li>                                <li><a href="http://blog.basespace.illumina.com" target="_blank">Blog</a></li>                                <li><a ng-href="{{basespaceUrl}}/auth/logout" target="_self">Sign Out</a></li>                            </ul>                        </li>                            <!-- Illumina Logo -->                        <li class="navbar-ilmn-logo">                            <a href="http://www.illumina.com"><img width="84" height="17" ng-src="{{basespaceUrl || \'\'}}/public/cdn/basespace/images/ILLUMINA_LOGO_small_new.png"/></a>                        </li>                    </ul>                </div><!-- /.navbar-collapse -->            </div><!-- /.container-fluid -->        </nav>    </div> <!-- /.show-full -->    <!-- ======================================= Tablet Navbar ======================================= -->        <div class="navbar-tablet">        <nav class="navbar navbar-default">                <div class="navbar-header">                    <bs-menu-mobile></bs-menu-mobile>                </div><!-- /.navbar-header -->                    <!-- Menu Items -->                <div class="collapse navbar-collapse">                    <!-- Utility Bar -->                    <ul class="nav navbar-nav navbar-right navbar-utility-bar-ul">                        <li ng-if="!disableSearch" bs-search-dialog-trigger><a href=""><span class="fa fa-search"></span></a></li>                        <li><a href="https://help.basespace.illumina.com" target="_blank"><span class="fa fa-question fa-lg"></span></a></li>                        <li ng-if="!disableTrash" ng-class="{ \'red-circle\' : trashCount > 0 }">                            <a ng-href="{{basespaceUrl}}/settings/trash" target="_self"><span class="fa fa-trash-o fa-lg"></span></a>                        </li>                        <li class="navbar-right-account account-dropdown dropdown">                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">                                <span class="fa fa-user fa-lg fa-fw pull-left"></span>                                <span class="navbar-username">&ensp;{{ user.Name }}</span>                                &ensp;<span class="fa fa-angle-down pull-right"></span>                              </a>                            <ul class="dropdown-menu dropdown-menu-left">                                <li ng-if="!user"><a><img src="/public/cdn/basespace/libraries/bootstrap/images/loading-small.gif" /></a></li>                                <li><span class="dropdown-user-name">{{ user.Name }}</span></li>                                <li><span class="dropdown-email">{{ user.Email }}</span></li>                                <li ng-if="user.StoreInfo"><span class="dropdown-icredits">iCredits: {{ user.StoreInfo.ICreditBalance | number }}</span></li>                                <li><a href="https://my.illumina.com" target="_self">MyIllumina Dashboard</a></li>                                                                <li ng-if=\'organizations === null || organizations.length > 0\' role="separator" class="divider"></li>                                <li ng-if=\'organizations === null\'><a><img src="/public/cdn/basespace/libraries/bootstrap/images/loading-small.gif" /></a></li>                                <li ng-if=\'organizations.length > 0\' ng-repeat="value in organizations track by value.Id" ng-click="onClickContextSwitch(value.Id)">                                    <a href="">{{value.Name}}</a>                                </li>                                <li ng-if=\'organizations === null || organizations.length > 0\' role="separator" class="divider"></li>                                                                <li><a ng-href="{{basespaceUrl}}/settings" target="_self">Settings</a></li>                                                                <li><a ng-href="{{basespaceUrl}}/agreements/toc" target="_self">Terms</a></li>                                <li><a href="http://blog.basespace.illumina.com" target="_blank">Blog</a></li>                                <li><a ng-href="{{basespaceUrl}}/auth/logout" target="_self">Sign Out</a></li>                            </ul>                        </li>                    </ul>                    </div><!-- /.navbar-collapse -->        </nav>        </div> <!-- /.show-tablet -->    <!-- ======================================= Mobile Navbar ======================================= -->        <div class="navbar-mobile">        <nav class="navbar navbar-default">                <div class="navbar-header">                    <bs-menu-mobile></bs-menu-mobile>                       <!-- Collapsed Utility Bar -->                    <div class="dropdown dropdown-accordion dropdown-responsive-utility-bar">                        <button class="btn btn-responsive-utility-bar" data-toggle="dropdown">                            <span class="ellipsis"></span>                        </button>                        <ul class="dropdown-menu pull-right">                            <li class="mobile-show">                                <div class="panel">                                    <div class="panel-heading">                                        <a class="collapsed" href="" ng-click="toggleSubMenu($event, \'submenu_username\')">                                            <span class="fa fa-user"></span>&emsp;{{ user.Name }}<span class="fa fa-angle-down pull-right"></span>                                        </a>                                    </div>                                    <div id="mobile-utility-bar-submenu" ng-class="{ \'collapse\' : !subMenuState.submenu_username }" class="panel-collapse bs-nav-mobile-user-menu">                                        <div class="panel-body">                                            <!-- User Menu -->                                            <ul class="responsive-utility-bar-dropdown">                                                <li ng-if="user.StoreInfo"><span>iCredits: {{ user.StoreInfo.ICreditBalance | number }}</span></li>                                                <li><a href="https://my.illumina.com" target="_self">MyIllumina<br /> Dashboard</a></li>                                                                                            <li ng-if=\'organizations === null || organizations.length > 0\' role="separator" class="divider"></li>                                                <li ng-if=\'organizations === null\'><a><img src="/public/cdn/basespace/libraries/bootstrap/images/loading-small.gif" /></a></li>                                                <li ng-if=\'organizations.length > 0\' ng-repeat="value in organizations track by value.Id" ng-click="onClickContextSwitch(value.Id)">                                                    <a href="">{{value.Name}}</a>                                                </li>                                                <li ng-if=\'organizations === null || organizations.length > 0\' role="separator" class="divider"></li>                                                                                            <li><a ng-href="{{basespaceUrl}}/settings" target="_self">Settings</a></li>                                                <li><a ng-href="{{basespaceUrl}}/agreements/toc" target="_self">Terms</a></li>                                                <li><a href="http://blog.basespace.illumina.com" target="_blank">Blog</a></li>                                                <li><a ng-href="{{basespaceUrl}}/auth/logout" target="_self">Sign Out</a></li>                                            </ul>                                        </div>                                    </div>                                </div>                            </li>                                                        <li ng-class="{ \'red-circle\' : trashCount > 0 }" ng-if="!disableTrash">                            <li ng-if="!disableTrash" ng-class="{ \'red-circle\' : trashCount > 0 }">                                <a ng-href="{{basespaceUrl}}/settings/trash" target="_self"><span class="fa fa-trash-o fa-lg"></span>&emsp;Trash</a>                            </li>                            <li><a href="https://help.basespace.illumina.com" target="_blank"><span class="fa fa-question fa-lg"></span>&emsp;Help</a></li>                            <li ng-if="!disableSearch" bs-search-dialog-trigger><a href=""><span class="fa fa-search"></span>&emsp;Search</a></li>                        </ul>                    </div>                    </div><!-- /.navbar-header -->        </nav>        </div> <!-- /.show-mobile -->',
menuMobile:'<div class="dropdown dropdown-accordion dropdown-responsive-menu">        <button class="btn btn-responsive-menu pull-left" data-toggle="dropdown">            <span class="fa fa-bars"></span>&ensp;Menu        </button>        <div class="product-lens sh">            <div class="el-1"></div>            <div class="el-2"></div>            <div class="el-3"></div>            <div class="el-4"></div>            <div class="el-5"></div>            <div class="el-6"></div>        </div>        <ul class="dropdown-menu">            <li                ng-repeat="li in globalHeaderListItems track by li.id"                 id="navbar-menu-item-{{ $index + 1 }}"                ng-class="{ active : isMenuButtonActive(li.id) }">                <!-- non dropdown menu content -->                <a ng-if="!globalHeaderSecondaryListItems.hasOwnProperty(li.id)" ng-href="{{ li.href }}" target="{{ li.target || \'_self\' }}">{{ li.title }}</a>                                <!-- drop down menu content -->                <div ng-if="globalHeaderSecondaryListItems.hasOwnProperty(li.id)" class="panel">                    <div class="panel-heading">                        <a class="collapsed" href="" ng-click="toggleSubMenu($event, \'submenu_\' + li.id)">                        {{ li.title }}&ensp;<span class="fa fa-caret-down pull-right"></span>                        </a>                    </div>                    <div class="panel-collapse collapse" ng-class="{ \'collapse\' : !subMenuState[\'submenu_\' + li.id] }">                        <div class="panel-body">                            <ul class="responsive-utility-bar-dropdown">                                <li ng-repeat="dd in globalHeaderSecondaryListItems[li.id] track by dd.id"                                        ng-class="{ active : isMenuButtonActive(dd.id) }">                                    <a ng-href="{{ dd.href }}" target="{{ dd.target || \'_self\' }}">{{ dd.title }}</a>                                </li>                            </ul>                        </div>                    </div>                </div>            </li>            <bs-app-switcher-mobile></bs-app-switcher-mobile>        </ul>        <span class="product-name">Sequence<br>Hub</span>    </div>',updateSubscriptionModalBody:'<p>Contact your Illumina representative if you want to update:</p>    <ul>        <li>Your BaseSpace subscription</li>        <li>Amount of storage available</li>    </ul>    <div>Our customer support team is available Monday through Friday from 7 a.m. to 5 p.m. PST at:</div>    <div><strong>800.809.4566 (North America)</strong></div>    <div><strong>858.202.4566 (Outside)</strong></div>    <div><strong>858.202.4766 (Fax)</strong></div>    <div><a href="mailto:customerservice@illumina.com">customerservice@illumina.com</a></div>    <br/>    <p><a href="https://www.illumina.com/basespace" target="_blank">Click here </a> to see our subscription plans.</p>',toolbar:'<div class="registry-action-toolbar">        <bs-dropdown ng-repeat="item in toolbar.items" service-name="{{::item}}">        </bs-dropdown>    </div>'}}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){function i(){return 1==("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}function s(){angular.element(document).on("selectstart","[draggable]",e.Compatibility.performDragDropIE)}function a(e){e.stopPropagation(),e.preventDefault(),this.dragDrop()}function r(){angular.element(document).off("selectstart",e.Compatibility.performDragDropIE)}function o(){var e=function(){return!1};angular.element(document).on("selectstart",e),setTimeout(function(){angular.element(document).off("selectstart",e)},1)}t.isTouchDevice=i,t.bindDragDropIE=s,t.performDragDropIE=a,t.unbindDragDropIE=r,t.preventTextSelection=o}(t=e.Compatibility||(e.Compatibility={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.toFixed=function(e,t){return+(Math.round(+(e.toString()+"e"+t)).toString()+"e"+-t)},e.getBasePairUnits=function(t,i){return void 0===i&&(i=2),0>t&&(t=Math.abs(t)),t>=0&&t<e.THOUSAND?{basePairUnit:e.BASE,result:t.toString()}:t>=e.THOUSAND&&t<e.MILLION?{basePairUnit:e.KILOBASE,result:e.toFixed(t/e.THOUSAND,i).toFixed(i)}:t>=e.MILLION&&t<e.BILLION?{basePairUnit:e.MEGABASE,result:e.toFixed(t/e.MILLION,i).toFixed(i)}:t>=e.BILLION?{basePairUnit:e.GIGABASE,result:e.toFixed(t/e.BILLION,i).toFixed(i)}:{basePairUnit:e.BASE,result:t+e.BASE_ABBR}},e.getMedian=function(e){e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2),i=e.length%2;return i?e[t]:(e[t-1]+e[t])/2},e.THOUSAND=1e3,e.MILLION=Math.pow(e.THOUSAND,2),e.BILLION=Math.pow(e.THOUSAND,3),e.BASE_ABBR="bp",e.KILOBASE_ABBR="Kbp",e.MEGABASE_ABBR="Mbp",e.GIGABASE_ABBR="Gbp",e.BASE={abbreviation:e.BASE_ABBR,divisor:1},e.KILOBASE={abbreviation:e.KILOBASE_ABBR,divisor:e.THOUSAND},e.MEGABASE={abbreviation:e.MEGABASE_ABBR,divisor:e.MILLION},e.GIGABASE={abbreviation:e.GIGABASE_ABBR,divisor:e.BILLION},e}();e.MathUtils=t;var i=function(){function e(){}return e}();e.BasePairUnit=i;var s=function(){function e(){}return e}();e.BasePairUnitResult=s}(t=e.Utils||(e.Utils={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i=function(){function t(e,t){void 0===t&&(t=1),this.candidates=e,this.attemptsPerCandidate=t,this.isComplete=!1,this.currentCandidateIndex=0,this.attemptsOnCurrent=0,this.candidatePerformanceRecords=[]}return t.prototype.recordCandidatePerformance=function(t,i){var s=this.candidatePerformanceRecords[t];s||(s=[],this.candidatePerformanceRecords[t]=s),s.push(i);var a=e.Common.Utils.MathUtils.getMedian(s);this.isBetter(a)&&(this.bestCandidate=t,this.bestCandidateMedianPerformance=a)},t.prototype.getCandidate=function(){if(this.isComplete)return this.bestCandidate;var e=this.candidates[this.currentCandidateIndex];return this.attemptsOnCurrent++,this.attemptsOnCurrent>=this.attemptsPerCandidate&&(this.currentCandidateIndex++,this.attemptsOnCurrent=0,this.currentCandidateIndex===this.candidates.length&&(this.isComplete=!0)),e},t.prototype.isBetter=function(e){return void 0===this.bestCandidateMedianPerformance?!0:e>this.bestCandidateMedianPerformance},t}();t.HillClimber=i}(i=t.Optimization||(t.Optimization={}))}(i=t.Utils||(t.Utils={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.toSlug=function(t){return encodeURIComponent(t.replace(e.REGEX_NON_WORDS,"-"))},e.REGEX_NON_WORDS=/[^\w]+/g,e}();e.StringUtils=t}(t=e.Utils||(e.Utils={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(){}return t.by=function(t,i,s){return function(a,r){var o,n;if("object"==typeof a&&"object"==typeof r&&a&&r)return o=a[t],n=r[t],o===n?"function"==typeof s?s(a,r):a:typeof o==typeof n?"desc"===i?n>o?1:-1:n>o?-1:1:typeof n>typeof o?-1:1;throw{type:e.Common.Interfaces.MessageType.ERROR,message:"Expected an object when sorting by "+t,data:a}}},t}();t.SortUtils=i}(i=t.Utils||(t.Utils={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.appSessionDeliveryEnabled=function(t){return t.Features&&t.Features.indexOf(e.APP_SESSION_DELIVERY)>-1},e.bioSampleRegistryEnabled=function(t){return t.Features&&t.Features.indexOf(e.BIOSAMPLE_REGISTRY)>-1},e.APP_SESSION_DELIVERY="AppSessionDelivery",e.BIOSAMPLE_REGISTRY="BioSampleRegistry",e.COMPUTE_METERING="ComputeMeteringEnabled",e}();e.CodeFeatures=t}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.NONE=0]="NONE",e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.SUCCESS=3]="SUCCESS",e[e.ERROR=4]="ERROR"}(e.MessageType||(e.MessageType={}));e.MessageType;!function(e){e[e.BEFORE=0]="BEFORE",e[e.AFTER=1]="AFTER"}(e.Placement||(e.Placement={}));e.Placement}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.VISUALIZATION="Visualization",e.ANALYTIC="Analytic",e.INSTANCE="Instance",e.QUALITY="Quality",e.NATIVE="Native",e.WORKFLOW="Workflow",e.UPLOADER="Uploader",e.DOWNLOAD="Download",e.OTHER="Other",e}();e.ApplicationCategory=t;var i=function(){function e(){}return e.UNDEFINED="Undefined",e.BILLING="Billing",e.AUTOMATABLE="Automatable",e.WORKFLOW="Workflow",e.PROVIDE_PRESETS="ProvidesPresets",e.AUTO_LAUNCHABLE="AutoLaunchable",e.BYPASS_FORM="BypassForm",e.DISABLE_GRANT_INHERITANCE="DisableGrantInheritance",e}();e.ApplicationFeatures=i}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.RUNNING="Running",e.RUNNING_LABEL="Running",e.COMPLETE="Complete",e.COMPLETE_LABEL="Complete",e.ABORTED="Aborted",e.ABORTED_LABEL="Aborted",e.NEEDS_ATTENTION="NeedsAttention",e.NEEDS_ATTENTION_LABEL="Needs Attention",e.TIME_OUT="TimedOut",e.TIME_OUT_LABEL="Timed Out",e.AWAITING_AUTHORIZATION="AwaitingAuthorization",e.AWAITING_AUTHORIZATION_LABEL="Awaiting Authorization",e.PENDING_PAYMENT="PendingPayment",e.PENDING_PAYMENT_LABEL="Pending Payment",e.PAYMENT_COMPLETE="PaymentComplete",e.PAYMENT_COMPLETE_LABEL="Payment Complete",e.PAYMENT_ABORTED="PaymentAborted",e.PAYMENT_ABORTED_LABEL="Payment Aborted",e.ABORTING="Aborting",e.ABORTING_LABEL="Aborting",e.PENDING="Pending",e.PENDING_LABEL="Pending",e.CANCELED="Canceled",e.CANCELED_LABEL="Canceled",e.PENDING_EXECUTION="PendingExecution",e.PENDING_EXECUTION_LABEL="Pending Execution",e.INITIALIZING="Initializing",e.INITIALIZING_LABEL="Initializing",e}();e.AppSessionStatus=t}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.DualIndex="DualIndex",e.SingleIndex="SingleIndex",e.None="None",e}();e.ValidIndexingStrategies=t;var i=function(){function e(){}return e.SingleRead="SingleRead",e.PairedEnd="PairedEnd",e}();e.ValidReadTypes=i}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.MiSeq="MiSeq",e.HiSeq2000="HiSeq2000",e.HiSeq1000="HiSeq1000",e.HiScanSQ="HiScanSQ",e.Eco="Eco",e.iScan="iScan",e.HiScan="HiScan",e.HiSeq4000="HiSeq4000",e.HiSeq3000="HiSeq3000",e.HiSeq2500="HiSeq2500",e.HiSeq1500="HiSeq1500",e.Project11="Project11",e.MiSeqDx="MiSeqDX",e.NextSeq="NextSeq",e.HiSeqX="HiSeqX",e.MiniSeq="MiniSeq",e}();e.InstrumentTypes=t;var i=function(){function e(){}return e.NextSeq="NextSeq",e.MiSeq="MiSeq",e.HiSeq="HiSeq",e.HiSeqX="HiSeqX",e.NeoPrep="NeoPrep",e.MiniSeq="MiniSeq",e}();e.InstrumentPlatforms=i;var s=function(){function e(){}return e.New="New",e.Ready="Ready",e.Unknown="Unknown",e.Running="Running",e.Paused="Paused",e.Stopped="Stopped",e.Uploading="Uploading",e.PendingAnalysis="PendingAnalysis",e.Analyzing="Analyzing",e.Complete="Complete",e.Failed="Failed",e.NeedsAttention="NeedsAttention",e.Deleted="Deleted",e.FailedUpload="FailedUpload",e}();e.AggregateRunState=s;var a=function(){function e(){}return e.Unknown="Unknown",e.Amplicon="Amplicon",e.DenovoAssembly="DenovoAssembly",e.Metagenomics="Metagenomics",e.Resequencing="Resequencing",e.SmallRna="SmallRna",e.LibraryQc="LibraryQc",e.iSAAC="iSAAC",e.PCRAmplicon="PCRAmplicon",e.GenerateFASTQ="GenerateFASTQ",e.HiSeqFastQ="HiSeqFastQ",e.NoAnalysis="NoAnalysis",e.Enrichment="Enrichment",e.TargetedRNASeq="TargetedRNASeq",e}();e.AnalysisWorkflowType=a}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.Personal="Personal",e.Pending="PENDING",e.Inactive="INACTIVE",e.Active="ACTIVE",e}();e.UserTypes=t;var i=function(){function e(){}return e.Admin="admin",e.User="user",e}();e.RoleTypes=i}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.OnCompleteAnalysis="notification_oncomplete_analysis",e.OnUploadedRun="notification_onuploaded_run",e}();e.UserSettingNotifications=t}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Complete=0]="Complete",e[e.Active=1]="Active",e[e.Cancelled=2]="Cancelled",e[e.Cancelling=3]="Cancelling",e[e.Queued=4]="Queued",e[e.Paused=5]="Paused",e[e.Failed=6]="Failed",e[e.Completable=7]="Completable",e[e.Completing=8]="Completing"}(e.TaskState||(e.TaskState={}));e.TaskState}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Authentication=1]="Authentication",e[e.Sharing=2]="Sharing",e[e.Run=3]="Run",e[e.Analysis=4]="Analysis",e[e.Projects=5]="Projects",e[e.AnalysisResult=6]="AnalysisResult",e[e.Sample=7]="Sample",e[e.Blog=8]="Blog",e[e.Application=9]="Application",e[e.Store=10]="Store",e[e.AppSession=11]="AppSession",e[e.RoleNotification=12]="RoleNotification"}(e.INotificationCategory||(e.INotificationCategory={}));e.INotificationCategory;!function(e){e[e.GrantClearing=2]="GrantClearing",e[e.GrantAddition=3]="GrantAddition",e[e.GrantRemoval=4]="GrantRemoval",e[e.ShareAccepted=5]="ShareAccepted",e[e.InviteSent=6]="InviteSent",e[e.InviteAccepted=7]="InviteAccepted"}(e.INotificationSubcategory||(e.INotificationSubcategory={}));e.INotificationSubcategory}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.ISampleAppSession=t}(t=e.Legacy||(e.Legacy={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){for(var t in e)this[t]=e[t]}return e}();e.BioSampleLibraryYield=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){this.Yields=[],this.PrepRequests=[]}return e}();e.BioSample=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){angular.extend(this,e)}return e}();e.Pool=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.CommonFiles="common.files",e.Default="common.files",e.CommonFastq="common.fastq",e.IlluminaFastq="illumina.fastq.v1.8",e.InstrumentDiagnostic="instrumentdiagnostic",e.IlluminaIsaac="illumina.isaac",e.IlluminaIsaacV4="illumina.isaac.v4",e.IlluminaTumorNormalV2="illumina.tumor_normal.v2",e}();e.DatasetTypeSlugs=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){for(var t in e)this[t]=e[t]}return e}();e.PrepRequest=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.LabRequeue=t,function(e){e[e.Undefined=0]="Undefined",e[e.Pending=1]="Pending",e[e.Acknowledged=2]="Acknowledged",e[e.Canceled=3]="Canceled",e[e.Fulfilled=4]="Fulfilled",e[e.Failed=5]="Failed"}(e.LabRequeueStatus||(e.LabRequeueStatus={}));var i=(e.LabRequeueStatus,function(){function e(){}return e.POOL_LIBRARIES_MISSING_PREPREQUEST="BASESPACE.REQUEUE_REQUEST.POOL_LIBRARIES_MISSING_PREPREQUEST",e.POOL_NOT_ACTIVE="BASESPACE.REQUEUE_REQUEST.POOL_NOT_ACTIVE",e}());e.LabRequeueErrors=i}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.QC_PASSED="QcPassed",e.QC_FAILED="QcFailed",e.FAILED="Failed",e}();e.LaneQcStatus=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.QC_PASSED="QcPassed",e.QC_FAILED="QcFailed",e}();e.QcStatus=t}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.V2||(e.V2={}))}(t=e.Interfaces||(e.Interfaces={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){function t(){angular.element(document).ready(function(){var t=angular.element("#main-menu");if(t.length>0){angular.bootstrap(t,[e.commonModuleName]);var s=t.injector();if(s){var a=s.get("$rootScope");a.showGlobalTooltips=!1,angular.element(window).on("realWindowResize",function(){i(t,a)}),i(t,a)}window.lastWindowHeight=$(window).height(),window.lastWindowWidth=$(window).width(),$(window).resize(function(){($(window).height()!=window.lastWindowHeight||$(window).width()!=window.lastWindowWidth)&&(window.lastWindowHeight=$(window).height(),window.lastWindowWidth=$(window).width(),$(window).trigger("realWindowResize"))})}})}function i(e,t){var i=t.showGlobalTooltips;if(t.showGlobalTooltips=e.find("li > a > label:visible").length>0?!1:!0,i!=t.showGlobalTooltips)try{t.$digest()}catch(s){}}e.commonModuleName="bs.Common",e.commonModule=angular.module(e.commonModuleName,["ngAnimate","ngCookies","cfp.hotkeys","hc.marked","ngSanitize","ngResource","ngRoute"]),e.commonModule.config(["markedProvider",function(e){e.setOptions({gfm:!0,sanitize:!0})}]),e.bootstrapHeader=t}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s=e.Common.Interfaces.AppSessionStatus;i.bsEnumDictionaryServiceName="bsEnumDictionary";var a=function(){function e(){this.APP_SESSION_QCSTATUS_LOOKUP={Undefined:{displayName:"Undefined"},QcPassed:{displayName:"QC Passed"},QcFailed:{displayName:"QC Failed",isError:!0}},this.APP_SESSION_EXECUTION_STATUS_LOOKUP={Undefined:{displayName:"Undefined"}},this.APP_SESSION_DELIVERY_STATUS_LOOKUP={None:{displayName:"--"},ReadyForDelivery:{displayName:"Ready For Delivery"},DeliveryInProgress:{displayName:"Delivery in Progress"},Delivered:{displayName:"Delivered"},OnHold:{displayName:"On Hold"},DoNotDeliver:{displayName:"Do Not Deliver",isError:!0},DeliveryFailed:{displayName:"Delivery Failed",isError:!0}},this.BIOSAMPLE_LAB_STATUS_LOOKUP={New:{displayName:"New"},VisualQcPassed:{displayName:"Visual QC Passed"},VisualQcFailed:{displayName:"Visual QC Failed",isError:!0},QuantQcPassed:{displayName:"Quant QC Passed"},QuantQcFailed:{displayName:"Quant QC Failed",isError:!0},FlowcellClustered:{displayName:"Flowcell Clustered"},Sequencing:{displayName:"Sequencing"},MissingYield:{displayName:"Missing Yield"},Requeued:{displayName:"Requeued"},Complete:{displayName:"Complete"}},this.BIOSAMPLE_STATUS_LOOKUP={New:{displayName:"New"},Active:{displayName:"Active"},Done:{displayName:"Done"},Canceled:{displayName:"Canceled"},QcFailed:{displayName:"QC Failed",isError:!0}},this.DATASET_QCSTATUS_LOOKUP={QcPassed:{displayName:"QC Passed"},QcFailed:{displayName:"QC Failed",isError:!0}},this.RUN_STATUS_LOOKUP={Analyzing:{displayName:"Analyzing"},Complete:{displayName:"Complete"},Failed:{displayName:"Failed",isError:!0},FailedUpload:{displayName:"Failed Upload",isError:!0},NeedsAttention:{displayName:"Needs Attention",isError:!0},New:{displayName:"New"},Paused:{displayName:"Paused"},PendingAnalysis:{displayName:"Pending Analysis"},Ready:{displayName:"Ready"},Running:{displayName:"Running"},Stopped:{displayName:"Stopped"},Uploading:{displayName:"Uploading"}},this.RUN_LANE_AND_QC_STATUS_LOOKUP={Initial:{displayName:"Initial"},LanePendingQc:{displayName:"Lane Pending QC"},LaneQcFailed:{displayName:"Lane QC Failed",isError:!0},QcPassed:{displayName:"QC Passed"},Rehybed:{displayName:"Rehybed"}},this.ENUMS={},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.ABORTED]={displayName:s.ABORTED_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.RUNNING]={displayName:s.RUNNING_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.NEEDS_ATTENTION]={displayName:s.NEEDS_ATTENTION_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.COMPLETE]={displayName:s.COMPLETE_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.TIME_OUT]={displayName:s.TIME_OUT_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.AWAITING_AUTHORIZATION]={displayName:s.AWAITING_AUTHORIZATION_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.PENDING_PAYMENT]={displayName:s.PENDING_PAYMENT_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.PAYMENT_COMPLETE]={displayName:s.PAYMENT_COMPLETE_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.PAYMENT_ABORTED]={displayName:s.PAYMENT_ABORTED_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.ABORTING]={displayName:s.ABORTING_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.PENDING_EXECUTION]={displayName:s.PENDING_EXECUTION_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.INITIALIZING]={displayName:s.INITIALIZING_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.PENDING]={displayName:s.PENDING_LABEL},this.APP_SESSION_EXECUTION_STATUS_LOOKUP[s.CANCELED]={displayName:s.CANCELED_LABEL},this.ENUMS[e.APP_SESSION_QC_STATUS_ENUM]=this.APP_SESSION_QCSTATUS_LOOKUP,this.ENUMS[e.APP_SESSION_EXECUTION_STATUS_ENUM]=this.APP_SESSION_EXECUTION_STATUS_LOOKUP,this.ENUMS[e.APP_SESSION_DELIVERY_STATUS_ENUM]=this.APP_SESSION_DELIVERY_STATUS_LOOKUP,this.ENUMS[e.BIOSAMPLE_LAB_STATUS_ENUM]=this.BIOSAMPLE_LAB_STATUS_LOOKUP,this.ENUMS[e.BIOSAMPLE_STATUS_ENUM]=this.BIOSAMPLE_STATUS_LOOKUP,this.ENUMS[e.DATASET_QCSTATUS_ENUM]=this.DATASET_QCSTATUS_LOOKUP,this.ENUMS[e.RUN_STATUS_ENUM]=this.RUN_STATUS_LOOKUP,this.ENUMS[e.RUN_LANE_AND_QC_STATUS_ENUM]=this.RUN_LANE_AND_QC_STATUS_LOOKUP}return Object.defineProperty(e,"APP_SESSION_QC_STATUS_ENUM",{get:function(){return"appSessionQcStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"APP_SESSION_EXECUTION_STATUS_ENUM",{get:function(){return"appSessionStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"APP_SESSION_DELIVERY_STATUS_ENUM",{get:function(){return"appSessionDeliveryStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BIOSAMPLE_LAB_STATUS_ENUM",{get:function(){return"biosampleLabStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BIOSAMPLE_STATUS_ENUM",{get:function(){return"biosampleStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DATASET_QCSTATUS_ENUM",{get:function(){return"datasetQcStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RUN_STATUS_ENUM",{get:function(){return"runStatus"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"RUN_LANE_AND_QC_STATUS_ENUM",{get:function(){return"runLaneAndQcStatus"},enumerable:!0,configurable:!0}),e.prototype.getDisplayName=function(e,t){if(!this.ENUMS.hasOwnProperty(e))throw"Enumeration with name '"+e+"' not found";return this.ENUMS[e].hasOwnProperty(t)?this.ENUMS[e][t].displayName:t},e.prototype.getValues=function(e){return Object.keys(this.ENUMS[e])},e.prototype.isError=function(e,t){if(!this.ENUMS.hasOwnProperty(e))throw"Enumeration with name '"+e+"' not found";return this.ENUMS[e].hasOwnProperty(t)?this.ENUMS[e][t].isError||!1:!1},e}();i.BsEnumDictionary=a,t.commonModule.service(i.bsEnumDictionaryServiceName,[function(){return new a}])}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.SEARCH_RESULT_ITEM=0]="SEARCH_RESULT_ITEM",e[e.SPREADSHEET_ITEM=1]="SPREADSHEET_ITEM"}(e.DataType||(e.DataType={}));e.DataType}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.serverConfigServiceName="serverConfig",t.serverConfigProviderName=t.serverConfigServiceName+"Provider",t.appStartConfigServiceName="appStartConfig",t.downloaderConfigServiceName="downloaderConfig";var i=function(){function e(e,t){var i=angular.element(t);if(i.length<1)return void console.log("Warning: "+t+" element not present in DOM.");for(var s in e){var a=e[s],r=i.data(a);if(void 0===r||null===r)console.log("Warning: '"+s+"' not defined in "+e+" element.");else{var o=i.data(a);"number"==typeof o&&(o=String(o)),this[s]=o}}}return e}();t.BaseSiteConfig=i;var s=function(e){function t(){var t={accessToken:"bs-access-token",currentUserId:"bs-current-user-id",currentUserEmail:"bs-current-user-email",cdnUrl:"bs-cdn-url",isOnSite:"bs-is-onsite",isOnSiteAdmin:"bs-is-onsite-admin",hasSupportedDownloader:"bs-has-supported-downloader",hasWebUploadSample:"bs-has-web-upload-sample",publicApiBaseUrl:"bs-api-base-uri",publicV2ApiBaseUrl:"bs-v2-api-base-uri",publicApiProxyBaseUrl:"bs-api-base-uri-proxy-fallback",privateApiBaseUrl:"bs-private-api-base-url",storeApiBaseUrl:"bs-store-api-base-uri",storeApiProxyBaseUrl:"bs-store-api-base-uri-proxy-fallback",isEmailEnabled:"bs-is-email-enabled",isStoreAvailable:"bs-is-store-available",storeWebsiteBaseUrl:"bs-store-website-base-uri",devportalWebsiteBaseUrl:"bs-devportal-website-base-uri",hasMiniSeq:"bs-has-mini-seq"},i="#site-config";e.call(this,t,i)}return __extends(t,e),t}(i);t.ServerConfig=s;var a=function(){function e(){}return Object.defineProperty(e.prototype,"serverConfig",{get:function(){return this._serverConfig||(this._serverConfig=new s),this._serverConfig},enumerable:!0,configurable:!0}),e.prototype.$get=function(){return this.serverConfig},e}();t.ServerConfigProvider=a;var r=function(e){function t(){var t={appId:"bs-app-id",isDeveloperMode:"bs-is-developer-mode",spacebugAgentId:"bs-spacebug-agent-id",spacebugDevPortalUrl:"bs-spacebug-dev-portal-url",missionControlUrl:"bs-mission-control-url"},i="#app-config";e.call(this,t,i)}return __extends(t,e),t}(i);t.AppStartConfig=r;var o=function(e){function t(){var t={webStartDefaultPath:"bs-web-start-default-path",webStartAppSessionVcfPath:"bs-web-start-app-session-vcf-path",webStartAppSessionBamPath:"bs-web-start-app-session-bam-path",installUri:"bs-install-uri",altInstallUri:"bs-alt-install-uri",downloadType:"bs-download-type",analysisLinkEnabled:"bs-analysis-link-enabled",fastqDownloadEnabled:"bs-fastq-download-enabled",launchSavUrl:"bs-launch-sav-url",savInfoUrl:"bs-sav-info-url",runAnalysisUrl:"bs-run-analysis-url"},i="#downloader-config";e.call(this,t,i)}return __extends(t,e),t}(i);t.DownloaderConfig=o,e.commonModule.provider(t.serverConfigServiceName,a).service(t.appStartConfigServiceName,r).service(t.downloaderConfigServiceName,o)}(i=t.ServerConfig||(t.ServerConfig={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.currentUserServiceName="currentUserService",e.commonModule.service(t.currentUserServiceName,["$q","$http","$cacheFactory",t.ServerConfig.serverConfigServiceName,function(e,t,s,a){return new i(e,t,s,a)}]);var i=function(){function e(e,t,i,s){this.$q=e,this.$http=t,this.$cacheFactory=i,this.serverConfig=s,this.currentUserCacheKey="CurrentUser",this.currentStoreInfoCacheKey="CurrentStoreInfo",this.currentUserCacheFactory=i(this.currentUserCacheKey),this.storeApiBaseUserUrl=this.serverConfig.storeApiBaseUrl+"users/",this.currentUserHttpConfig={method:"GET",url:this.serverConfig.publicApiBaseUrl+"users/current",cache:!0,withCredentials:!0},this.currentStoreUserHttpConfig={method:"GET",url:"",cache:!0,withCredentials:!0},this.getCurrentUser()}return e.prototype.getUserFromCache=function(){var e=this.getUserFromCacheFactory();return e},e.prototype.getUserFromCacheFactory=function(){var e=this.currentUserCacheFactory.get(this.currentUserCacheKey);return e&&(e.StoreInfo=this.getStoreInfoFromCacheFactory()),e},e.prototype.getStoreInfoFromCacheFactory=function(){return this.currentUserCacheFactory.get(this.currentStoreInfoCacheKey)},e.prototype.loadUser=function(){var e=this,t=this.$q.defer();return this.$http(this.currentUserHttpConfig).then(function(i){var s=i.data.Response;e.serverConfig.currentUserEmail=s.Email,e.serverConfig.currentUserId=s.Id,e.currentUserCacheFactory.put(e.currentUserCacheKey,s),t.resolve(s)},function(e){t.reject(e)}),t.promise},e.prototype.loadStoreInfo=function(){var e=this,t=this.$q.defer();return this.$http(this.currentStoreUserHttpConfig).then(function(i){var s=i.data.Response;e.currentUserCacheFactory.put(e.currentStoreInfoCacheKey,s),t.resolve(s)},function(e){t.reject(e)}),t.promise},e.prototype.processStoreInfo=function(){var e=this.$q.defer();return this.loadStoreInfo().then(function(t){e.resolve(t)},function(t){e.reject(t)}),e.promise},e.prototype.resolveStoreInfo=function(e,t){this.currentStoreUserHttpConfig.url=this.storeApiBaseUserUrl+e.Id,this.processStoreInfo().then(function(e){t.resolve(e)},function(e){t.resolve(null)})},e.prototype.getCurrentUser=function(e){var t=this;void 0===e&&(e=!1);var i=e&&this.serverConfig.storeApiBaseUrl,s=this.$q.defer(),a=this.$q.defer(),r=this.$q.defer(),o=this.getUserFromCache();return o?(s.resolve(o),i&&(o.StoreInfo?r.resolve(null):this.resolveStoreInfo(o,r))):this.loadUser().then(function(e){s.resolve(e),i&&t.resolveStoreInfo(e,r)},function(e){s.reject(e)}),i||r.resolve(null),this.$q.all([s.promise,r.promise]).then(function(e){o=e[0],o.StoreInfo=e[1],o.StoreInfo&&o.StoreInfo.Subscription&&angular.isNumber(o.StoreInfo.Subscription.Storage.Quota)&&(o.StorageStatistics.Quota=o.StoreInfo.Subscription.Storage.Quota),a.resolve(o)},function(e){a.reject(e)}),a.promise},e.prototype.flushCache=function(){this.flushUserCache(),this.flushStoreInfoCache()},e.prototype.flushUserCache=function(){this.$cacheFactory.get("$http").remove(this.currentUserHttpConfig.url),this.currentUserCacheFactory.remove(this.currentUserCacheKey)},e.prototype.flushStoreInfoCache=function(){this.$cacheFactory.get("$http").remove(this.currentStoreUserHttpConfig.url),this.currentUserCacheFactory.remove(this.currentStoreInfoCacheKey)},e}();t.CurrentUserService=i}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){
var t;!function(t){t.siteNavigationServiceName="siteNavigationService";var i=function(){function e(){}return e.prototype.setCurrentLocation=function(e){this.currentLocation=e},e.prototype.getCurrentLocation=function(){return this.currentLocation},e.prototype.urlBiosamplesList=function(){return"/biosamples/"},e.prototype.urlBiosampleSummary=function(e){return"/biosamples/"+e+"/"},e.prototype.urlBiosampleLibraries=function(e){return"/biosamples/"+e+"/libraries"},e.prototype.urlBiosampleRuns=function(e){return"/biosamples/"+e+"/runs"},e.prototype.urlBiosampleRequeues=function(e){return"/biosamples/"+e+"/requeues"},e.prototype.urlBiosampleAnalyses=function(e){return"/biosamples/"+e+"/analyses"},e.prototype.urlBiosampleDatasets=function(e){return"/biosamples/"+e+"/datasets"},e.prototype.urlPoolSummary=function(e){return"/pools/"+e+"/"},e.prototype.urlPoolLibraries=function(e){return"/pools/"+e+"/libraries"},e.prototype.urlProjectList=function(){return"/projects/"},e.prototype.urlProjectSummary=function(e){return"/projects/"+e+"/"},e.prototype.urlAnalysesList=function(){return"/analyses/"},e.prototype.urlAnalysisDefault=function(e){return"/analyses/"+e+"/"},e.prototype.urlAnalysisInfo=function(e){return"/analyses/"+e+"/info"},e.prototype.urlAnalysisSummary=function(e){return"/analyses/"+e+"/summary"},e.prototype.urlAnalysisInputs=function(e){return"/analyses/"+e+"/inputs"},e.prototype.urlAnalysisOutputFiles=function(e){return"/analyses/"+e+"/files"},e.prototype.urlAnalysisResult=function(e,t){return"/analyses/"+e+"/results/"+t},e.prototype.urlAnalysisMetrics=function(e,t){return"/analyses/"+e+"/metrics/"+t},e}();t.SiteNavigationService=i,e.commonModule.service(t.siteNavigationServiceName,i)}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.serviceName="validationRuleDictionary",e.commonModule.service(i.serviceName,[t.ServerConfig.serverConfigServiceName,function(e){return new o(e)}]);var s=function(){function e(){}return e.MUST_BE_OWNER="must-be-owner",e.MUST_BE_SUPPORTED_GENOME="must-be-supported-genome",e}();i.RuleNames=s;var a=function(){function e(){}return e.OWNER="owner",e.READ="read",e}();i.Permissions=a;var r=function(){function e(){}return e.SERVER="VALIDATION_SERVER_ERROR",e.CLIENT="VALIDATION_CLIENT_ERROR",e}();i.ErrorOrigin=r;var o=function(){function e(e){var t=this;this.serverConfig=e,this[s.MUST_BE_OWNER]=function(e){return e.UserOwnedBy&&e.UserOwnedBy.Id&&t.serverConfig.currentUserId?String(e.UserOwnedBy.Id)==String(t.serverConfig.currentUserId):!1},this[s.MUST_BE_SUPPORTED_GENOME]=function(e,t){if(!e.Genome)return!1;var i=e.Genome.Build,s=t.indexOf(i)>-1;return s}}return e}();i.ValidationRuleDictionary=o}(i=t.Validation||(t.Validation={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.VERSION2_PREFIX="v2/",i.VERSION_PREFIX="v1pre3/",i.VERSION_ZERO_PREFIX="0/",i.SAVE_PROPERTY_URI_SUFFIX="/properties",i.GET_PROPERTY_URI_SUFFIX=i.SAVE_PROPERTY_URI_SUFFIX+"/:propertyName",i.GET_FILES_URI_SUFFIX="/files?limit=100",i.apiServiceName="publicApi",e.commonModule.service(i.apiServiceName,["$http","$q","$resource",t.ServerConfig.serverConfigServiceName,function(e,t,i,s){return new l(e,t,i,s)}]);var s=function(){function e(){}return e.COMPLETE="Complete",e.ABORTED="Aborted",e.RUNNING="Running",e.UPLOADING="Uploading",e.DELIMITER=",",e}();i.ApiResourceStatus=s;var a=function(){function e(){}return e.INPUT_SAMPLES="Input.Samples",e.INPUT_APPRESULTS="Input.AppResults",e.INPUT_PROJECTS="Input.Projects",e.OUTPUT_SAMPLES="Output.Samples",e.OUTPUT_APPRESULTS="Output.AppResults",e.OUTPUT_PROJECTS="Output.Projects",e}();i.PropertyName=a;var r=function(){function e(){}return e.BASESPACE_FILES_NOT_FOUND="BASESPACE.FILES.NOT_FOUND",e}();i.ApiErrorCodes=r;var o=function(){function e(){}return e.STRICT="strict",e.DEFAULT="default",e}();i.PagingStyles=o;var n=function(){function e(){}return e.DEVELOPMENT="development",e.INITIALIZING="initializing",e.BETA="beta",e.TESTING="testing",e.PUBLISHED="published",e.DEPRECATED="deprecated",e.DISABLED="disabled",e}();i.ApplicationStatus=n;var l=function(){function e(e,t,i,s){this.$http=e,this.$q=t,this.$resource=i,this.serverConfig=s,this.defaultHeaders={},this.formHeaders={},this.serverConfig.accessToken?(this.defaultHeaders["x-access-token"]=this.serverConfig.accessToken,this.useCookieAuth=!1):$.support.cors&&(this.useCookieAuth=!0,(null===s.currentUserId||void 0===s.currentUserId)&&console.log("Warning: access token absent, so we will attempt to use cookie authentication, but currentUserId is unknown.")),this.defaultHttpConfig={headers:this.defaultHeaders,withCredentials:this.useCookieAuth},angular.copy(this.defaultHeaders,this.formHeaders),angular.extend(this.formHeaders,{"Content-type":null}),this.apiBaseUrl=$.support.cors?this.serverConfig.publicApiBaseUrl:this.serverConfig.publicApiProxyBaseUrl,this._defineResources()}return e.prototype._defineResources=function(){this.defaultRestActionConfig={get:{method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},post:{method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},query:{method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth},save:{method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},"delete":{method:"delete",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},saveProperty:{method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},getProperty:{method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},getFiles:{method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth}};var e={Id:"@Id",propertyName:"@propertyName"};this.apiBaseUrl=$.support.cors?this.serverConfig.publicApiBaseUrl:this.serverConfig.publicApiProxyBaseUrl,this.userCurrentUrl=this.apiBaseUrl+"users/current",this.agreementUrl=this.apiBaseUrl+"agreements/:Id",this.userAgreementsUrl=this.userCurrentUrl+"/agreements",this.userAppSessionsUrl=this.userCurrentUrl+"/appsessions",this.applicationUrl=this.apiBaseUrl+"applications/:Id",this.applicationVersionsUrl=this.applicationUrl+"/versions",this.applicationAgreementsUrl=this.applicationUrl+"/agreements",this.applicationProductsUrl=this.serverConfig.storeApiBaseUrl+"/application/:Id/products",this.applicationProductsUrlProxy=this.serverConfig.privateApiBaseUrl+"application/:Id/products",this.storeApplicationUrl=this.serverConfig.storeApiBaseUrl+"/applications/:Id",this.storeApplicationProductsUrl=this.serverConfig.storeApiBaseUrl+"/applications/:Id/products",this.applicationScreenshotsUrl=this.applicationUrl+"/screenshots",this.applicationSettingsUrl=this.apiBaseUrl+"applications/:Id/settings",this.applicationsListUrl=this.serverConfig.privateApiBaseUrl+"/application",this.applicationMetadataUrl=this.apiBaseUrl+"applicationmetadata",this.applicationMyAppsUrl=this.apiBaseUrl+"/users/current/applications",this.applicationPurchasesUrl=this.serverConfig.storeApiBaseUrl+"/applications/:Id/purchases",this.applicationAssetPackagesUrl=this.apiBaseUrl+"applications/:appId/assets/:assetPackageType/:assetPackageId",this.productUrl=this.serverConfig.storeApiBaseUrl+"/products/:Id",this.productMyProductsUrl=this.serverConfig.storeApiBaseUrl+"/users/current/products",this.userPurchaseListUrl=this.serverConfig.storeApiBaseUrl+"/users/current/purchases",this.appSessionsListUrl=this.userCurrentUrl+"/appsessions",this.appSessionsUrl=this.apiBaseUrl+"appsessions/:Id",this.appSessionReserveSpaceUrl=this.appSessionsUrl+"/reservedspace",this.appResultUrl=this.apiBaseUrl+"appresults/:Id",this.bioSamplesListUrl=this.apiBaseUrl+"users/current/biologicalsamples",this.fileUrl=this.apiBaseUrl+"files/:Id",this.genomeUrl=this.apiBaseUrl+"genomes/:Id",this.invitesUrl=this.apiBaseUrl+"/invites/:Id/:action",this.invitesCancelUrl=this.apiBaseUrl+"invites/:Id/cancel",this.inviteListUrl=this.userCurrentUrl+"/invites",this.runsListUrl=this.userCurrentUrl+"/runs",this.runDetailsUrl=this.apiBaseUrl+"runs/:Id",this.runInviteUrl=this.apiBaseUrl+"run/:Id/invites",this.projectsListUrl=this.userCurrentUrl+"/projects",this.runSampleLibrariesUrl=this.apiBaseUrl+"runs/:Id/SampleLibraries",this.runFilesUrl=this.apiBaseUrl+"runs/:Id/files",this.runPropertyUrl=this.apiBaseUrl+"runs/:Id/properties/:Property",this.plannedRunsUrl=this.apiBaseUrl+"plannedRuns",this.plannedRunLibraryPoolUrl=this.plannedRunsUrl+"/:Id/librarypools",this.projectInviteUrl=this.apiBaseUrl+"project/:Id/invites",this.projectUrl=this.apiBaseUrl+"projects/:Id",this.projectAnalysisUrl="/api/project/:Id/analysis",this.projectSamplesUrl=this.apiBaseUrl+"projects/:Id/samples",this.sampleUrl=this.apiBaseUrl+"samples/:Id",this.searchUrl=this.apiBaseUrl+"search",this.trashUrl=this.apiBaseUrl+"trash/:Id",this.trashRestoreUrl=this.trashUrl+"/restorefromtrash",this.trashListUrl=this.userCurrentUrl+"/trash",this.collaboratorListUrl=this.serverConfig.privateApiBaseUrl+"collaborator/:Resource/:Id",this.userNotificationsUrl=this.userCurrentUrl+"/notifications",this.notificationUrl=this.apiBaseUrl+"notifications/:Id/",this.libraryPrepKitsUrl=this.apiBaseUrl+"LibraryPrepKits",this.libraryContainersListUrl=this.apiBaseUrl+"users/current/LibraryContainers",this.libraryContainersUrl=this.apiBaseUrl+"LibraryContainers/:Id",this.libraryContainerSampleLibrariesUrl=this.apiBaseUrl+"LibraryContainers/:Id/Libraries",this.libraryPoolsUrl=this.apiBaseUrl+"librarypools",this.speciesListUrl=this.apiBaseUrl+"species",this.bioCreateSampleUrl=this.apiBaseUrl+"biologicalsamples",this.cmsUrl=this.apiBaseUrl+"contentgroups",this.instrumentListUrl=this.serverConfig.publicV2ApiBaseUrl+"instruments",this.userSettingsUrl=this.serverConfig.publicV2ApiBaseUrl+"users/current/settings",this.membersListUrl=this.serverConfig.publicV2ApiBaseUrl+"users/current/members";var t={};angular.copy(this.defaultRestActionConfig,t),t.query.url=this.userAgreementsUrl,t.accept={method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.userAgreementsUrl},this.Agreement=this.$resource(this.agreementUrl,e,t);var s={query:{method:"get",headers:this.defaultHeaders,isArray:!0,withCredentials:this.useCookieAuth}};this.ApplicationsList=this.$resource(this.applicationsListUrl,{},s),this.AppSessionsList=this.$resource(this.appSessionsListUrl,{},this.defaultRestActionConfig);var a={};angular.copy(this.defaultRestActionConfig,a),a.query.url=this.userAppSessionsUrl,a.saveProperty.url=this.appSessionsUrl+i.SAVE_PROPERTY_URI_SUFFIX,a.getProperty.url=this.appSessionsUrl+i.GET_PROPERTY_URI_SUFFIX,a.reserveSpace={method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.appSessionReserveSpaceUrl},a.stop={method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.appSessionsUrl+"/stop"},this.AppSession=this.$resource(this.appSessionsUrl,e,a),this.BioSamplesList=this.$resource(this.bioSamplesListUrl,{},this.defaultRestActionConfig),this.InstrumentList=this.$resource(this.instrumentListUrl,{},this.defaultRestActionConfig),this.Invite=this.$resource(this.invitesUrl,{Id:"@Id",action:"@action"},this.defaultRestActionConfig),this.InvitesCancel=this.$resource(this.invitesCancelUrl,{Id:"@Id"},this.defaultRestActionConfig),this.InviteList=this.$resource(this.inviteListUrl,{},this.defaultRestActionConfig),this.MemberList=this.$resource(this.membersListUrl,{Id:"@Id",action:"@action"},this.defaultRestActionConfig);var r={};angular.copy(this.defaultRestActionConfig,r),r.save.method="put",r.query.url=this.userNotificationsUrl,this.Notification=this.$resource(this.notificationUrl,{Id:"@Id"},r);var o={};angular.copy(this.defaultRestActionConfig,o),o.query.url=this.cmsUrl,o.getContentEntries={method:"get",withCredentials:this.useCookieAuth,headers:this.defaultHeaders,url:this.cmsUrl+"/:contentGroupName/contententries"},this.CMS=this.$resource(this.cmsUrl,e,o);var n={};angular.copy(this.defaultRestActionConfig,n),n.query.url=this.apiBaseUrl+"users/current/runs",n.getCyclePlot={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/cycleplot/data"},n.getQscoreHistogramPlot={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/qscorehistogram/data"},n.getSampleQcPlot={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/sampleqcchart/data"},n.getFlowcellPlot={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/flowcellchart/data"},n.getLanePlot={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/laneplot/data"},n.getQscoreHeatmapPlot={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/qscoreheatmap/data"},n.getCyclePlotOptions={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/cycleplot/options"},n.getQscoreHistogramPlotOptions={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/qscorehistogram/options"},n.getFlowcellPlotOptions={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/flowcellchart/options"},n.getLanePlotOptions={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/laneplot/options"},n.getQscoreHeatmapPlotOptions={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/qscoreheatmap/options"},n.getSequencingStats={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"runs/:Id/sequencingstats"},n.getSequencingSamples={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.serverConfig.privateApiBaseUrl+"run/:Id/sample"},n.saveProperty.url=this.runDetailsUrl+i.SAVE_PROPERTY_URI_SUFFIX,n.getProperty.url=this.runDetailsUrl+i.GET_PROPERTY_URI_SUFFIX,this.Run=this.$resource(this.runDetailsUrl,e,n),this.RunsList=this.$resource(this.runsListUrl,{},this.defaultRestActionConfig),this.RunInvite=this.$resource(this.runInviteUrl,{Id:"@Id"},this.defaultRestActionConfig),this.RunSampleLibraries=this.$resource(this.runSampleLibrariesUrl,{Id:"@Id"},this.defaultRestActionConfig),this.RunFiles=this.$resource(this.runFilesUrl,{Id:"@Id"},this.defaultRestActionConfig),this.RunProperty=this.$resource(this.runPropertyUrl,{Id:"@Id",Property:"@Property"},this.defaultRestActionConfig);var l={};angular.copy(this.defaultRestActionConfig,l),l.create={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{projectId:"@projectId"},url:this.apiBaseUrl+"projects/:projectId/samples"},l.queryChildSamples={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.apiBaseUrl+"samples/:Id/childsamples"},l.queryFiles={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.serverConfig.privateApiBaseUrl+"sample/:Id/file"},l.queryAppSessions={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},isArray:!0,url:this.serverConfig.privateApiBaseUrl+"sample/:Id/appsessions"},l.queryAppSessionFiles={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id",AppSessionId:"@AppSessionId"},url:this.serverConfig.privateApiBaseUrl+"sample/:Id/appsession/:AppSessionId/file"},l.saveProperty.url=this.sampleUrl+i.SAVE_PROPERTY_URI_SUFFIX,l.getProperty.url=this.sampleUrl+i.GET_PROPERTY_URI_SUFFIX,l.getFiles.url=this.sampleUrl+i.GET_FILES_URI_SUFFIX,this.Sample=this.$resource(this.sampleUrl,e,l);var c={};angular.copy(this.defaultRestActionConfig,c),c.validateFileSummary={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id",validationType:"@validationType"},url:this.apiBaseUrl+"files/:Id/validations/:validationType"},c.saveProperty.url=this.fileUrl+i.SAVE_PROPERTY_URI_SUFFIX,c.getProperty.url=this.fileUrl+i.GET_PROPERTY_URI_SUFFIX,this.File=this.$resource(this.fileUrl,e,c);var u={};angular.copy(this.defaultRestActionConfig,u),u.create={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{projectId:"@projectId"},url:this.apiBaseUrl+"projects/:projectId/appresults"},u.validate={method:"POST",headers:this.formHeaders,withCredentials:this.useCookieAuth,params:{type:"@type"},url:this.apiBaseUrl+"validatefile/:type"},u.saveProperty.url=this.appResultUrl+i.SAVE_PROPERTY_URI_SUFFIX,u.getProperty.url=this.appResultUrl+i.GET_PROPERTY_URI_SUFFIX,u.getFiles.url=this.appResultUrl+i.GET_FILES_URI_SUFFIX,this.AppResult=this.$resource(this.appResultUrl,e,u);var d={};angular.copy(this.defaultRestActionConfig,d),d.queryMyApps={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.applicationMyAppsUrl},d.getVersions={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.applicationVersionsUrl},d.getAgreements={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.applicationAgreementsUrl},d.getProducts={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.storeApplicationUrl},d.getProductsProxy={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.applicationProductsUrlProxy},d.getScreenshots={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.applicationScreenshotsUrl},d.getSettings={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.applicationSettingsUrl},d.getMetadata={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.applicationMetadataUrl},d.createVersion={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.applicationVersionsUrl},d.createProduct={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,crossDomain:!0,params:{Id:"@Id"},url:this.storeApplicationProductsUrl},d.saveSettings={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{Id:"@Id"},url:this.applicationSettingsUrl},d.saveProperty.url=this.applicationUrl+i.SAVE_PROPERTY_URI_SUFFIX,d.getProperty.url=this.applicationUrl+i.GET_PROPERTY_URI_SUFFIX,this.Application=this.$resource(this.applicationUrl,e,d);var p={};angular.copy(this.defaultRestActionConfig,p),p.save.method="PUT",p.clone={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,params:{}},this.AssetPackage=this.$resource(this.applicationAssetPackagesUrl,e,p);var m={};angular.copy(this.defaultRestActionConfig,m),m.query.url=this.productMyProductsUrl,m.save.method="PUT",this.Product=this.$resource(this.productUrl,e,m);var h={};angular.copy(this.defaultRestActionConfig,h),this.AppPurchase=this.$resource(this.applicationPurchasesUrl,e,h);var f={};angular.copy(this.defaultRestActionConfig,f),this.UserPurchaseList=this.$resource(this.userPurchaseListUrl,e,f);var v={};angular.copy(this.defaultRestActionConfig,v),v.query.url=this.apiBaseUrl+"users/current/projects",v.saveProperty.url=this.projectUrl+i.SAVE_PROPERTY_URI_SUFFIX,v.getProperty.url=this.projectUrl+i.GET_PROPERTY_URI_SUFFIX,this.ProjectInvite=this.$resource(this.projectInviteUrl,e,this.defaultRestActionConfig),this.ProjectsList=this.$resource(this.projectsListUrl,{},this.defaultRestActionConfig),this.Project=this.$resource(this.projectUrl,e,v),this.ProjectAnalyses=this.$resource(this.projectAnalysisUrl,e,this.defaultRestActionConfig),this.ProjectSamples=this.$resource(this.projectSamplesUrl,e,this.defaultRestActionConfig);var g={};angular.copy(this.defaultRestActionConfig,g),g.query.url=this.apiBaseUrl+"genomes",g.saveProperty.url=this.genomeUrl+i.SAVE_PROPERTY_URI_SUFFIX,g.getProperty.url=this.genomeUrl+i.GET_PROPERTY_URI_SUFFIX,this.Genome=this.$resource(this.genomeUrl,e,g);var b=angular.copy(this.defaultRestActionConfig);this.Search=this.$resource(this.searchUrl,{},b);var S={};angular.copy(this.defaultRestActionConfig,S),S.query.url=this.trashListUrl,this.Trash=this.$resource(this.trashUrl,{Id:"@Id"},this.defaultRestActionConfig),this.TrashRestore=this.$resource(this.trashRestoreUrl,{Id:"@Id"},this.defaultRestActionConfig),this.TrashList=this.$resource(this.trashListUrl,{},this.defaultRestActionConfig);var y={};angular.copy(this.defaultRestActionConfig,y),this.CollaboratorList=this.$resource(this.collaboratorListUrl,{Resource:"@Resource",Id:"@Id"},y);var C={};angular.copy(this.defaultRestActionConfig,C),C.get={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.libraryPrepKitsUrl+"/:Id"},this.LibraryPrepKits=this.$resource(this.libraryPrepKitsUrl,e,C),this.LibraryContainerList=this.$resource(this.libraryContainersListUrl,e,this.defaultRestActionConfig);var w={};angular.copy(this.defaultRestActionConfig,w),this.LibraryContainers=this.$resource(this.libraryContainersUrl,e,w),this.LibraryContainerSampleLibraries=this.$resource(this.libraryContainerSampleLibrariesUrl,e,this.defaultRestActionConfig);var I={};angular.copy(this.defaultRestActionConfig,I),I.get={method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.libraryPoolsUrl+"/:Id"},I.info={method:"put",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.libraryPoolsUrl+"/info"},this.LibraryPool=this.$resource(this.libraryPoolsUrl+"/:Id",e,I),this.SpeciesList=this.$resource(this.speciesListUrl,{},this.defaultRestActionConfig);var T={};angular.copy(this.defaultRestActionConfig,T),T.get={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.plannedRunsUrl+"/:Id"},T.readyUp={method:"PUT",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.plannedRunsUrl+"/:Id/ready"},T.save={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.plannedRunsUrl+"/:Id"},T.create={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.plannedRunsUrl},this.PlannedRun=this.$resource(this.plannedRunsUrl,e,T);var A={};A.get={method:"GET",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.plannedRunLibraryPoolUrl},this.PlannedRunPools=this.$resource(this.plannedRunLibraryPoolUrl,e,A);var D={};angular.copy(this.defaultRestActionConfig,D),D.create={method:"POST",headers:this.defaultHeaders,withCredentials:this.useCookieAuth,url:this.bioCreateSampleUrl},this.BioSample=this.$resource(this.bioCreateSampleUrl,e,D)},e.prototype.getFromResourceUrl=function(e){if(e.toLowerCase().indexOf("v1pre3/")>-1)return this.getFromV1ResourceUrl(e);if(e.toLowerCase().indexOf("v2/")>-1)return this.getFromV2ResourceUrl(e);throw"Unable to determine API version from href: "+e},e.prototype.getFromV1ResourceUrl=function(e){var t=this.$q.defer(),i=this._getNgResource(e);return i.get({},function(e,i){var s=e.Response;t.resolve(s)},function(e){t.reject(e.data.ResponseStatus.Message)}),t.promise},e.prototype._getNgResource=function(e){if(!e||e.length<=0)throw"url is required";var t,i=$.support.cors?this.serverConfig.publicApiBaseUrl:this.serverConfig.publicApiProxyBaseUrl,s=/^https?:\/\//i;t=s.test(e)?e:i+e.split("/").splice(1).join("/").toString();var a={get:{method:"get",headers:{},withCredentials:!0,url:t}},r=this.$resource(i,{},a);return r},e.prototype.getFromV2ResourceUrl=function(e){var t=this.$q.defer(),i=this._getNgResource(e);return i.get({},function(e,i){return t.resolve(e)},function(e){t.reject(e.data.ErrorMessage)}),t.promise},e}();i.PublicApi=l}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(t,i){this.$resource=t,this.serverConfig=i,this.defaultHeaders={},this.formHeaders={},this.serverConfig.accessToken?(this.defaultHeaders["x-access-token"]=this.serverConfig.accessToken,this.useCookieAuth=!1):$.support.cors&&(this.useCookieAuth=!0,(null===i.currentUserId||void 0===i.currentUserId)&&console.log("Warning: access token absent, so we will attempt to use cookie authentication, but currentUserId is unknown.")),this.defaultHttpConfig={headers:this.defaultHeaders,withCredentials:this.useCookieAuth},angular.copy(this.defaultHeaders,this.formHeaders),angular.extend(this.formHeaders,{"Content-type":null}),this.apiBaseUrl=this.serverConfig.publicApiBaseUrl,this.urlParameterMap={Id:"@Id",propertyName:"@propertyName"},this.actions={get:{method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},post:{method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},query:{method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth},save:{method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},"delete":{method:"delete",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},saveProperty:{method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},getProperty:{method:"get",headers:this.defaultHeaders,withCredentials:this.useCookieAuth}},this.initActions(),this.actions.saveProperty.url=this.serviceUrl+e.SAVE_PROPERTY_URI_SUFFIX,this.actions.getProperty.url=this.serviceUrl+e.GET_PROPERTY_URI_SUFFIX,this.ResourceClass=this.$resource(this.serviceUrl,this.urlParameterMap,this.actions)}return t.prototype.initActions=function(){throw"initActions() not implemented"},t.prototype.get=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.get(e,t,i).$promise},t.prototype.query=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.query(e,t,i).$promise},t.prototype.save=function(e,t,i,s){return void 0===i&&(i=null),void 0===s&&(s=null),this.ResourceClass.save(e,t,i,s).$promise},t.prototype["delete"]=function(e,t,i,s){return void 0===i&&(i=null),void 0===s&&(s=null),this.ResourceClass.save(e,t,i,s).$promise},t}();e.AbstractApiService=t}(t=e.Api||(e.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.AbstractApiService);t.V1AbstractApiService=i}(t=e.V1||(e.V1={}))}(t=e.Api||(e.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.AbstractApiService);t.V2AbstractApiService=i}(t=e.V2||(e.V2={}))}(t=e.Api||(e.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a;!function(s){var a;!function(s){s.serviceName="appSessionV1Api";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"appsessions",this.actions.get.url=this.serviceUrl+"/:Id",this.actions.query.url=this.apiBaseUrl+"users/current/appsessions"},t}(e.Common.Services.Api.V1.V1AbstractApiService);s.Service=a,t.commonModule.service(s.serviceName,["$resource",i.ServerConfig.serverConfigServiceName,function(e,t){return new a(e,t)}])}(a=s.V1||(s.V1={}))}(a=s.AppSession||(s.AppSession={}))}(s=i.Api||(i.Api={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a;!function(s){var a;!function(s){s.serviceName="appSessionV2Api";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"appsessions",this.actions.get.url=this.serviceUrl+"/:Id",this.actions.save.url=this.serviceUrl+"/:Id",this.actions.stop={url:this.serviceUrl+"/:Id/stop",method:"post",headers:this.defaultHeaders,withCredentials:this.useCookieAuth}},t.prototype.stop=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.stop(e,t,i).$promise},t}(e.Common.Services.Api.V2.V2AbstractApiService);s.Service=a,t.commonModule.service(s.serviceName,["$resource",i.ServerConfig.serverConfigServiceName,function(e,t){return new a(e,t)}])}(a=s.V2||(s.V2={}))}(a=s.AppSession||(s.AppSession={}))}(s=i.Api||(i.Api={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="bioSampleApi",e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,function(e,t){return new a(e,t)}]);var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"biosamples/:Id",this.actions.query.url=this.apiBaseUrl+"biosamples",this.actions.queryLibraries={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"biosamples/:Id/libraries"},this.actions.upload={method:"post",url:this.apiBaseUrl+"biosamples/manifestimport",headers:this.defaultHeaders,withCredentials:this.useCookieAuth},this.actions.queryRunLanes={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"biosamples/:Id/runlanesummaries"},this.actions.queryRequeues={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"biosamples/:Id/labrequeues"},this.actions.createNewLibraryRequeue={method:"post",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"preprequests/:PrepRequestId/labrequeues"},this.actions.createExistingLibraryRequeue={method:"post",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"libraries/:LibraryId/labrequeues"},this.actions.createPoolRequeue={method:"post",headers:this.defaultHeaders,isArray:!1,withCredentials:!0,url:this.apiBaseUrl+"librarypools/:PoolId/labrequeues"}},t.prototype.queryLibraries=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.queryLibraries(e,t,i).$promise},t.prototype.queryRunLanes=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.queryRunLanes(e,t,i).$promise},t.prototype.queryRequeues=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.queryRequeues(e,t,i).$promise},t.prototype.upload=function(e,t,i,s){return void 0===i&&(i=null),void 0===s&&(s=null),this.ResourceClass.upload({preview:e},t,i,s).$promise},t.prototype.createNewLibraryRequeue=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.createNewLibraryRequeue(e,null,t,i).$promise},t.prototype.createExistingLibraryRequeue=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.createExistingLibraryRequeue(e,null,t,i).$promise},t.prototype.createPoolRequeue=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.createPoolRequeue(e,null,t,i).$promise},t}(i.V2.V2AbstractApiService);s.Service=a}(s=i.BioSample||(i.BioSample={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){
var i;!function(i){var s;!function(s){s.serviceName="datasetApi",e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,function(e,t){return new a(e,t)}]);var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"datasets",this.actions.queryFiles={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.serviceUrl+"/:Id/files"},this.actions.getType={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.apiBaseUrl+"datasettypes/:Id"},this.actions.get.url=this.serviceUrl+"/:Id",this.actions.save.url=this.serviceUrl+"/:Id"},t.prototype.queryFiles=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.queryFiles(e,t,i).$promise},t.prototype.getType=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.getType(e,t,i).$promise},t}(i.V2.V2AbstractApiService);s.Service=a}(s=i.Dataset||(i.Dataset={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="runApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"runs",this.actions.nextseqRequeue={method:"post",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.serviceUrl+"/:Id/nextseqrequeue"},this.actions.getCapabilities={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.serviceUrl+"/:Id/capabilities"}},t.prototype.nextseqRequeue=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.nextseqRequeue(e,t,i).$promise},t.prototype.getCapabilities=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.getCapabilities(e,t,i).$promise},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,a])}(s=i.Run||(i.Run={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="labRequeueApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"labrequeues",this.actions.save.url=this.serviceUrl+"/:Id"},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,a])}(s=i.LabRequeue||(i.LabRequeue={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="laneIndexSummariesApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"/runs/:Id/laneindexsummaries"},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,function(e,t){return new a(e,t)}])}(s=i.LaneIndexSummaries||(i.LaneIndexSummaries={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="LaneApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"lanes",this.actions.save.url=this.serviceUrl+"/:Id"},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,a])}(s=i.LaneQc||(i.LaneQc={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="libraryPoolApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"librarypools",this.actions.get.url=this.serviceUrl+"/:Id",this.actions.save.url=this.serviceUrl+"/:Id",this.actions.getCapabilities={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.serviceUrl+"/:Id/capabilities"},this.actions.queryLibraries={method:"get",headers:this.defaultHeaders,isArray:!1,withCredentials:this.useCookieAuth,url:this.serviceUrl+"/:Id/libraries"}},t.prototype.getCapabilities=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.getCapabilities(e,t,i).$promise},t.prototype.queryLibraries=function(e,t,i){return void 0===t&&(t=null),void 0===i&&(i=null),this.ResourceClass.queryLibraries(e,t,i).$promise},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,a])}(s=i.LibraryPool||(i.LibraryPool={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="subscriptionApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"subscriptions",this.actions.query.url=this.apiBaseUrl+"users/current/subscriptions"},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,a])}(s=i.Subscription||(i.Subscription={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.Error="Error",e.Warning="Warning",e}();e.V2ImportStatus=t}(t=e.BioSample||(e.BioSample={}))}(t=e.Api||(e.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.serviceName="bioSampleTemplateFetch",e.commonModule.service(i.serviceName,["$http","$location","$q",t.ServerConfig.serverConfigServiceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function e(e,t,i){var s=this;this.getTemplate=function(){var e=s.$q.defer(),t=s.$location.protocol()+"://"+s.$location.host();return s.$http.get(t+"/Resources/Import_BiologicalSamples_Template-v2.csv",{withCredentials:!0}).then(function(t){for(var i=[],s=t.data.toString().split("\n"),a=0;a<s.length;a++)i.push(s[a].split(","));e.resolve({data:{Response:{ParsedLines:i,ManifestStatuses:{Statuses:[]}}}})},function(){e.reject()}),e.promise},this.$http=e,this.$location=t,this.$q=i}return e}();i.TemplateFetchService=s}(s=i.BioSampleTemplateFetch||(i.BioSampleTemplateFetch={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="newsFeedApi";var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.initActions=function(){this.apiBaseUrl=this.serverConfig.publicV2ApiBaseUrl,this.serviceUrl=this.apiBaseUrl+"feeds"},t}(i.V2.V2AbstractApiService);s.Service=a,e.commonModule.service(s.serviceName,["$resource",t.ServerConfig.serverConfigServiceName,a])}(s=i.NewsFeed||(i.NewsFeed={}))}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e){this.api=e}return e.prototype.injectCmsSurveyCode=function(e){this.api.CMS.getContentEntries({contentGroupName:"surveys"}).$promise.then(function(t){for(var i,s=0;s<t.Response.Items.length;s++){var a=t.Response.Items[s];if(a.Name===e){i=a;break}}i&&i.Content&&angular.element("body").append(i.Content)})},e}();t.CmsSurveyService=i,t.cmsSurveyServiceName="cmsSurvey",e.commonModule.service(t.cmsSurveyServiceName,[t.Api.apiServiceName,i])}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a=t.Services.BsEnumDictionary;s.searchFilterDictionaryServiceName="bsSearchFilterDictionary",t.commonModule.service(s.searchFilterDictionaryServiceName,[i.Api.apiServiceName,i.ServerConfig.appStartConfigServiceName,e.Common.Services.bsEnumDictionaryServiceName,function(e,t,i){return new r(e,t,i)}]);var r=function(){function e(e,t,i){var s=this;this.api=e,this.appStartConfig=t,this.enumDictionary=i,this._getEnumChoices=function(e){var t=s.enumDictionary.getValues(e);return t.sort(),t.map(function(t){return{value:t,label:s.enumDictionary.getDisplayName(e,t)}})},this.getAppSessionCombinedStatusChoices=function(){var e,t=s.enumDictionary.getValues(a.APP_SESSION_QC_STATUS_ENUM),i=s.enumDictionary.getValues(a.APP_SESSION_EXECUTION_STATUS_ENUM),r=new Array;for(e=0;e<t.length;e++)"Undefined"!==t[e]&&r.push({value:"QcStatus|"+t[e],label:s.enumDictionary.getDisplayName(a.APP_SESSION_QC_STATUS_ENUM,t[e])});for(e=0;e<i.length;e++)"Undefined"!==i[e]&&r.push({value:"ExecutionStatus|"+i[e],label:s.enumDictionary.getDisplayName(a.APP_SESSION_EXECUTION_STATUS_ENUM,i[e])});return r.sort(function(e,t){return e.label.localeCompare(t.label)}),r},this.project={id:"project-filter",uiType:this._getDropdownType(),label:"Project",facet:"Projects.Id",choices:[],dataSource:{apiResource:this.api.Project,limit:1e3,sortDir:"asc",sortBy:"Name"},choiceLabelAccessor:function(e){return e.Name},choiceValueAccessor:function(e){return e.Id},currentChoice:null},this.genome={id:"genome-filter",uiType:this._getDropdownType(),label:"Genome",facet:"Genome.Id",choices:[],dataSource:{apiResource:this.api.Genome,limit:1e3,sortDir:"asc",sortBy:"SpeciesName"},choiceLabelAccessor:function(e){return e.DisplayName},choiceValueAccessor:function(e){return e.Id},currentChoice:null},this.minRead1={id:"min-read-1-filter",uiType:"textbox",ngClass:{"half-width":!0},label:"Min Read 1 length",facet:"Read1",choices:[],currentChoice:null,choiceValueAccessor:function(e){return s._stringToComparisonOperatorQueryValue(e,">=")}},this.minRead2={id:"min-read-2-filter",uiType:"textbox",ngClass:{"half-width":!0},label:"Min Read 2 length",facet:"Read2",choices:[],currentChoice:null,choiceValueAccessor:function(e){return s._stringToComparisonOperatorQueryValue(e,">=")}},this.maxRead1={id:"max-read-1-filter",uiType:"textbox",ngClass:{"half-width":!0},label:"Max Read 1 length",facet:"Read1",choices:[],currentChoice:null,choiceValueAccessor:function(e){return s._stringToComparisonOperatorQueryValue(e,"<=")}},this.maxRead2={id:"max-read-2-filter",uiType:"textbox",ngClass:{"half-width":!0},label:"Max Read 2 length",facet:"Read2",choices:[],currentChoice:null,choiceValueAccessor:function(e){return s._stringToComparisonOperatorQueryValue(e,"<=")}},this.minReadsPF={id:"min-reads-pf-filter",uiType:"textbox",ngClass:{"half-width":!0},label:"Min # reads",facet:"NumReadsPF",choices:[],currentChoice:null,choiceValueAccessor:function(e){return s._stringToComparisonOperatorQueryValue(e,">=")}},this.maxReadsPF={id:"max-reads-pf-filter",uiType:"textbox",ngClass:{"half-width":!0},label:"Max # reads",facet:"NumReadsPF",choices:[],currentChoice:null,choiceValueAccessor:function(e){return s._stringToComparisonOperatorQueryValue(e,"<=")}},this.runStatus={id:"run-status-filter",uiType:"dropdown",label:"Run status",facet:"Run.Status",choices:this._getEnumChoices(a.RUN_STATUS_ENUM),currentChoice:null},this.runInstrumentSerialNumber={id:"run-instrument-serial-number-filter",uiType:this._getDropdownType(),label:"Instrument",facet:"Instrument.Id",choices:[],dataSource:{apiResource:this.api.InstrumentList,limit:1e3,sortDir:"asc",sortBy:"Id"},choiceLabelAccessor:function(e){return e.Id},choiceValueAccessor:function(e){return e.Id},currentChoice:null},this.runLaneAndQcStatus={id:"run-lane-and-qc-status-filter",uiType:"dropdown",label:"Lane & QC status",facet:"Run.LaneAndQcStatus",choices:this._getEnumChoices(a.RUN_LANE_AND_QC_STATUS_ENUM),currentChoice:null},this.fileextension={id:"file-extension-filter",uiType:"dropdown",label:"Extension",facet:"fileextension",choices:[{value:".bam",label:"BAM"},{value:".csv",label:"CSV"},{value:".vcf",label:"VCF"},{value:".txt",label:"TXT"},{value:".xml",label:"XML"}],currentChoice:null},this.appSessionCombinedStatus={id:"appsession-combined-status",uiType:"dropdown",label:"Status",facet:"AppSessionCombinedStatus",choices:this.getAppSessionCombinedStatusChoices(),currentChoice:null}}return e.prototype._stringToComparisonOperatorQueryValue=function(e,t){if(!e||!e.trim())return null;var i=Number(e);return isNaN(i)?null:t+i},e.prototype._getDropdownType=function(){return"dropdown"},e}();s.SearchFilterDictionary=r}(s=i.Search||(i.Search={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.serviceName="bsResourceDictionary",t.commonModule.service(s.serviceName,[i.Api.apiServiceName,i.ServerConfig.appStartConfigServiceName,i.Search.searchFilterDictionaryServiceName,e.Common.Services.siteNavigationServiceName,function(e,t,i,s){return new o(e,t,i,s)}]);var a=function(){function e(){}return e.APPLICATION="application",e.APPRESULT="appresult",e.APPSESSION="appsession",e.APPRESULT_FILE="appresultfile",e.GENOME="genome",e.PROJECT="project",e.SAMPLE="sample",e.SAMPLE_FILE="samplefile",e.RUN="run",e.NOTIFICATION="notification",e}();s.SearchApiResourceTypes=a;var r=function(){function e(){}return e.CHOOSER_ROW_SUFFIX="chooserRow",e.GROUPER_ROW_SUFFIX="grouperRow",e.SEARCH_RESULT_ROW_SUFFIX="searchResultsRow",e.TYPEAHEAD_MATCH_SUFFIX="typeaheadMatch",e.LIST_ROW_SUFFIX="listRow",e.PREVIEW_ROW_SUFFIX="preview",e}();s.TemplateSuffixes=r;var o=function(){function e(e,s,a,r){var o=this;this.api=e,this.appStartConfig=s,this.searchFilterDictionary=a,this.siteNavigationService=r,this.allResources=[],this.allResources.push(this.app={key:"app",displayNameSingular:"App",displayNamePlural:"Apps",searchObjectName:"Application",namePropertyName:"Name",idPropertyName:"Id",chooserMessage:"Select App(s)",searchScope:"apps",apiBaseHrefFragment:"applications",searchFilters:[],isCreatableInChooser:!1,selectedItemNameAccessor:function(e){return e.Application.Name},uiHrefAccessor:function(e){return"/apps/"+e.Application.Id+"/"+t.Utils.StringUtils.toSlug(e.Application.Name)},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"applications/"+e.Application.Id},gridOptions:{},restResource:this.api.Project,baseQuery:"islatestversion:true"}),this.allResources.push(this.biosample={key:"biosample",displayNameSingular:"Biosample",displayNamePlural:"Biosamples",searchObjectName:"BioSample",namePropertyName:"BioSampleName",idPropertyName:"Id",chooserMessage:"Select Biosample(s)",apiBaseHrefFragment:"biosamples",searchFilters:[],isCreatableInChooser:!1,selectedItemNameAccessor:function(e){return e.BioSample.BioSampleName},uiHrefAccessor:function(e){return o.siteNavigationService.urlBiosampleSummary(e.BioSample.Id)},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION2_PREFIX:"")+"biosamples/"+e.BioSample.Id},gridOptions:{}}),this.allResources.push(this.sample={key:"sample",displayNameSingular:"Sample",displayNamePlural:"Samples",chooserMessage:"Select Sample(s):",searchObjectName:"Sample",idPropertyName:"Id",namePropertyName:"SampleId",searchScope:"samples",apiBaseHrefFragment:"samples",searchFilters:[this.searchFilterDictionary.project,this.searchFilterDictionary.genome,this.searchFilterDictionary.minRead1,this.searchFilterDictionary.maxRead1,this.searchFilterDictionary.minRead2,this.searchFilterDictionary.maxRead2,this.searchFilterDictionary.minReadsPF,this.searchFilterDictionary.maxReadsPF],isCreatableInChooser:!1,baseQuery:"Status:Complete",selectedItemNameAccessor:function(e){return e.Sample.SampleId},uiHrefAccessor:function(e){return"/sample/"+e.Sample.Id+"/"+t.Utils.StringUtils.toSlug(e.Sample.SampleId)},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"samples/"+e.Sample.Id},restResource:this.api.Sample}),this.allResources.push(this.run={key:"run",displayNameSingular:"Run",displayNamePlural:"Runs",chooserMessage:"Select Run(s):",searchObjectName:"Run",idPropertyName:"Id",namePropertyName:"ExperimentName",searchScope:"runs",apiBaseHrefFragment:"runs",searchFilters:[this.searchFilterDictionary.runStatus,this.searchFilterDictionary.runInstrumentSerialNumber,this.searchFilterDictionary.runLaneAndQcStatus],isCreatableInChooser:!1,restoreFromTrashUrlAccessor:function(t){return e.apiBaseUrl+"runs/"+t.Id+"/RestoreFromTrash"},uiHrefAccessor:function(e){return"/run/"+e.Run.Id+"/"+t.Utils.StringUtils.toSlug(e.Run.ExperimentName)},uiHrefAccessorAll:function(){return"/runs"},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"runs/"+e.Run.Id},convertContentObject:function(e){var t=e;return{Run:t}},restResource:this.api.Run}),this.allResources.push(this.appsession={key:"appsession",displayNameSingular:"Analysis",displayNamePlural:"Analyses",searchObjectName:"AppSession",chooserMessage:"Select Analysis:",idPropertyName:"Id",namePropertyName:"Name",searchScope:"appsessions",apiBaseHrefFragment:"appsessions",searchFilters:[this.searchFilterDictionary.appSessionCombinedStatus],isCreatableInChooser:!1,uiHrefAccessor:function(e){return"/analyses/"+e.AppSession.Id},uiHrefAccessorAll:function(){return"/analyses"},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"appsessions/"+e.AppSession.Id},restResource:this.api.AppSession,restoreFromTrashUrlAccessor:function(t){return e.apiBaseUrl+"appsessions/"+t.Id+"/RestoreFromTrash"}}),this.allResources.push(this.appresult={key:"appresult",displayNameSingular:"App Result",displayNamePlural:"App Results",searchObjectName:"AppResult",chooserMessage:"Select App Result(s):",idPropertyName:"Id",namePropertyName:"Name",searchScope:"appresults",apiBaseHrefFragment:"appresults",searchFilters:[this.searchFilterDictionary.project],isCreatableInChooser:!1,uiHrefAccessor:function(e){return"/analyses/"+e.AppResult.AppSession.Id+"/results/"+e.AppResult.Id},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"appresults/"+e.AppResult.Id},restResource:this.api.AppResult}),this.allResources.push(this.appresult_file={key:"appresult_file",displayNameSingular:"File",displayNamePlural:"Files",searchObjectName:"AppResultFile",chooserMessage:"Select File(s):",idPropertyName:"Id",namePropertyName:"Name",searchScope:"appresult_files",apiBaseHrefFragment:"files",searchFilters:[this.searchFilterDictionary.project,this.searchFilterDictionary.fileextension],isCreatableInChooser:!1,uiHrefAccessor:function(e){return"/files/"+e.AppResultFile.Id},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"files/"+e.AppResultFile.Id},restResource:this.api.File}),this.allResources.push(this.project={key:"project",displayNameSingular:"Project",displayNamePlural:"Projects",searchObjectName:"Project",chooserMessage:"Select Project(s):",idPropertyName:"Id",namePropertyName:"Name",hrefPropertyName:"Href",searchScope:"projects",apiBaseHrefFragment:"projects",searchFilters:[],isCreatableInChooser:!0,uiHrefAccessor:function(e){return o.siteNavigationService.urlProjectSummary(e.Project.Id)},convertContentObject:function(e){var t=e;return{Project:t}},apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"projects/"+e.Project.Id},restResource:this.api.Project}),this.allResources.push(this.genome={key:"genome",displayNameSingular:"Genome",displayNamePlural:"Genomes",searchObjectName:"Genome",chooserMessage:"Select Genome(s):",idPropertyName:"Id",namePropertyName:"DisplayName",searchScope:"genomes",apiBaseHrefFragment:"genomes",searchFilters:[],isCreatableInChooser:!1,apiHrefAccessor:function(e,t){return void 0===t&&(t=!0),(t?i.Api.VERSION_PREFIX:"")+"genomes/"+e.Genome.Id},restResource:this.api.Genome}),this.allResources.push(this.notification={key:"notification",displayNameSingular:"Notification",displayNamePlural:"Notifications",searchObjectName:"Notification",chooserMessage:"Select Notification(s):",idPropertyName:"Id",apiBaseHrefFragment:"notifications",searchFilters:[],isCreatableInChooser:!1,restResource:this.api.Notification,uiHrefAccessorAll:function(){return null}}),this.allResources.push(this.pool={key:"pool",displayNameSingular:"Pool",displayNamePlural:"Pools",searchObjectName:"Pool",chooserMessage:"Select Pool(s):",idPropertyName:"Id",apiBaseHrefFragment:"library-pools",searchFilters:[],isCreatableInChooser:!1,restResource:null,namePropertyName:"UserPoolId",uiHrefAccessor:function(e){var t;return t=e.hasOwnProperty(o.pool.searchObjectName)?e.Pool:e,t&&t.Id?o.siteNavigationService.urlPoolSummary(t.Id):""}}),this.allResources.push(this.library={key:"library",displayNameSingular:"Library",displayNamePlural:"Libraries",searchObjectName:"Library",chooserMessage:"Select Libraries:",idPropertyName:"Id",apiBaseHrefFragment:"libraries",searchFilters:[],isCreatableInChooser:!1,restResource:null,namePropertyName:"Name"}),this.allResources.push(this.dataset={key:"dataset",displayNameSingular:"dataset",displayNamePlural:"datasets",searchObjectName:"Dataset",chooserMessage:"Select Datasets:",idPropertyName:"IdToken",apiBaseHrefFragment:"datasets",searchFilters:[],isCreatableInChooser:!1,restResource:null,namePropertyName:"Name"}),this.allResources.push(this.uiAll={key:"uiAll",displayNameSingular:null,displayNamePlural:null,chooserMessage:"Select Item(s)",searchObjectName:null,namePropertyName:null,idPropertyName:null,searchScope:[this.sample.searchScope,this.project.searchScope,this.appresult_file.searchScope,this.run.searchScope,this.app.searchScope].join(","),searchFilters:[],isCreatableInChooser:!1,templates:function(e){var t=o.getResourceConfigBySearchType(e.Type),i=t.templates;return"function"==typeof t.templates?i(e):t.templates},uiHrefAccessor:function(e){var t=o.getResourceConfigBySearchType(e.Type);return t.uiHrefAccessor(e)},baseQuery:"_missing_:islatestversion or islatestversion:true"}),this._initTemplates()}return e.prototype._concatAllBaseQueries=function(){for(var e=[],t="",i=0;i<this.allResources.length;i++){var s=this.allResources[i];"uiAll"!=s.key&&s.baseQuery&&e.push(s.baseQuery)}return t="("+e.join(" AND ")+")"},e.prototype._initTemplates=function(){for(var e=0;e<this.allResources.length;e++){var i=this.allResources[e];i.templates||(i.templates={});for(var s in r){var a=r[s],o=a.charAt(0).toUpperCase()+a.slice(1),n=i.key+o;n in t.Templates&&(i.templates[a]=t.Templates[n])}}},e.prototype.getIdAccessorForResource=function(e){var t=this;if(e===this.uiAll)return function(e){var i=t.getResourceConfigBySearchType(e.Type);return t.getNameAccessorForResource(i)(e)};var i=e.searchObjectName,s=e.idPropertyName;return function(e){return e[i]&&e[i].hasOwnProperty(s)?e[i][s]:null}},e.prototype.getNameAccessorForResource=function(e){var t=this;if(e===this.uiAll)return function(e){var i=t.getResourceConfigBySearchType(e.Type);return t.getNameAccessorForResource(i)(e)};var i=e.searchObjectName,s=e.namePropertyName;return function(e){return e[i]&&e[i].hasOwnProperty(s)?e[i][s]:null}},e.prototype.getObjectCreatorForResource=function(e){if(e===this.uiAll)throw new Error("Cannot create a new resource of type 'uiAll'.");var t=e.searchObjectName,i=e.namePropertyName,s=e.idPropertyName,a=e.hrefPropertyName;return function(e,r,o){var n={};return n[t]={},n[t][i]=r,n[t][s]=e,n[t][a]=o,n}},e.prototype.getComparatorForResource=function(e){var t=this;if(e===this.uiAll)return function(e,i){if(e.Type!=i.Type)return!1;var s=t.getResourceConfigBySearchType(e.Type),a=t.getIdAccessorForResource(s),r=a(e),o=a(i);return r===o};var i=e.searchObjectName,s=e.idPropertyName;return function(e,t){var a=e[i][s],r=t[i][s];return a===r}},e.prototype.getResourceConfigBySearchType=function(e){switch(e.toLowerCase()){case a.APPLICATION:return this.app;case a.APPSESSION:return this.appsession;case a.APPRESULT:return this.appresult;case a.APPRESULT_FILE:return this.appresult_file;case a.GENOME:return this.genome;case a.PROJECT:return this.project;case a.RUN:return this.run;case a.SAMPLE:return this.sample;default:throw new Error("Unknown search type "+e)}},e}();s.BsResourceDictionary=o,t.commonModule.filter("uiHref",[s.serviceName,function(e){return function(t,i){var s=e.getResourceConfigBySearchType(i?i:t.Type),a="";try{a=s.uiHrefAccessor(t)}catch(r){}return a}}]),t.commonModule.filter("preferredAppHref",[s.serviceName,function(e){return function(t){if(!t||!t.Id)return"";var i=e.app.uiHrefAccessor({Application:t});return i+"?preferredversion"}}]),t.commonModule.filter("fileAppSessionUiHref",[s.serviceName,function(e){return function(e){var t;return e&&e.ParentProjects&&(e.AppSessionRoot?t=e.AppSessionRoot.Id:e.ParentAppResult&&e.ParentAppResult.AppSession&&(t=e.ParentAppResult.AppSession.Id)),t?"/appsession/"+t+"/route?projectId="+e.ParentProjects[0].Id:"#"}}]),t.commonModule.filter("appResultAppSessionHref",[s.serviceName,function(e){return function(e){return e&&e.AppSession&&e.Projects?"/appsession/"+e.AppSession.Id+"/route?projectId="+e.Projects[0].Id:"#"}}]),t.commonModule.filter("resourceName",[s.serviceName,function(e){return function(t,i){var s=e.getResourceConfigBySearchType(i?i:t.Type),a="";try{a=t[s.searchObjectName][s.namePropertyName]}catch(r){}return a}}]),t.commonModule.filter("appIconHref",[s.serviceName,function(e){return function(t,i){if(!t||!t.Id)return"#";i||(i="original");var s=e.api.apiBaseUrl+"applications/"+t.Id+"/icon/?ImageSize="+i;return s}}]),t.commonModule.filter("appLaunchHref",function(){return function(e){return e&&e.Id?"/apps/"+e.Id+"/start":"#"}})}(s=i.BsResourceDictionary||(i.BsResourceDictionary={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.apiHrefParserServiceName="apiHrefParser",e.commonModule.service(i.apiHrefParserServiceName,[t.BsResourceDictionary.serviceName,function(e){return new s(e)}]);var s=function(){function e(e){this.resourceDictionary=e}return e.prototype.hrefWithoutPrefix=function(e){return angular.isString(e)?e.replace(i.VERSION_PREFIX,""):null},e.prototype.hrefToId=function(e){var t=this.hrefWithoutPrefix(e);if(!t)return null;for(var i=0;i<this.resourceDictionary.allResources.length;i++){var s=this.resourceDictionary.allResources[i],a=s.apiBaseHrefFragment+"/";if(s.apiBaseHrefFragment&&0===t.indexOf(a)){var r=t.substring(a.length,t.length);if(r)return r}}return null},e}();i.ApiHrefParser=s}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.dataMappingServiceName="dataMappingService",e.commonModule.service(i.dataMappingServiceName,[t.BsResourceDictionary.serviceName,function(e){return new s(e)}]);var s=function(){function e(e){this.resourceDictionary=e}return e.prototype.map=function(e,i,s){var a,r=this;if(i==t.DataType.SEARCH_RESULT_ITEM&&s==t.DataType.SPREADSHEET_ITEM)a=this.searchResultItemToSpreadsheetItem;else{if(s!=t.DataType.SEARCH_RESULT_ITEM||i!=t.DataType.SPREADSHEET_ITEM)throw"Mapping function not implemented from type '"+t.DataType[i]+"' to type '"+t.DataType[s]+"'";a=this.spreadsheetItemToSearchResultItem}return e.map(function(e){return a.call(r,e)})},e.prototype.searchResultItemToSpreadsheetItem=function(e){var t=e;if(angular.isDefined(t.name)&&angular.isDefined(t.id)&&angular.isDefined(t.type))return t;var i=this.resourceDictionary.getResourceConfigBySearchType(e.Type),s=this.resourceDictionary.getIdAccessorForResource(i),a=this.resourceDictionary.getNameAccessorForResource(i),r={name:a(e),id:s(e),type:e.Type};return r},e.prototype.spreadsheetItemToSearchResultItem=function(e,t){var i={Type:e.type};t||(t=this.resourceDictionary.getResourceConfigBySearchType(e.type));var s=i[t.searchObjectName]={};return s[t.idPropertyName]=e.id,s[t.namePropertyName]=e.name,i},e}();i.DataMappingService=s}(i=t.Mappings||(t.Mappings={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.propertyService="propertyService",e.commonModule.service(i.propertyService,[t.BsResourceDictionary.serviceName,function(e){return new a(e)}]);var s=function(){function e(){}return e.string="string",e.stringArray="string[]",e.sample="sample",e.sampleArray="sample[]",e.appresult="appresult",e.appresultArray="appresult[]",e.project="project",e.projectArray="project[]",e.biosample="biosample",e.biosampleArray="biosample[]",e.library="library",e.libraryArray="library[]",e.run="run",e.runArray="run[]",e.map="map",e.mapArray="map[]",e}();i.PropertyType=s;var a=function(){function e(e){this.resourceDictionary=e}return e.prototype.getProperty=function(e,t){for(var i=0;i<e.length;i++){var s=e[i];if(angular.isString(s.Name)&&s.Name.toLowerCase()===t.toLowerCase())return s}return null},e.prototype.getPropertyValue=function(e,t){var i=this.getProperty(e,t);return null===i?null:this.getValue(i)},e.prototype.getValue=function(e){return e.Content?e.Content:e.Items?e.Items:null},e.prototype.getPropertyResourceName=function(e,t,i,s){void 0===s&&(s=null);var a=this.getProperty(e,t),r="--";if(!this.isPropertyResource(a))return r;var o=this.getValue(a);angular.isArray(o)&&(o=o[0]);var n=this.getResourceTypeFromPropertyType(a.Type);if(!n||!n.namePropertyName)return r;var l=o[n.namePropertyName];if(l||(l=o[n.idPropertyName]),!i||!angular.isFunction(n.uiHrefAccessor))return l;var c={};c[n.searchObjectName]=o;var u=null==s?"<a href='"+n.uiHrefAccessor(c)+"'>"+l+"</a>":"<a href='"+n.uiHrefAccessor(c)+"' target='"+s+"'>"+l+"</a>";return u},e.prototype.getPropertyMapValue=function(e,t,i){var s=this.getPropertyValue(e,t);if(!s)return null;for(var a=0;a<s.length;a++){var r=s[a];if(angular.isString(r.Key)&&r.Key.toLowerCase()===i.toLowerCase())return r.Values}return null},e.prototype.getResourceTypeFromPropertyType=function(e){switch(e){case s.appresult:case s.appresultArray:return this.resourceDictionary.appresult;case s.biosample:case s.biosampleArray:return this.resourceDictionary.biosample;case s.sample:case s.sampleArray:return this.resourceDictionary.sample;case s.run:case s.runArray:return this.resourceDictionary.run;case s.project:case s.projectArray:return this.resourceDictionary.project;case s.library:case s.libraryArray:return this.resourceDictionary.library;default:return null}},e.prototype.isPropertyResource=function(e){if(!e)return null;switch(e.Type){case s.sample:case s.sampleArray:case s.appresult:case s.appresultArray:case s.run:case s.runArray:case s.biosample:case s.biosampleArray:case s.project:case s.projectArray:case s.library:case s.libraryArray:return!0;default:return!1}},e.prototype.setStringProp=function(e,t,i,a,r){var o={Properties:[{Name:i,Description:r,Type:s.string,Content:a}]};return this.setProperty(e,t,o)},e.prototype.setStringArrayProp=function(e,t,i,a,r){var o={Properties:[{Name:i,Description:r,Type:s.stringArray,
Items:a}]};return this.setProperty(e,t,o)},e.prototype.setProjectArrayProp=function(e,t,i,a,r){var o=this,n=a.map(function(e){return o.resourceDictionary.project.apiHrefAccessor({Project:{Id:e}},!1)}),l={Properties:[{Name:i,Description:r,Type:s.projectArray,Items:n}]};return this.setProperty(e,t,l)},e.prototype.setProjectProp=function(e,t,i,a,r){var o={Properties:[{Name:i,Description:r,Type:s.project,Content:this.resourceDictionary.project.apiHrefAccessor({Project:{Id:a}},!1)}]};return this.setProperty(e,t,o)},e.prototype.setAppResultArrayProp=function(e,t,i,a,r){var o=this,n=a.map(function(e){return o.resourceDictionary.appresult.apiHrefAccessor({AppResult:{Id:e}},!1)}),l={Properties:[{Name:i,Description:r,Type:s.appresultArray,Items:n}]};return this.setProperty(e,t,l)},e.prototype.setAppResultProp=function(e,t,i,a,r){var o={Properties:[{Name:i,Description:r,Type:s.appresult,Content:this.resourceDictionary.appresult.apiHrefAccessor({AppResult:{Id:a}},!1)}]};return this.setProperty(e,t,o)},e.prototype.setSampleArrayProp=function(e,t,i,a,r){var o=this,n=a.map(function(e){return o.resourceDictionary.sample.apiHrefAccessor({Sample:{Id:e}},!1)}),l={Properties:[{Name:i,Description:r,Type:s.sampleArray,Items:n}]};return this.setProperty(e,t,l)},e.prototype.setSampleProp=function(e,t,i,a,r){var o={Properties:[{Name:i,Description:r,Type:s.sample,Content:this.resourceDictionary.sample.apiHrefAccessor({Sample:{Id:a}},!1)}]};return this.setProperty(e,t,o)},e.prototype.setMapProp=function(e,t,i,a,r){var o=this.hashToKeyVals(a),n={Properties:[{Name:i,Description:r,Type:s.map,ContentMap:o}]};return this.setProperty(e,t,n)},e.prototype.setMapArrayProp=function(e,t,i,a,r){for(var o=[],n=0;n<a.length;n++){var l=a[n];o.push(this.hashToKeyVals(l))}var c={Properties:[{Name:i,Description:r,Type:s.mapArray,ItemsMap:o}]};return this.setProperty(e,t,c)},e.prototype.setProperty=function(e,t,i){var s=this.resourceDictionary[e],a=s.restResource;return a.saveProperty(angular.extend(i,{Id:t})).$promise},e.prototype.hashToKeyVals=function(e){var t=[];for(var i in e){var s={Key:null,Values:null};s.Key=i,s.Values=e[i],t.push(s)}return t},e.prototype.keyValsToObject=function(e){var t=e.reduce(function(e,t){return e[t.Key]=1==t.Values.length?t.Values[0]:t.Values,e},{});return t},e}();i.PropertyService=a}(i=t.Api||(t.Api={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.fileUtilsServiceName="fileUtilsService",e.commonModule.service(t.fileUtilsServiceName,function(){return new s}),e.commonModule.filter("bytes",function(){var e=1024,t=Math.pow(e,2),i=Math.pow(e,3),s=Math.pow(e,4),a=Math.pow(e,5);return function(r,o){return"undefined"==typeof r?"--":r>=0&&e>r?r+" B":r>=e&&t>r?(r/e).toFixed(o)+" KB":r>=t&&i>r?(r/t).toFixed(o)+" MB":r>=i&&s>r?(r/i).toFixed(o)+" GB":r>=s&&a>r?(r/s).toFixed(o)+" TB":r>=a?(r/a).toFixed(o)+" PB":r+" B"}}),e.commonModule.filter("pathWithoutFilename",function(){return function(e){if(!e||!e.Path||!e.Name)return"";var t=e.Path,i=e.Path.lastIndexOf(e.Name);return i>-1&&(t=t.substring(0,i)),t}}),function(e){e[e.None=0]="None",e[e.Image=1]="Image",e[e.Text=2]="Text",e[e.Pdf=3]="Pdf"}(t.FilePreviewType||(t.FilePreviewType={}));var i=t.FilePreviewType,s=function(){function e(){}return e.prototype.getExtension=function(e){if(!e)return null;var t=["gz","zip","gzip"],i="",s=e.split("."),a=s.pop(),r=s.pop();return i=s.length>0&&a&&r&&t.indexOf(a.toLowerCase())>-1?r+"."+a:a,i.toLowerCase()},e.prototype.getPreviewType=function(e){if(!e||!e.ContentType)return i.None;var t=e.ContentType.split("/"),s=t.shift();if(!s)return i.None;switch(s=s.toLowerCase()){case"text":return i.Text;case"image":return i.Image;case"application":var a=t.shift();if(!a)return i.None;switch(a=a.toLowerCase()){case"pdf":return i.Pdf;default:return i.None}default:return i.None}},e}();t.FileUtilsService=s}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.searchQueryServiceName="bsSearchQuery",e.commonModule.service(t.searchQueryServiceName,function(){return new i});var i=function(){function e(){this.wildcard="*",this.andDelimiter=" AND ",this.orDelimiter=" OR ",this.assigner=":",this.searchOperatorRegex=/\*|!|:|\sand\s|\sor\s|\snot\s|~|\^|\?|\\|\||\(|\[|\{|\"/i}return e.prototype.buildQueryString=function(e,t,i,s,a){void 0===e&&(e=""),void 0===t&&(t="");var r,o="",n=t.search(this.searchOperatorRegex)>-1;n?r=t:(t=t.trim(),r=a?t?this.restrictQueryToNameField(t,a):this.wildcard:t?t:this.wildcard);for(var l=0;l<i.length;l++){var c=i[l],u="("+c.facet+":"+c.currentChoice.value+")";o=o?[o,u].join(this.andDelimiter):u}return o&&(r=[r,o].join(this.andDelimiter)),e&&(r="("+[r,e].join(")"+this.andDelimiter+"(")+")"),a&&a.baseQuery&&(r="("+[r,a.baseQuery].join(")"+this.andDelimiter+"(")+")"),s&&(r="(id:"+s+") OR ("+r+")"),r},e.prototype.excludeHiddenFiles=function(e,t){return"+AND+-(path:%27indexes//data*%27)+AND+-(path:%27coverage//data*%27)+AND+datemodified:[*+TO+"+e("date")(t.getTime(),"yyyy-MM-ddTHH:mm:ss")+"]+AND+filestatus:UploadComplete+AND+size:[1+TO+*]"},e.prototype.restrictQueryToNameField=function(e,t){if(t.searchObjectName&&t.namePropertyName){var i=t.searchObjectName+"."+t.namePropertyName+":";return i+'"'+e+'"'}return e},e}();t.SearchQueryService=i}(i=t.Search||(t.Search={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.serviceName="bsModalDialog",t.MODAL_DIALOG_SHOW="bs-modal-dialog-show",t.MODAL_DIALOG_HIDE="bs-modal-dialog-hide",e.commonModule.service(t.serviceName,["$rootScope","$compile","$timeout","$interval","$q",function(e,t,s,a,r){return new i(e,t,s,a,r)}]);var i=function(){function t(e,t,i,s,a){this.$rootScope=e,this.$compile=t,this.$timeout=i,this.$interval=s,this.$q=a}return t.prototype.showModal=function(e,t){var i=this;this.modalScope=this.$rootScope.$new(!0),this.modalScope.dialogScope=null==t?{isVisible:!1}:t,this.modalScope.dialogScope.isVisible=!1,this.modalScope.clickOutside=function(e){i.modalScope.dialogScope.dismissByOutsideClick&&angular.element(e.target).is("bs-modal-dialog")&&i.removeModal()},angular.element(document).find("bs-modal-dialog").remove(),this.modalEl=this.$compile('<bs-modal-dialog ng-click="clickOutside($event)" ng-show="dialogScope.isVisible" class="bs-ng-modal-dialog">'+e.masterTemplate+"</bs-modal-dialog>")(this.modalScope),angular.element(document).find("body").append(this.modalEl),this.modalScope.dialogScope.isVisible=!0},t.prototype.bootstrapConfirm=function(t){var i=this,s=this.$q.defer();this.modalScope=this.$rootScope.$new(!0),this.modalScope.dialogScope=t.dialogScope||{},angular.extend(this.modalScope.dialogScope,{ngClass:t.ngClass||{},isVisible:!1}),this.modalScope.clickOutside=function(e){i.modalScope.dialogScope.dismissByOutsideClick&&angular.element(e.target).is("bs-modal-dialog")&&i.removeModal()};var a="",r=null;t.headerTemplate&&(r=this.$compile("<bs-bootstrap-modal-header>"+t.headerTemplate+"</bs-bootstrap-modal-header>")(this.modalScope));var o=null;t.bodyTemplate&&(o=this.$compile("<bs-bootstrap-modal-body>"+t.bodyTemplate+"</bs-bootstrap-modal-body>")(this.modalScope));var n,l=this.$rootScope.$new(!0);l.options={isConfirmDisabled:angular.isFunction(t.isConfirmDisabled)?t.isConfirmDisabled:function(){return!1},confirmLabel:t.confirmLabel?t.confirmLabel:"OK",cancelLabel:t.cancelLabel?t.cancelLabel:"Cancel",clickConfirm:function(){if(n&&i.$interval.cancel(n),angular.isFunction(t.onBeforeConfirmAsync)){l.isLoading=!0;var e=t.onBeforeConfirmAsync();e.then(function(e){i.removeModal().then(function(){return s.resolve(e)})},function(){l.isLoading=!1})}else{var a=null;angular.isFunction(t.onBeforeConfirm)&&(a=t.onBeforeConfirm()),i.removeModal().then(function(){return s.resolve(a)})}}},angular.isNumber(t.autoConfirmAfter)&&(this.modalScope.showCountdown=!0,this.modalScope.autoConfirmCountdown=Math.ceil(t.autoConfirmAfter/1e3),n=this.$interval(function(){i.modalScope.autoConfirmCountdown--,i.modalScope.autoConfirmCountdown<1&&(i.$interval.cancel(n),l.options.clickConfirm())},1e3)),t.showCancelButton!==!1&&(l.options.clickCancel=function(){n&&i.$interval.cancel(n);var e=t.onBeforeCancel?t.onBeforeCancel():null;i.removeModal().then(function(){return s.reject(e)})});var c=this.$compile("<bs-bootstrap-modal-footer>"+e.Templates.bootstrapModalFooterButtons+"</bs-bootstrap-modal-footer>")(l);try{l.$digest()}catch(u){}this.modalEl=this.$compile('<bs-modal-dialog ng-click="clickOutside($event)" ng-show="dialogScope.isVisible" class="bs-ng-modal-dialog"><bs-bootstrap-modal>'+a+"</bs-bootstrap-modal></bs-modal-dialog>")(this.modalScope);var d=this.modalEl.find(".modal-content");return r&&d.append(r),o&&d.append(o),d.append(c),angular.element(document).find("bs-modal-dialog").remove(),angular.element(document).find("body").append(this.modalEl),this.modalScope.dialogScope.isVisible=!0,s.promise},t.prototype.bootstrapAlert=function(e){return this.bootstrapConfirm(angular.extend(e,{showCancelButton:!1}))},t.prototype.actionPlaceholder=function(e,t){return void 0===t&&(t="This functionality is not yet available."),this.bootstrapAlert({headerTemplate:"<h4>"+e+"</h4>",bodyTemplate:t})},t.prototype.removeModal=function(){var e=this,t=this.$q.defer();return void 0!==this.modalScope?(this.modalScope.dialogScope.isVisible=!1,this.$timeout(function(){e.modalEl.remove(),e.modalScope.$destroy(),t.resolve()},500)):t.resolve(),t.promise},t}();t.ModalDialogService=i}(i=t.ModalDialog||(t.ModalDialog={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(t){for(var i=0;i<e.types.length;i++){var s=e.types[i];if(s.serverType===t)return s}return null}var i=function(){function e(e){for(var t in e)this[t]=e[t]}return e}();e.FileValidationType=i,e.types=[],e.types.push(e.trex=new i({propertyName:"BaseSpace.Files.Validations.manifest-trex-v1.0",propertyDescription:"Confirms that the manifest file passed initial server validation",displayName:"TruSeq Targeted RNA",serverType:"manifest-trex"})),e.types.push(e.amplicon=new i({propertyName:"BaseSpace.Files.Validations.manifest-amplicon-v1.0",propertyDescription:"Confirms that the manifest file passed initial server validation",displayName:"TruSeq Amplicon",serverType:"manifest-amplicon"})),e.types.push(e.nextera=new i({propertyName:"BaseSpace.Files.Validations.manifest-nextera-v1.0",propertyDescription:"Confirms that the manifest file passed initial server validation",displayName:"Nextera Rapid Capture",serverType:"manifest-nextera"})),e.types.push(e.vcf=new i({propertyName:"BaseSpace.Files.Validations.vcf-v1.0",propertyDescription:"Confirms that the VCF file passed initial server validation",displayName:"VCF",serverType:"vcf"})),e.types.push(e.vcfgz=new i({propertyName:"BaseSpace.Files.Validations.vcfgz-v1.0",propertyDescription:"Confirms that the gzipped VCF file passed initial server validation",displayName:"VCF.GZ",serverType:"vcfgz"})),e.getByServerType=t}(t=e.Validation||(e.Validation={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.fileMetadataServiceName="fileMetadata",e.commonModule.service(i.fileMetadataServiceName,["$q",function(e){return new s(e)}]);var s=function(){function e(e){this.$q=e}return e.prototype.getImportType=function(e){for(var i=[t.Import.ImportType.SAMPLE,t.Import.ImportType.ANALYSIS,t.Import.ImportType.MANIFEST],s=0;s<i.length;s++){var a=i[s],r=this.isValidFilename(a,e);if(r.isValid||r.isIntended)return{importType:a,isValid:r.isValid,isIntended:r.isIntended,message:r.message}}return{importType:t.Import.ImportType.UNKNOWN,isValid:!1}},e.prototype.isValidFilename=function(e,i){switch(e){case t.Import.ImportType.ANALYSIS:return this.isImportTypeAnalysis(i);case t.Import.ImportType.MANIFEST:return this.isImportTypeManifest(i);case t.Import.ImportType.SAMPLE:return this.isImportTypeSample(i);default:return{importType:t.Import.ImportType.UNKNOWN,isValid:!1,isIntended:!1}}},e.prototype.isImportTypeManifest=function(e){var t=/\.txt$/i;return t.exec(e)?{isIntended:!0,isValid:!0}:{isIntended:!1,isValid:!1}},e.prototype.isImportTypeAnalysis=function(e){var t=/(\.vcf|\.vcf.gz)$/i;return t.exec(e)?{isIntended:!0,isValid:!0}:{isIntended:!1,isValid:!1}},e.prototype.isImportTypeSample=function(e){var t=/(\.fastq|\.fq)$/i,s=/(\.fastq.gz|\.fq.gz)$/i;return t.exec(e)?{isIntended:!0,isValid:!1,message:"FASTQ files must be gzipped."}:i.FastqChecker.parseIlmnFastQFileName(e)?{isIntended:!0,isValid:!0}:s.exec(e)?{isIntended:!0,isValid:!1,message:"FASTQ files must follow Illumina naming conventions."}:{isIntended:!1,isValid:!1}},e}();i.FileMetadataService=s}(i=t.Validation||(t.Validation={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.utcDateServiceName="bsUTCDate",e.commonModule.service(t.utcDateServiceName,function(){return new i});var i=function(){function e(){}return e.prototype.toUTCDate=function(e){var t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return t},e.prototype.millisToUTCDate=function(e){return this.toUTCDate(new Date(e))},e.prototype.getTime=function(){var e=new Date;return this.millisToUTCDate(e.getTime()).getTime()},e}();t.UTCDate=i}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.dropDownActionServiceName="bsDropDownActionService",e.commonModule.service(t.dropDownActionServiceName,[function(){return new i}]);var i=function(){function e(){this.dropDowns=[]}return e.prototype.registerDropDown=function(e){this.dropDowns.push(e)},e.prototype.unregisterDropDown=function(e){var t=this.dropDowns.indexOf(e);this.dropDowns.splice(t,1)},e.prototype.hideAllDropDowns=function(e){this.dropDowns.forEach(function(t,i,s){e!==t&&(t.isVisible=!1)})},e}();t.DropDownActionService=i}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i=function(){function e(){}return e.ASCII_RANGE_LOWER=63,e.ASCII_RANGE_UPPER=79,e}();t.FastqQScore=i;var s=function(){function e(e,t){if(void 0===t&&(t=!1),this.rawString=e,this.readName=this.rawString.split(" ")[0].replace(/@/,""),t){if("@"!=this.rawString.substring(0,1))throw new r({errorCode:c.InvalidFastqRecord,message:"Invalid header line",lines:null});var i=this.rawString.split(":");if(10!=i.length)throw new r({errorCode:c.InvalidFastqRecord,message:"Invalid header line",lines:null});if(this.instrumentName=i[0],this.runId=i[1],this.flowCellId=i[2],this.lane=i[3],this.title=i[4],this.x=i[5],this.y=i[6].split(" ")[0],this.readNum=parseInt(i[6].split(" ")[1]),this.isFiltered="Y"===i[7],this.sampleNum=i[8],this.indexSequence=i[9],this.isFiltered)throw new r({errorCode:c.ClusterDidNotPassFilter,message:"This file contains reads that did not pass filter, according to the first cluster header: "+this.rawString,lines:null});var s=[this.instrumentName,this.runId,this.flowCellId,this.lane].join(":")+":";this.referenceCheckLeading={str:s,start:0,end:s.length};var a=[this.readNum,i[7]].join(":")+":",o=this.rawString.indexOf(" ")+1;this.referenceCheckTrailing={str:a,start:o,end:o+a.length}}}return e}();t.FastqClusterHeader=s;var a=function(){function e(e,t,i){void 0===i&&(i=!1),this.clusterNumber=t,this.setLines(e,i)}return e.prototype.validateAgainstReference=function(e){if(!e)throw new r({errorCode:c.BadReferenceCluster,message:"Could not determine validity of the cluster, because the reference cluster was not provided. Cluster: "+this.clusterNumber,lines:this.lines});var t="This file contains inconsistent header information. We expected all cluster headers to match '"+e.header.rawString+"' but we encountered the header '"+this.header.rawString+"' at cluster "+this.clusterNumber+".",i=this.header.rawString.substring(e.header.referenceCheckLeading.start,e.header.referenceCheckLeading.end);if(e.header.referenceCheckLeading.str!=i)throw new r({errorCode:c.InconsistentClusterHeaders,message:t,lines:this.lines});var s=this.header.rawString.lastIndexOf(" ")+1;if(i=this.header.rawString.substring(s,s+e.header.referenceCheckTrailing.str.length),e.header.referenceCheckTrailing.str!=i)throw new r({errorCode:c.InconsistentClusterHeaders,message:t,lines:this.lines})},e.prototype.validateQScoreOffset=function(){for(var e=!1,t=0;t<this.lines.baseQualities.length;t++){var s=this.lines.baseQualities.charCodeAt(t);if(s>=i.ASCII_RANGE_UPPER)throw new r({errorCode:c.QScoreOutOfBounds,message:"On the quality score line, we encountered the character '"+this.lines.baseQualities[t]+"' which does not conform to the Illumina standard ASCII 33 offset. Please ensure that your FASTQ files use the ASCII 33 offset. Cluster: "+this.clusterNumber,lines:this.lines});s<=i.ASCII_RANGE_LOWER&&(e=!0)}return e},e.prototype.setLines=function(e,t){if(void 0===t&&(t=!1),this.lines=e,!this.lines.header)throw new r({errorCode:c.InvalidFastqRecord,message:"Header line must not be empty. Cluster: "+this.clusterNumber,lines:e});if(this.header=new s(this.lines.header,t),!this.lines.baseCalls)throw new r({errorCode:c.InvalidFastqRecord,message:"Base call line must not be empty. Cluster: "+this.clusterNumber,lines:e});if(!this.lines.separator)throw new r({errorCode:c.InvalidFastqRecord,message:"Separator line must not be empty. Cluster: "+this.clusterNumber,lines:e});if("+"!=this.lines.separator.substring(0,1))throw new r({errorCode:c.InvalidFastqRecord,message:"Separator must begin with the '+' sign.  Cluster: "+this.clusterNumber,lines:e});if(!this.lines.baseQualities)throw new r({errorCode:c.InvalidFastqRecord,message:"Quality line must not be empty.  Cluster: "+this.clusterNumber,lines:e});if(this.lines.baseCalls.length!=this.lines.baseQualities.length)throw new r({errorCode:c.ReadLengthDidNotMatchQualityLength,message:"Base calls and qualities must be the same length.  Cluster: "+this.clusterNumber,lines:this.lines})},e}();t.FastqCluster=a;var r=function(){function e(e){this.errorCode=e.errorCode,this.message=e.message,this.lines=e.lines}return e}();t.FastqClusterException=r;var o=function(){function e(){this.validationStartTime=new Date}return e.prototype.endValidation=function(){this.validationEndTime=new Date,this.validationRunDuration=this.validationEndTime-this.validationStartTime},e}();t.FastqMetadata=o;var n=function(){function e(){}return e}();t.FastqValidationInfo=n;var l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(n);t.FastqValidationProgressInfo=l;var c=function(){function e(){}return e.InvalidFileName="InvalidFileName",e.EmptyFile="EmptyFile",e.InsufficientMetaData="InsufficientMetaData",e.DecompressionFailed="DecompressionFailed",e.InvalidFastqFormat="InvalidFastqFormat",e.InvalidFastqRecord="InvalidFastqRecord",e.ClusterDidNotPassFilter="ClusterDidNotPassFilter",e.ReadLengthDidNotMatchQualityLength="ReadLengthDidNotMatchQualityLength",e.BadReferenceCluster="BadReferenceCluster",e.ReadNameMismatch="ReadNameMismatch",e.InconsistentClusterHeaders="InconsistentClusterHeaders",e.QScoreOutOfBounds="QScoreOutOfBounds",e.MaxFileNameLengthExceded="MaxFileNameLengthExceded",e}();t.FastqValidationErrorCode=c;var u=function(){function e(){}return e}();t.FastqValidationError=u;var d=function(){function e(){}return e}();t.FastqValidationWorkerMessage=d;var p=function(){function e(){}return e}();t.FastqValidationWorkerMessageEvent=p;var m=function(){function e(){}return e}();t.FastqValidationWorkerResponse=m;var h=function(){function e(){}return e}();t.FastqValidationWorkerResponseEvent=h;var f=function(){function e(){}return e.DONE="done",e.FAIL="fail",e.PROGRESS="progress",e.FINALLY="finally",e}();t.FastqValidationWorkerMessageType=f;var v=function(){function e(){this.MAX_FILENAME_LENGTH=200}return e.extractMetadata=function(t){var i=new o,s=this.parseIlmnFastQFileName(t);return s?(i.sampleName=s[0].substring(0,Math.min(e.MAX_SAMPLE_NAME_LENGTH,s[0].length)),i.sampleNumber=s[1],i.lane=s[2],i.read=s[3],i.index=s[4],i):null},e.parseIlmnFastQFileName=function(e){if(!e)return null;var t=e.split(".");if(t.length>0&&"fastq"==t[1]&&"gz"==t[2]){var i=t[0].split("_");if(5==i.length&&/^((?:[^_]+)+)/i.test(i[0])&&/^(S\d+)/i.test(i[1])&&/^(L[0-9]{3})/i.test(i[2])&&/^(R[12]){1}/i.test(i[3])&&/^([0-9]{3})/i.test(i[4]))return i}return null},e.prototype.validate=function(t,i){var s=Q.defer();if(i=t.name?t.name:i,i.length>this.MAX_FILENAME_LENGTH)return s.reject({message:"fastq file "+i+" is too long.  It cannot be longer than "+this.MAX_FILENAME_LENGTH+" characters.",errorCode:c.MaxFileNameLengthExceded}),s.promise;var a=e.extractMetadata(i);if(null==a)return s.reject({message:"fastq file "+i+" has an invalid name.",errorCode:c.InvalidFileName}),s.promise;var r=new g(t,a,s);return r.start()},e.MAX_SAMPLE_NAME_LENGTH=60,e.FASTQ_NAME_REGEX=/^((?:[^_]+)+)_(S\d+)_(L[0-9]{3})_(R[12]){1}_([0-9]{3})\.fastq\.gz$/i,e}();t.FastqChecker=v;var g=function(){function t(t,i,s){var a=this;this.def=s,this.promise=this.def.promise,this.file=t,this.hillClimber=new e.Common.Utils.Optimization.HillClimber([2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576],4),this.sliceLength=this.hillClimber.getCandidate(),this.currentSlice=null;try{this.reader=new FileReader,this.isFileReaderAsync=!0}catch(r){this.reader=new FileReaderSync,this.isFileReaderAsync=!1}this.reader.onload=function(e){a._onLoadSlice(e)},this._initInflator(),this.metadata=i,this.isAsciiKnownCorrect=!1}return t.prototype.start=function(){return this.currentStartPos=0,this.currentEndPos=Math.min(this.sliceLength,this.file.size),this._readSlice(this.file.slice(this.currentStartPos,this.currentEndPos)),this.promise},t.prototype._initInflator=function(){var e=this;this.inflator=new pako.Inflate({to:"string"}),this.inflator.onEnd=function(t){e._onGunzipEnd(t)}},t.prototype._onGunzipEnd=function(e){e<pako.Z_OK&&this._rejectDecompressionError()},t.prototype._rejectDecompressionError=function(){this.def.reject({message:"failed decompression",errorCode:c.DecompressionFailed})},t.prototype._readSlice=function(e){var t=this;null==this.currentSlice?this.currentSlice=0:this.currentSlice++,this.isFileReaderAsync?this.reader.readAsArrayBuffer(e):Q.fcall(function(){var i=t.reader.readAsArrayBuffer(e);i&&t._onLoadSlice({currentTarget:{result:i}})})},t.prototype._onLoadSlice=function(e){var t=new Date;this.def.notify({file:this.file,metadata:this.metadata,percentComplete:this.currentEndPos/this.file.size*100,validatedSlice:this.currentSlice,sliceSize:this.currentEndPos-this.currentStartPos});var i=new Uint8Array(e.currentTarget.result),s=this.currentEndPos==this.file.size;if(this.inflator.push(i,s)){var a,r=this.inflator.ended&&(!this.inflator.strm.next_in||this.inflator.strm.next_in===this.file.size),o="";if(this.inflator.chunks&&this.inflator.chunks.length>0){for(;void 0!==(a=this.inflator.chunks.shift());)o+=a;this.validateChunkText(o,s,r)}if(this.inflator.ended&&this.inflator.strm.next_in>=1&&this.inflator.strm.next_in<this.file.size){if(!(this.file.size>this.currentStartPos))return void this._onFileEnd();this.currentStartPos+=this.inflator.strm.next_in,this._initInflator()}else this.currentStartPos=this.currentEndPos;var n=new Date,l=o.length/(n-t);l===1/0&&(l=0),this.hillClimber.recordCandidatePerformance(this.sliceLength,l),this.sliceLength=this.hillClimber.getCandidate(),this.currentEndPos=Math.min(this.file.size,this.currentStartPos+this.sliceLength),this.currentStartPos!=this.currentEndPos?this._readSlice(this.file.slice(this.currentStartPos,this.currentEndPos)):this._onFileEnd()}else this._rejectDecompressionError()},t.prototype.validateChunkText=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=!1),this.remainderText&&(e=this.remainderText+e,this.remainderText="");var s=e.split("\n");s[0].trim()||s.shift(),t&&!s[s.length-1]&&s.pop();var r=s.length%4;if(r>0&&t&&i)return void this.def.reject({message:"Unrecognized text encountered at the end of the file.",errorCode:c.InvalidFastqFormat,lines:s});for(var o,n=[],l=(s.length-r)/4,u=0;l>u;u++){var d=4*u,p=u+1;try{var m=!this.referenceCluster;o=new a({header:s[d].trim(),baseCalls:s[d+1].trim(),separator:s[d+2].trim(),baseQualities:s[d+3].trim()},p,m),this.isAsciiKnownCorrect||(this.isAsciiKnownCorrect=o.validateQScoreOffset()),this.referenceCluster?o.validateAgainstReference(this.referenceCluster):this.referenceCluster=o}catch(h){if("errorCode"in h){if(h=h,t&&i)return void this.def.reject({message:h.message,errorCode:h.errorCode,currentFastqRecord:p,cluster:o});if(h.errorCode===c.ReadLengthDidNotMatchQualityLength||h.errorCode===c.InvalidFastqRecord){var f=p==l;if(f&&0==r){n=s.slice(d,d+4);break}return void this.def.reject({message:h.message,errorCode:h.errorCode,currentFastqRecord:p})}return void this.def.reject({message:h.message,errorCode:h.errorCode,currentFastqRecord:p})}return void this.def.reject({message:"Unable to parse FASTQ record.",errorCode:c.InvalidFastqRecord,currentFastqRecord:p})}if(void 0===this.metadata.clusterCount)this.metadata.clusterCount=1,this.metadata.firstReadName=o.header.readName,this.metadata.clusterCountPF=o.header.isFiltered?0:1,this.metadata.readLength=o.lines.baseCalls.length;else{if(this.metadata.clusterCount+=1,o.header.isFiltered)return void this.def.reject({message:"This read did not pass filter at cluster: "+this.metadata.clusterCount,errorCode:c.ClusterDidNotPassFilter,currentFastqRecord:o});this.metadata.clusterCountPF+=1,this.metadata.readLength=Math.max(this.metadata.readLength,o.lines.baseCalls.length)}this.metadata.currentBase=o.lines.baseCalls,this.metadata.clusterPercentPF=this.metadata.clusterCountPF/this.metadata.clusterCount,delete s[d],delete s[d+1],delete s[d+2],delete s[d+3]}if(o=null,r)for(u=s.length-r;u<s.length;u++)n.push(s[u]);s.length=0,n.length>0&&(this.remainderText=n.join("\n"))},t.prototype._rejectJunkEntry=function(e){return this.def.reject({message:"Invalid text encountered in FASTQ file.",errorCode:c.InvalidFastqRecord,currentFastqRecord:e}),null},t.prototype._rejectInvalidHeader=function(e,t){return this.def.reject({message:e,errorCode:c.InvalidFastqRecord,currentFastqRecord:t}),null},t.prototype._onFileEnd=function(){this.metadata.endValidation(),this.metadata.readLength&&this.metadata.clusterCount?this.def.resolve({file:this.file,metadata:this.metadata,percentComplete:100}):this.def.reject({message:"Metadata not extracted.",errorCode:c.InsufficientMetaData,currentFastqRecord:""})},t}();t.FastqCheckerJob=g}(i=t.Validation||(t.Validation={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.fastqCheckerService="fastqChecker",i.fastqCheckerWorkerUrl="fastqCheckerWorkerUrl",i.defaultFastqCheckerWorkerUrl="/public/cdn/basespace/apps/FastqCheckerWorker.js?q="+(new Date).toISOString(),e.commonModule.constant(i.fastqCheckerWorkerUrl,i.defaultFastqCheckerWorkerUrl),function(e){e[e.NameMismatch=0]="NameMismatch",e[e.NumberMismatch=1]="NumberMismatch",e[e.UnableToExtractMetadata=2]="UnableToExtractMetadata",e[e.ReadOneMissing=3]="ReadOneMissing",e[e.ReadTwoMissing=4]="ReadTwoMissing"}(i.FastqConflictType||(i.FastqConflictType={}));var s=i.FastqConflictType,a=function(){function e(e,t,i){this.$log=e,this.serverConfig=t,this.workerUrl=i}return e.prototype.validate=function(e,t,s){var a=this,r=new Worker(this.workerUrl),o=Q.defer();r.addEventListener("message",function(e){var t=e.data,s=e.data.messageType;switch(s){case i.FastqValidationWorkerMessageType.PROGRESS:"string"==typeof t.info?a.$log.log(t.info):o.notify(t.info);break;case i.FastqValidationWorkerMessageType.DONE:o.resolve(t.info);break;case i.FastqValidationWorkerMessageType.FAIL:o.reject(t.info)}}),r.addEventListener("error",function(e){o.reject(e)}),r.postMessage({file:e,fileName:t,imports:s});var n=o.promise;return n.cancel=function(){o.reject({message:"Cancelled promise"})},n},e.prototype.doPairClusterCountsMatch=function(e,t){return e.clusterCount==t.clusterCount},e.prototype.doPairHeadersMatch=function(e,t){return e.firstReadName==t.firstReadName},e.prototype.getFastqMetadataValidationProperty=function(e){for(var i=0;i<e.Properties.Items.length;i++){var s=e.Properties.Items[i];if(s.Name==t.Import.Sample.ImportTask.IMPORT_VALIDATION_FASTQ_PROPERTY_NAME){var a=null;try{a=JSON.parse(s.Content).metadata}catch(r){}return a}}return null},e.prototype.getExpectedPairFileName=function(e){var t=i.FastqChecker.extractMetadata(e);return t?"R1"==t.read?e.replace("_R1_","_R2_"):"R2"==t.read?e.replace("_R2_","_R1_"):void 0:null},e.prototype.filterConflictingFiles=function(e,t){var s=[],a=[],r=i.FastqChecker.extractMetadata(t.name);if(0==e.length)return s=this._getMetadataErrors(t,r),s.length<1&&a.push(t),{errors:s,validFiles:a};if(null==r)throw"Error: unable to extract metadata from reference file.";for(var o=0;o<e.length;o++){var n=e[o],l=i.FastqChecker.extractMetadata(n.name);s=this._getMetadataErrors(n,l,t,r),s.length<1&&a.push(n)}return{errors:s,validFiles:a,referenceMetadata:r}},e.prototype.anyFilesMissing=function(e,t){void 0===t&&(t=!1);for(var i=[],a={},r=[],o=[],n=0;n<e.length;n++){var l=e[n];a[l]=null,this._isReadNumber(2,l)?r.push(l):t&&this._isReadNumber(1,l)&&o.push(l)}for(n=0;n<r.length;n++){var c=r[n],u=c.replace("_R2_","_R1_").replace("_r2_","_R1_"),d=c.replace("_R2_","_r1_").replace("_r2_","_r1_");u in a||d in a||i.push({conflictType:s.ReadOneMissing,metadata:null,referenceMetadata:null,fileName:c})}if(t)for(n=0;n<o.length;n++){var p=o[n],m=p.replace("_R1_","_R2_").replace("_r1_","_R2_"),h=p.replace("_R1_","_r2_").replace("_r1_","_r2_");m in a||h in a||i.push({conflictType:s.ReadTwoMissing,metadata:null,referenceMetadata:null,fileName:p})}return i},e.prototype._getMetadataErrors=function(e,t,i,a){var r=[];if(null==t){var o={conflictType:s.UnableToExtractMetadata,metadata:t,fileName:e.name};r.push(o)}else null!=i&&null!=a&&(t.sampleName!=a.sampleName&&r.push({conflictType:s.NameMismatch,metadata:t,referenceMetadata:a,fileName:e.name}),t.sampleNumber!=a.sampleNumber&&r.push({conflictType:s.NumberMismatch,metadata:t,referenceMetadata:a,fileName:e.name}));return r},e.prototype._isReadNumber=function(e,t){var s=!1,a=i.FastqChecker.parseIlmnFastQFileName(t);return a&&(s=a[3].toUpperCase()==="R"+e),s},e}();i.FastqCheckerService=a,e.commonModule.service(i.fastqCheckerService,["$log",t.ServerConfig.serverConfigServiceName,i.fastqCheckerWorkerUrl,a])}(i=t.Validation||(t.Validation={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.analysisValidationServiceName="analysisButtonsValidation";var s=function(){function e(){}return e.prototype.canStop=function(e){if(e.length&&1===e.length){var i=(e[0].Status||e[0].ExecutionStatus).toLowerCase(),s=e[0].Application.Category.toLowerCase();return!(i!==t.Interfaces.AppSessionStatus.RUNNING.toLowerCase()&&i!==t.Interfaces.AppSessionStatus.PENDING.toLowerCase()&&i!==t.Interfaces.AppSessionStatus.PENDING_EXECUTION.toLowerCase()||s!==t.Interfaces.ApplicationCategory.NATIVE.toLowerCase()&&s!==t.Interfaces.ApplicationCategory.WORKFLOW.toLowerCase()&&s!==t.Interfaces.ApplicationCategory.INSTANCE.toLowerCase())}return!1},e.prototype.canDelete=function(e){return e.length>0},e.prototype.canDownload=function(e){return e.length>0},e}();i.AnalysisValidationService=s,e.Common.commonModule.service(i.analysisValidationServiceName,s)}(s=i.Validation||(i.Validation={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){
var t;!function(t){var i=function(){function e(e){for(var t in e)this[t]=e[t]}return e.SAMPLE="sample",e.ANALYSIS="analysis",e.MANIFEST="manifest",e.UNKNOWN="unknown",e}();t.ImportType=i,function(e){e[e.VALIDATE_FIRST=0]="VALIDATE_FIRST",e[e.UPLOAD_FIRST=1]="UPLOAD_FIRST",e[e.PARALLEL=2]="PARALLEL"}(t.TaskOrder||(t.TaskOrder={}));var s=t.TaskOrder;!function(e){e[e.HTTP_STREAM=0]="HTTP_STREAM",e[e.FILE_SUMMARY=1]="FILE_SUMMARY",e[e.WORKER=2]="WORKER"}(t.ValidationMethod||(t.ValidationMethod={}));var a=t.ValidationMethod;t.sample=new i({name:i.SAMPLE,validFileTypes:["fastq.gz"],validationTypes:[],validationMethod:a.WORKER,fileIconClass:".icon-fastq",taskOrder:s.PARALLEL,maxFileCount:16,maxFileSize:26843545600,maxRetries:5}),t.vcf=new i({name:i.ANALYSIS,validFileTypes:["vcf","vcf.gz"],validationTypes:[e.Validation.vcf,e.Validation.vcfgz],validationMethod:a.HTTP_STREAM,fileIconClass:".icon-vcf",taskOrder:s.VALIDATE_FIRST,maxFileCount:16,maxFileSize:26843545600,maxRetries:5}),t.manifest=new i({name:i.MANIFEST,validFileTypes:["txt"],validationTypes:[e.Validation.amplicon,e.Validation.trex,e.Validation.nextera],validationMethod:a.FILE_SUMMARY,fileIconClass:".icon-vcf",taskOrder:s.UPLOAD_FIRST,maxFileCount:16,maxFileSize:26843545600,maxRetries:5})}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.fileUploaderFactoryName="fileUploaderFactory",e.commonModule.factory(i.fileUploaderFactoryName,["$http","$q",t.Api.apiServiceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function e(e,t,i){this.$http=e,this.$q=t,this.api=i}return e.prototype.getSampleFileUploader=function(e,t){return new r(this.$http,this.$q,this.api,e,t)},e.prototype.getAppResultFileUploader=function(e,t){return new o(this.$http,this.$q,this.api,e,t)},e}();i.UploaderFactory=s,i.MAX_CONCURRENT_CHUNKS=5,i.MAX_RETRIES=5,i.MAX_DELETE_RETRIES=5,i.TIME_BETWEEN_RETRIES=500,i.BIG_FILE_THRESHOLD=104857600,i.SMALL_FILE_CHUNK_SIZE=5242880,i.BIG_FILE_CHUNK_SIZE=26214400;var a=function(){function e(e,t,i,s){this.$http=e,this.$q=t,this.api=i,this.file=s,this.filetype="application/octet-stream",this.configChunking(),this.deferred=t.defer(),this.$promise=this.deferred.promise,this.canceller=t.defer(),this.cancellerPromise=this.canceller.promise,this.isCancelled=!1,this.alreadyRetried=!1,this.percentComplete=0,this._numPartsUploaded=0}return e.prototype.configChunking=function(){this.chunkSize=this.file.size<i.BIG_FILE_THRESHOLD?i.SMALL_FILE_CHUNK_SIZE:i.BIG_FILE_CHUNK_SIZE,this.isMultipart=this.chunkSize<=this.file.size},e.prototype.start=function(){return this.isMultipart?this._startMultipart():this._startSinglepart(),this.$promise},e.prototype.cancel=function(){var e=this;return 0==this.isCancelled&&(this.isCancelled=!0,this.fileId?this._deleteFile():this.fileCreationPromise?this.fileCreationPromise.then(function(){return e._deleteFile()}):this.deferred.reject({file:this.file,message:i.FILE_UPLOAD_CANCELLED,isMultipart:this.isMultipart,percentComplete:this.percentComplete})),this.$promise},e.prototype._deleteFile=function(e){var s=this;void 0===e&&(e=0),this.$http["delete"](this.api.apiBaseUrl+"files/"+this.fileId,this._getHttpConfig()).then(function(e){var t=e.data.Response;s.canceller.reject({isMultipart:s.isMultipart,message:i.FILE_UPLOAD_CANCELLED,percentComplete:s.percentComplete,file:t}),s.deferred.reject({isMultipart:s.isMultipart,message:i.FILE_UPLOAD_CANCELLED,percentComplete:s.percentComplete,file:t})},function(a){a.data.ResponseStatus.ErrorCode==t.Api.ApiErrorCodes.BASESPACE_FILES_NOT_FOUND?(s.canceller.reject({isMultipart:s.isMultipart,message:i.FILE_UPLOAD_CANCELLED,percentComplete:s.percentComplete,file:s.file}),s.deferred.reject({isMultipart:s.isMultipart,message:i.FILE_UPLOAD_CANCELLED,percentComplete:s.percentComplete,file:s.file})):!s.alreadyRetried&&++e<i.MAX_DELETE_RETRIES?setTimeout(function(){s._deleteFile(e)},e*i.TIME_BETWEEN_RETRIES):(s.canceller.reject({isMultipart:s.isMultipart,message:i.UNABLE_TO_DELETE,percentComplete:s.percentComplete,file:s.file}),s.deferred.reject({isMultipart:s.isMultipart,message:i.UNABLE_TO_DELETE,percentComplete:s.percentComplete,file:s.file}))})},e.prototype._getHttpConfig=function(){var e=angular.extend({},this.api.defaultHttpConfig,{headers:{"Content-Type":this.filetype},timeout:this.cancellerPromise});return e},e.prototype._startMultipart=function(){var e=this;this.fileCreationPromise=this.$http.post(this.fileCreationBaseUrl()+"?name="+encodeURI(this.file.name)+"&multipart=true",null,this._getHttpConfig()).then(function(t){e.fileId=t.data.Response.Id,e.fileResponse=t.data.Response,e.deferred.notify({isMultipart:e.isMultipart,message:i.MULTIPART_INIT,percentComplete:e.percentComplete,file:e.fileResponse}),e.isCancelled||(e._sliceFile(),e._startQueuedUpload())},function(){e.deferred.reject({isMultipart:e.isMultipart,message:i.MULTIPART_INIT_FAILED,percentComplete:e.percentComplete})})},e.prototype._startSinglepart=function(){var e=this;this.fileCreationPromise=this.$http.post(this.fileCreationBaseUrl()+"?name="+encodeURI(this.file.name)+"&multipart=false",this.file,this._getHttpConfig()).then(function(t){e.fileId=t.data.Response.Id,e.fileResponse=t.data.Response,e.isCancelled||e._onFileUploadComplete()},function(){e.deferred.reject({isMultipart:e.isMultipart,message:i.FILE_UPLOAD_FAILED,percentComplete:e.percentComplete})})},e.prototype._sliceFile=function(){this.fileParts=[];var e=0,t=this.chunkSize,i=1;do this.fileParts.push({partNumber:i,slice:this.file.slice(e,t,this.filetype)}),e=t,t+=this.chunkSize,i++;while(e<this.file.size)},e.prototype._startQueuedUpload=function(){this.filePartQueue=[];for(var e=0;e<this.fileParts.length;e++){var t=this.fileParts[e];e<i.MAX_CONCURRENT_CHUNKS?this._uploadFilePart(t,e):this.filePartQueue.push(t)}},e.prototype._uploadFilePart=function(e,t,i){void 0===i&&(i=0);var s=this._getSuccessCallback(e,t),a=this._getFailCallback(e,t,i);return this.$http.put(this.api.apiBaseUrl+"files/"+this.fileId+"/parts/"+e.partNumber,e.slice,this._getHttpConfig()).then(s,a)},e.prototype._getSuccessCallback=function(e,t){var i=this;return function(){if(i._numPartsUploaded++,i.percentComplete=i._numPartsUploaded/i.fileParts.length,i.deferred.notify({isMultipart:i.isMultipart,message:"Successfully uploaded file part "+i._numPartsUploaded+" of "+i.fileParts.length+"...",currentSlice:t,totalSlices:i.fileParts.length,percentComplete:i.percentComplete,file:i.fileResponse}),console.dir(i.fileResponse),i.filePartQueue.length>0){var e=i.filePartQueue.shift();i._uploadFilePart(e,t+1)}else i._numPartsUploaded==i.fileParts.length&&(i.isCancelled||i._markMultipartAsComplete())}},e.prototype._markMultipartAsComplete=function(){var e=this;this.$http.post(this.api.apiBaseUrl+"files/"+this.fileId+"?uploadstatus=complete",null,this._getHttpConfig()).then(function(t){e.fileResponse=t.data.Response,e._onFileUploadComplete()},function(){e.deferred.reject({isMultipart:e.isMultipart,message:i.FILE_UPLOAD_FAILED})})},e.prototype._getFailCallback=function(e,t,s){var a=this;return void 0===s&&(s=0),function(){var r=function(){!a.alreadyRetried&&s<i.MAX_RETRIES&&!a.isCancelled?(a.deferred.notify({message:i.SLICE_UPLOAD_RETRY+" ("+t+") -- Attempting "+s+" of "+i.MAX_RETRIES,isMultipart:a.isMultipart,currentSlice:t,totalSlices:a.fileParts.length,percentComplete:a.percentComplete}),console.log("notify",{message:i.SLICE_UPLOAD_RETRY+" ("+t+") -- Attempting "+s+" of "+i.MAX_RETRIES,isMultipart:a.isMultipart,currentSlice:t,totalSlices:a.fileParts.length,percentComplete:a.percentComplete}),setTimeout(function(){a._uploadFilePart(e,t,++s)},i.TIME_BETWEEN_RETRIES)):(a.alreadyRetried=!0,a.deferred.reject({message:i.SLICE_UPLOAD_FAILED,isMultipart:a.isMultipart,currentSlice:t,totalSlices:a.fileParts.length}))};r()}},e.prototype._onFileUploadComplete=function(){this.deferred.resolve({isMultipart:this.isMultipart,message:i.FILE_UPLOAD_SUCCESS,file:this.fileResponse}),console.log("resolve",{isMultipart:this.isMultipart,message:i.FILE_UPLOAD_SUCCESS})},e}();i.BaseMultipartFileUpload=a;var r=function(e){function t(t,i,s,a,r){e.call(this,t,i,s,a),this.fileCreationBaseUrl=function(){return s.apiBaseUrl+"samples/"+r.Id+"/files"}}return __extends(t,e),t}(a);i.SampleFileUpload=r;var o=function(e){function t(t,i,s,a,r){e.call(this,t,i,s,a),this.fileCreationBaseUrl=function(){return s.apiBaseUrl+"appresults/"+r.Id+"/files"}}return __extends(t,e),t}(a);i.AppResultFileUpload=o,i.SLICE_UPLOAD_SUCCESS="Currently uploading ",i.SLICE_UPLOAD_RETRY="Slice upload failed; retrying...",i.SLICE_UPLOAD_FAILED="Slice upload failed.",i.MULTIPART_INIT="Successfully created file; now beginning multi-part upload.",i.MULTIPART_INIT_FAILED="Failed to created file for multipart upload.",i.FILE_UPLOAD_SUCCESS="File upload success.",i.FILE_UPLOAD_FAILED="File upload failed.",i.FILE_UPLOAD_CANCELLED="File upload cancelled.",i.UNABLE_TO_DELETE="Unable to delete file."}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(t){for(var i in t)this[i]=t[i];this.deferred=this.$q.defer(),this.promise=this.deferred.promise,this.completion=0,this.subtasks=[],this.subtitle=null,this.state=e.Interfaces.TaskState.Queued}return t.prototype.then=function(e,t,i){return this.promise.then(e,t,i)},t.prototype.alreadyComplete=function(){this.completion=1,this.statusDescription="",this.state=e.Interfaces.TaskState.Complete,this.deferred.resolve()},t.prototype.start=function(){},t}();t.BaseTask=i}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.MAX_FILE_ERROR="You have exceeded the amount of total files you can upload at one time: ";var i=function(i){function s(e){var t=this;i.call(this,e),this._allFileNames=[],this.initMetadata(),this.maxFileCount=16,this.maxFileSize=26843545600,this.timeUntilAutocompleteStart=3e5,this.timeUntilAutocompleteFinish=3e4,this.maxActiveTasks=1,this.maxResultNameLength=70,this.numActiveTasks=0,this._taskQueue=[],this._allFileNames=[],this.isCancellable=!0,this.isCompletable=!1,this.finishAsap=!1,this.useReferenceFile=!1,this.fileDict={},this._sessionInitDeferred=this.$q.defer(),this._autoCompleteTimeout=null,this._sessionInitPromise=this._sessionInitDeferred.promise,this._sessionInitPromise.then(function(){return t._isInitiatingUploadSession=!1},function(){return t._isInitiatingUploadSession=!1})}return __extends(s,i),s.prototype.initMetadata=function(){throw"initMetadata must be implemented by inheriting class"},s.prototype.allowNavigateAway=function(){var t=!0;return this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Complete&&this.getNonFailedFiles().length>0&&(t=!1),t},s.prototype.setImportProperty=function(t){return this.propertyService.setStringProp("appsession",t,e.Directives.ImporterDirective.IMPORT_TYPE_PROPERTY_NAME,this.importType.name,e.Directives.ImporterDirective.IMPORT_TYPE_PROPERTY_DESCRIPTION)},s.prototype.finishImport=function(){throw"finishImport must be implemented by inheriting class"},s.prototype.abortImport=function(){throw"abortImport must be implemented by inheriting class"},s.prototype.onRequestComplete=function(){this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Cancelling&&(this.finishAsap=!0,this.uiConfig.subtaskUIConfig.showCancelOrRemoveButton=!1,this._taskQueue.length<=0&&this.numActiveTasks<=0&&this.hasCompletedSubstasks()&&(this.isCancellable=!1,this.state=e.Interfaces.TaskState.Completing,this.finishImport()))},s.prototype.onRequestCancel=function(){this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Cancelling&&(this.isCancellable=!1,this.state=e.Interfaces.TaskState.Cancelling,this.abortImport())},s.prototype.getNonFailedSubtasks=function(){for(var t=[],i=0;i<this.subtasks.length;i++){var s=this.subtasks[i];s.state!=e.Interfaces.TaskState.Cancelled&&s.state!=e.Interfaces.TaskState.Cancelling&&s.state!=e.Interfaces.TaskState.Failed&&t.push(s)}return t},s.prototype.getSubtasksBasedOnStatus=function(e){for(var t=[],i=0;i<this.subtasks.length;i++){var s=this.subtasks[i];s.state==e&&t.push(s)}return t},s.prototype.getFailedSubtasks=function(){return this.getSubtasksBasedOnStatus(e.Interfaces.TaskState.Failed)},s.prototype.getSuccessfullyCompletedSubtasks=function(){return this.getSubtasksBasedOnStatus(e.Interfaces.TaskState.Complete)},s.prototype.hasCompletedSubstasks=function(){return this.getSuccessfullyCompletedSubtasks().length>0},s.prototype.hasFailedSubstasks=function(){return this.getFailedSubtasks().length>0},s.prototype.getFormErrors=function(){throw"getFormErrors must be implemented by inheriting class."},s.prototype.updateMetadata=function(e){throw"updateMetadata must be implemented by inheriting class"},s.prototype.getNonFailedFiles=function(){return this.getNonFailedSubtasks().map(function(e){return e.file})},s.prototype.filterConflictingFiles=function(e){},s.prototype.getNewSubtask=function(e){throw"getNewSubtask must be implemented by inheriting class"},s.prototype.startNewSubtask=function(e){throw"startNewSubtask must be implemented by inheriting class"},s.prototype.addFile=function(e){if(e.size>this.maxFileSize)throw"File "+e.name+" size ("+this.filterService("bytes")(e.size,2)+") exceeded maximum file size allowed of "+this.filterService("bytes")(this.maxFileSize,2);var i=this.getNonFailedFiles();if(i.length>=this.maxFileCount)throw t.MAX_FILE_ERROR+this.maxFileCount;for(var s=!1,a=e.size,r=0;r<i.length;r++)if(a+=i[r].size,i[r].name==e.name){s=!0;break}if(s)throw"File '"+e.name+"' has already been added.";if(a>this.maxFileSize)throw"Adding this file will exceed the total size of all files you can upload at one time. Current file "+e.name+" ("+this.filterService("bytes")(e.size,2)+") increases total size to: "+this.filterService("bytes")(a,2)+". Max file size allowed: "+this.filterService("bytes")(this.maxFileSize,2)+".";this.filterConflictingFiles(e);var o=this.getNewSubtask(e);this.subtasks.push(o),this._allFileNames.push(e.name),this.fileDict[e.name]=o,this.useReferenceFile&&!this.referenceFile&&(this.referenceFile=e),this._updateTotalFileSize(),this.startNewSubtask(o),this.isCompletable=!0},s.prototype.addUploadedFile=function(e,t){this.useReferenceFile&&this._allFileNames.length<1&&(this.referenceFile={name:e.Name,size:e.Size}),this._allFileNames.push(e.Name);var i={name:e.Name,lastModifiedDate:e.DateCreated,type:e.ContentType,size:e.Size,msDetachStream:null,slice:null,msClose:null},s=this.getNewSubtask(i);t&&(s.metadata=t),this.subtasks.push(s),this.fileDict[e.Name]=s,s.alreadyComplete(),this.updateMetadata(s),this._updateTotalFileSize(),this._setCompletable(),this._sessionInitDeferred.resolve()},s.prototype.startTask=function(t){var i=this;if(this.numActiveTasks<this.maxActiveTasks){t.start(),this.state=e.Interfaces.TaskState.Active,this.numActiveTasks++;var s=this._taskQueue.indexOf(t);s>-1&&this._taskQueue.splice(s,1),t.promise.then(function(){return i._onTaskComplete(t)},function(){return i.onTaskFail(t)},function(){return i._onTaskProgress(t)})}else{var a=this._taskQueue.indexOf(t);0>a&&this._taskQueue.push(t)}},s.prototype._onTaskComplete=function(e){var t=this;if(this.numActiveTasks--,this.updateMetadata(e),this._taskQueue.length>0){var i=this._taskQueue[0],s=this.saveProgress();null!=s?s.then(function(){return t.startTask(i)}):this.startTask(i)}else this._setCompletable()},s.prototype.saveProgress=function(){return null},s.prototype.onTaskFail=function(t){this.finishAsap=!1,this.uiConfig.subtaskUIConfig.showCancelOrRemoveButton=!0,this.numActiveTasks--,this._updateTotalFileSize(),this.updateMetadata(t);var i=this.useReferenceFile&&t.file==this.referenceFile;if(this._taskQueue.length>0){var s=this._taskQueue[0];i&&(this.referenceFile=s.file),this.startTask(s)}else{var a=!1;this.useReferenceFile&&i&&(this.referenceFile=null);for(var r=0;r<this.subtasks.length;r++){var o=this.subtasks[r];if(o.state==e.Interfaces.TaskState.Complete){a=!0,this.useReferenceFile&&i&&(this.referenceFile=o.file);break}}a?this._setCompletable():(this.isCompletable=!1,this.state=e.Interfaces.TaskState.Failed)}},s.prototype.resume=function(){this._sessionInitDeferred&&(this._sessionInitDeferred.resolve(),this._isInitiatingUploadSession=!1)},s.prototype._setCompletable=function(){var t=this,i=this.getFormErrors();i.length>0?(this.state=e.Interfaces.TaskState.Active,this.reasonsNotCompletable=i,this.finishAsap=!1,this._autoCompleteNotifyPromise&&this.$timeout.cancel(this._autoCompleteNotifyPromise)):(this.state=e.Interfaces.TaskState.Completable,this.isCompletable=!0,this.reasonsNotCompletable=null,this.finishAsap?(this.state=e.Interfaces.TaskState.Completing,this.finishImport()):this._autoCompleteNotifyPromise=this.$timeout(function(){t._isAutoCompletable()&&t.modalDialogService.bootstrapConfirm({headerTemplate:"Uploads complete",bodyTemplate:"All files uploaded successfully. Your upload session will be automatically completed.",autoConfirmAfter:t.timeUntilAutocompleteFinish}).then(function(){t.finishImport()})},this.timeUntilAutocompleteStart))},s.prototype._isAutoCompletable=function(){return angular.isObject(this.modalDialogService.modalScope)&&angular.isObject(this.modalDialogService.modalScope.dialogScope)&&this.modalDialogService.modalScope.dialogScope.isVisible?!1:!0},s.prototype._updateTotalFileSize=function(){var t=0;for(var i in this.fileDict){var s=this.fileDict[i];s.state!=e.Interfaces.TaskState.Cancelled&&s.state!=e.Interfaces.TaskState.Cancelling&&s.state!=e.Interfaces.TaskState.Failed&&(t+=s.file.size)}this.metadata.totalFileSize=t},s.prototype._onTaskProgress=function(e){this.updateMetadata(e)},s}(t.BaseTask);t.BaseTaskManager=i}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(i){function s(e,t){i.call(this,e),this.file=t,this.title="Upload task.",this._needToCancel=!1,this.initUploader()}return __extends(s,i),s.prototype.initUploader=function(){throw"initUploader must be implemented by inherited class."},s.prototype.then=function(e,t,i){return this.promise.then(e,t,i)},s.prototype.start=function(){var i=this;return this.state=e.Interfaces.TaskState.Active,this.uploader.start().then(function(t){i.completion=1,i.statusDescription=t.message,i.state=e.Interfaces.TaskState.Complete,i.deferred.resolve(t)},function(s){i.state=e.Interfaces.TaskState.Failed,i.statusLabel="Upload failed",i.statusDescription=t.FILE_UPLOAD_FAILED,i.deferred.reject(angular.extend({},s,{message:t.FILE_UPLOAD_FAILED}))},function(e){i.completion=e.percentComplete,i.statusLabel="Upload progress",i.statusDescription=e.message,i.deferred.notify(e)}),this.promise},s.prototype.cancel=function(){var t=this;this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Cancelling&&(this.state=e.Interfaces.TaskState.Cancelling,this.uploader.cancel()["finally"](function(){var i="Upload cancelled";t.statusDescription=i,t.statusLabel="Cancelled",t.state=e.Interfaces.TaskState.Cancelled,t.deferred.reject({file:t.uploader.file,currentSlice:null,isMultipart:t.uploader.isMultipart,percentComplete:t.uploader.percentComplete,totalSlices:t.uploader.fileParts.length,message:"Upload cancelled"})}))},s}(t.BaseTask);t.BaseUploadTask=i}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.resourceListIteratorName="resourceListIteratorService",e.commonModule.service(t.resourceListIteratorName,["$q",function(e){return new i(e)}]);var i=function(){function e(e){this.$q=e}return e.prototype.iterate=function(e,t,i,s){var a=this.$q.defer();return i.TotalCount>t.limit?this.iterateUntil(e,t,1,Math.ceil(i.TotalCount/t.limit),a,s):a.resolve(),a.promise},e.prototype.iterateUntil=function(e,t,i,s,a,r){var o=this;e.get({limit:t.limit,sortBy:t.sortBy,sortDir:t.sortDir,offset:t.limit*i},function(n){n=n.Response,o.onIterateSuccess(e,t,i,s,n,a,r)})},e.prototype.onIterateSuccess=function(e,t,i,s,a,r,o){o(a),i++,i==s?r.resolve():this.iterateUntil(e,t,i,s,r,o)},e}();t.ResourceListIteratorService=i}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.start=function(){},t}(e.BaseTask);t.BaseTask=i}(t=e.Sample||(e.Sample={}))}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.READ_1_MIN=1,s.READ_2_MIN=0;var a=function(a){function r(e){a.call(this,e),this.useReferenceFile=!0,this._isInitiatingUploadSession=!1,this.maxFileCount=i.sample.maxFileCount,this.maxFileSize=i.sample.maxFileSize,this.importType=i.sample}return __extends(r,a),r.prototype.initMetadata=function(){this.title="FastQ Upload - Main Task",this.state=e.Interfaces.TaskState.Active,this.metadata={sample:{Name:"",Read1:0,Read2:0,NumReadsPF:0,NumReadsRaw:0},appSession:null,genome:null,currentBase:"",totalFileSize:0}},r.prototype.finishImport=function(){var i=this,s=this.metadata.genome?this.metadata.genome.Id:null,a=null;s&&(a="/v1pre3/genomes/"+s);var r=this.metadata.sample.SampleId?this.metadata.sample.SampleId:this.metadata.sample.Name,o=r?r:this.metadata.appSession.Name;this.api.Sample.save({Id:this.metadata.sample.Id,Status:t.Api.ApiResourceStatus.COMPLETE,Name:o,SampleId:o,HrefGenome:a,NumReadsPF:this.metadata.sample.TotalClustersPF,NumReadsRaw:this.metadata.sample.TotalClustersRaw,TotalClustersRaw:this.metadata.sample.TotalClustersRaw,TotalClustersPF:this.metadata.sample.TotalClustersPF,TotalReadsRaw:this.metadata.sample.TotalReadsRaw,TotalReadsPF:this.metadata.sample.TotalReadsPF,Read1:this.metadata.sample.Read1,Read2:this.metadata.sample.Read2,IsPairedEnd:this.metadata.sample.IsPairedEnd},function(s){var a=s.Response;i.metadata.sample=a,i.metadata.appSession=a.AppSession,i.api.AppSession.save({Id:i.metadata.appSession.Id,Status:t.Api.ApiResourceStatus.COMPLETE,Name:i.metadata.sample.Name},function(t){var s=t.Response;i.metadata.appSession=s,i.state=e.Interfaces.TaskState.Complete,i.api.AppSession.reserveSpace({Id:i.metadata.appSession.Id,SpaceRequiredInBytes:0})},function(){i.state=e.Interfaces.TaskState.Failed,i.isCancellable=!0})},function(){i.state=e.Interfaces.TaskState.Failed,i.isCancellable=!0})},r.prototype.abortImport=function(){var i=this;if(!this.metadata.appSession)return void(this.state=e.Interfaces.TaskState.Cancelled);for(var s=[],a=0;a<this.subtasks.length;a++){var r=this.subtasks[a];r.state!=e.Interfaces.TaskState.Failed&&r.state!=e.Interfaces.TaskState.Cancelled&&(r.cancel(),s.push(r.promise))}this.$q.all(s)["finally"](function(){i.api.AppSession.reserveSpace({Id:i.metadata.appSession.Id,SpaceRequiredInBytes:0}),i.api.AppSession.save({Id:i.metadata.appSession.Id,Status:t.Api.ApiResourceStatus.ABORTED,Name:"(Cancelled)"},function(){console.log("app session aborted..."),i.api.AppSession["delete"]({Id:i.metadata.appSession.Id,ByPassTrash:!0},function(){console.log("app session deleted..."),i.state=e.Interfaces.TaskState.Cancelled},function(e){console.log("Error Deleting App Session!"),console.dir(e),setTimeout(function(){i.abortImport()},1e3)})},function(e){console.log("Error aborting app session..."),console.dir(e),setTimeout(function(){i.abortImport()},1e3)})})},r.prototype.filterConflictingFiles=function(e){var i;if(i=this.referenceFile?this.fastqCheckerService.filterConflictingFiles([e],this.referenceFile):this.fastqCheckerService.filterConflictingFiles([],e),i.errors&&i.errors.length>0){var s="";throw i.errors.forEach(function(i){switch(i.conflictType){case t.Validation.FastqConflictType.NameMismatch:s=s+"\n File '"+e.name+"' has a different sample name than file(s) already associated with this sample.";break;case t.Validation.FastqConflictType.NumberMismatch:s=s+"\n File '"+e.name+"' has a different sample number than file(s) already associated with this sample.";break;case t.Validation.FastqConflictType.UnableToExtractMetadata:s=s+"\n File '"+e.name+"' does not conform to Illumina FASTQ naming conventions."}}),s}},r.prototype.getNewSubtask=function(e){return new s.ImportTask({$q:this.$q,$timeout:this.$timeout,fastqCheckerService:this.fastqCheckerService,serverConfig:this.serverConfig,api:this.api,projectId:this.projectId,uploaderFactory:this.uploaderFactory,propertyService:this.propertyService,uiConfig:this.uiConfig.subtaskUIConfig,filterService:this.filterService},e,this.metadata.sample)},r.prototype.startNewSubtask=function(e){var i=this;if(this._isInitiatingUploadSession||this.metadata.sample.Id)this._sessionInitPromise?this._sessionInitPromise.then(function(){return i.startTask(e)}):this.startTask(e);else{if(!this.metadata.sample.SampleId){var s=t.Validation.FastqChecker.extractMetadata(e.file.name);if(s){var a=s.sampleName;a=a.substring(0,Math.min(this.maxResultNameLength,a.length)),this.metadata.sample.SampleId=this.metadata.sample.Name=a}}this._isInitiatingUploadSession=!0,this.api.Sample.create(angular.extend(this.metadata.sample,{Read1:1,projectId:this.projectId}),function(t){var s=t.Response;i.metadata.sample.Id=s.Id,console.log("Saved sample!  "+i.metadata.sample.Id),i.metadata.appSession=s.AppSession,i.api.AppSession.reserveSpace({Id:i.metadata.appSession.Id,SpaceRequiredInBytes:i.maxFileSize},function(t){i.api.AppSession.save({Id:i.metadata.appSession.Id,Name:i.metadata.sample.Name+" (Upload Pending)"},function(t){i._isInitiatingUploadSession=!1,i.setImportProperty(i.metadata.appSession.Id).then(function(){i.startTask(e),i._sessionInitDeferred.resolve()},function(){i.onTaskFail(e),i._sessionInitDeferred.reject()})})},function(t){i._sessionInitDeferred.reject(),e.fail("Upload can not be started."),404==t.status?i.modalDialogService.bootstrapAlert({headerTemplate:"Error - Resource Not Found",bodyTemplate:t.data.ResponseStatus.Message}):409==t.status&&i.modalDialogService.bootstrapAlert({headerTemplate:"Error - Not Enough Free Space",bodyTemplate:t.data.ResponseStatus.Message})})},function(){console.log("Error!"),i._sessionInitDeferred.reject(),i.onTaskFail(e)})}},r.prototype.saveProgress=function(){return this.api.AppSession.save({Id:this.metadata.appSession.Id,Name:this.metadata.sample.Name+" (Upload Pending)"}).$promise},r.prototype._getPairedTask=function(t){var i=t.file.name,s=this.fastqCheckerService.getExpectedPairFileName(i);if(s in this.fileDict){var a=this.fileDict[s];if(a.state!=e.Interfaces.TaskState.Cancelled&&a.state!=e.Interfaces.TaskState.Cancelling&&a.state!=e.Interfaces.TaskState.Failed)return a}return null},r.prototype.getFormErrors=function(){var e=$.map(this.getNonFailedFiles(),function(e){return e.name}),t=this.fastqCheckerService.anyFilesMissing(e,this.metadata.sample.IsPairedEnd);return t},r.prototype.updateMetadata=function(t){if(this._updateSampleStats(t.metadata),this.metadata.sample.IsPairedEnd){var i,s=this._getPairedTask(t);s&&(s.state!=e.Interfaces.TaskState.Queued&&s.state!=e.Interfaces.TaskState.Failed&&t.isPendingHeaderMatchValidation&&t.metadata&&null!=t.metadata.firstReadName&&void 0!=t.metadata.firstReadName&&(i=this.fastqCheckerService.doPairHeadersMatch(s.metadata,t.metadata),i||t.fail("The headers in file '"+t.file.name+"' do not match the headers in its paired file, '"+s.file.name+"'."),t.isPendingHeaderMatchValidation=!1,s.isPendingHeaderMatchValidation=!1),t.isPendingClusterCountValidation&&t.checkerTask.state==e.Interfaces.TaskState.Complete&&s.state==e.Interfaces.TaskState.Complete&&(i=this.fastqCheckerService.doPairClusterCountsMatch(s.metadata,t.metadata),i||t.fail("The cluster count in file '"+t.file.name+"' ("+this.filterService("number")(t.metadata.clusterCount)+") does not match the cluster count in its paired file, '"+s.file.name+"' ("+this.filterService("number")(s.metadata.clusterCount)+")."),t.isPendingClusterCountValidation=!1,s.isPendingClusterCountValidation=!1))}},r.prototype.setSampleClustersAndReadsRaw=function(e,t){e.TotalReadsRaw=t,e.TotalClustersRaw=Math.ceil(t/(e.IsPairedEnd?2:1))},r.prototype.setSampleClustersAndReadsPF=function(e,t){e.TotalReadsPF=t,e.TotalClustersPF=Math.ceil(t/(e.IsPairedEnd?2:1))},r.prototype._updateSampleStats=function(e){for(var t=0,i=0,a=s.READ_1_MIN,r=s.READ_2_MIN,o=!1,n=this.getNonFailedSubtasks(),l=0;l<n.length;l++){var c=n[l];c.metadata&&("R1"==c.metadata.read?a=Math.max(isNaN(this.metadata.sample.Read1)?s.READ_1_MIN:this.metadata.sample.Read1,isNaN(c.metadata.readLength)?s.READ_1_MIN:c.metadata.readLength):"R2"==c.metadata.read&&(o=!0,r=Math.max(isNaN(this.metadata.sample.Read2)?s.READ_2_MIN:this.metadata.sample.Read2,isNaN(c.metadata.readLength)?s.READ_2_MIN:c.metadata.readLength)),t+=c.metadata.clusterCount,i+=c.metadata.clusterCountPF)}this.metadata.sample.Read1=a,this.metadata.sample.Read2=r,this.metadata.sample.IsPairedEnd=o,this.setSampleClustersAndReadsRaw(this.metadata.sample,t),this.setSampleClustersAndReadsPF(this.metadata.sample,i)},r}(i.BaseTaskManager);s.TaskManager=a}(s=i.Sample||(i.Sample={}))}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i=function(i){function s(e,s,a){i.call(this,e),this.file=s,this.title=s.name,this.subtitle=this.filterService("bytes")(s.size,2),this.sample=a,this.isPendingHeaderMatchValidation=!0,this.isPendingClusterCountValidation=!0;var r=angular.extend({},e,{uiConfig:e.uiConfig.subtaskUIConfig});this.subtasks=[this.checkerTask=new t.CheckerTask(r,s),this.uploadTask=new t.UploadTask(r,s,a)]}return __extends(s,i),s.prototype.start=function(){var t=this;this.uploadTask.start(),this.checkerTask.start(),this.uploadTask.then(function(e){return t._onUploadTaskComplete(e)},function(e){return t._onUploadTaskFail(e)},function(e){return t._onUploadTaskProgress(e)}),this.checkerTask.then(function(e){return t._onCheckerTaskComplete(e)},function(e){return t._onCheckerTaskFail(e)},function(e){return t._onCheckerTaskProgress(e)}),this.state=e.Interfaces.TaskState.Active},s.prototype.cancel=function(){var t=this;this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Cancelling&&this.state!=e.Interfaces.TaskState.Completing&&this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Failed&&(this.state=e.Interfaces.TaskState.Cancelling,this.checkerTask.cancel(),this.uploadTask.cancel(),this.$q.all([this.uploadTask.promise,this.checkerTask.promise])["finally"](function(){t.state=e.Interfaces.TaskState.Cancelled,t.statusLabel="Cancelled",t.statusDescription="The upload of file "+t.file.name+" was cancelled.",t.deferred.reject("Cancelled Task")}))},s.prototype.fail=function(t){this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Failed&&this.state!=e.Interfaces.TaskState.Cancelling&&this.state!=e.Interfaces.TaskState.Cancelled&&(this.checkerTask.cancel(),this.uploadTask.cancel(),this.state=e.Interfaces.TaskState.Failed,this.statusLabel="FASTQ upload failed",this.statusDescription=t,this.deferred.reject(t))},s.prototype.alreadyComplete=function(){this.uploadTask.alreadyComplete(),this.checkerTask.alreadyComplete(),this.state=e.Interfaces.TaskState.Complete,this.completion=1,this.deferred.resolve()},s.prototype._onUploadTaskComplete=function(e){this.fileResponse=e.file,this._onTaskComplete()},s.prototype._onCheckerTaskComplete=function(e){this.metadata=e.metadata,this._onTaskComplete();

},s.prototype._onTaskComplete=function(){var i=this;this.deferred.notify(),this.checkerTask.state==e.Interfaces.TaskState.Complete&&this.uploadTask.state==e.Interfaces.TaskState.Complete&&(this.state=e.Interfaces.TaskState.Completing,this.api.Sample.save({Id:this.sample.Id,Name:this.sample.SampleId?this.sample.SampleId:"uploading",SampleId:this.sample.SampleId,TotalClustersPF:this.sample.TotalClustersPF,TotalClustersRaw:this.sample.TotalClustersRaw,TotalReadsPF:this.sample.TotalReadsPF,TotalReadsRaw:this.sample.TotalReadsRaw,Read1:Math.max(this.sample.Read1,t.READ_1_MIN),Read2:this.sample.Read2,IsPairedEnd:this.sample.IsPairedEnd},function(t){i._setImportFileValidationProperty(i.fileResponse.Id).then(function(t){i.state=e.Interfaces.TaskState.Complete,i.completion=1,i.deferred.resolve()})},function(){i.state=e.Interfaces.TaskState.Failed}))},s.prototype._setImportFileValidationProperty=function(t){var i=this,a=JSON.stringify({metadata:this.metadata});return this.propertyService.setStringProp("appresult_file",t,s.IMPORT_VALIDATION_FASTQ_PROPERTY_NAME,a,s.IMPORT_TYPE_PROPERTY_DESCRIPTION).then(function(){i.propertyService.setStringArrayProp("appresult_file",t,e.Directives.ImporterDirective.IMPORT_VALIDATIONS_PROPERTY_NAME,[e.Directives.ImporterDirective.IMPORT_VALIDATIONS_TYPE_PROPERTY_FASTQ],s.IMPORT_TYPE_PROPERTY_DESCRIPTION)})},s.prototype._onUploadTaskFail=function(e){this.fail(e.message)},s.prototype._onCheckerTaskFail=function(e){this.fail(e.message)},s.prototype._onTaskProgress=function(){for(var e,t=this.subtasks.length,i=0,s=0;s<this.subtasks.length;s++){var a=this.subtasks[s];i+=a.completion}e=i/t,this.completion=e,this.deferred.notify()},s.prototype._onUploadTaskProgress=function(t){this.fileResponse=t.file,this.state==e.Interfaces.TaskState.Active&&(this.statusLabel="Upload progress",this.statusDescription=t.message),this._onTaskProgress()},s.prototype._onCheckerTaskProgress=function(e){this.metadata=e.metadata,this._onTaskProgress()},s.IMPORT_VALIDATION_FASTQ_PROPERTY_NAME="BaseSpace.Files.Validations.fastq",s.IMPORT_TYPE_PROPERTY_DESCRIPTION="Confirms that the fastq file passed simple client side validation",s}(t.BaseTask);t.ImportTask=i}(i=t.Sample||(t.Sample={}))}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i=function(t){function i(e,i){t.call(this,e),this.file=i,this.title="Validation task."}return __extends(i,t),i.prototype.start=function(){var t=this;this.validationPromise=this.fastqCheckerService.validate(this.file,this.file.name),this.validationPromise.then(function(e){return t._onWorkerComplete(e)},function(e){return t._onWorkerFail(e)},function(e){return t._onWorkerProgress(e)}),this.state=e.Interfaces.TaskState.Active},i.prototype.cancel=function(){this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Failed&&this.state!=e.Interfaces.TaskState.Complete&&this.validationPromise&&(this.state=e.Interfaces.TaskState.Cancelled,this.validationPromise.cancel(),this.deferred.reject({message:"Validation cancelled."}))},i.prototype._onWorkerComplete=function(t){this.state!=e.Interfaces.TaskState.Complete&&(this.deferred.notify(t),this.state=e.Interfaces.TaskState.Complete,this.completion=1,this.deferred.resolve(t))},i.prototype._onWorkerFail=function(t){this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Failed&&(this.statusLabel="FASTQ Validation failed",this.statusDescription=t.message,this.state=e.Interfaces.TaskState.Failed,this.deferred.reject(t))},i.prototype._onWorkerProgress=function(e){this.metadata=e,this.completion=e.percentComplete/100,this.deferred.notify(e)},i}(t.BaseTask);t.CheckerTask=i}(i=t.Sample||(t.Sample={}))}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(t,i,s){this.sample=s,e.call(this,t,i)}return __extends(t,e),t.prototype.initUploader=function(){this.uploader=this.uploaderFactory.getSampleFileUploader(this.file,this.sample)},t}(e.BaseUploadTask);t.UploadTask=i}(t=e.Sample||(e.Sample={}))}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.start=function(){return null},t}(e.BaseTask);t.BaseTask=i}(t=e.AppResult||(e.AppResult={}))}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a=function(a){function r(e,t,i){a.call(this,e),this.file=t,this.title=t.name,this.subtitle=this.filterService("bytes")(t.size,2),this.appresult=i,this.isValidationPropertySet=!1,e.metadata||(this.metadata={validationType:null,serverValidationResult:null});var r=angular.extend({},e,{metadata:this.metadata});this.validationTask=new s.ValidationTask(r,this.file),this.uploadTask=new s.UploadTask(r,t,this.appresult),this.subtasks.push(this.validationTask),this.subtasks.push(this.uploadTask)}return __extends(r,a),r.prototype.start=function(){var t=this;switch(this.state=e.Interfaces.TaskState.Active,this.importType.taskOrder){case i.TaskOrder.VALIDATE_FIRST:this.statusLabel="Validating",this.validationTask.start().then(function(e){t._onValidationTaskComplete(e),t.uploadTask.start().then(function(e){t._onUploadTaskComplete(e),t._onAllTasksComplete(e)},function(e){t._onUploadTaskFail(e)},function(e){t._onUploadTaskProgress(e)})},function(e){t._onValidationTaskFail(e)});break;case i.TaskOrder.UPLOAD_FIRST:this.statusLabel="Uploading",this.uploadTask.start().then(function(e){t._onUploadTaskComplete(e),t.validationTask.fileResponse=e.file,t.validationTask.start().then(function(e){t._onValidationTaskComplete(e),t._onAllTasksComplete(e)},function(e){t._onValidationTaskFail(e)},function(e){})},function(e){t._onUploadTaskFail(e)})}return this.promise},r.prototype.cancel=function(){var t=this;this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Cancelling&&this.state!=e.Interfaces.TaskState.Completing&&this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Failed&&(this.state=e.Interfaces.TaskState.Cancelling,this.statusLabel="Cancelling",this.statusDescription="Currently stopping the upload of file "+this.file.name+"...",this.validationTask.cancel(),this.uploadTask.cancel(),this.$q.all([this.uploadTask.promise,this.validationTask.promise])["finally"](function(){t.state=e.Interfaces.TaskState.Cancelled,t.statusLabel="Cancelled",t.statusDescription="The upload of file "+t.file.name+" was cancelled.",t.deferred.reject({message:"Cancelled Task"})}))},r.prototype.fail=function(t){this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Failed&&this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Cancelling&&(this.validationTask.cancel(),this.uploadTask.cancel(),this.state=e.Interfaces.TaskState.Failed,this.statusLabel="File upload failed",this.statusDescription=t,this.deferred.reject(t))},r.prototype.alreadyComplete=function(){this.isValidationPropertySet=!0,this.statusLabel="Upload complete.",this.statusDescription="The file passed validation and was uploaded successfully.",this.uploadTask.alreadyComplete(),this.validationTask.alreadyComplete(),this._updateSubtitle(),this.state=e.Interfaces.TaskState.Complete,this.completion=1,this.deferred.resolve()},r.prototype._updateCompletion=function(){this.completion=.25*this.validationTask.completion+.75*this.uploadTask.completion},r.prototype._setImportFileValidationProperty=function(t){var i=this,s=JSON.stringify(this.metadata.serverValidationResult);return this.propertyService.setStringProp("appresult_file",t,this.metadata.validationType.propertyName,s,this.metadata.validationType.propertyDescription).then(function(){i.propertyService.setStringArrayProp("appresult_file",t,e.Directives.ImporterDirective.IMPORT_VALIDATIONS_PROPERTY_NAME,[i.metadata.validationType.propertyName],i.metadata.validationType.propertyDescription)})},r.prototype._onValidationTaskComplete=function(i){this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Completing&&this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Cancelling&&this.state!=e.Interfaces.TaskState.Failed&&(this.statusLabel="Validation complete.",this.statusDescription="Validation completed.",this.metadata.serverValidationResult=i,this.metadata.validationType=t.Validation.getByServerType(this.metadata.serverValidationResult.Type),this._updateSubtitle(),this._updateCompletion())},r.prototype._updateSubtitle=function(){this.metadata.validationType&&(this.subtitle=this.subtitle+" | "+this.metadata.validationType.displayName)},r.prototype._onValidationTaskFail=function(e){this.fail(this.validationTask.statusDescription)},r.prototype._onUploadTaskComplete=function(t){var s=this;this.state!=e.Interfaces.TaskState.Complete&&this.state!=e.Interfaces.TaskState.Completing&&this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Cancelling&&this.state!=e.Interfaces.TaskState.Failed&&(this.importType.taskOrder==i.TaskOrder.VALIDATE_FIRST&&!this.isValidationPropertySet&&t.file&&this._setImportFileValidationProperty(t.file.Id).then(function(){s.isValidationPropertySet=!0}),this.statusLabel="Upload complete.",this.statusDescription="Upload of file "+this.file.name+" completed successfully.",this._updateCompletion())},r.prototype._onAllTasksComplete=function(t){this.statusLabel="Upload complete.",this.statusDescription="The file passed validation and was uploaded successfully.",this._updateCompletion(),this.state=e.Interfaces.TaskState.Complete,this.deferred.resolve(t)},r.prototype._onUploadTaskFail=function(e){this.fail(e.message)},r.prototype._onUploadTaskProgress=function(e){var t=this;this._updateCompletion(),this.statusLabel="Upload progress",this.statusDescription=e.message,this.importType.taskOrder==i.TaskOrder.VALIDATE_FIRST&&!this.isValidationPropertySet&&e.file&&this._setImportFileValidationProperty(e.file.Id).then(function(){t.isValidationPropertySet=!0})},r}(s.BaseTask);s.ImportTask=a}(s=i.AppResult||(i.AppResult={}))}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.OUTPUT_APPRESULTS_PROPERTY_NAME="Output.AppResults";var a=function(i){function a(e){i.call(this,e)}return __extends(a,i),a.prototype.initMetadata=function(){this.title="Analysis Upload - Main Task",this.state=e.Interfaces.TaskState.Active,this.uploadPendingSuffix=" (Upload Pending)",this.metadata={appSession:{Id:null,Name:null},appResult:{Id:null,Name:null},totalFileSize:0,validationSummary:null}},a.prototype.getNewSubtask=function(e){return new s.ImportTask({$q:this.$q,$timeout:this.$timeout,serverConfig:this.serverConfig,api:this.api,projectId:this.projectId,uploaderFactory:this.uploaderFactory,propertyService:this.propertyService,uiConfig:this.uiConfig.subtaskUIConfig,filterService:this.filterService,importType:this.importType},e,this.metadata.appResult)},a.prototype.saveProgress=function(e){var i=this,s=this.$q.defer(),a=s.promise;return this._sessionInitPromise.then(function(){var a=e==t.Api.ApiResourceStatus.COMPLETE?"":i.uploadPendingSuffix,r=(i.metadata.appResult.Name?i.metadata.appResult.Name:i.metadata.appSession.Name)+a,o={Id:i.metadata.appSession.Id,Name:r},n={Id:i.metadata.appResult.Id,Name:r};e&&(angular.extend(o,{Status:e}),angular.extend(n,{Status:e})),i.api.AppResult.save(n,function(){i.api.AppSession.save(o,function(){s.resolve()},function(){s.reject()})},function(){s.reject()})}),a},a.prototype.finishImport=function(i){var s=this;void 0===i&&(i=0),this.saveProgress(t.Api.ApiResourceStatus.COMPLETE).then(function(){s.state=e.Interfaces.TaskState.Complete,s.api.AppSession.reserveSpace({Id:s.metadata.appSession.Id,SpaceRequiredInBytes:0})},function(t){i<s.importType.maxRetries?(console.log("Failed to save progress and set status as 'Complete'.",t),i++,setTimeout(function(){s.finishImport(i)},1e3*i)):(s.state=e.Interfaces.TaskState.Failed,s.isCancellable=!0)})},a.prototype.abortImport=function(){var i=this;if(!this.metadata.appSession)return void(this.state=e.Interfaces.TaskState.Cancelled);for(var s=[],a=0;a<this.subtasks.length;a++){var r=this.subtasks[a];r.cancel(),s.push(r.promise)}this.$q.all(s)["finally"](function(){i.api.AppSession.reserveSpace({Id:i.metadata.appSession.Id,SpaceRequiredInBytes:0}),i.api.AppSession.save({Id:i.metadata.appSession.Id,Status:t.Api.ApiResourceStatus.ABORTED,Name:"(Cancelled)"},function(){console.log("app session aborted..."),i.api.AppSession["delete"]({Id:i.metadata.appSession.Id,ByPassTrash:!0},function(){console.log("app session deleted..."),i.state=e.Interfaces.TaskState.Cancelled},function(e){console.log("Error Deleting App Session!"),console.dir(e),setTimeout(function(){i.abortImport()},1e3)})},function(e){console.log("Error aborting app session..."),console.dir(e),setTimeout(function(){i.abortImport()},1e3)})})},a.prototype.getFormErrors=function(){return[]},a.prototype.updateMetadata=function(){},a.prototype.startNewSubtask=function(e){var t=this;if(this._isInitiatingUploadSession||this.metadata.appSession.Id)this._sessionInitPromise?this._sessionInitPromise.then(function(){return t.startTask(e)}):this.startTask(e);else{if(this._sessionInitPromise.then(function(){return t._isInitiatingUploadSession=!1},function(){return t._isInitiatingUploadSession=!1}),!this.metadata.appSession.Name||!this.metadata.appResult.Name){var i=e.file.name.split(".")[0];i=i.substring(0,Math.min(this.maxResultNameLength,i.length)),this.metadata.appSession.Name=this.metadata.appResult.Name=i}this._isInitiatingUploadSession=!0;var s=angular.extend({},this.metadata.appResult,{projectId:this.projectId,Name:this.metadata.appResult.Name+this.uploadPendingSuffix});console.log(s,"appResultParams"),this.api.AppResult.create(s,function(i){var s=i.Response;t.metadata.appResult.Id=s.Id,t.metadata.appSession.Id=s.AppSession.Id;var a={Id:t.metadata.appSession.Id,Name:t.metadata.appSession.Name+t.uploadPendingSuffix};t.api.AppSession.reserveSpace({Id:t.metadata.appSession.Id,SpaceRequiredInBytes:t.maxFileSize},function(i){t.api.AppSession.save(a,function(i){t._isInitiatingUploadSession=!1,t.setImportProperty(t.metadata.appSession.Id).then(function(){t.startTask(e),t._sessionInitDeferred.resolve()},function(){t.onTaskFail(e),t._sessionInitDeferred.reject()})})},function(i){t._sessionInitDeferred.reject(),e.fail("Upload can not be started."),404==i.status?t.modalDialogService.bootstrapAlert({headerTemplate:"Error - Resource Not Found",bodyTemplate:i.data.ResponseStatus.Message}):409==i.status&&t.modalDialogService.bootstrapAlert({headerTemplate:"Error - Not Enough Free Space",bodyTemplate:i.data.ResponseStatus.Message})})},function(i){console.log("Error! Failed to create AppResult."),console.dir(i),t._sessionInitDeferred.reject(),t.onTaskFail(e)})}},a}(i.BaseTaskManager);s.TaskManager=a}(s=i.AppResult||(i.AppResult={}))}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a=function(s){function a(e,t,i){s.call(this,e),this.BYTES_NEEDED_FOR_VCF_VALIDATION=1048576,this.file=t,i&&(this.fileResponse=i),this.title="Validation task",this.cancellerDeferred=this.$q.defer(),this.cancellerPromise=this.cancellerDeferred.promise}return __extends(a,s),a.prototype.start=function(){var t=this;switch(this.importType.validationMethod){case i.ValidationMethod.HTTP_STREAM:this.api.$http.post(this.api.apiBaseUrl+"validatefile/"+this._getValidationType(),this._getFirstSlice(),this._getHttpConfig()).then(function(e){return t._onValidationComplete(e)},function(e){return t._onValidationFail(e)});break;case i.ValidationMethod.FILE_SUMMARY:this.api.File.validateFileSummary({Id:this.fileResponse.Id,validationType:this._getValidationType()}).$promise.then(function(e){return t._onValidationComplete({data:e})},function(e){return t._onValidationFail(e)})}return this.state=e.Interfaces.TaskState.Active,this.completion=.5,this.deferred.notify({completion:this.completion,message:"Submitting the first "+this.BYTES_NEEDED_FOR_VCF_VALIDATION+" bytes of file to server for validation."}),this.promise},a.prototype.cancel=function(){this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Failed&&this.state!=e.Interfaces.TaskState.Complete&&(this.state=e.Interfaces.TaskState.Cancelled,this.statusLabel="VCF Validation cancelled",this.statusDescription="Cancelled",this.deferred.reject())},a.prototype._getValidationType=function(){var e=this.file.name.split("."),t=e[e.length-1].toLowerCase();return"vcf"==t?"vcf":"gz"==t?"vcfgz":"txt"==t?"manifest":void 0},a.prototype._getFirstSlice=function(){return this.file.slice(0,this.BYTES_NEEDED_FOR_VCF_VALIDATION)},a.prototype._getHttpConfig=function(){var e=angular.extend({},this.api.defaultHttpConfig,{headers:{"Content-Type":"application/octet-stream"},timeout:this.cancellerPromise});return e},a.prototype._onValidationComplete=function(i){if(console.log(i,"Success!"),this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Complete){var s=i.data.Response;i.data.Response.Passed?(this.deferred.notify(i),this.state=e.Interfaces.TaskState.Complete,this.statusLabel="File validation succeeded.",this.statusDescription="File validation succeeded.",this.metadata.validationSummary=t.Validation.getByServerType(s.Type),this.completion=1,this.deferred.resolve(s)):this._onValidationFail({data:{ResponseStatus:{Message:s.ValidationMessage,ErrorCode:s.ErrorCode,StackTrace:null,Errors:null}}})}},a.prototype._onValidationFail=function(t){this.state!=e.Interfaces.TaskState.Cancelled&&this.state!=e.Interfaces.TaskState.Failed&&(this.statusLabel="File validation failed",this.statusDescription=t.data.ResponseStatus.Message,this.state=e.Interfaces.TaskState.Failed,this.deferred.reject({message:t.data.ResponseStatus.Message,errorCode:t.data.ResponseStatus.ErrorCode,data:t}))},a}(s.BaseTask);s.ValidationTask=a}(s=i.AppResult||(i.AppResult={}))}(i=t.Import||(t.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(t,i,s){this.appresult=s,e.call(this,t,i)}return __extends(t,e),t.prototype.initUploader=function(){this.uploader=this.uploaderFactory.getAppResultFileUploader(this.file,this.appresult)},t}(e.BaseUploadTask);t.UploadTask=i}(t=e.AppResult||(e.AppResult={}))}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a=function(i){function s(s,a){i.call(this,s),this.importType=e.Import.vcf,this.selectedSamples=a,this.needToRemoveSample=!1,this.maxFileCount=t.vcf.maxFileCount,this.maxFileSize=t.vcf.maxFileSize,this.needToRemoveSample=!1}return __extends(s,i),s.prototype.saveProgress=function(t){var i=this,s=this.$q.defer(),a=s.promise;return this._sessionInitPromise.then(function(){var a=t==e.Api.ApiResourceStatus.COMPLETE?"":i.uploadPendingSuffix,r=(i.metadata.appResult.Name?i.metadata.appResult.Name:i.metadata.appSession.Name)+a,o={Id:i.metadata.appSession.Id,Name:r},n={Id:i.metadata.appResult.Id,Name:r};t&&(angular.extend(o,{Status:t}),angular.extend(n,{Status:t}));var l;if(i.selectedSamples.length>0)l=i.$q.when([i.propertyService.setSampleArrayProp("appsession",i.metadata.appSession.Id,e.Api.PropertyName.INPUT_SAMPLES,i._getSamplePropertyParams())]),angular.extend(n,{Properties:[{Name:"Input.Samples",Items:["v1pre3/samples/"+i.selectedSamples[0].Sample.Id]}]});else if(i.needToRemoveSample)l=i.$q.when([i.propertyService.setSampleArrayProp("appsession",i.metadata.appSession.Id,e.Api.PropertyName.INPUT_SAMPLES,[]),i.propertyService.setSampleArrayProp("appresult",i.metadata.appResult.Id,e.Api.PropertyName.INPUT_SAMPLES,[])]).then(function(){return i.needToRemoveSample=!1});else{var c=i.$q.defer();l=c.promise,c.resolve()}l.then(function(){i.api.AppResult.save(n,function(){i.api.AppSession.save(o,function(){s.resolve()},function(){s.reject()})},function(){s.reject()})},function(){s.reject()})}),a},s.prototype._getSamplePropertyParams=function(){var e=this.selectedSamples.map(function(e){return e.Sample.Id});return e},s}(i.TaskManager);s.TaskManager=a}(s=i.VCF||(i.VCF={}))}(i=t.AppResult||(t.AppResult={}))}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){var a=function(i){function s(s){i.call(this,s),this.importType=e.Import.manifest,this.maxFileCount=t.manifest.maxFileCount,this.maxFileSize=t.manifest.maxFileSize}return __extends(s,i),s.prototype.updateMetadata=function(){var e=this.getNonFailedSubtasks();this.metadata.manifestTypeSummary={};for(var t=0;t<e.length;t++){var i=e[t],s=i.metadata.validationType;s&&(s.displayName in this.metadata.manifestTypeSummary||(this.metadata.manifestTypeSummary[s.displayName]=0),this.metadata.manifestTypeSummary[s.displayName]++)}},s}(i.TaskManager);s.TaskManager=a}(s=i.Manifest||(i.Manifest={}))}(i=t.AppResult||(t.AppResult={}))}(t=e.Import||(e.Import={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.dragSpreadsheetServiceName="bsDragSpreadsheet",e.commonModule.service(i.dragSpreadsheetServiceName,["$timeout",t.Mappings.dataMappingServiceName,function(e,t){return new a(e,t)}]);var s=function(){function e(){}return e}();i.IInsertionOptions=s;var a=function(){function e(e,t){this.$timeout=e,this.mappingService=t,this.originItem=null,this.targetItem=null}return e.prototype.registerOrigin=function(e,t,i){this.originItem=e,this.originGroup=t,i&&(this.originScope=i)},e.prototype.deregisterOrigin=function(){this.originItem=null,this.originGroup=null,this.originScope=null},e.prototype.registerTarget=function(e,t,i){var s=!1;if(this.targetItem!=e&&(this.targetItem=e,s=!0),this.targetGroup!=t&&(this.targetGroup=t,s=!0),this.targetScope!=i&&(this.targetScope=i,s=!0),s&&this.targetGroup&&this.targetItem&&this.originItem&&this.originGroup){this.originGroup.dataType!=this.targetGroup.dataType&&this._mapOrigin();var a=this.getInsertionOptions(this._isRowClampNeeded());this.canAddResult=this.targetGroup.canAdd(a.matrix,a.columnNumber,a.rowNumber),this.canDrop()?(this._updateDropPreviewAndPadRows(a),this.targetGroup.isInvalidDropAttempted=!1):this.targetGroup.isInvalidDropAttempted=!0}},e.prototype._updateDropPreviewAndPadRows=function(e){for(var t=this,i=0,s=0;s<e.matrix.length;s++){var a=e.matrix[s];i=Math.max(a.length,i)}for(var r=i+e.rowNumber,o=[],n=0;n<this.targetGroup.columns.length;n++){var l=this.targetGroup.columns[n],c=l.items.length+(null===l.items[l.items.length-1]?0:1);o[n]=Math.min(l.limit,c);for(var u=e.rowNumber;r>u||u<l.items.length;u++){var d=l.items[u],p=u+1;r>u?(angular.isDefined(d)||(l.items[u]=null),p==l.items.length&&p<l.limit&&(l.items[u+1]=null)):u<l.items.length&&(angular.isDefined(d)&&null!=d?o[n]=l.items.length:o[n]==c&&(o[n]=u+1))}}var m=Math.max.apply(null,o);for(!isNaN(m)&&angular.isNumber(m)&&this._deleteTargetCellsFrom(m),this.targetGroup.clearTargets(),s=0;s<this.canAddResult.columnsToChange.length;s++)for(var h=this.canAddResult.columnsToChange[s],f=0;f<h.rowsToChange.length;f++){var v=h.rowsToChange[f];this.targetGroup.targetedCells[h.columnNumber][v.rowNumber]=!0}this.$timeout(function(){t.targetGroup&&t.targetScope.$digest()})},e.prototype._deleteTargetCellsFrom=function(e){for(var t=0;t<this.targetGroup.columns.length;t++){var i=this.targetGroup.columns[t];i.items.length=e}},e.prototype.deregisterTarget=function(){var e=this;this.targetScope&&this.targetScope.$apply(function(t){e.targetGroup.isInvalidDropAttempted=!1,e.targetGroup.clearTargets(),e.targetGroup=null,e.targetItem=null,e.targetScope=null})},e.prototype.canDrop=function(){var e=!1;if(this.targetGroup&&this.targetItem&&this.originItem&&this.originGroup&&this.canAddResult){e=!0;for(var t=0;t<this.canAddResult.columnsToChange.length;t++)for(var i=this.canAddResult.columnsToChange[t],s=0;s<i.rowsToChange.length;s++){var a=i.rowsToChange[s];if(!a.canAdd)return!1}}return e},e.prototype.deselectRange=function(e,t,i){for(var s=this._getColumnStartIndex(t),a=this._getColumnEndIndex(t),r=this._getRowStartIndex(t),o=this._getRowEndIndex(t),n=s;a>=n;n++)for(var l=r;o>=l;l++)e.deselectItem(n,l),i[n][l].dragEnabled=!1},e.prototype.selectRange=function(e,t,i){for(var s=this._getColumnStartIndex(t),a=this._getColumnEndIndex(t),r=this._getRowStartIndex(t),o=this._getRowEndIndex(t),n=s;a>=n;n++)for(var l=r;o>=l;l++)e.selectItem(n,l),i[n][l].dragEnabled=!0},e.prototype._getColumnStartIndex=function(e){return e.startPosition.columnNumber>e.endPosition.columnNumber?e.endPosition.columnNumber:e.startPosition.columnNumber},e.prototype._getColumnEndIndex=function(e){return e.startPosition.columnNumber>e.endPosition.columnNumber?e.startPosition.columnNumber:e.endPosition.columnNumber},e.prototype._getRowStartIndex=function(e){return e.startPosition.rowNumber>e.endPosition.rowNumber?e.endPosition.rowNumber:e.startPosition.rowNumber},e.prototype._getRowEndIndex=function(e){return e.startPosition.rowNumber>e.endPosition.rowNumber?e.startPosition.rowNumber:e.endPosition.rowNumber},e.prototype.drop=function(){var e=this;if(this.canDrop()){angular.isFunction(this.originItem.onBeforeDrop)&&this.originItem.onBeforeDrop();var t=this.getInsertionOptions(this._isRowClampNeeded());this.addResult=this.targetGroup.add(t.matrix,t.columnNumber,t.rowNumber),angular.isFunction(this.originItem.onAfterDrop)&&this.originItem.onAfterDrop(),this.originGroup.clearSelections(),this.targetGroup!=this.originGroup&&this.targetGroup.clearSelections();var i=this.targetScope&&this.targetScope!=this.originScope;this.originScope&&this.$timeout(function(){try{e.originScope.$digest()}catch(t){console.error(t)}finally{e.deregisterOrigin()}}),i&&this.$timeout(function(){try{e.targetScope.$digest()}catch(t){console.error(t)}finally{e.deregisterTarget()}})}},e.prototype._isRowClampNeeded=function(){return 0==this.targetGroup.columns[this.targetItem.position.columnNumber].nonEmptyItems.length?!0:!1},e.prototype.getInsertionOptions=function(e){void 0===e&&(e=!1);var t=this.targetGroup==this.originGroup,i={columnNumber:null,rowNumber:null,matrix:null},s=this.originItem.position;e&&(s={columnNumber:this.originItem.position.columnNumber,rowNumber:this._getMinSelectedRow()});var a=this._getMinSelectedColumn(),r=this._getMaxSelectedColumn(),o=this._getMinSelectedRow(),n=r-a+1,l=this.targetItem.position.columnNumber-s.columnNumber,c=this.targetItem.position.rowNumber-s.rowNumber;t&&(n+=Math.abs(l));var u,d;t?(u=Math.min(a,a+l),d=Math.min(o,o+c)):(u=a+l,d=o+c);for(var p=[],m=0;n>m;m++)p.push([]);for(m=0;m<this.originGroup.selectedCells.length;m++)for(var h=0;h<this.originGroup.selectedCells[m].length;h++)if(this.originGroup.selectedCells[m][h]){var f={position:{columnNumber:m,rowNumber:h}};if(t){var v=p[f.position.columnNumber-u][f.position.rowNumber-d];void 0==v&&(p[f.position.columnNumber-u][f.position.rowNumber-d]=null),p[f.position.columnNumber-u+l][f.position.rowNumber-d+c]=this.originGroup.columns[f.position.columnNumber].items[f.position.rowNumber]}else p[f.position.columnNumber-a][f.position.rowNumber-o]=this.originGroup.columns[f.position.columnNumber].items[f.position.rowNumber]}return i.matrix=p,i.rowNumber=d,i.columnNumber=u,i},e.prototype._getMinSelectedColumn=function(){for(var e=0;e<this.originGroup.selectedCells.length;e++)for(var t=0;t<this.originGroup.selectedCells[e].length;t++)if(this.originGroup.selectedCells[e][t])return e;return null},e.prototype._getMinSelectedRow=function(){for(var e=0;e<this.originGroup.maxRows;e++)for(var t=0;t<this.originGroup.columns.length;t++)if(this.originGroup.selectedCells[t][e])return e;return null},e.prototype._getMaxSelectedColumn=function(){for(var e=this.originGroup.selectedCells.length-1;e>=0;e--)for(var t=0;t<this.originGroup.selectedCells[e].length;t++)if(this.originGroup.selectedCells[e][t])return e;return null},e.prototype._getMaxSelectedRow=function(){for(var e=this.originGroup.maxRows-1;e>=0;e--)for(var t=0;t<this.originGroup.columns.length;t++)if(this.originGroup.selectedCells[t][e])return e;return null},e.prototype._mapOrigin=function(){for(var e=0;e<this.originGroup.columns.length;e++){var t=this.originGroup.columns[e];t.items=this.mappingService.map(t.items,this.originGroup.dataType,this.targetGroup.dataType)}},e}();i.DragSpreadsheetService=a}(i=t.DragDrop||(t.DragDrop={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.REPETITION_DISALLOWED="Repetition of items is disallowed.",e.COLUMN_LOCKED="This column is currently locked.",e.LIMIT_EXCEEDED="You tried to add more items than is allowed by this column.",e.COLUMN_DOES_NOT_EXIST="No column exists at the desired position.",e.NEGATIVE_ROW="A negative row cannot be specified as the matrix insertion point.",e}();e.Errors=t}(t=e.Matrix||(e.Matrix={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e,t,i,s,a,r){void 0===s&&(s=!1),void 0===a&&(a=[]),void 0===r&&(r=null),this.name=e,this.title=t,this.limit=i,this.items=[],this.isRepetitionAllowed=!0,this.isLocked=s,this.validationRules=a,this.sorter=r,this.nonEmptyItems=[],this.isSortAsc=!0,this.isSorted=!1}return t.prototype.disallowAllItemAdditions=function(e,t,i){for(var s={rowsToChange:[]},a=0;a<e.length;a++){var r=t+a;s.rowsToChange.push({canAdd:!1,itemToAdd:e[a],itemToRemove:void 0===this.items[r]?null:this.items[r],rowNumber:r,reasonDisallowed:i})}return s},t.prototype.canAdd=function(t,i){if(this.isLocked)return this.disallowAllItemAdditions(t,i,e.Errors.COLUMN_LOCKED);if(0>i)return this.disallowAllItemAdditions(t,i,e.Errors.NEGATIVE_ROW);if(i>this.limit)return this.disallowAllItemAdditions(t,i,e.Errors.LIMIT_EXCEEDED);for(var s={rowsToChange:[]},a=[],r=i+t.length-this.limit;r>0;)a.push(t.splice(t.length-r,1)[0]),r--;for(var o=0;o<t.length;o++){var n=t[o];if(angular.isDefined(n)){var l=i+o,c=void 0==this.items[l]?null:this.items[l],u={itemToAdd:n,itemToRemove:c,rowNumber:l,canAdd:!0};if(!this.isRepetitionAllowed){for(var d=!1,p=0;p<this.items.length;p++){var m=this.items[p];if(angular.equals(m,n)&&p!=l){d=!0;break}}d&&(u.canAdd=!1,u.reasonDisallowed=e.Errors.REPETITION_DISALLOWED)}if(1==u.canAdd){var h=this._getValidationErrors(n);null!=h&&(u.canAdd=!1,u.reasonDisallowed=h)}s.rowsToChange.push(u)}}for(var f=0;a.length>0;)s.rowsToChange.push({itemToAdd:a.shift(),itemToRemove:null,rowNumber:this.limit+f,canAdd:!1,reasonDisallowed:e.Errors.LIMIT_EXCEEDED}),f++;return s},t.prototype.add=function(e,t){for(var i=this.canAdd(e,t),s={rowsChanged:[],addedItemIds:[],removedItemIds:[]},a=0;a<i.rowsToChange.length;a++){var r=i.rowsToChange[a],o={rowNumber:r.rowNumber,itemAdded:null,itemRemoved:null,changed:!1};r.canAdd?(this.items[r.rowNumber]=o.itemAdded=r.itemToAdd,o.itemRemoved=r.itemToRemove,o.changed=!angular.equals(o.itemRemoved,o.itemAdded)):(o.itemAdded=r.itemToAdd,
o.itemRemoved=r.itemToRemove,o.reasonDisallowed=r.reasonDisallowed),o.changed&&(o.itemRemoved&&s.removedItemIds.push(o.itemRemoved.id),o.itemAdded&&s.addedItemIds.push(o.itemAdded.id)),s.rowsChanged.push(o)}return this.nonEmptyItems=this.getNonEmptyItems(),this.isSorted=!1,s},t.prototype.remove=function(e){var t=null,i=this.items[e];return angular.isDefined(i)&&null!=i&&(t=i.id),this.items[e]=null,this.nonEmptyItems=this.getNonEmptyItems(),this.isSorted=!1,t},t.prototype.removeAll=function(e){void 0===e&&(e=this.items.length);for(var t=[],i=0;e>i;i++){var s=this.items[i];angular.isDefined(s)&&null!=s&&t.push(s.id),this.items[i]=null}return this.nonEmptyItems=this.getNonEmptyItems(),this.isSorted=!1,t},t.prototype.trimTheFat=function(){for(var e=0;e<this.items.length;e++){var t=this.items[e];null==t&&(this.items.splice(e,1),e--)}},t.prototype.sort=function(){var e=this;this.sorter&&(this.trimTheFat(),this.items.sort(this.isSortAsc?this.sorter:function(t,i){return-1*e.sorter(t,i)}),this.isSortAsc=!this.isSortAsc,this.isSorted=!0)},t.prototype.padToIndex=function(e){for(var t=e;t>=0;t--){var i=this.items[t];if(angular.isDefined(i))return;this.items[t]=null}},t.prototype.getNonEmptyItems=function(){for(var e=[],t=0;t<this.items.length;t++){var i=this.items[t];angular.isDefined(i)&&null!=i&&e.push(i)}return e},t.prototype.getItemIds=function(){var e=this.getNonEmptyItems().map(function(e){return e.id});return e},t.prototype._getValidationErrors=function(e){for(var t=null,i=0;i<this.validationRules.length;i++){var s=this.validationRules[i],a=s(e);angular.isString(a)&&a.length>0&&(t=null==t?a:t+" "+a)}return t},t}();e.SpreadsheetColumn=t}(t=e.Matrix||(e.Matrix={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s=function(){function s(t,i,s,a,r,o){void 0===r&&(r=100),void 0===o&&(o=!1),this.name=t,this.title=i,this.columns=s,this.dataType=a,this.isRepetitionAllowedAcrossColumns=!0,this.allowUnpairedCells=o,this.persistItemsAfterDragAway=!1,this.nonEmptyItems=[],this.maxRows=r,this.errors=[],this.statusSummary={message:"",type:e.Interfaces.MessageType.NONE},this.targetedCells=[],this.selectedCells=[],this.invalidCells=[],this.itemsHash={},this.serverErrorsHash={};for(var n=0;n<this.columns.length;n++)this.targetedCells.push([]),this.selectedCells.push([]),this.invalidCells.push([]);angular.isNumber(this.maxRows)&&this.columns.forEach(function(e){return Math.min(e.limit,r)}),this.isInvalidDropAttempted=!1}return s.prototype.disallowAllItemAdditions=function(e,t,i,s){for(var a={columnsToChange:[]},r=0,o=t;r<e.length;r++,o++){var n=e[r];if(o>=this.columns.length)a.columnsToChange.push(this.disallowAdditionToAbsentColumn(n,o,i));else{var l=this.columns[o],c=l.disallowAllItemAdditions(n,i,s);a.columnsToChange.push({column:l,columnNumber:o,rowsToChange:c.rowsToChange})}}return a},s.prototype.disallowAdditionToAbsentColumn=function(e,t,s){var a=new i.SpreadsheetColumn("","",1e3),r=a.disallowAllItemAdditions(e,s,i.Errors.COLUMN_DOES_NOT_EXIST);return{column:null,columnNumber:t,rowsToChange:r.rowsToChange}},s.prototype.clearColumn=function(e){var t=this.columns[e],i=this.getMaxRows(),s=t.removeAll(i);this._updateItemsHash(null,s),this.updateErrors()},s.prototype.selectItem=function(e,t){if(!this.columns[e].isLocked){var i=this.columns[e].items[t];angular.isDefined(i)&&null!=i&&(this.selectedCells[e][t]=!0)}},s.prototype.deselectItem=function(e,t){this.columns[e].isLocked||delete this.selectedCells[e][t]},s.prototype.clearSelections=function(e){if(isFinite(e))this.selectedCells[e].length=0;else for(var t=0;t<this.selectedCells.length;t++)this.selectedCells[t].length=0},s.prototype.toggleSelected=function(e,t){if(this.columns[e].isLocked)return!1;var i=this.columns[e].items[t];angular.isDefined(i)&&null!=i&&(1==this.selectedCells[e][t]?delete this.selectedCells[e][t]:this.selectedCells[e][t]=!0)},s.prototype.clearTargets=function(){for(var e=0;e<this.targetedCells.length;e++)this.targetedCells[e].length=0;this.isInvalidDropAttempted=!1},s.prototype.clearInvalidCells=function(){for(var e=0;e<this.invalidCells.length;e++)this.invalidCells[e].length=0},s.prototype.clearCell=function(e,t){this.deselectItem(e,t);var i=this.columns[e].remove(t);this._updateItemsHash(null,[i]),this.updateErrors()},s.prototype.canAdd=function(e,t,i){for(var s={columnsToChange:[]},a=0,r=t;a<e.length;a++,r++){var o,n=this.columns[r],l=e[a];o=n?angular.extend({column:n,columnNumber:r,rowsToChange:null},n.canAdd(l,i)):this.disallowAdditionToAbsentColumn(l,r,i),s.columnsToChange.push(o)}return s},s.prototype.add=function(e,t,s){for(var a={columnsChanged:[]},r=[],o=[],n=0,l=t;n<e.length;n++,l++){var c=e[n];if(l>=this.columns.length||!isFinite(l)||0>l){for(var u=this.disallowAdditionToAbsentColumn(c,l,s),d={column:u.column,columnNumber:u.columnNumber,rowsChanged:[]},p=0;p<u.rowsToChange.length;p++){var m=u.rowsToChange[p];d.rowsChanged.push({changed:!1,reasonDisallowed:i.Errors.COLUMN_DOES_NOT_EXIST,itemAdded:m.itemToAdd,itemRemoved:m.itemToRemove,rowNumber:m.rowNumber})}a.columnsChanged.push(d)}else{var h=this.columns[l],f=h.add(c,s);a.columnsChanged.push({column:h,columnNumber:l,rowsChanged:f.rowsChanged}),r=r.concat(f.addedItemIds),o=o.concat(f.removedItemIds)}}return this._updateItemsHash(r,o),this.updateErrors(),a},s.prototype.getNumSelectedItems=function(){var e=this.selectedCells.concat.apply([],this.selectedCells);return e.filter(function(e){return e}).length},s.prototype._updateItemsHash=function(e,t){if(angular.isArray(t))for(var i=0;i<t.length;i++)delete this.itemsHash[t[i]];if(angular.isArray(e))for(var s=0;s<e.length;s++)this.itemsHash[e[s]]=!0},s.prototype.resetItemsHash=function(){for(var e in this.itemsHash)delete this.itemsHash[e];var t=this._getAllIds();this._updateItemsHash(t,[])},s.prototype._getAllIds=function(){for(var e=[],t=0;t<this.columns.length;t++){var i=this.columns[t],s=i.getItemIds();e=e.concat(s)}return e},s.prototype.getItemPosition=function(e,t){void 0===t&&(t=null),null==t&&(t=function(e,t){return angular.equals(e,t)});for(var i=null,s=0;s<this.columns.length;s++)for(var a=this.columns[s],r=0;r<a.items.length;r++){var o=a.items[r],n=t(e,o);if(n)return i={columnNumber:s,rowNumber:r}}return i},s.prototype.updateErrors=function(){this.nonEmptyItems=this.getNonEmptyItems();for(var i=0;i<this.errors.length;i++){var s=this.errors[i];s.code==t.Validation.ErrorOrigin.CLIENT&&(this.errors.splice(i,1),i--)}var a=this.getMaxRows();if(!this.allowUnpairedCells)for(var r=0;a>r;r++)!this._isRowEmptyAcrossColumns(r)&&this._anyColumnsEmpty(r)&&this.errors.push({code:t.Validation.ErrorOrigin.CLIENT,message:"You have an empty cell at row "+(r+1)+".",type:e.Interfaces.MessageType.ERROR});this.errors.length>0?this.statusSummary.message=this.errors.every(function(t){return t.type==e.Interfaces.MessageType.WARNING})?"Please review the warnings below.":"Please review the errors below.":this.nonEmptyItems.length>0?(this.statusSummary.message="All groups are valid.",this.statusSummary.type=e.Interfaces.MessageType.SUCCESS):(this.statusSummary.message="",this.statusSummary.type=e.Interfaces.MessageType.NONE),this.markInvalidCells()},s.prototype.setReadMoreMessage=function(t){var i="";if(t.data.position.columnId){var s=this.getColumnByName(t.data.position.columnId.toLowerCase()).title;i=s}null!=t.data.position.rowNumber&&t.data.position.rowNumber>=0&&(i=(i?i+", ":"")+"Row "+(t.data.position.rowNumber+1)),t.readMoreMessage=i,t.readMorePlacement=e.Interfaces.Placement.BEFORE},s.prototype.markInvalidCells=function(){this.clearInvalidCells();for(var i=0;i<this.errors.length;i++){var s=this.errors[i];if(s.code==t.Validation.ErrorOrigin.SERVER&&null!=s.data&&null!=s.data.position.columnId&&null!=s.data.position.rowNumber&&s.data.position.rowNumber>=0){s.readMoreMessage||this.setReadMoreMessage(s),s.data.position.columnNumber=this.getColumnIndexByName(s.data.position.columnId);var a,r;s.data.position.columnNumber>-1&&(a=s.data.item,r=this.columns[s.data.position.columnNumber].items[s.data.position.rowNumber]),r&&r.id&&a.id==r.id&&s.type==e.Interfaces.MessageType.ERROR?this.invalidCells[s.data.position.columnNumber][s.data.position.rowNumber]=s.message:delete this.invalidCells[s.data.position.columnNumber][s.data.position.rowNumber]}}},s.prototype.getNonEmptyItems=function(){for(var e=[],t=0;t<this.columns.length;t++){var i=this.columns[t];e=e.concat(i.nonEmptyItems)}return e},s.prototype.sortColumn=function(e){var t=this.columns[e];t.sort(),t.padToIndex(this.getMaxRows()-1),this.trimTheTrailingFat()},s.prototype.trimTheFat=function(){for(var e=0;e<this.columns.length;e++)for(var t=this.columns[e],i=0;i<t.items.length;i++){var s=this._isRowEmptyAcrossColumns(i);s&&(this._removeRow(i),i--)}if(0==this.getMaxRows())for(e=0;e<this.columns.length;e++)t=this.columns[e],t.items.push(null)},s.prototype.trimTheTrailingFat=function(){for(var e=this.getMaxRows();e>0;e--){if(1==e)return;if(!this._isRowEmptyAcrossColumns(e)||!this._isRowEmptyAcrossColumns(e-1))return;this._removeRow(e)}},s.prototype.getMaxRows=function(){for(var e=0,t=0;t<this.columns.length;t++){var i=this.columns[t];e=Math.max(i.items.length,e)}return e},s.prototype.getColumnByName=function(e){for(var t=0;t<this.columns.length;t++){var i=this.columns[t];if(i.name==e)return i}return null},s.prototype.getColumnIndexByName=function(e){for(var t=0;t<this.columns.length;t++){var i=this.columns[t];if(angular.isString(i.name)&&i.name.toLowerCase()===e.toLowerCase())return t}return-1},s.prototype._removeRow=function(e){for(var t=0;t<this.columns.length;t++){var i=this.columns[t];i.items.splice(e,1)}},s.prototype._anyColumnsEmpty=function(e){for(var t=0;t<this.columns.length;t++){var i=this.columns[t],s=i.items[e];if(null==s||!angular.isDefined(s))return!0}return!1},s.prototype._isEmpty=function(){for(var e=0;e<this.columns.length;e++)for(var t=this.columns[e],i=0;i<t.items.length;i++)if(t.items[i])return!1;return!0},s.prototype._isRowEmptyAcrossColumns=function(e){for(var t=0;t<this.columns.length;t++){var i=this.columns[t],s=i.items[e];if(angular.isDefined(s)&&null!=s)return!1}return!0},s}();i.DragSpreadsheetDataSource=s}(i=t.Matrix||(t.Matrix={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function e(){}return e.prototype.getSortedActiveLabWorkflows=function(e,t){return this.getSortedLabWorkflows(e,t).filter(function(e){return null!=e.prepRequest&&"Canceled"!=e.prepRequest.Status&&"Cancelled"!=e.prepRequest.Status})},e.prototype.getSortedLabWorkflows=function(e,t){var i=this,s=[],a=this.getActivePrepRequestsDictionary(t);return e.forEach(function(e){var t={prepKitYield:e,prepRequest:null,missingYield:0};a[e.LibraryPrep.Id]&&(t.prepRequest=a[e.LibraryPrep.Id],t.missingYield=t.prepRequest.RequiredYield-t.prepKitYield.TotalExpectedYield),s.push(t)}),s=s.sort(function(e,t){return null==e.prepRequest&&null==t.prepRequest?e.prepKitYield.LibraryPrep.Name<t.prepKitYield.LibraryPrep.Name?-1:e.prepKitYield.LibraryPrep.Name===t.prepKitYield.LibraryPrep.Name?0:1:null!=e.prepRequest&&null==t.prepRequest?-1:null==e.prepRequest&&null!=t.prepRequest?1:null!=e.prepRequest&&null!=t.prepRequest?i._compareByDate(e,t,function(e){return e.prepRequest.DateModified}):0})},e.prototype.getActivePrepRequestsDictionary=function(e){var t={};return e.forEach(function(e){var i=e.LibraryPrep.Id;t[i]||(t[i]=e)}),t},e.prototype._compareByDate=function(e,t,i){var s=i(e),a=i(t),r=new Date(s),o=new Date(a);return r>o?-1:s===a?0:1},e}();t.LabWorkflowService=i,t.labWorkflowServiceName="labWorkflow",e.commonModule.service(t.labWorkflowServiceName,[i])}(i=t.Mappings||(t.Mappings={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){var s=function(){function e(e,t,i){this.propertyService=e,this.datasetApiService=t,this.basepairsFilter=i,this.datasetFiles={}}return e.prototype.getBiosampleCell=function(e){var t=this.propertyService.getPropertyResourceName(e.Properties.Items,"Input.Biosamples",!0,"_self");return t},e.prototype.getLibraryCell=function(e){var t=this.propertyService.getPropertyResourceName(e.Properties.Items,"Input.Libraries",!1);return t},e.prototype.getRunCell=function(e){var t=this.propertyService.getPropertyResourceName(e.Properties.Items,"Input.Runs",!0);return t},e.prototype.getLaneCell=function(e){var t=this.propertyService.getPropertyMapValue(e.Properties.Items,"BaseSpace.Metrics.FastQ","LaneNumber"),i="--";return null!=t&&angular.isArray(t)&&t.length>0&&(i=t[0]),i="<span>"+i+"</span>"},e.prototype.getRunFromDataset=function(e){if(e.Properties&&e.Properties.Items){var t=this.propertyService.getPropertyValue(e.Properties.Items,"Input.Runs");return angular.isArray(t)&&t.length>0?t[0]:null}return null},e.prototype.getYieldCell=function(e){if(e.Attributes&&e.Attributes.hasOwnProperty("common_fastq")){var t=e.Attributes.common_fastq,i=(t.TotalClustersPF||0)*((t.MaxLengthRead1||0)+(t.MaxLengthRead2||0));return this.basepairsFilter(i)}return"--"},e.prototype.getDatasetFiles=function(e,t){this.datasetApiService.queryFiles({Id:e,Limit:100,SortBy:"Name",SortDir:"asc"}).then(function(e){t.setFiles(e.Items)})},e.prototype.fetchDatasetFiles=function(e){var t=this;this.datasetFiles[e]||this.datasetApiService.queryFiles({Id:e,Limit:100,SortBy:"Name",SortDir:"asc"}).then(function(i){t.datasetFiles[e]=i.Items})},e}();i.DatasetGridHelper=s,i.datasetGridHelperServiceName="datasetGridHelper",e.commonModule.service(i.datasetGridHelperServiceName,[t.Api.propertyService,t.Api.Dataset.serviceName,"basepairsFilter",s])}(i=t.GridHelpers||(t.GridHelpers={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,i){this.$http=e,this.$httpParamSerializer=t,this.basePath="https://api.basespace.illumina.com/v2",this.defaultHeaders={"Content-Type":"application/json"},i&&(this.basePath=i)}return e.prototype.extendObj=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},e.prototype.getCurrentUser=function(e){var t=this.basePath+"/users/current",i={},s=this.extendObj({},this.defaultHeaders),a={method:"GET",url:t,json:!0,params:i,headers:s};return e&&(a=this.extendObj(a,e)),this.$http(a)},e.prototype.setCurrentUser=function(e,t){var i=this.basePath+"/users/current",s={},a=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter iUserId when calling setCurrentUser");var r={method:"POST",url:i,json:!0,data:e,params:s,headers:a};return t&&(r=this.extendObj(r,t)),this.$http(r)},e.prototype.getCurrentUserWorkgroups=function(e){var t=this.basePath+"/users/current/workgroups",i={},s=this.extendObj({},this.defaultHeaders),a={method:"GET",url:t,json:!0,params:i,headers:s};return e&&(a=this.extendObj(a,e)),this.$http(a)},e.prototype.getUser=function(e,t,i){var s=this.basePath+"/users/{id}".replace("{id}",String(e)),a={},r=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter id when calling getUser");void 0!==t&&(a.options=t);var o={method:"GET",url:s,json:!0,params:a,headers:r};return i&&(o=this.extendObj(o,i)),this.$http(o)},e.prototype.getWorkgroup=function(e,t){var i=this.basePath+"/workgroups/{id}".replace("{id}",String(e)),s={},a=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter id when calling getWorkgroup");var r={method:"GET",url:i,json:!0,params:s,headers:a};return t&&(r=this.extendObj(r,t)),this.$http(r)},e.prototype.changeName=function(e,t,i){var s=this.basePath+"/workgroups/{id}".replace("{id}",String(e)),a={},r=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter id when calling changeName");if(!t)throw new Error("Missing required parameter iWorkgroupName when calling changeName");var o={method:"POST",url:s,json:!0,data:t,params:a,headers:r};return i&&(o=this.extendObj(o,i)),this.$http(o)},e.prototype.inviteUser=function(e,t,i){var s=this.basePath+"/workgroups/{id}/invites".replace("{id}",String(e)),a={},r=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter id when calling inviteUser");if(!t)throw new Error("Missing required parameter iInvite when calling inviteUser");var o={method:"POST",url:s,json:!0,data:t,params:a,headers:r};return i&&(o=this.extendObj(o,i)),this.$http(o)},e.prototype.removeUser=function(e,t,i){var s=this.basePath+"/workgroups/{id}/invites".replace("{id}",String(e)),a={},r=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter id when calling removeUser");if(!t)throw new Error("Missing required parameter iRemoveUsers when calling removeUser");var o={method:"DELETE",url:s,json:!0,data:t,params:a,headers:r};return i&&(o=this.extendObj(o,i)),this.$http(o)},e.prototype.getWorkgroupUsers=function(e,t){var i=this.basePath+"/workgroups/{id}/users".replace("{id}",String(e)),s={},a=this.extendObj({},this.defaultHeaders);if(!e)throw new Error("Missing required parameter id when calling getWorkgroupUsers");var r={method:"GET",url:i,json:!0,params:s,headers:a};return t&&(r=this.extendObj(r,t)),this.$http(r)},e.$inject=["$http","$httpParamSerializer"],e}();e.DefaultApi=t}(t=e.Swagger||(e.Swagger={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){"use strict";i.swaggerServiceName="bsSwaggerService";var s=function(){function t(t,i){this.$http=t,this.serverConfig=i;var s=void 0;this.apiClient=new e.Common.Services.Swagger.DefaultApi(this.$http,s,this.serverConfig.publicV2ApiBaseUrl)}return t.$inject=["$http",e.Common.Services.ServerConfig.serverConfigServiceName],t}();i.SwaggerService=s,t.commonModule.service(i.swaggerServiceName,["$http",e.Common.Services.ServerConfig.serverConfigServiceName,function(e,t){return new s(e,t)}])}(s=i.Swagger||(i.Swagger={}))}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.serviceName="toastr",e.commonModule.service(t.serviceName,function(){return new i});var i=function(){function e(){}return e.prototype.success=function(e){return toastr.success(e)},e.prototype.error=function(e){return toastr.error(e)},e.prototype.warning=function(e){return toastr.warning(e)},e.prototype.info=function(e){return toastr.info(e)},e}();t.Toastr=i}(i=t.Toastr||(t.Toastr={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.formDirectiveName="bsUpdateQcStatusForm";var i=function(){function t(){this.template=e.Templates.updateQcStatusForm,this.restrict="E",this.scope={options:"=",columnHeaderLabel:"@"},this.controller=["$scope",function(t){t.availableOptions=[{label:"QC Passed",value:e.Interfaces.V2.QcStatus.QC_PASSED},{label:"QC Failed",value:e.Interfaces.V2.QcStatus.QC_FAILED}],t.filterCurrentQcStatusOption=function(e){return t.options.areAllQcStatusesAlike&&t.options.selections[0].QcStatus===e.value?void 0:e}}]}return t}();t.UpdateQcStatusFormDirective=i,e.commonModule.directive(t.formDirectiveName,function(){return new i})}(t=e.ChangeQc||(e.ChangeQc={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.QC_STATUS_CHANGED_EVENT="qcStatusChanged";var i=function(){function e(e,t){this.$q=e,this.modalDialog=t}return e.prototype.showModal=function(e,t){var i=this;t.areAllQcStatusesAlike=e.areAllQcStatusesAlike(t.selections),this.modalDialog.bootstrapConfirm({bodyTemplate:e.modalBodyTemplate,headerTemplate:e.modalHeaderTemplate,dialogScope:{options:t},confirmLabel:t.areAllQcStatusesAlike?"Save":"OK",showCancelButton:t.areAllQcStatusesAlike,onBeforeConfirmAsync:function(){var s=i.$q.defer();return t.areAllQcStatusesAlike?e.saveAllStatuses(t,s):s.resolve(),s.promise},isConfirmDisabled:function(){return t.areAllQcStatusesAlike&&null===t.status},ngClass:{"modal-small":!0}}).then(function(t){e.onQcChanged(t)},function(){})},e}();t.ChangeQcService=i,t.changeQcServiceName="changeQcStatus",e.commonModule.service(t.changeQcServiceName,["$q",e.Services.ModalDialog.serviceName,i])}(i=t.ChangeQc||(t.ChangeQc={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e,t,i){this.$rootScope=e,this.$q=t,this.entityName=i}return t.prototype.areAllQcStatusesAlike=function(e){if(!angular.isArray(e)||0===e.length)return!1;for(var t=e[0],i=1;i<e.length;i++){var s=e[i];if(s.QcStatus!==t.QcStatus)return!1;t=s}return!0},t.prototype.onQcChanged=function(t){if(t&&t.length>0){var i=t.length>1?t.length+" "+this.entityName+" QC statuses changed":this.entityName+" QC status changed";toastr.success(i),this.$rootScope.$broadcast(e.QC_STATUS_CHANGED_EVENT,t[0].QcStatus)}},t}();e.AbstractChangeQcStrategy=t}(t=e.ChangeQc||(e.ChangeQc={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){"use strict";i.orgCacheServiceName="bsOrgCacheService";var s=function(){function t(e,t,i){this.$cacheFactory=e,this.$q=t,this.apiClient=i.apiClient}return t.prototype.getCache=function(e){var t=this.$cacheFactory.get(e);return t?t:this.$cacheFactory(e)},t.prototype.getWorkgroupUsersCache=function(e){var t=this,i=this.getCache("orgUsersCache");if(i.get(e))return i.get(e);var s=this.apiClient.getWorkgroupUsers(e,{withCredentials:!0,cache:!0}).then(function(s){return i.put(e,t.$q.when(s.data)),s.data});return i.put(e,s),s},t.prototype.getCurrentUserWorkgroupsCache=function(e){var t=this,i=this.getCache("currentUserOrgCache");if(i.get(e))return i.get(e);var s=this.apiClient.getCurrentUserWorkgroups({withCredentials:!0,cache:!0}).then(function(s){return i.put(e,t.$q.when(s.data)),s.data});return i.put(e,s),s},t.inject=["$cacheFactory","$q",e.Common.Services.Swagger.swaggerServiceName],t}();i.OrganizationCacheService=s,t.commonModule.service(i.orgCacheServiceName,["$cacheFactory","$q",e.Common.Services.Swagger.swaggerServiceName,function(e,t,i){return new s(e,t,i)}])}(i=t.OrganizationCache||(t.OrganizationCache={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){"use strict";i.serviceName="bsContextSwitch";var s=function(){function t(e,t,i){this.serverConfig=e,this.swaggerService=t,this.orgCacheService=i,this.userId=e.currentUserId,this.apiClient=t.apiClient}return t.prototype.getCurrentUserOrg=function(){return this.orgCacheService.getCurrentUserWorkgroupsCache(this.userId)},t.prototype.setCurrentUser=function(e){var t={};return t.id=e,this.apiClient.setCurrentUser(t,{withCredentials:!0})},t.$inject=[e.Common.Services.ServerConfig.serverConfigServiceName,e.Common.Services.Swagger.swaggerServiceName,e.Common.OrganizationCache.orgCacheServiceName],t}();i.Service=s,t.commonModule.service(i.serviceName,[e.Common.Services.ServerConfig.serverConfigServiceName,e.Common.Services.Swagger.swaggerServiceName,e.Common.OrganizationCache.orgCacheServiceName,function(e,t,i){return new s(e,t,i)}])}(i=t.ContextSwitch||(t.ContextSwitch={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.directiveName="bsContextSwitch",i.inactiveSubscriptionErrorCode="BASESPACE.WORKGROUPS.MISSING_OR_INACTIVE_SUBSCRIPTION",t.commonModule.directive(i.directiveName,["$window",e.Common.Services.currentUserServiceName,t.Services.Api.apiServiceName,e.Common.ContextSwitch.serviceName,t.Services.Toastr.serviceName,t.Services.ModalDialog.serviceName,function(e,t,i,a,r,o){return new s(e,t,i,a,r,o)}]);var s=function(){function s(e,i,s,a,r,o){var n=this;this.restrict="E",this.scope={selectedContext:"="},this.template=t.Templates.contextSwitch,this.currentUserService=i,this.publicApi=s,this.contextSwitchService=a,this.window=e,this.toastr=r,this.modalDialogService=o,this.controller=["$scope","$window",function(e,t){e.bindOrganizations=function(){return n.bindOrganizations(e)},e.onClickContextSwitch=function(t){return n.onClickContextSwitch(t,e)},e.hasOrgs=!1,e.bindOrganizations()}]}return s.prototype.bindOrganizations=function(t){var i=this;t.contextItems=t.contextItems||[],0===t.contextItems.length&&this.currentUserService.getCurrentUser().then(function(s){s.Id===s.LoggedInUser.Id&&(s.Name=e.Common.Interfaces.UserTypes.Personal),t.selectedContext=s,t.isLoading=!1,i.contextSwitchService.getCurrentUserOrg().then(function(i){i.Items.length>0&&(t.hasOrgs=!0,s.LoggedInUser.Name=e.Common.Interfaces.UserTypes.Personal,t.contextItems.push(s.LoggedInUser),t.contextItems=t.contextItems.concat(i.Items))})})},s.prototype.onClickContextSwitch=function(e,s){var a=this;s.selectedContext.Id!=e&&this.contextSwitchService.setCurrentUser(e).then(function(e){a.window.location.reload()},function(e){e.data.ErrorCode===i.inactiveSubscriptionErrorCode?a.modalDialogService.bootstrapConfirm({headerTemplate:"<h4>Activate Your BaseSpace Subscription</h4>",confirmLabel:"Done",bodyTemplate:t.Templates.updateSubscriptionModalBody,showCancelButton:!1}):toastr.error(e.data.ErrorMessage)})},s}();i.Directive=s}(i=t.ContextSwitch||(t.ContextSwitch={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(){}return e}();t.Service=i,t.serviceName="pageContext",e.commonModule.service(t.serviceName,[i])}(t=e.PageContext||(e.PageContext={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function e(){this.sites=[{href:"/",title:"Sequence<br/> Hub","class":"sh",isActive:function(){return!0}},{href:"https://www.nextbio.com/b/nextbio.nb",title:"Correlation<br/> Engine","class":"ce",isActive:function(){return!1}},{href:"http://designstudio.illumina.com/",title:"Design<br/> Studio","class":"ad",isActive:function(){return!1}}],this.currentSite=this.sites[0]}return e}();t.Service=i,t.serviceName="appSwitcher",e.commonModule.service(t.serviceName,[i])}(i=t.AppSwitcher||(t.AppSwitcher={}))}(t=e.GlobalHeader||(e.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(){this.replace=!0,this.template=e.Templates.appSwitcherDesktop,this.restrict="E",this.scope=!1}return t}();t.DesktopDirective=i,t.desktopDirectiveName="bsAppSwitcherDesktop",e.commonModule.directive(t.desktopDirectiveName,[function(){return new i}])}(i=t.AppSwitcher||(t.AppSwitcher={}))}(t=e.GlobalHeader||(e.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(){this.replace=!0,this.template=e.Templates.appSwitcherMobile,this.restrict="E",this.scope=!1}return t}();t.MobileDirective=i,t.mobileDirectiveName="bsAppSwitcherMobile",e.commonModule.directive(t.mobileDirectiveName,[function(){return new i}])}(i=t.AppSwitcher||(t.AppSwitcher={}))}(t=e.GlobalHeader||(e.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(){this.replace=!0,this.template=e.Templates.menuMobile,this.restrict="E",this.scope=!1}return t}();t.MobileDirective=i,t.mobileDirectiveName="bsMenuMobile",e.commonModule.directive(t.mobileDirectiveName,[function(){return new i}])}(i=t.Menu||(t.Menu={}))}(t=e.GlobalHeader||(e.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.globalHeaderDataPreRegistryService="GlobalHeaderDataPreRegistry";var i=function(){function e(){this.getGlobalHeaderListItems=function(e){return[{id:"dashboard",href:e+"/dashboard",title:"Dashboard",isActive:function(){return!0},target:"_self"},{id:"prep",href:e+"/lab",title:"Prep",isActive:function(){return!0},target:"_self"},{id:"runs",href:e+"/runs",title:"Runs",isActive:function(){return!0},target:"_self"},{id:"projects",href:e+"/projects",title:"Projects",isActive:function(){return!0},target:"_self"},{id:"apps",href:e+"/apps",title:"Apps",isActive:function(){return!0},target:"_self"},{id:"datacentral",href:e+"/datacentral",title:"Public Data",isActive:function(){return!0},target:"_self"}]},this.getGlobalHeaderSecondaryListItems=function(e){return{}}}return e}();t.GlobalHeaderDataPreRegistry=i,e.commonModule.service(t.globalHeaderDataPreRegistryService,function(){return new i})}(t=e.GlobalHeader||(e.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.globalHeaderDataRegistryService="GlobalHeaderDataRegistry";var s=function(){function e(e){var t=this;this.getGlobalHeaderListItems=function(e){return[{id:"dashboard",href:e+"/dashboard",title:"Dashboard",isActive:function(){return!0}},{id:"myData",href:e+t.siteNavigationService.urlProjectList(),title:"My Data",isActive:function(){return!0}},{id:"prep",href:e+"/lab",title:"Prep",isActive:function(){return!0}},{id:"apps",href:e+"/apps",title:"Apps",isActive:function(){return!0}},{id:"datacentral",href:e+"/datacentral",title:"Public Data",isActive:function(){return!0}}]},this.getGlobalHeaderSecondaryListItems=function(e){return{myData:[{id:"projects",href:e+t.siteNavigationService.urlProjectList(),title:"Projects",isActive:function(){return!0}},{id:"registry_biosamples",href:e+t.siteNavigationService.urlBiosamplesList(),title:"Biosamples",isActive:function(){return!0;

}},{id:"runs",href:e+"/runs",title:"Runs",isActive:function(){return!0}},{id:"registry_analyses",href:e+"/analyses",title:"Analyses",isActive:function(){return!0}}]}},this.siteNavigationService=e}return e}();i.GlobalHeaderRegistry=s,t.commonModule.service(i.globalHeaderDataRegistryService,[e.Common.Services.siteNavigationServiceName,function(e){return new s(e)}])}(i=t.GlobalHeader||(t.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.globalHeaderDirectiveName="bsGlobalHeader",t.commonModule.directive(i.globalHeaderDirectiveName,["$window","$document","$timeout","$q",t.Services.ServerConfig.serverConfigServiceName,t.Services.currentUserServiceName,t.Services.siteNavigationServiceName,t.Services.Api.apiServiceName,t.ContextSwitch.serviceName,t.GlobalHeader.AppSwitcher.serviceName,function(e,t,i,a,r,o,n,l,c,u){return new s(e,t,i,a,r,o,n,l,c,u)}]);var s=function(){function s(e,s,a,r,o,n,l,c,u,d){var p=this;this.$window=e,this.$document=s,this.$timeout=a,this.$q=r,this.serverConfig=o,this.currentUserService=n,this.contextSwitchService=u,this.appSwitcherService=d,this.template=t.Templates.globalHeader,this.scope={basespaceUrl:"@?",disableTrash:"@?",disableSearch:"@?"},this.controller=["$scope","$injector",function(e,t){e.dropdownSites=d.sites.filter(function(e){return!e.isActive()}),e.currentSite=d.currentSite,e.disableTrash||c.TrashList.get({},function(t){e.trashCount=t.Response.TotalCount.toString()}),e.storeWebsiteBaseUrl=p.serverConfig.storeWebsiteBaseUrl||"",e.isMenuButtonActive=function(t){var i=l.getCurrentLocation();if(i){if(i=i.replace(/\./g,"_"),!e.globalHeaderSecondaryListItems[t])return t===i;for(var s=e.globalHeaderSecondaryListItems[t],a=0,r=s.length;r>a;a++)if(s[a].id===i)return!0}return!1},p.currentUserService.getCurrentUser(!0).then(function(s){if(e.user=s,s.Features){e.basespaceUrl||(e.basespaceUrl="");var a=s.Features.indexOf("BioSampleRegistry")>-1?i.globalHeaderDataRegistryService:i.globalHeaderDataPreRegistryService,r=t.get(a);e.globalHeaderListItems=r.getGlobalHeaderListItems(e.basespaceUrl),e.globalHeaderSecondaryListItems=r.getGlobalHeaderSecondaryListItems(e.basespaceUrl),p.$timeout(function(){e.slideToActive()})}}),e.subMenuState={},e.toggleSubMenu=function(t,i){e.subMenuState[i]=e.subMenuState.hasOwnProperty(i)?!e.subMenuState[i]:!0;for(var s in e.subMenuState)s!==i&&(e.subMenuState[s]=!1);t.preventDefault(),t.stopPropagation()},e.userAccountMenuListItems=[{id:"settings",href:e.basespaceUrl+"/settings",title:"Settings",isActive:function(){return!0}},{id:"trash",href:e.basespaceUrl+"/settings/trash",title:"Trash",isActive:function(){return!0}},{id:"terms",href:e.basespaceUrl+"/agreements/toc",title:"Terms",isActive:function(){return!0}},{id:"basespace blog",href:"http://blog.basespace.illumina.com",title:"Basespace Blog",isActive:function(){return!0}},{id:"logout",href:e.basespaceUrl+"/auth/logout",title:"Logout",isActive:function(){return!0}}],e.onClickContextSwitch=function(t){return p.onClickContextSwitch(t,e)},p.bindOrganizations(e)}],this.link=function(e,t,i){e.markerStyle={opacity:.35,left:null,width:null},e.moveMarker=function(t){var i=angular.element(t.currentTarget)[0];e.markerStyle.left=i.offsetLeft+"px",e.markerStyle.width=i.clientWidth+"px"},e.slideToActive=function(){var i=t[0].getElementsByClassName("navbar-menu-ul"),s=angular.element(i).find(".active")[0];s&&(e.markerStyle.width=s.clientWidth+"px",e.markerStyle.left=s.offsetLeft+"px")}}}return s.prototype.bindOrganizations=function(t){t.organizations=null;var i=[];i.push(this.currentUserService.getCurrentUser()),i.push(this.contextSwitchService.getCurrentUserOrg()),this.$q.all(i).then(function(i){var s=i.shift(),a=i.shift();if(t.userOrOrgContext=s,a.Items.length>0){s.LoggedInUser.Name=e.Common.Interfaces.UserTypes.Personal;var r=[].concat(a.Items);r.unshift(s.LoggedInUser),t.organizations=r}else t.organizations=[];t.$applyAsync()},function(e){t.organizations=[]})},s.prototype.onClickContextSwitch=function(e,t){var i=this;t.userOrOrgContext.Id!=e&&this.contextSwitchService.setCurrentUser(e).then(function(e){i.$window.location.reload()})},s}();i.GlobalHeaderDirective=s}(i=t.GlobalHeader||(t.GlobalHeader={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.moduleName="bs.Common.Filters",e.commonModule.filter("readLengthString",function(){return function(e){var t="";return e?(e.IsPairedEnd?t=e.Read1==e.Read2?"2 x "+e.Read1:e.Read1+", "+e.Read2:e.Read1&&(t=String(e.Read1)),t):t}}),e.commonModule.filter("genome",function(){return function(e){return e&&e.DisplayName?e.DisplayName:"(Unknown genome)"}}),e.commonModule.filter("fileIcon",function(){return function(e){if(!e||!e.Name)return"";var t=["gz","zip","gzip"],i="",s=e.Name.split("."),a=s.pop(),r=s.pop();i=a&&r&&t.indexOf(a.toLowerCase())>-1?r+"."+a:a;var o="";switch(i){case"pdf":o="icon-pdf";break;case"vcf":o="icon-vcf";break;case"fq":case"fastq":o="icon-fq";break;case"xls":case"csv":case"tsv":case"tab":o="icon-spreadsheet";break;case"gif":case"jpeg":case"jpg":case"png":case"tiff":case"tif":case"bmp":o="icon-image";break;default:o="icon-file"}return o}}),e.commonModule.filter("runTotalSize",["bytesFilter",function(t){return function(i){var s="--";if(i&&i.Status&&angular.isDefined(i.TotalSize))switch(i.Status){case e.Services.Api.ApiResourceStatus.RUNNING:case e.Services.Api.ApiResourceStatus.UPLOADING:if(i.TotalSize<1)break;default:s=t(i.TotalSize)}return s}}]),e.commonModule.filter("runInstrumentIcon",function(){return function(t){if(!t||!t.InstrumentType)return"icon-HiSeq";var i="";switch(t.InstrumentType){case e.Interfaces.InstrumentTypes.MiniSeq:i="icon-MiniSeq";break;case e.Interfaces.InstrumentTypes.MiSeq:case e.Interfaces.InstrumentTypes.MiSeqDx:i="icon-MiSeq";break;case e.Interfaces.InstrumentTypes.HiSeqX:i="icon-HiSeq";break;case e.Interfaces.InstrumentTypes.Project11:case e.Interfaces.InstrumentTypes.NextSeq:i="icon-nextseq";break;case e.Interfaces.InstrumentTypes.HiSeq1000:case e.Interfaces.InstrumentTypes.HiSeq1500:case e.Interfaces.InstrumentTypes.HiSeq2000:case e.Interfaces.InstrumentTypes.HiSeq2500:case e.Interfaces.InstrumentTypes.HiSeq3000:case e.Interfaces.InstrumentTypes.HiSeq4000:case e.Interfaces.InstrumentTypes.HiScan:case e.Interfaces.InstrumentTypes.HiScanSQ:default:i="icon-HiSeq"}return i}}),e.commonModule.filter("stringFormat",function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return function(t){return t.replace(/\{(\d+)\}/g,function(t,i){return e[1*i+1]})}}),e.commonModule.filter("fractionToPercent",function(){return function(e,t,i){return void 0===t&&(t=2),void 0===i&&(i=!0),isNaN(e)?"0%":(100*e).toFixed(t)+(i?"%":"")}}),e.commonModule.filter("trashLabel",function(){return function(e){var t=1e3,i=1e4,s=1e5,a=Number(e);return a>=t&&i>a?e.substring(0,1).toString()+"k":a>=i&&s>a?e.substring(0,2).toString()+"k":a>=s?"!!!":e}}),e.commonModule.filter("stripWhiteSpace",function(){return function(e){return e.replace(/\s/g,"")}}),e.commonModule.filter("twitterTime",["$filter",function(e){return function(e){if(!angular.isDefined(e))return void 0;var t,i=moment.utc(e);return t=moment().utc().diff(i,"h")<=22?i.fromNow():i.format("MMM D, YYYY")}}]),e.commonModule.filter("durationTime",function(){return function(e,t){var i=moment.duration(e),s={year:i.years(),month:i.months(),day:i.days(),hour:i.hours(),minute:i.minutes(),second:i.seconds()},a="";for(var r in s){var o=s[r];if((o>0||r===t)&&(a=a+o+" "+r+(1!=o?"s":"")+" "),r===t)break}return a=a.trim()}}),e.commonModule.filter("logTime",function(){return function(e){if(!angular.isDefined(e))return void 0;var t=moment.utc(e);return t.format("h:mm:ssa UTC")}}),e.commonModule.filter("applicationIconSrc",[e.Services.Api.apiServiceName,function(e){return function(t){return t.Id?e.apiBaseUrl+"applications/"+t.Id+"/icon?ImageSize=Thumb":t.HrefLogo}}]),e.commonModule.filter("mapDataType",[e.Services.Mappings.dataMappingServiceName,function(e){return function(t,i,s){return e.map([t],i,s)[0]}}]),e.commonModule.filter("toLegalUrl",function(){return function(e){return encodeURIComponent(e.replace(/[^\w]+/g,"-"))}}),e.commonModule.filter("appStatusToDescription",[function(){var e={};return function(t,i){if(!i)return"";var s=e[t];return angular.isDefined(s)?s:(s="",i.forEach(function(i){var a=i.Description;e[i.Name]=a,i.Name==t&&(s=a)}),s)}}]),e.commonModule.filter("formatPersistenceLabel",function(){return function(e){return isFinite(e)?0===e?"Single use":e>=1e4?"One-time purchase":"Good for "+e+" day"+(Math.abs(e)>1?"s":""):""}}),e.commonModule.filter("statusIconClass",function(){return function(e){if(!angular.isString(e))return"";switch(e.toLowerCase().trim().replace(/\s/g,"")){case"complete":return"complete";case"failed":case"uploadfailed":return"failed";case"initializing":case"running":return"running";case"aborting":case"aborted":case"needsattention":case"timedout":return"needsattention";case"stopped":case"stopping":return"stopped";case"pending":case"planning":case"pendinganalysis":case"pendingexecution":case"pendingpayment":case"awaitingauthorization":return"pending";case"uploading":return"uploading";case"analyzing":return"analysis";default:return""}}}),e.commonModule.filter("orderObject",function(){return function(e,t){if(!angular.isObject(e))return e;var i=Object.keys(e);i.sort(function(e,t){return e.localeCompare(t)});var s={};return i.forEach(function(t){s[t]=e[t]}),s}}),e.commonModule.filter("limitObject",function(){return function(e,t){var i=parseInt(t),s={};for(var a in e){if(i--<=0)break;s[a]=e[a]}return s}}),e.commonModule.filter("basepairs",function(){return function(t,i,s){if(void 0===i&&(i=2),void 0===s&&(s="--"),t||0===t){var a=e.Utils.MathUtils.getBasePairUnits(t,i);if(a)return a.result+" "+a.basePairUnit.abbreviation}return s}}),e.commonModule.filter("abbreviateLargeNumber",function(){var e=1e3,t=Math.pow(e,2),i=Math.pow(e,3);return function(s,a){return void 0===a&&(a=2),s>=0&&e>s?s.toString():s>=e&&t>s?(s/e).toFixed(a)+"K":s>=t&&i>s?(s/t).toFixed(a)+"M":s>=i?(s/i).toFixed(a)+"B":s.toString()}}),e.commonModule.filter("max",function(){return function(e){var t;if(e)for(var i in e)(e[i]>t||void 0===t||null===t)&&(t=e[i]);return t}}),e.commonModule.filter("min",function(){return function(e){var t;if(e)for(var i in e)(e[i]<t||void 0===t||null===t)&&(t=e[i]);return t}}),e.commonModule.filter("emailToGravatarUrl",function(){return function(e,t){return void 0===t&&(t=24),"https://2.gravatar.com/avatar/"+$.md5(e)+"?s="+t+"&amp;d=identicon&amp;r=G"}}),e.commonModule.filter("operatorToSymbol",function(){var e={Equal:"=",LessThan:"<",GreaterThan:">",LessThanOrEqual:"<=",GreaterThanOrEqual:">=",NotEqual:"!=",Between:"[ ]",Outside:") ("};return function(t){return e[t]||""}}),e.commonModule.filter("numberEx",["numberFilter","$locale",function(e,t){var i=t.NUMBER_FORMATS;return function(t,s){var a=!isNaN(parseFloat(t))&&isFinite(t);if(!a)return t;var r=e(t,s),o=r.indexOf(i.DECIMAL_SEP);if(-1==o)return r;var n=r.substring(0,o),l=(Number(r.substring(o))||"").toString();return n+l.substring(1)}}])}(t=e.Filters||(e.Filters={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){var s=e.Common.Services.BsEnumDictionary;t.commonModule.filter("enumDisplayName",[e.Common.Services.bsEnumDictionaryServiceName,function(e){var t=function(t,i){return e.getDisplayName(i,t)};return t}]),t.commonModule.filter("enumIsError",[e.Common.Services.bsEnumDictionaryServiceName,function(e){var t=function(t,i){return e.isError(i,t)};return t}]),t.commonModule.filter("appSessionCombinedStatus",[e.Common.Services.bsEnumDictionaryServiceName,function(t){var i=e.Common.Interfaces.AppSessionStatus.COMPLETE,a="Undefined",r=function(e){return e.ExecutionStatus!==i?t.getDisplayName(s.APP_SESSION_EXECUTION_STATUS_ENUM,e.ExecutionStatus):e.ExecutionStatus===i&&e.QcStatus===a?t.getDisplayName(s.APP_SESSION_EXECUTION_STATUS_ENUM,e.ExecutionStatus):t.getDisplayName(s.APP_SESSION_QC_STATUS_ENUM,e.QcStatus)};return r}]),t.commonModule.filter("appSessionCombinedStatusIsError",function(){return function(t){return t.ExecutionStatus===e.Common.Interfaces.AppSessionStatus.NEEDS_ATTENTION||"QcFailed"===t.QcStatus}})}(s=i.Enum||(i.Enum={}))}(i=t.Filters||(t.Filters={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.moduleName="bs.Common.Filters.Strings",e.commonModule.filter("charactersTruncate",function(){return function(e,t,i){if(isNaN(t))return e;if(0>=t)return"";if(e&&e.length>t){if(e=e.substring(0,t),i)for(;" "===e.charAt(e.length-1);)e=e.substr(0,e.length-1);else{var s=e.lastIndexOf(" ");-1!==s&&(e=e.substr(0,s))}return e+"…"}return e}}),e.commonModule.filter("splitCharactersTruncate",function(){return function(e,t){if(isNaN(t))return e;if(0>=t)return"";if(e&&e.length>t){var i=e.substring(0,t/2),s=e.substring(e.length-t/2,e.length);return i+"..."+s}return e}}),e.commonModule.filter("wordsTruncate",function(){return function(e,t){if(isNaN(t))return e;if(0>=t)return"";if(e){var i=e.split(/\s+/);i.length>t&&(e=i.slice(0,t).join(" ")+"…")}return e}}),e.commonModule.filter("isNotEmptyString",function(){return function(e){return angular.isString(e)&&e.trim().length>0}})}(i=t.Strings||(t.Strings={}))}(t=e.Filters||(e.Filters={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){"use strict";t.bstooltipnumberName="bsTooltipNumber";var i=function(e){var t=e("number");return function(e,i){return angular.isDefined(e)?t(e,i).toString():"--"}};e.commonModule.filter(t.bstooltipnumberName,["$filter",i])}(t=e.Filters||(e.Filters={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.searchUrlManagerFactoryName="searchUrlManagerFactory",e.commonModule.service(t.searchUrlManagerFactoryName,["$location","$routeParams",function(e){return new i(e)}]);var i=function(){function e(e){this.$location=e}return e.prototype.getManager=function(e){return new s(this.$location,e)},e}();t.SearchUrlManagerFactory=i;var s=function(){function e(e,t){this.$location=e,this.$scope=t,this._initListeners(),this._applySettingsFromRoute()}return e.prototype._applySettingsFromRoute=function(){var e=this.$location.search();e.query&&(this.$scope.rawQuery=e.query),e.type&&(this.$scope.searchFilters.currentResourceType=e.type),e.filters&&(this.$scope.searchFilters.preselections=e.filters)},e.prototype._initListeners=function(){var e=this;this.$scope.$watch("rawQuery",function(t,i){t!=i&&e.$location.search("query",t)}),this.$scope.$watch("searchFilters.preselections",function(t,i){t!=i&&e.$location.search("filters",t)},!0),this.$scope.$watch("searchFilters.currentResourceType",function(t,i){if(t!=i){var s="uiAll"==t?null:t;e.$location.search("type",s)}})},e}();t.SearchUrlManager=s}(i=t.Search||(t.Search={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.MODIFIED_ON="modifiedon",e.SCORE="score",e}();e.ServerSortFields=t;var i=function(){function e(){}return e.ASC="asc",e.DESC="desc",e}();e.ServerSortDirection=i;var s=function(){function e(){}return e.LIMIT="limit",e.OFFSET="offset",e}();e.ServerPagingParams=s;var a=function(){function e(){}return e.SORT_BY="sortby",e.SORT_DIR="sortdir",e}();e.ServerSortParams=a;var r=function(){function e(){this.items=[],this.offset=0,this.limit=25,this.totalCount=0,this.sortBy=t.MODIFIED_ON,this.sortDir=i.DESC}return e.prototype.setOffset=function(e,t){return this.offset=e,t?this.fetchItems(t):this.fetchItems()},e.prototype.sort=function(e,t,s){return void 0===t&&(t=!0),this.sortBy=e,this.sortDir=t?i.DESC:i.ASC,this.offset=0,this.fetchItems(s)},e.prototype.fetchItems=function(e,t,i){return this.items.slice(this.offset,this.offset+this.limit)},e}();e.GridDataSource=r}(t=e.TangGrid||(e.TangGrid={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(e){function t(t){void 0===t&&(t=null),e.call(this),this.isLoading=!1,this.customParams={},this.queryMethod=t}return __extends(t,e),t.prototype.fetchItems=function(e,t,i){throw"fetchItems() not implemented"},t}(e.Directives.TangGrid.GridDataSource);t.AbstractApiGridDataSource=i}(i=t.TangGrid||(t.TangGrid={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e){void 0===e&&(e=null),this.queryMethod=e}return e.prototype.getDataSource=function(){return new s(this.queryMethod)},e}();t.LegacyApiGridDataSourceFactory=i;var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.fetchItems=function(e,t,i){var s=this,a={offset:this.offset,limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy};return a=angular.extend(a,this.customParams),a=angular.extend(a,e),this.isLoading=!0,this.queryMethod(a,function(e){s.items=[];var i=e.results;s.totalCount=e.totalCount;for(var a=0;a<e.results.length;a++)s.items.push(i[a]);s.isLoading=!1,t&&t.apply(s,e)},function(e){s.isLoading=!1,i&&i.apply(s,e)}),this.items},t}(e.AbstractApiGridDataSource);t.LegacyApiGridDataSource=s}(t=e.Legacy||(e.Legacy={}))}(t=e.TangGrid||(e.TangGrid={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.fetchItems=function(e,t,i){var s=this,a={offset:this.offset,limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy};return a=angular.extend(a,this.customParams),a=angular.extend(a,e),this.isLoading=!0,this.queryMethod(a,function(e){s.items=[];var i=e.Response.Items;s.totalCount=e.Response.TotalCount,s.offset=e.Response.Offset,s.limit=e.Response.Limit;for(var a=0;a<e.Response.Items.length;a++)s.items.push(i[a]);s.isLoading=!1,t&&t.apply(s,e)},function(e){s.isLoading=!1,i&&i.apply(s,e)}),this.items},t}(e.AbstractApiGridDataSource);t.V1ApiGridDataSource=i}(t=e.V1||(e.V1={}))}(t=e.TangGrid||(e.TangGrid={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e){void 0===e&&(e=null),this.queryMethod=e}return t.prototype.getDataSource=function(){return new e.V1ApiGridDataSource(this.queryMethod)},t}();e.V1ApiGridDataSourceFactory=t}(t=e.V1||(e.V1={}))}(t=e.TangGrid||(e.TangGrid={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.fetchItems=function(e,t,i){var s=this,a={offset:this.offset,limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy};return angular.extend(a,this.customParams),angular.extend(a,e),this.isLoading=!0,this.queryMethod(a,function(e){s.items=[];var i=e.Items;s.totalCount=e.Paging.TotalCount,s.offset=e.Paging.Offset,s.limit=e.Paging.Limit;for(var a=0;a<e.Items.length;a++)s.items.push(i[a]);s.isLoading=!1,t&&t.apply(s,e)},function(e){s.isLoading=!1,i&&i.apply(s,e)}),this.items},t}(e.AbstractApiGridDataSource);t.V2ApiGridDataSource=i}(t=e.V2||(e.V2={}))}(t=e.TangGrid||(e.TangGrid={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(e){void 0===e&&(e=null),this.queryMethod=e}return t.prototype.getDataSource=function(){return new e.V2ApiGridDataSource(this.queryMethod)},t}();e.V2ApiGridDataSourceFactory=t}(t=e.V2||(e.V2={}))}(t=e.TangGrid||(e.TangGrid={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(e){function t(t,i,s){e.call(this),this.publicApi=t,this.$q=i,this.deferrals=[]}return __extends(t,e),t.prototype.rejectDeferrals=function(){for(var e=0;e<this.deferrals.length;e++)this.deferrals[e].reject(),delete this.deferrals[e];this.deferrals=[]},t}(e.Directives.TangGrid.GridDataSource);t.BaseServerDataSource=i}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.appVersionsGridDataSourceFactoryName="appVersionsGridDataSourceFactory",t.commonModule.factory(i.appVersionsGridDataSourceFactoryName,[i.Api.apiServiceName,function(e){return new s(e)}]);var s=function(){function e(e){this.publicApi=e}return e.prototype.getAppVersionsDataSource=function(e){return new a(this.publicApi,e)},e}();i.AppVersionsGridDataSourceFactory=s;var a=function(e){function t(t,i){e.call(this),this.isLoading=!1,this.publicApi=t,this.appId=i,this.sortBy="versionnumber"}return __extends(t,e),t.prototype.fetchItems=function(e,t,i){var s=this,a={offset:this.offset,limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy,Id:this.appId};a=angular.extend(a,e),this.isLoading=!0;var r=this.publicApi.Application.getVersions(a,function(e){s.items=[];var i=e.Response.Items;s.totalCount=r.Response.TotalCount;for(var a=0;a<r.Response.Items.length;a++)s.items.push(i[a]);s.isLoading=!1,t&&t.call(s,e)},function(e){s.isLoading=!1,i&&i.call(s,e)});return this.items},t}(e.Common.Directives.TangGrid.GridDataSource);i.AppVersionsGridDataSource=a}(i=t.Services||(t.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.searchFilterName="searchFilterService",e.commonModule.service(t.searchFilterName,["$q",function(e){return new i(e)}]);var i=function(){function e(e){this.$q=e}return e.prototype.fetchFilterData=function(e){var t=this,i=this.$q.defer();return e.dataSource.apiResource.query({limit:e.dataSource.limit,sortBy:e.dataSource.sortBy,sortDir:e.dataSource.sortDir},function(s){t.onFetchFilterDataSuccess(e,s,i)}),i.promise},e.prototype.onFetchFilterDataSuccess=function(e,t,i){e.choices=[];var s=t.Response;s||(s=t),this.appendValueLabel(e,s.Items),s.TotalCount>e.dataSource.limit?this.iterateUntil(e,1,Math.ceil(s.TotalCount/e.dataSource.limit),i):i.resolve()},e.prototype.iterateUntil=function(e,t,i,s){var a=this;e.dataSource.apiResource.query({limit:e.dataSource.limit,sortBy:e.dataSource.sortBy,sortDir:e.dataSource.sortDir,offset:e.dataSource.limit*t},function(r){a.onIterateSuccess(e,t,i,r,s)})},e.prototype.onIterateSuccess=function(e,t,i,s,a){this.appendValueLabel(e,s.Response.Items),t++,t==i?a.resolve():this.iterateUntil(e,t,i,a)},e.prototype.appendValueLabel=function(e,t){for(var i=0;i<t.length;i++){var s=t[i];e.choices.push({value:e.choiceValueAccessor(s),label:e.choiceLabelAccessor(s)})}},e}();t.SearchFilterService=i}(i=t.Search||(t.Search={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.searchGridDataSourceFactoryName="searchGridDataSourceFactory",e.commonModule.factory(i.searchGridDataSourceFactoryName,[t.Api.apiServiceName,"$q",i.searchQueryServiceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function e(e,t,i){this.api=e,this.$q=t,this.searchQuery=i}return e.prototype.getSearchList=function(e){return void 0===e&&(e=null),new a(this.api,this.$q,this.searchQuery,e)},e}();i.SearchGridDataSourceFactory=s;var a=function(i){function s(e,t,s,a){void 0===a&&(a=null),i.call(this,e,t,s),this.isLoading=!1,this.baseQuery="",this._searchFilters=[],this._prevQueryString=null,this._prevScope=null,this.restResource=this.publicApi.Search,this.searchQuery=s,this.resourceConfig=a,this.useStrictPaging=!1}return __extends(s,i),s.prototype.updateRawSearchQuery=function(t){return this._rawTextQuery=t,this.sortBy=this._rawTextQuery?e.Directives.TangGrid.ServerSortFields.SCORE:e.Directives.TangGrid.ServerSortFields.MODIFIED_ON,this.fetchItems()},s.prototype.setSearchFilters=function(e){this._searchFilters=e,this.fetchItems()},s.prototype.fetchItems=function(i,s,a){var r=this;this.rejectDeferrals();var o=this.searchQuery.buildQueryString(this.baseQuery,this._rawTextQuery,this._searchFilters,null,this.resourceConfig);(null!=this._prevQueryString&&o!=this._prevQueryString||this.scope!=this._prevScope)&&(this.offset=0),this._prevQueryString=o,this._prevScope=this.scope;var n={offset:this.offset,limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy,query:o};this.scope&&(n.scope=this.scope),this.useStrictPaging&&this.sortBy==e.Directives.TangGrid.ServerSortFields.SCORE&&(n.pagingStyle=t.Api.PagingStyles.STRICT),n=angular.extend(n,i),this.isLoading=!0;this.restResource.query(n,this._getWrappedSuccessCallback(s),function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];r.isLoading=!1,a&&a.apply(r,e)});return this.items},s.prototype.fetchNewlyCreatedResource=function(t,i,s,a){var r=this;void 0===s&&(s=5),void 0===a&&(a=1e3);var o=this.searchQuery.buildQueryString(this.baseQuery,this._rawTextQuery,this._searchFilters,t);this.offset=0;var n={offset:this.offset,limit:this.limit,sortDir:e.Directives.TangGrid.ServerSortDirection.DESC,sortBy:e.Directives.TangGrid.ServerSortFields.SCORE,query:o,scope:this.scope},l=0,c=function(e){var t=e.Response.Items,o=t.filter(i);o.length<1&&(l++,s>l?setTimeout(function(){r.fetchItems(n,c)},a):alert("Sorry, we encountered a problem trying to select your newly created project. Please refresh the page and try again."))};this.fetchItems(n,c)},s.prototype._getWrappedSuccessCallback=function(e){var t=this,i=this.$q.defer();return i.promise.then(function(i){t.items=[];var s=i.Response.Items;t.totalCount=i.Response.TotalCount;for(var a=0;a<i.Response.Items.length;a++){var r=angular.extend({},s[a],{sortIndex:i.Response.Offset+a});t.items.push(r)}t.isLoading=!1,e&&e.apply(t,arguments)}),this.deferrals.push(i),function(){i.resolve(arguments[0])}},s}(t.BaseServerDataSource);i.SearchGridDataSource=a}(i=t.Search||(t.Search={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.searchTypeaheadDataSourceFactoryName="searchTypeaheadDataSourceFactory",e.commonModule.factory(i.searchTypeaheadDataSourceFactoryName,[t.Api.apiServiceName,"$q",i.searchQueryServiceName,t.BsResourceDictionary.serviceName,function(e,t,i,a){return new s(e,t,i,a)}]);var s=function(){function e(e,t,i,s){this.api=e,this.$q=t,this.searchQuery=i,this.resourceDictionary=s}return e.prototype.getNewSource=function(){return new a(this.api,this.$q,this.searchQuery,this.resourceDictionary)},e}();i.SearchTypeaheadDataSourceFactory=s;var a=function(){function t(e,t,i,s){this.isLoading=!1,this.limit=3,this.sortDir="DESC",this.sortBy="Score",this.publicApi=e,this.$q=t,this.searchApiResource=this.publicApi.Search,this.searchQuery=i,this.resourceDictionary=s,this.searchableResourceTypes=[this.resourceDictionary.sample,this.resourceDictionary.project,this.resourceDictionary.run,this.resourceDictionary.appresult_file,this.resourceDictionary.app],this.promises=[],this.matches=[],this.deferrals=[],this.initMatchesByScope()}return t.prototype.initMatchesByScope=function(){this.matchesByScope={};for(var e=0;e<this.searchableResourceTypes.length;e++){var t=this.searchableResourceTypes[e];this.matchesByScope[t.searchScope]=[]}},t.prototype.fetchMatches=function(e,t,i){for(var s=this,a=0;a<this.deferrals.length;a++)this.deferrals[a].reject(),delete this.deferrals[a];if(this.deferrals=[],this._rawTextQuery=e,!this._rawTextQuery)return this.matches=[],void this.initMatchesByScope();var r={limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy};this.isLoading=!0,this.promises=[];for(var o=0;o<this.searchableResourceTypes.length;o++){var n=this.searchableResourceTypes[o],l=n.searchScope,c=this._getCallbackByResource(n);e=this.searchQuery.buildQueryString("",this._rawTextQuery,[],null,n),this.searchApiResource.query(angular.extend(r,{query:e,scope:l}),c,c)}for(var u=[],a=0;a<this.deferrals.length;a++)u.push(this.deferrals[a].promise);return this.$q.all(u).then(function(){for(var e=[],i=0;i<arguments.length;i++)e[i-0]=arguments[i];s.matches=[];for(var a in s.matchesByScope)s.matches=s.matches.concat(s.matchesByScope[a]);s.initMatchesByScope(),s.isLoading=!1,t&&t.apply(s,e)},function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];s.isLoading=!1,i&&i.apply(s,e)}),this.matches},t.prototype._getCallbackByResource=function(t){var i=this,s=this.$q.defer(),a=this.resourceDictionary.getNameAccessorForResource(t),r=this.resourceDictionary.getIdAccessorForResource(t);return s.promise.then(function(s){var o=[];if("Response"in s&&(o=s.Response.Items),i.matchesByScope[t.searchScope].length=0,o.length>0){var n={title:o.length>1?t.displayNamePlural:t.displayNameSingular,selectable:!1,value:null,template:e.Templates.typeaheadCategoryTitle};i.matchesByScope[t.searchScope].push(n)}for(var l=0;l<o.length;l++){var c=o[l],u={selectable:!0,title:a(c),value:{id:r(c),resource:c[t.searchObjectName],resourceType:t.key},data:c,href:t.uiHrefAccessor(c),template:t.templates.typeaheadMatch};i.matchesByScope[t.searchScope].push(u)}}),this.deferrals.push(s),function(){s.resolve(arguments[0])}},t}();i.SearchTypeaheadDataSource=a}(i=t.Search||(t.Search={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.filterSelectionManagerName="filterStringManager",e.commonModule.service(i.filterSelectionManagerName,["$q",t.Search.searchFilterName,function(e,t){return new s(e,t)}]);var s=function(){function e(e,t){this.$q=e,this.searchFilterService=t}return e.prototype.setFilterSelections=function(e){var t=this.stringToHash(e.searchFilters.preselections);if(!(Object.keys(t).length<1))for(var i=0;i<e.allFilters.length;i++){var s=e.allFilters[i];if(s.id in t){for(var a=t[s.id],r=null,o=0;o<s.choices.length;o++){var n=s.choices[o];if(n.value==a){r=n;break}}r||(r={label:a,value:a},s.choices.push(r)),s.currentChoice=r,e.onFilterChoiceChange(s)}}},e.prototype.updatePreselectionsString=function(e){for(var t={},i=0;i<e.searchFilters.activeFilters.length;i++){var s=e.searchFilters.activeFilters[i];t[s.id]="textbox"===s.uiType||"autocomplete"===s.uiType?s.currentChoice.label:s.currentChoice.value}e.searchFilters.preselections=this.hashToString(t)},e.prototype.stringToHash=function(e){var t={};try{t=JSON.parse(e)}catch(i){}return t},e.prototype.hashToString=function(e){return JSON.stringify(e)},e.prototype.initFilters=function(e,t,i,s){var a=[],r=this.$q.defer();if(angular.isArray(s))for(var o=0;o<s.length;o++){var n=s[o],l=t.searchFilters.indexOf(n);if(l>-1){var c=angular.copy(t.searchFilters[l],{});i.push(c)}}else angular.copy(t.searchFilters,i);for(this.removeInapplicableFilters(e,i),o=0;o<i.length;o++){var u=i[o];u.dataSource&&a.push(this.searchFilterService.fetchFilterData(u))}return a.length>0?this.$q.all(a).then(function(){r.resolve()}):r.resolve(),r.promise},e.prototype.removeInapplicableFilters=function(e,t){if(e)for(var i=t.length,s=0;i>s;s++){var a=t[s],r=new RegExp("(\\(|\\+|\\s|^)"+a.facet,"i");e.search(r)>-1&&(t.splice(s,1),i=t.length)}},e}();i.FilterSelectionManager=s}(i=t.Search||(t.Search={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.bioSampleGridDataSourceFactoryName="bioSampleGridDataSourceFactory",e.commonModule.factory(t.bioSampleGridDataSourceFactoryName,["$http",e.Services.Api.apiServiceName,e.Services.ServerConfig.serverConfigServiceName,function(e,t,s){
return new i(e,t,s)}]);var i=function(){function e(e,t,i){this.$http=e,this.publicApi=t,this.serverConfig=i}return e.prototype.getBioSampleList=function(){return new s(this.$http,this.publicApi,this.serverConfig)},e}();t.BioSampleGridDataSourceFactory=i;var s=function(e){function t(t,i,s){e.call(this),this.isLoading=!1,this.$http=t,this.publicApi=i,this.serverConfig=s}return __extends(t,e),t.prototype.fetchItems=function(e,t,i){var s=this,a={offset:this.offset,limit:this.limit,sortDir:this.sortDir,sortBy:this.sortBy};a=angular.extend(a,e),this.isLoading=!0;var r=this.publicApi.BioSamplesList.get(a,function(e){s.items=[];var i=e.Response.Items;s.totalCount=r.Response.TotalCount;for(var a=0;a<r.Response.Items.length;a++)s.items.push(i[a]);s.isLoading=!1,t&&t.apply(s,e)},function(e){s.isLoading=!1,i&&i.apply(s,e)});return this.items},t}(e.Directives.TangGrid.GridDataSource);t.BioSampleListDataSource=s}(i=t.BioSample||(t.BioSample={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.trashServiceName="trashService",e.commonModule.service(t.trashServiceName,["$q",t.Api.apiServiceName,function(e,t){return new i(e,t)}]);var i=function(){function e(e,t){this.$q=e,this.publicApi=t}return e.prototype.initTrashRun=function(e){var t=this,i=this.$q.defer(),s={InputRuns:e.Id,ShowHiddenWorkflows:!0},a=this.publicApi.AppSessionsList.get(s,function(){var s=t.createTrashableRunItem(e,a.Response.Items);i.resolve(s)},function(e){});return i.promise},e.prototype.createTrashableRunItem=function(e,t){var i=[],s={resourceId:e.Id,resourceName:e.ExperimentName,sentToTrash:!1,sentToTrashError:!1},a={run:s,totalSize:e.TotalSize.toString(),associatedAppSessions:i};return angular.forEach(t,function(e,t){i.push({resourceId:e.Id,resourceName:e.Name})}),a},e.prototype.initTrashAppSession=function(e){var t=this,i=this.$q.defer(),s=0,a=[];return angular.forEach(e,function(e,i){a.push(t.createTrashableAppSession(e)),s+=t.getAppSessionTotalSize(e)}),i.resolve({appSessions:a,totalSize:s.toString()}),i.promise},e.prototype.getAppSessionTotalSize=function(e){var t;return t="undefined"!=typeof e.totalSize?e.totalSize:e.TotalSize},e.prototype.createTrashableAppSession=function(e){var t,i;t=e.idToken?e.idToken:e.Id,i=e.appSessionName?e.appSessionName:e.Name;var s={resourceId:t,resourceName:i,sentToTrash:!1,sentToTrashError:!1};return s},e.prototype.createTrashableSample=function(e){var t={resourceId:e.Id,resourceName:e.SampleId,sentToTrash:!1,sentToTrashError:!1};return t},e.prototype.trashAppSessions=function(e,t){var i=this.$q.defer(),s=0,a=0;return this.trashAppSession(i,e,a,s,t).promise},e.prototype.trashAppSession=function(e,t,i,s,a,r){var o=this;void 0===r&&(r=0);{var n=t[r];this.publicApi.AppSession["delete"]({Id:n.resourceId},function(){if(i++,a.percentage=i/t.length*100,i+s==t.length){var n=o.hasErrors(t);n.length?e.reject(n):e.resolve()}else r++,e=o.trashAppSession(e,t,i,s,a,r)},function(l){if(s++,n.sentToTrashError=!0,n.errorMessage=o.setFriendlyTrashAnalysisFailure(n.resourceName,l.data.ResponseStatus.Message),i+s==t.length){var c=o.hasErrors(t);c.length?e.reject(c):e.resolve()}else r++,e=o.trashAppSession(e,t,i,s,a,r)})}return e},e.prototype.hasErrors=function(e){var t=[];return angular.forEach(e,function(e,i){e.sentToTrashError&&t.push(e)}),t},e.prototype.setFriendlyTrashAnalysisFailure=function(e,t){return'Analysis named "'+e+'" has the following error message: '+t},e.prototype.trashRuns=function(e,t){var i=this,s=this.$q.defer(),a=0,r=0;return angular.forEach(e,function(o,n){i.publicApi.Run["delete"]({Id:o.resourceId},function(){if(r++,t.percentage=r/e.length*100,r+a==e.length){var o=i.hasErrors(e);o.length?s.reject(o):s.resolve()}},function(t){if(a++,o.sentToTrashError=!0,o.errorMessage=o.resourceName+": "+t.data.ResponseStatus.Message,r+a==e.length){var n=i.hasErrors(e);n.length?s.reject(n):s.resolve()}})}),s.promise},e.prototype.createTrashableProject=function(e){var t={resourceId:e.Id,resourceName:e.Name,sentToTrash:!1,sentToTrashError:!1};return t},e.prototype.trashProject=function(e,t){var i=this.$q.defer();return this.publicApi.Project["delete"]({Id:e.resourceId},function(){t.percentage=100,i.resolve()},function(t){e.errorMessage=e.resourceName+": "+t.data.ResponseStatus.Message,i.reject([e])}),i.promise},e.prototype.initTrashSample=function(e,t){var i=this,s=this.$q.defer(),a=0,r=[];return angular.forEach(e,function(e,s){e.UserOwnedBy.Id===t.currentUserId&&(r.push(i.createTrashableSample(e)),a+=e.TotalSize)}),s.resolve({samples:r,totalSize:a.toString()}),s.promise},e.prototype.trashSamples=function(e,t){var i=this.$q.defer(),s=0,a=0;return this.trashSample(i,e,a,s,t).promise},e.prototype.trashSample=function(e,t,i,s,a,r){var o=this;void 0===r&&(r=0);var n=t[r];return this.publicApi.Sample["delete"]({Id:n.resourceId},function(){if(i++,a.percentage=i/t.length*100,i+s==t.length){var n=o.hasErrors(t);n.length?e.reject(n):e.resolve()}else r++,e=o.trashSample(e,t,i,s,a,r)},function(l){if(s++,n.sentToTrashError=!0,n.errorMessage=n.resourceName+": "+l.data.ResponseStatus.Message,i+s==t.length){var c=o.hasErrors(t);c.length?e.reject(c):e.resolve()}else r++,e=o.trashSample(e,t,i,s,a,r)}),e},e}();t.TrashService=i}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.loaderDirectiveName="bsLoader",e.commonModule.directive(t.loaderDirectiveName,["$timeout",function(e){return new s(e)}]);var i=250,s=function(){function t(t){this.$timeout=t,this.template=e.Templates.loader,this.restrict="E",this.scope=!0,this.link=function(e,s,a){var r;e.showLoader=!1,e.$parent.$watch(a.isLoading,function(s){s?null==r&&(r=t(function(){e.showLoader=!0,r=null},i)):(e.showLoader=!1,null!=r&&(t.cancel(r),r=null))})}}return t}()}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.truncateDirectiveName="bsTruncate",e.commonModule.directive(t.truncateDirectiveName,[function(){return new i}]);var i=function(){function t(){var e=this;this.restrict="A",this.terminal=!0,this.priority=0,this.link=function(t,i,s){if(s.bsTruncate){var a=parseInt(s.bsTruncate);t.$watch(function(){i.find(".bs-truncate").length<1&&e.applyDirective(i,a)}),e.applyDirective(i,a)}}}return t.prototype.applyDirective=function(e,t){if(t&&e.text().trim().length>0&&e.text().trim().length>t){var i=e.children().detach(),s=$("<div class='bs-truncate'></div>");s.prependTo(e),s.append(i);var a=this.getTruncationCutoff(s[0],t);if("object"==typeof a){var r=angular.element(a.node),o=s.clone();o.hide(),this.truncate(r,a.stoppingCharPosition),o.appendTo(e),s.find(".bs-truncate-expand").click(function(){s.hide(),o.show()})}}},t.prototype.getTruncationCutoff=function(e,t){if(null==t)return null;if("string"==typeof e.nodeValue){var i=e.nodeValue.trim().length;return i>=t?{node:e,stoppingCharPosition:t}:t-=i}for(var s=0;s<e.childNodes.length;s++)if(t=this.getTruncationCutoff(e.childNodes[s],t),null!=t&&"object"==typeof t)return t;return t},t.prototype.truncate=function(i,s){for(var a=i[0].textContent,r=0,o=s;o>0;o--)if(t.WORD_DELIMITER.test(a[o-1])){r=o-1;break}i[0].textContent=i[0].textContent.trim().substring(0,r),i.nextAll().remove();for(var n=i.parent();!n.hasClass("bs-truncate");)n.nextAll().remove(),n=n.parent();for(var l=i.parent();(l.is("a")||l.is("code")||l.is("pre")||l.is("h1")||l.is("h2")||l.is("h3")||l.is("h4")||l.is("h5")||l.is("h6"))&&!l.hasClass("bs-truncate");)l=l.parent();l.append(e.Templates.truncateExpandLink)},t.WORD_DELIMITER=/\s|,|-|:|;|\.|\?|\!/,t}();t.TruncateDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.dropdownMenuDirectiveName="bsDropdownMenu",e.commonModule.directive(t.dropdownMenuDirectiveName,[e.Services.BsResourceDictionary.serviceName,function(e){return new i(e)}]);var i=function(){function t(t){this.restrict="EA",this.scope={resourceType:"@",selectedItemId:"=",emptyMessage:"@?",isDisabled:"=?",params:"=?"},this.template=e.Templates.dropdown,this.controller=["$scope",function(e){var i=t[e.resourceType];if(e.choices=[],angular.isDefined(e.isDisabled)||(e.isDisabled=!1),!i)throw"Unable to initialize dropdown menu directive: unknown resource type '"+e.resourceType+"'";var s=e.params?e.params:{};i.restResource.query(s,function(t){t.Response.Items.forEach(function(t){e.choices.push({label:t[i.namePropertyName],value:t.Id})})})}]}return t}();t.DropdownMenuDirective=i}(i=t.FormControls||(t.FormControls={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.markdownEditorDirectiveName="bsMarkdownEditor",e.commonModule.directive(t.markdownEditorDirectiveName,function(){return new i});var i=function(){function t(){this.transclude=!0,this.scope={model:"=ngModel",name:"@formName",disabled:"&ngDisabled",maxlength:"=?ngMaxlength",rows:"=?"},this.restrict="E",this.template=e.Templates.markdownEditor,this.controller=["$scope",function(e){angular.isDefined(e.rows)||(e.rows=5),angular.isDefined(e.maxlength)||(e.maxlength=524288),e.isDisabled=function(){return e.$eval(e.disabled)}}],this.link=function(e,t,i){i.required&&t.find("textarea").attr("required","")}}return t}();t.MarkdownEditorDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.emailServiceName="emailValidation",e.commonModule.service(t.emailServiceName,function(){return new i});var i=function(){function e(){}return e.prototype.isEmailValid=function(e){return e.match(/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/i)},e}();t.EmailValidation=i}(i=t.Validation||(t.Validation={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.numericValidationServiceName="bsNumericValidation",e.commonModule.service(t.numericValidationServiceName,function(){return new i});var i=function(){function e(){}return e.isPositiveInteger=function(e){var t=/^\d+$/;return t.test(e)},e}();t.NumericValidation=i}(i=t.Validation||(t.Validation={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function t(){this.restrict="E",this.scope={alignment:"@"},this.template=e.Templates.ellipsisTooltip,this.transclude=!0,this.controller=["$scope",function(e){e.killClickPropagation=function(e){e.preventDefault(),e.stopPropagation()}}],this.link=function(e,t){angular.isDefined(e.alignment)&&t.find(".modal-tooltip").addClass(e.alignment)}}return t}();t.ellipsisTooltipDirectiveName="bsEllipsisTooltip",e.commonModule.directive(t.ellipsisTooltipDirectiveName,function(){return new i})}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.slidePanelDirectiveName="bsSlidePanel",t.commonModule.directive(i.slidePanelDirectiveName,function(){return new s});var s=function(){function t(){this.restrict="E",this.replace=!0,this.transclude=!0,this.template=e.Common.Templates.bsSlidePanel,this.scope={heading:"=",isPanelVisible:"="},this.controller=["$scope",function(e){e.onToggleVisibilityClick=function(){e.isPanelVisible=!e.isPanelVisible}}]}return t}();i.SlidePanel=s}(s=i.SlidePanel||(i.SlidePanel={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.navListDirectiveName="bsNavList",e.commonModule.directive(t.navListDirectiveName,[function(){return new i}]);var i=function(){function t(){this.scope={items:"="},this.template=e.Templates.navList,this.controller=["$scope",function(e){}]}return t}();t.NavListDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.navTabListDirectiveName="bsNavTabList";var i=function(){function t(t,i){this.template=e.Templates.navTabList,this.restrict="E",this.replace=!0,this.scope={itemsProvider:"@"},this.controller=["$scope","$injector","$routeParams",function(e,s,a){try{var r=s.get(e.itemsProvider);e.items=r.getItems(e,a,i,t)}catch(o){e.items=[{title:"Missing or bad items provider",href:"",isActive:function(){return!0}}]}}]}return t}();t.NavTabListDirective=i,e.commonModule.directive(t.navTabListDirectiveName,[e.Services.siteNavigationServiceName,e.PageContext.serviceName,function(e,t){return new i(e,t)}])}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.multiResourceDropdownDirectiveName="bsMultiResourceDropdown",e.commonModule.directive(t.multiResourceDropdownDirectiveName,["$document",e.Services.dropDownActionServiceName,e.Services.BsResourceDictionary.serviceName,function(e,t,s){return new i(e,t,s)}]);var i=function(){function t(t,i,s){var a=this;this.restrict="E",this.scope={resources:"=",type:"@"},this.template=e.Templates.multiResourceDropdown,this.$document=t,this.dropDownActionService=i,this.resourceDictionary=s,this.controller=["$scope",function(e){if(!a.resourceDictionary.hasOwnProperty(e.type))throw new Error("No resource config present for specified resource type '"+e.type+"'.");var t=a.resourceDictionary[e.type];e.getHref=function(e){var i={};return i[t.searchObjectName]=e,t.uiHrefAccessor(i)},e.getName=function(e){return e[t.namePropertyName]},e.resourceNamePlural=t.displayNamePlural,e.menu={isVisible:!1},a.dropDownActionService.registerDropDown(e.menu),e.onCloseClick=function(t){e.menu.isVisible=!1,t.stopPropagation(),t.preventDefault()},e.onMultipleLinkClick=function(t){a.dropDownActionService.hideAllDropDowns(e.menu),e.menu.isVisible=!e.menu.isVisible,t.stopPropagation(),t.preventDefault()}}],this.link=function(e,t,i){var s=function(){e.menu.isVisible=!1,e.$digest()};a.$document.on("click",s),e.$on("$destroy",function(){a.$document.off("click",s),a.dropDownActionService.unregisterDropDown(e.menu)})}}return t}();t.MultiResourceDropdownDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.trendLineChartName="bsTrendLineChart",t.commonModule.directive(i.trendLineChartName,["$window",function(e){return new s(e)}]);var s=function(){function t(t){this.template=e.Common.Templates.trendLineChartDirective,this.restrict="E",this.$window=t,this.scope={graphTitle:"=",graphXTitle:"=",graphYTitle:"=",graphValues:"=",graphTrendValues:"="},this.link=function(e,i,s){t.onresize=function(){e.$apply()};var a,r,o,n,l=200,c=20,u=20,d=60,p=d3.select(i[0].children[1]).append("svg").attr("width","100%").attr("height",l+c),m=d3.format(".2s"),h=p.append("svg:g").attr("class","x axis"),f=p.append("svg:g").attr("class","y axis"),v=p.append("svg:path"),g=d3.svg.line().x(function(e){return a(e.x)}).y(function(e){return r(e.y)}).interpolate("linear");e.update=function(){var t=i.find("svg")[0],s=t.offsetWidth||t.parentNode.clientWidth;e.bgTitleLineStyle={width:s-d-d,"margin-left":d},a=d3.scale.linear().range([d,s-d]).domain([e.graphTrendValues.StartPosition.x,e.graphTrendValues.EndPosition.x]),r=d3.scale.linear().range([l,u]).domain([e.graphTrendValues.StartPosition.y,e.graphTrendValues.EndPosition.y]),o=d3.svg.axis().scale(a).tickSize(5).ticks(10),n=d3.svg.axis().scale(r).tickSize(-s+d+d).ticks(7).tickPadding(10).tickFormat(function(e){return m(e)}).orient("left"),h.attr("transform","translate(0,"+l+")").call(o),f.attr("transform","translate("+d+",0)").call(n);var c=[e.graphTrendValues.StartPosition,e.graphTrendValues.EndPosition];v.attr("fill","none").transition().duration(500).attr("d",g(c)).attr("stroke","#53b6c3").attr("fill","none").attr("stroke-width",1.5),v.attr("d",g(c));{var b=p.selectAll("circle").data(e.graphValues);b.enter().append("circle").append("svg:title").text(function(e){return"x: "+e.x+" y: "+e.y})}b.attr("cx",function(e){return a(e.x)}).attr("cy",function(e){return r(e.y)}).attr("r",0).transition().delay(function(e,t){return 20*t}).duration(500).attr("r",3),b.exit().remove()},e.$watch(function(){return t.innerWidth},function(t,i){e.update()})}}return t}();i.TrendLineChartDirective=s}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.donutChartServiceName="bsDonutChartSvc",e.commonModule.service(t.donutChartServiceName,[function(){return new i}]);var i=function(){function e(){}return e.prototype.getDefaultOptions=function(t,i,s,a,r,o,n){return void 0===t&&(t=null),void 0===i&&(i=[]),void 0===s&&(s=105),void 0===a&&(a=105),void 0===r&&(r=null),void 0===o&&(o=null),void 0===n&&(n=0),{segments:[],width:105,height:105,innerRadius:44.5,outerRadius:52.5,startAngle:0,chartTitle:{subtitleText:"",titleText:"",titleColor:e.DEFAULT_FILL_COLOR}}},e.prototype.initSvg=function(e,t){if(e.element!==t){if(e.element=t,e.element){var i=d3.select(t).append("svg").attr("width",e.width).attr("height",e.height);e.chartGroup=i.append("g").attr("transform","translate("+e.width/2+","+e.height/2+")");var s=i.append("defs"),a=s.append("radialGradient").attr({id:"donut-chart-radial-gradient",cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"});a.append("stop").attr("offset","0%").style("stop-color","white"),a.append("stop").attr("offset","100%").style("stop-color","#f8f8f9"),e.segmentGroup=e.chartGroup.append("g"),e.segmentGroup.classed("bs-chart-donut-segment-group"),e.segmentGroup.append("circle").attr("r",e.innerRadius).attr("fill","url(#donut-chart-radial-gradient)"),e.titleGroup=e.chartGroup.append("g").attr("class","bs-chart-donut-title-group"),e.titleGroup.attr("transform","translate(0,6)").classed("bs-chart-donut-title-group")}this.update(e)}},e.prototype.update=function(e){if(e.element&&!(e.segments.length<1)){var t=d3.layout.pie().sort(null);t.startAngle(e.startAngle),t.endAngle(2*Math.PI+e.startAngle),t.value(function(e){return e.value});var i=d3.svg.arc().innerRadius(e.innerRadius).outerRadius(e.outerRadius),s=e.segmentGroup.selectAll("path").data(t(e.segments));s.enter().append("path"),s.attr("fill",this.getChartFillColor).transition().duration(500).attrTween("d",function(e){var t=d3.interpolate(e.startAngle,e.endAngle);return function(s){return e.endAngle=t(s),i(e)}}),s.exit().remove();var a=e.titleGroup.selectAll("text.title").data([e.chartTitle]);a.enter().append("text"),a.text(function(e){return e.titleText}).attr("text-anchor","middle").attr("dy","-0.33em").attr("class","title").style("fill",function(e){return e.titleColor});var r=e.titleGroup.selectAll("text.subtitle").data([e.chartTitle]);r.enter().append("text"),r.text(function(e){return e.subtitleText}).attr("text-anchor","middle").attr("dy","1em").attr("class","subtitle")}},e.prototype.getChartFillColor=function(t){return t.data.segmentStyles&&t.data.segmentStyles.fill?t.data.segmentStyles.fill:e.DEFAULT_FILL_COLOR},e.DEFAULT_FILL_COLOR="#d7d7d7",e}();t.DonutChartService=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.donutChartDirectiveName="bsDonutChart",e.commonModule.directive(t.donutChartDirectiveName,[t.donutChartServiceName,function(e){return new i(e)}]);var i=function(){function t(t){var i=this;this.donutChartService=t,this.restrict="E",this.template=e.Templates.donutChart,this.scope={options:"=?"},this.link=function(e,t,s){e.options=angular.isDefined(e.options)?angular.extend(i.donutChartService.getDefaultOptions(),e.options):i.donutChartService.getDefaultOptions();var a=t.find(".bs-chart-donut");i.donutChartService.initSvg(e.options,a[0]),i.donutChartService.update(e.options)}}return t}();t.DonutChart=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.storageDonutChartDirectiveName="bsStorageDonutChart",e.commonModule.directive(t.storageDonutChartDirectiveName,[t.donutChartServiceName,e.Services.Api.apiServiceName,e.Services.currentUserServiceName,"bytesFilter",function(e,t,s,a){return new i(e,t,s,a)}]);var i=function(){function t(t,i,s,a){var r=this;this.donutChartService=t,this.api=i,this.currentUserService=s,this.scope={metricType:"@",options:"=?",storageStats:"=?"},this.bytesFilter=a,this.template=e.Templates.storageDonutChart,this.controller=["$scope",function(e){e.options=angular.isDefined(e.options)?angular.extend(r.donutChartService.getDefaultOptions(),e.options):r.donutChartService.getDefaultOptions(),angular.isDefined(e.showLegend)||(e.showLegend=!0),e.title="",angular.isDefined(e.storageStats)?r.onLoadStorageStats(e):(e.isLoading=!0,r.currentUserService.getCurrentUser().then(function(t){e.storageStats=t,r.onLoadStorageStats(e),e.isLoading=!1}))}]}return t.prototype.onLoadStorageStats=function(e){switch(e.metricType){case t.METRIC_TYPE_RUNS:e.statToUse=e.storageStats.TotalRunsSize,e.title="Runs",e.linkHref="/runs";break;case t.METRIC_TYPE_PROJECTS:e.statToUse=e.storageStats.TotalProjectsSize,e.title="Projects",e.linkHref="/projects";break;case t.METRIC_TYPE_TRASH:e.statToUse=e.storageStats.TotalTrashSize,e.title="Trash",e.linkHref="/settings/trash";break;default:throw"Metric type "+e.metricType+" is not supported by the storage donut chart."}var i=this.createSegments(e.storageStats,e.statToUse),s=i[0];e.options.segments=i,e.options.chartTitle={titleText:s.label,subtitleText:s.valueFormatted,titleColor:s.segmentStyles.fill},this.donutChartService.update(e.options)},t.prototype.getPercentage=function(t){return 0>=t?"0%":.01>t?"<1%":t>.99&&1>t?"99%":e.Utils.MathUtils.toFixed(100*t,0)+"%"},t.prototype.createSegments=function(e,i){var s=0;e.TotalSize>0&&(s=i/e.TotalSize);var a=this.bytesFilter(i,2),r=this.getPercentage(s),o={value:i,valueFormatted:a,label:r,segmentStyles:{fill:t.SEGMENT_FILL_COLOR}},n={value:e.TotalSize-i,valueFormatted:"",label:"Total"};return[o,n]},t.METRIC_TYPE_TRASH="trash",t.METRIC_TYPE_RUNS="runs",t.METRIC_TYPE_PROJECTS="projects",t.SEGMENT_FILL_COLOR="#7ba8d6",t}();t.StorageDonutChartDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.tooltipName="bsTooltip",t.commonModule.directive(i.tooltipName,["$timeout",function(e){return new s(e)}]);var s=function(){function i(i){var s=this;this.template=t.Templates.tooltip,this.restrict="EA",this.transclude=!0,this.$timeout=i,this.link=function(t,i,a){if(!e.Compatibility.isTouchDevice()){var r=i.parent();if(0==r.length)throw"The <bs-tooltip> directive cannot be used on an element that has no parent.";var o=r.attr("title");o&&r.removeAttr("title");var n=a.placement?a.placement:"s",l=a.openIf?!0:!1,c=void 0!=a.smartPlacement?"true"===a.smartPlacement:!0,u=void 0!=a.mouseOnToPopup?"true"===a.smartPlacement:!0,d={smartPlacement:c,placement:n,mouseOnToPopup:u,manual:l,popupClass:a.popupClass},p=angular.isString(a.watch)?a.watch.split(","):[],m=angular.isString(a.watchCollection)?a.watchCollection.split(","):[];t.$watchGroup(p,function(e,t){angular.equals(e,t)||s.resetPowertip(r,i)},!0),m.forEach(function(e){t.$watchCollection(e,function(e,t){angular.equals(e,t)||s.resetPowertip(r,i)})}),s.$timeout(function(){r.data("powertipjq",i.find(".bs-tooltip").first().clone()),r.powerTip(d)}),angular.isDefined(a.openIf)&&t.$watch(function(){return t.$eval(a.openIf)},function(e){s.$timeout(function(){1==e?$.powerTip.show(r):0==e&&$.powerTip.hide(r)})}),angular.isDefined(a.canOpenIf)&&t.$watch(function(){return t.$eval(a.canOpenIf)},function(e){s.$timeout(function(){1==e?(r.powerTip(d),r.removeAttr("title")):0==e&&($.powerTip.destroy(r),o&&r.attr("title",o))})})}}}return i.prototype.resetPowertip=function(e,t){this.$timeout(function(){var i=t.find(".bs-tooltip").first();e.data("powertipjq").html(i.html())})},i}();i.TooltipDirective=s}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.bootstrapDialogDirectiveName="bsBootstrapModal",t.bootstrapHeaderDirectiveName="bsBootstrapModalHeader",t.bootstrapBodyDirectiveName="bsBootstrapModalBody",t.bootstrapFooterDirectiveName="bsBootstrapModalFooter",e.commonModule.directive(t.bootstrapDialogDirectiveName,function(){return new i(e.Templates.bootstrapModal)}),e.commonModule.directive(t.bootstrapHeaderDirectiveName,function(){return new i(e.Templates.bootstrapModalHeader)}),e.commonModule.directive(t.bootstrapBodyDirectiveName,function(){return new i(e.Templates.bootstrapModalBody)}),e.commonModule.directive(t.bootstrapFooterDirectiveName,function(){return new i(e.Templates.bootstrapModalFooter)});var i=function(){function e(e){this.restrict="E",this.template=e,this.transclude=!0,this.replace=!0}return e}();t.BootstrapModalDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.downloadRunModalDirectiveName="bsDownloadRunModal",t.commonModule.directive(i.downloadRunModalDirectiveName,function(){return new s});var s=function(){function i(){this.template=e.Common.Templates.downloadRunModal,this.restrict="E",this.scope={dialogScope:"="},this.link=function(e,t,i){{var s=t.find(".bs-ng-modal-dialog-body")[0];angular.element(s).load("/runs/"+e.dialogScope.resourceId+"/downloadv2/options/-1")}},this.controller=["$scope",t.Services.ModalDialog.serviceName,function(e,t){e.$watch("selections",function(t,i){var s=e.dialogScope.selections[0];e.resourceName=s.ExperimentName,e.resourceIcon=s.InstrumentType,e.resource=s},!0),e.onCloseClick=function(){t.removeModal()}}]}return i}();i.DownloadRunModal=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.downloadModalDirectiveName="bsDownloadModal",t.commonModule.directive(i.downloadModalDirectiveName,function(){return new s});var s=function(){function i(){this.template=e.Common.Templates.downloadModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope",t.Services.ModalDialog.serviceName,function(e,t){e.onCloseClick=function(){t.removeModal()}}]}return i}();i.DownloadModal=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.createProjectModalDirectiveName="bsCreateProjectModal",t.commonModule.directive(i.createProjectModalDirectiveName,[t.Services.Api.apiServiceName,function(e){return new s(e)}]);var s=function(){function i(i){this.template=e.Common.Templates.createProjectModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ModalDialog.serviceName,function(e,t,s){e.projectNamePlaceholder="Name",e.projectForm={projectName:"",projectDescription:""},e.onCloseClick=function(){s.removeModal()},e.onCreateClick=function(){e.errorMessage="";var a=!0;if(e.formProject.projectName.$error.required&&(a=!1,e.formProject.projectName.$pristine=!1,e.userHasEnteredText=!0),a){var r={Name:e.projectForm.projectName,Description:e.projectForm.projectDescription};t({method:"POST",url:i.apiBaseUrl+"/projects",data:r,withCredentials:!0,headers:i.defaultHeaders}).success(function(t,i,a,r){200==i&&(e.errorMessage="Project name already exists."),201==i&&(e.dialogScope.successCallback&&e.dialogScope.successCallback(t.Response),e.dialogScope.gridDataSource&&e.dialogScope.gridDataSource.fetchItems(),s.removeModal())}).error(function(t,i,s,a){e.errorMessage=t.ResponseStatus.Message})}},e.onProjectNameChange=function(){angular.isDefined(e.projectForm.projectName)&&e.projectForm.projectName.length>0&&(e.userHasEnteredText=!0)}}]}return i}();i.CreateProjectModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.emptyTrashModalDirectiveName="bsEmptyTrashModal",t.commonModule.directive(i.emptyTrashModalDirectiveName,[t.Services.Api.apiServiceName,function(e){return new s(e)}]);var s=function(){function i(i){this.template=e.Common.Templates.emptyTrashModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope",t.Services.ModalDialog.serviceName,function(e,t){e.$watch("dialogScope.gridDataSource.items",function(t,i){var s=0;angular.forEach(e.dialogScope.gridDataSource.items,function(e,t){s+=e.TotalSize}),e.totalSize=s.toString()},!0),e.onCancelClick=function(){t.removeModal()},e.onDeleteClick=function(){i.TrashList["delete"]({},function(){null!=e.dialogScope&&angular.isFunction(e.dialogScope.confirmAction)&&e.dialogScope.confirmAction(),e.dialogScope.gridDataSource.fetchItems(),t.removeModal()}),function(){}}}]}return i}();i.EmptyTrashModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.getLinkDirectiveName="bsGetLinkModal",t.commonModule.directive(i.getLinkDirectiveName,function(){return new s});var s=function(){function i(){var i=this;this.template=e.Common.Templates.getLinkModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ModalDialog.serviceName,t.Services.ServerConfig.serverConfigServiceName,function(e,t,s,a){var r;"run"==e.dialogScope.resourceType?(i.selectedItem=e.dialogScope.selections[0],e.resource=i.selectedItem,e.resourceId=i.selectedItem.Id,e.resourceName=i.selectedItem.ExperimentName,r=a.privateApiBaseUrl+"share_by_link/run/"+e.resourceId):"project"==e.dialogScope.resourceType&&(i.selectedItem=e.dialogScope.selections?e.dialogScope.selections[0]:e.dialogScope.resource,e.resourceId=i.selectedItem.Id,e.resourceName=i.selectedItem.Name,r=a.privateApiBaseUrl+"share_by_link/project/"+e.resourceId),t({method:"GET",url:r}).success(function(t,i,s,a){e.shareUrl=t.ShareUrl}).error(function(e,t,i,s){}),e.onCloseClick=function(){s.removeModal()},e.onActivateClick=function(){t({method:"POST",url:r}).success(function(t,i,s,a){e.shareUrl=t.ShareUrl}).error(function(e,t,i,s){})},e.onDeactivateClick=function(){"run"==e.dialogScope.resourceType?e.warningMessage="Are you sure you want to deactivate this share link? This link will no longer provide access to the run. Existing shares will remain active and can be removed from the collaborators list in the share dialog.":"project"==e.dialogScope.resourceType&&(e.warningMessage="Are you sure you want to deactivate this share link? This link will no longer provide access to the project. Existing shares will remain active and can be removed from the collaborators list in the share dialog.")},e.onDeactivateConfirmClick=function(){t({method:"DELETE",url:r}).success(function(e,t,i,a){s.removeModal()}).error(function(e,t,i,s){})}}]}return i}();i.getLinkDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.getLinkDialogTriggerDirectiveName="bsGetLinkDialogTrigger",t.commonModule.directive(i.getLinkDialogTriggerDirectiveName,[t.Services.ModalDialog.serviceName,e.Common.Services.Api.apiServiceName,function(e,t){return new s(e,t)}]);var s=function(){function e(e,t){var i=this;this.restrict="A",this.modalDialog=e,this.scope={resourceId:"@?",resourceType:"@?",selections:"@?"},this.controller=["$scope",function(e){}],this.link=function(e,s,a){e.trigger=function(){var t={masterTemplate:"<bs-get-link-modal dialog-scope='dialogScope'></bs-get-link-modal>"
},s={selections:e.selections,resourceType:e.resourceType,dismissByOutsideClick:!0};i.modalDialog.showModal(t,s)},e.dismiss=function(){i.modalDialog.removeModal()},s.on("click",function(){!e.selections&&e.resourceId&&e.resourceType?(e.selections=[],"run"==e.resourceType&&t.Run.get({Id:e.resourceId},function(t){var i=t.Response;e.selections.push(i),e.trigger()})):e.trigger()})}}return e}();i.GetLinkDialogTriggerDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){var s;!function(i){i.directiveName="bsShareToUserContext",t.commonModule.directive(i.directiveName,[e.Common.Services.currentUserServiceName,t.Services.Api.apiServiceName,e.Common.ContextSwitch.serviceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function t(t,i,s){var a=this;this.restrict="E",this.template=e.Common.Templates.shareToUserContext,this.currentUserService=t,this.publicApi=i,this.contextSwitchService=s,this.scope={selectedShareContext:"="},this.controller=["$scope",function(e){e.updateShareContext=function(t){return a.updateShareContext(t,e)},e.fetchContexts=function(){return a.fetchContexts(e)},e.fetchContexts()}]}return t.prototype.fetchContexts=function(e){var t=this;e.contextItems=[],this.currentUserService.getCurrentUser().then(function(i){t.contextSwitchService.getCurrentUserOrg().then(function(t){t.Items.length>0&&(i.LoggedInUser.Name="Personal",e.contextItems.push(i.LoggedInUser),e.contextItems=e.contextItems.concat(t.Items)),e.selectedShareContext=i.LoggedInUser})},function(e){})["finally"](function(){e.isLoading=!1})},t.prototype.updateShareContext=function(e,t){t.contextItems.forEach(function(i){i.Id==e&&(t.selectedShareContext=i)})},t}();i.Directive=s}(s=i.shareToUserContext||(i.shareToUserContext={}))}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.shareModalDirectiveName="bsShareModal",t.commonModule.directive(i.shareModalDirectiveName,function(){return new s});var s=function(){function i(){var i=this;this.template=e.Common.Templates.shareModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope",t.Services.ModalDialog.serviceName,e.Common.Services.ServerConfig.serverConfigServiceName,"$q",e.Common.Services.Api.apiServiceName,e.Common.Services.Validation.emailServiceName,function(e,t,s,a,r,o){var n,l;if(e.collaborators=[],e.includeAssociatedResources=!0,e.hasNewInvitees=!1,e.permissionsChanged=!1,e.usernamePlaceholder=s.isEmailEnabled?"Email address":"Username","run"===e.dialogScope.resourceType){n=e.dialogScope.selections[0],e.dialogScope.resourceId=n.Id,e.resourceName=n.ExperimentName,e.resourceIcon=n.InstrumentType,e.resource=n,l=s.privateApiBaseUrl+"collaborator/run/"+e.dialogScope.resourceId,e.permissionLevels=[{value:"READ",text:"Read Only"}];var c=r.CollaboratorList.get({Resource:"run",Id:e.dialogScope.resourceId},function(t,s){e.collaboratorResource=c,e.collaborators=c.results,e.collaborators=i.reMapCollaboratorsPermissions(e.collaborators)},function(e){console.log("ERROR"),console.log(e)})}else"project"===e.dialogScope.resourceType&&(n=e.dialogScope.selections?e.dialogScope.selections[0]:e.dialogScope.resource,e.dialogScope.resourceId=n.Id,e.resourceName=n.Name,c=r.CollaboratorList.get({Resource:"project",Id:e.dialogScope.resourceId},function(t,s){e.collaboratorResource=c,e.collaborators=c.results,e.collaborators=i.reMapCollaboratorsPermissions(e.collaborators)},function(e){console.log("Error"),console.log(e)}),e.permissionLevels=[{value:"READ",text:"Read Only"},{value:"WRITE",text:"Write"}]);e.selection=n.resourceName,e.cancelClick=function(){e.shareForm.$dirty?e.shouldShowConfirmCancelMessage=!0:t.removeModal()},e.removeConfirmCancelMessage=function(){e.shouldShowConfirmCancelMessage=!1},e.closeModal=function(){e.isLoading=!1,t.removeModal()},e.invite=function(){e.showValidation=!0;var t={email:e.shareForm.userEmail,personalMessage:e.shareForm.message,markedForDeletion:!1,isNew:!0,permission:"READ",inviteId:"",grantId:0};angular.isDefined(t.personalMessage)||(t.personalMessage=""),e.collaboratorError=e.getCollaboratorError(t),e.validationPassed&&(e.hasNewInvitees=!0,e.collaborators.push(t),e.shareForm.userEmail="",e.shareForm.message="",e.showValidation=!1)},e.saveSettings=function(){if(e.isLoading=!0,e.hasNewInvitees||e.permissionsChanged){var t=[];if(e.errorMessage="",t.push(r.CollaboratorList.save({Resource:e.dialogScope.resourceType,Id:e.dialogScope.resourceId},e.collaborators).$promise),e.includeAssociatedResources&&"run"===e.dialogScope.resourceType){var i={InputRuns:e.dialogScope.resourceId,ShowHiddenWorkflows:!0,Limit:100};t.push(r.AppSessionsList.get(i).$promise.then(function(e){var t=[];return e.Response.Items.forEach(function(e){var i={Id:e.Id,propertyName:"output.projects",Limit:100};t.push(r.AppSession.getProperty(i).$promise)}),a.all(t)}).then(function(t){var i=[],s=[];return t.forEach(function(t){t.Response.Items.forEach(function(t){-1===s.indexOf(t.Id)&&(i.push(r.CollaboratorList.save({Resource:"Project",Id:t.Id},e.collaborators).$promise),s.push(t.Id))})}),a.all(i)}))}a.all(t).then(function(){e.closeModal()},function(){console.log("err"),e.closeModal()})}else e.isLoading=!1,e.collaboratorError="You have not invited anyone"},e.collaboratorPermissionChanged=function(){e.permissionsChanged=!0},e.markForDeletion=function(t){e.permissionsChanged=!0,t.markedForDeletion=!0},e.cancelMarkForDeletion=function(t){e.permissionsChanged=!0,t.markedForDeletion=!1},e.getEmailError=function(e){if(angular.isDefined(e)){if(e.required)return"Please enter a value";if(e.userEmail)return"Please enter a valid email address"}},e.getPersonalMessageError=function(e){return angular.isDefined(e)&&e.maxlength?"Personal message is restricted to 140 characters":void 0},e.getCollaboratorError=function(t){if(t.email&&""!==t.email){if(s.isEmailEnabled&&null===o.isEmailValid(t.email))return e.validationPassed=!1,t.email+" is not a valid email address";for(var i=0;i<e.collaborators.length;i++)if(e.collaborators[i].email.toLowerCase()===e.shareForm.userEmail.toLowerCase()&&!e.collaborators[i].grantId)return e.validationPassed=!1,e.shareForm.userEmail+" already has a pending invite";e.validationPassed=!0}else e.validationPassed=!1}}]}return i.prototype.reMapCollaboratorsPermissions=function(e){return e.forEach(function(e){"ROLE_READER"===e.permission?e.permission="READ":"ROLE_WRITER"===e.permission&&(e.permission="WRITE")}),e},i}();i.ShareModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.shareDialogTriggerDirectiveName="bsShareDialogTrigger",t.commonModule.directive(i.shareDialogTriggerDirectiveName,[t.Services.ModalDialog.serviceName,e.Common.Services.Api.apiServiceName,function(e,t){return new s(e,t)}]);var s=function(){function e(e,t){var i=this;this.restrict="A",this.modalDialog=e,this.scope={resourceId:"@?",resourceType:"@?",selections:"@?"},this.controller=["$scope",function(e){}],this.link=function(e,s,a){e.trigger=function(){var t={masterTemplate:"<bs-share-modal dialog-scope='dialogScope'></bs-share-modal>"},s={selections:e.selections,resourceType:e.resourceType,dismissByOutsideClick:!0};i.modalDialog.showModal(t,s)},e.dismiss=function(){i.modalDialog.removeModal()},s.on("click",function(){!e.selections&&e.resourceId&&e.resourceType?(e.selections=[],"run"==e.resourceType&&t.Run.get({Id:e.resourceId},function(t){var i=t.Response;e.selections.push(i),e.trigger()})):e.trigger()})}}return e}();i.ShareDialogTriggerDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.trashModalDirectiveName="bsTrashModal",t.commonModule.directive(i.trashModalDirectiveName,[function(){return new s}]);var s=function(){function i(){var i=this;this.template=e.Common.Templates.trashModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$rootScope","$routeParams","$window","$location",t.Services.ModalDialog.serviceName,t.Services.trashServiceName,t.Services.Toastr.serviceName,t.Services.ServerConfig.serverConfigServiceName,t.Services.BsResourceDictionary.serviceName,function(e,t,s,a,r,o,n,l,c,u){i.$window=a,e.itemsToTrash=[],e.trashAssocAppSession={sendToTrash:!1},e.isWarningSectionVisible=!0,e.isPromptSectionVisible=!0,e.isProgressSectionVisible=!1,e.isTrashAssociatedAppSessVisible=!1,e.isDoneLoading=!1,e.btnConfirmVisible=!0,e.btnCancelVisible=!0,e.btnCloseVisible=!1,e.trashProgress={percentage:0,message:""},e.errorMessages=[];var d=e.dialogScope.resourceType.toLowerCase(),p=u[d];switch(d){case u.appsession.key:var m=e.dialogScope.selections;n.initTrashAppSession(m).then(function(t){angular.forEach(t.appSessions,function(t,i){e.itemsToTrash.push(t)}),e.totalSize=t.totalSize,e.isDoneLoading=!0});break;case u.run.key:var h=e.dialogScope.selections[0];h.HasCollaborators&&(e.hasCollaborators=!0),h.UserOwnedBy&&h.UserOwnedBy.Id===c.currentUserId&&(e.isOwner=!0),n.initTrashRun(h).then(function(t){e.itemsToTrash.push(t.run),e.totalSize=t.totalSize,t.associatedAppSessions.length&&(e.isTrashAssociatedAppSessVisible=!0,e.trashableAppSessions=t.associatedAppSessions),e.isDoneLoading=!0});break;case u.project.key:var f=e.dialogScope.selections[0];f.HasCollaborators&&(e.hasCollaborators=!0),f.UserOwnedBy&&f.UserOwnedBy.Id===c.currentUserId&&(e.isOwner=!0),e.itemsToTrash.push(n.createTrashableProject(f)),e.totalSize=f.TotalSize.toString(),e.isDoneLoading=!0;break;case u.sample.key:var v=e.dialogScope.selections;n.initTrashSample(v,c).then(function(t){angular.forEach(t.samples,function(t,i){e.itemsToTrash.push(t)}),e.totalSize=t.totalSize,e.isDoneLoading=!0})}e.resourceTypeLabelSingular=p.displayNameSingular.toLowerCase(),e.resourceTypeLabelPlural=p.displayNamePlural.toLowerCase(),e.onCancelClick=function(){e.dialogScope.selections.length=0,o.removeModal()},e.onConfirmClick=function(){e.isProgressSectionVisible=!0,e.isPromptSectionVisible=!1;var s;switch(e.dialogScope.resourceType.toLowerCase()){case"appsession":s="Analyses were moved to the trash",e.trashProgress.message="Moving analyses to the trash...",n.trashAppSessions(e.itemsToTrash,e.trashProgress).then(function(){i.handleSuccess(e,o,s,l,r,t,!0,e.dialogScope.redirectUrl,e.dialogScope.redirectToExternalApp)},function(t){i.handleErrors(e,t)});break;case"run":s="Run was moved to the trash",e.trashProgress.message="Moving run to the trash...",n.trashRuns(e.itemsToTrash,e.trashProgress).then(function(){e.isOwner||(s="This item was removed from your account"),e.trashAssocAppSession.sendToTrash?(e.trashProgress.message="Moving analyses to the trash...",n.trashAppSessions(e.trashableAppSessions,e.trashProgress).then(function(){i.handleSuccess(e,o,"Analyses were moved to the trash",l,r,t,!0)},function(t){i.handleErrors(e,t)})):i.handleSuccess(e,o,s,l,r,t,!0,e.dialogScope.redirectUrl,e.dialogScope.redirectToExternalApp)},function(t){i.handleErrors(e,t)});break;case"project":s="Project was moved to the trash",e.trashProgress.message="Moving project to the trash...",n.trashProject(e.itemsToTrash[0],e.trashProgress).then(function(){e.isOwner||(s="This item was removed from your account"),i.handleSuccess(e,o,s,l,r,t,!0,e.dialogScope.redirectUrl,e.dialogScope.redirectToExternalApp)},function(t){i.handleErrors(e,t)});break;case"sample":s="Sample was moved to the trash",e.trashProgress.message="Moving sample to the trash...",n.trashSamples(e.itemsToTrash,e.trashProgress).then(function(){i.handleSuccess(e,o,s,l,r,t,!0)},function(t){i.handleErrors(e,t)})}}}]}return i.prototype.handleSuccess=function(e,i,s,a,r,o,n,l,c){void 0===l&&(l=null),void 0===c&&(c=!1),e.dialogScope.selections.length=0,e.dialogScope.gridDataSource&&e.dialogScope.gridDataSource.fetchItems(),a.success(s),o.$broadcast(t.Directives.TrashIcon.EVENT_TRASHICON_UPDATE),l&&(c?this.$window.location.replace(l):r.url(l).replace()),n&&i.removeModal()},i.prototype.handleErrors=function(e,t){e.dialogScope.selections.length=0,null!=e.dialogScope.gridDataSource&&e.dialogScope.gridDataSource.fetchItems(),e.btnConfirmVisible=!1,e.btnCancelVisible=!1,e.btnCloseVisible=!0,e.isTrashAssociatedAppSessVisible=!1,e.isWarningSectionVisible=!1,e.isProgressSectionVisible=!1,angular.forEach(t,function(t,i){e.errorMessages.push(t.errorMessage)})},i}();i.TrashModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.editProjectModalDirectiveName="bsEditProjectModal",t.commonModule.directive(i.editProjectModalDirectiveName,[function(){return new s}]);var s=function(){function i(){this.template=e.Common.Templates.editProjectModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ModalDialog.serviceName,t.Services.Api.apiServiceName,function(e,t,i,s){e.nameInput=e.dialogScope.project.Name,e.descriptionInput=e.dialogScope.project.Description,e.onCloseClick=function(){i.removeModal()},e.onSaveClick=function(){e.errorMessage="";{var t={Id:e.dialogScope.project.Id,Name:e.nameInput,Description:e.descriptionInput};s.Project.save(t,function(){e.dialogScope.project.Name=t.Name,e.dialogScope.project.Description=t.Description,i.removeModal()},function(t){e.errorMessage=t.data.ResponseStatus.Message})}}}]}return i}();i.EditProjectModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.transferModalDirectiveName="bsTransferModal",t.commonModule.directive(i.transferModalDirectiveName,function(){return new s});var s=function(){function i(){var i=this;this.template=e.Common.Templates.transferModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ServerConfig.serverConfigServiceName,t.Services.Api.apiServiceName,t.Services.Toastr.serviceName,t.Services.ModalDialog.serviceName,t.Services.Validation.emailServiceName,function(e,t,s,a,r,o,n){e.confirmStep=!1,s.isEmailEnabled?(e.usernamePlaceholder="Email address",e.transfereeInputType="email"):(e.usernamePlaceholder="Username",e.transfereeInputType="text");var l;if("run"==e.dialogScope.resourceType){if(e.dialogScope.selections)l=e.dialogScope.selections[0],e.resource=l,e.resourceId=l.Id,e.resourceName=l.ExperimentName;else if(e.dialogScope.resource){var c=e.dialogScope.resource;e.resourceId=c.Id,e.resourceName=c.Name}}else if("project"==e.dialogScope.resourceType)if(e.dialogScope.selections)l=e.dialogScope.selections[0],e.resourceId=l.Id,e.resourceName=l.Name;else if(e.dialogScope.resource){var u=e.dialogScope.resource;e.resourceId=u.Id,e.resourceName=u.Name}e.onCloseClick=function(){o.removeModal()},e.onContinueClick=function(){angular.isDefined(e.emailAddress)&&n.isEmailValid(e.emailAddress)||!s.isEmailEnabled?(e.confirmStep=!0,e.invalidEmailMessage=null):e.invalidEmailMessage="Not a valid email."},e.onTransferClick=function(){var t,s={Id:e.resourceId,Email:e.emailAddress,Description:e.optionalMessage,Permission:"OWN"};"run"==e.dialogScope.resourceType?t=a.RunInvite.save(s,function(){i.onTransferSuccess(o,r,e.dialogScope)},function(t){e.errorMessage=t.data.ResponseStatus.Message}):"project"==e.dialogScope.resourceType&&(t=a.ProjectInvite.save(s,function(){if(e.dialogScope.resource){var t=e.dialogScope.resource;t.IsTransferPending=!0}i.onTransferSuccess(o,r,e.dialogScope)},function(t){e.errorMessage=t.data.ResponseStatus.Message}))}}]}return i.prototype.onTransferSuccess=function(e,t,i){i.gridDataSource&&i.gridDataSource.fetchItems(),i.selections&&(i.selections.length=0),e.removeModal(),t.success('<p><a href="/settings/transferhistory">Transfer invitation sent.<br/>View pending invitations &raquo;</a></p>'),i.reloadOnSave&&window.location.reload()},i}();i.TransferModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.transferOwnerDialogTriggerDirectiveName="bsTransferOwnerDialogTrigger",t.commonModule.directive(i.transferOwnerDialogTriggerDirectiveName,[t.Services.ModalDialog.serviceName,e.Common.Services.Api.apiServiceName,function(e,t){return new s(e,t)}]);var s=function(){function e(e,t){var i=this;this.restrict="A",this.modalDialog=e,this.scope={resourceId:"@?",resourceType:"@?",reloadOnSave:"@?",selections:"@?"},this.controller=["$scope",function(e){}],this.link=function(e,s,a){e.trigger=function(){var t={masterTemplate:"<bs-transfer-modal dialog-scope='dialogScope'></bs-transfer-modal>"},s={selections:e.selections,resourceType:e.resourceType,dismissByOutsideClick:!0,reloadOnSave:e.reloadOnSave};i.modalDialog.showModal(t,s)},e.dismiss=function(){i.modalDialog.removeModal()},s.on("click",function(){!e.selections&&e.resourceId&&e.resourceType?(e.selections=[],"run"===e.resourceType&&t.Run.get({Id:e.resourceId},function(t){var i=t.Response;e.selections.push(i),e.trigger()})):e.trigger()})}}return e}();i.TransferOwnerDialogTriggerDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.transferPendingModalDirectiveName="bsTransferPendingModal",t.commonModule.directive(i.transferPendingModalDirectiveName,function(){return new s});var s=function(){function i(){this.template=e.Common.Templates.pendingTransferModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ServerConfig.serverConfigServiceName,t.Services.Api.apiServiceName,t.Services.Toastr.serviceName,t.Services.ModalDialog.serviceName,function(e,t,i,s,a,r){var o,n,l;if("run"==e.dialogScope.resourceType)o=e.dialogScope.selections[0],e.resourceId=o.Id,e.resourceName=o.ExperimentName,e.resourceIcon=o.InstrumentType,n={RunId:e.resourceId,Statuses:"Pending",Permissions:"OWN"},l=s.InviteList.get(n,function(){e.invite=l.Response.Items[0]},function(e){});else if("project"==e.dialogScope.resourceType){if(e.dialogScope.selections)o=e.dialogScope.selections[0],e.resourceId=o.Id,e.resourceName=o.Name;else if(e.dialogScope.resource){var c=e.dialogScope.resource;e.resourceId=c.Id,e.resourceName=c.Name}n={ProjectId:e.resourceId,Statuses:"Pending",Permissions:"OWN"},l=s.InviteList.get(n,function(){e.invite=l.Response.Items[0]},function(e){})}e.onCloseClick=function(){r.removeModal()},e.onCancelTransferClick=function(){if(angular.isUndefined(e.invite)||angular.isUndefined(e.invite.Id))return void(e.errorMessage="Transfer cannot be canceled, because it was already accepted");{var t={Id:e.invite.Id};s.InvitesCancel.save(t,function(){if(e.dialogScope.gridDataSource&&e.dialogScope.gridDataSource.fetchItems(),e.dialogScope.selections&&(e.dialogScope.selections.length=0),"project"==e.dialogScope.resourceType&&e.dialogScope.resource){var t=e.dialogScope.resource;t.IsTransferPending=!1}r.removeModal(),a.success("Transfer Invitation Cancelled"),e.dialogScope.reloadOnSave&&window.location.reload()},function(t){e.errorMessage=t.data.ResponseStatus.Message})}}}]}return i}();i.TransferPendingModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.sampleCopyDirectiveName="bsSampleCopyModal",t.commonModule.directive(i.sampleCopyDirectiveName,function(){return new s});var s=function(){function i(){this.template=e.Common.Templates.sampleCopyModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ModalDialog.serviceName,e.Common.Services.Api.apiServiceName,e.Common.Services.ServerConfig.serverConfigServiceName,"toastr",e.Common.Services.resourceListIteratorName,e.Common.Services.siteNavigationServiceName,function(e,t,i,s,a,r,o,n){var l=e.dialogScope.selections[0];e.dialogScope.resourceId=l.Id,e.currentProject=e.dialogScope.resource,e.isNotValidProject=!0,e.isLoadingProjects=!0;var c={offset:0,limit:1e3,sortDir:"ASC",sortBy:"Name"},u=s.ProjectsList.get(c,{});e.projects=[],e.appendProjects=function(t){e.projects.push.apply(e.projects,t)},e.onIterateSuccessCallBack=function(t){e.appendProjects(t.Items)},u.$promise.then(function(){e.appendProjects(u.Response.Items),o.iterate(s.ProjectsList,c,u.Response,e.onIterateSuccessCallBack).then(function(){e.isLoadingProjects=!1})}),e.cancel=function(){i.removeModal()},e.copy=function(){var s=e.selectedProject,o=a.privateApiBaseUrl+"project/"+e.currentProject.Id+"/sample/copy",l=e.dialogScope.selections,c=[];l.forEach(function(e){c.push(parseInt(e.Id))});var u={action:"copy",destinationProjectId:s.Id,samples:c};e.isSaving=!0,t({method:"PUT",url:o,data:u}).success(function(t){e.dialogScope.selections.length=0,e.dialogScope.gridDataSource.fetchItems(),r.success("Successfully copied samples to:<br/> <span class='illumicons project'></span> <a href='"+n.urlProjectSummary(e.selectedProject.Id)+"'>"+e.selectedProject.Name+"</a>"),e.isSaving=!1,i.removeModal()}).error(function(t){e.errorMessages=[],angular.forEach(t.errors,function(t){e.errorMessages.push(t.ErrorMessage)}),console.log(t.errors[0].ErrorMessage),e.isSaving=!1})},e.onSelectChange=function(){e.isNotValidProject=null===e.selectedProject||angular.isUndefined(e.selectedProject)?!0:!1},e.selectItems=function(t){return t.Id!=e.currentProject.Id}}]}return i}();i.SampleCopyDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.sampleCombineDirectiveName="bsSampleCombineModal",t.commonModule.directive(i.sampleCombineDirectiveName,function(){return new s});var s=function(){function i(){var i=this;this.template=e.Common.Templates.sampleCombineModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ModalDialog.serviceName,function(e,t,s){i.sampleIds=[],e.vm={newSampleIdName:"",validationLoader:!0,serverWarnings:[],serverErrors:[]},angular.forEach(e.dialogScope.selections,function(e,t){i.sampleIds.push(e.Id)});var a={action:"validate",samplename:"",samples:i.sampleIds};t({method:"PUT",url:"/api/project/"+e.dialogScope.resource.Id+"/sample/merge",data:JSON.stringify(a)}).success(function(t,i,s,a){e.vm.serverErrors=t.errors,e.vm.serverWarnings=t.warnings,e.vm.validationLoader=!1}).error(function(e,t,i,s){}),e.onCombineClick=function(){var a={action:"merge",samplename:e.vm.newSampleIdName,samples:i.sampleIds};t({method:"PUT",url:"/api/project/"+e.dialogScope.resource.Id+"/sample/merge",data:JSON.stringify(a)}).success(function(t,i,a,r){e.vm.serverErrors=t.errors,e.vm.serverWarnings=t.warnings,e.dialogScope.selections.length=0,e.dialogScope.gridDataSource.fetchItems(),s.removeModal()}).error(function(e){var t;t=e&&e.errors&&e.errors.length>0?e.errors[0]:"Due to a server error, we were unable to combine your samples.",s.bootstrapAlert({headerTemplate:"<h4>Error combining samples</h4>",bodyTemplate:"<div class='alert alert-danger' style='padding:15px;font-size:inherit'>"+t+"</div>"})})},e.onCloseClick=function(){s.removeModal()}}]}return i}();i.SampleCombineModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.logTextAreaDirective="bsLogTextArea",t.commonModule.directive(i.logTextAreaDirective,[function(){return new s}]);var s=function(){function t(){var t=this;this.controller=["$scope",function(e){t.scope=e,t.scope.rows||(t.scope.rows=4)}],this.link=function(e,i,s,a,r){t._textareaJqElement=i.find("#logTextarea"),t._textareaElement=t._textareaJqElement[0],t._lastUpdatedJqElement=i.find("#lastUpdateSpan"),e.$watch(function(){return t._textareaElement.value},t.onContentChange),e.$watch(function(){return e.followTail},t.onFeatureChange),t._textareaJqElement.on("scroll",t.onScroll)},this.scrollToBottom=function(){t._shouldFollowTail&&t._scrollToBottom()},this._scrollToBottom=function(){t._textareaElement.scrollTop=t._textareaElement.scrollHeight},this.isAtBottom=function(){return Math.floor(t._textareaJqElement.scrollTop())===Math.floor(t._textareaElement.scrollHeight-t._textareaJqElement.innerHeight())},this.wasAtBottom=function(){var e=t._textareaElement.offsetHeight/t._textareaElement.rows,i=Math.ceil(t._textareaElement.scrollHeight/e),s=i-1,a=Math.ceil(t._textareaElement.scrollTop/e),r=t._textareaElement.rows,o=a+r;return o>=s},this.shouldFollowTail=function(){return void 0===t.scope.followTail||!!t.scope.followTail},this.onContentChange=function(e,i){var s=t.wasAtBottom();t._shouldFollowTail=t.shouldFollowTail()&&e===i||s,t._unseenContentAvailable=!s,t.scrollToBottom(),t.updateVisuals(),t.updateTimeStamp()},this.onFeatureChange=function(e,i){e!==!0||i||t._scrollToBottom()},this.onScroll=function(){t.scope.$apply(function(){var e=t.isAtBottom();t._shouldFollowTail=t.shouldFollowTail()&&e,t._unseenContentAvailable=t._unseenContentAvailable&&!e,t.updateVisuals()})},this.updateTimeStamp=function(){t.scope.lastUpdateStamp=new Date(Date.now()).toString()},this.updateVisuals=function(){t._textareaJqElement.toggleClass("following-tail",t._shouldFollowTail),t._textareaJqElement.toggleClass("unseen-content-available",t._unseenContentAvailable),t._lastUpdatedJqElement.toggleClass("unseen-content-available",t._unseenContentAvailable)},this.restrict="E",this.template=e.Common.Templates.bsLogTextAreaTemplate,this.replace=!1,this.scope={followTail:"=",rows:"@",bind:"&"}}return t}();i.LogTextAreaDirective=s}(s=i.LotTextArea||(i.LotTextArea={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.historyStateServiceName="tangGridHistoryStateService",e.commonModule.service(t.historyStateServiceName,["$location",function(e){return new i(e)}]);var i=function(){function e(e){this.$location=e}return e.prototype.getParamsFromUrl=function(){var e={};return angular.forEach(this.$location.search(),function(t,i){e[i]=t}),e},e.prototype.setSortParam=function(e,t){this.$location.search(e,t)},e.prototype.setParamOffset=function(e){this.$location.search(t.ServerPagingParams.OFFSET,e)},e.prototype.setCustomParam=function(e,t){this.$location.search(e,t)},e.prototype.setParamFromGridDataSource=function(e){this.$location.search(t.ServerPagingParams.OFFSET,e.offset),this.$location.search(t.ServerSortParams.SORT_BY,e.sortBy),this.$location.search(t.ServerSortParams.SORT_DIR,e.sortDir),this.$location.search(t.ServerPagingParams.LIMIT,e.limit)},e}();t.TangGridHistoryStateService=i}(i=t.TangGrid||(t.TangGrid={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.gridFilterServiceName="tangGridFilterService",e.commonModule.service(t.gridFilterServiceName,["$location",t.historyStateServiceName,function(e,t){return new i(e,t)}]);var i=function(){function e(e,t){this.historyStateService=t,this.$location=e}return e.prototype.applyFilter=function(e,t,i){if(i.filter.activeFilterParam[i.filter.filterName]=e.filterSelect.selectedVal,t.urlHistoryEnabled)this.historyStateService.setParamOffset(0),this.historyStateService.setCustomParam(i.filter.filterName,i.filter.activeFilterParam[i.filter.filterName]);else{t.gridDataSource.offset=0;var s=this.getActiveFiltersParam(t);t.gridDataSource.fetchItems(s)}i.filterMenuVisibility=!1},e.prototype.getActiveFiltersParam=function(e){var t={};return e&&e.headers&&angular.forEach(e.headers,function(e,i){e.filter&&e.filter.activeFilterParam&&angular.extend(t,e.filter.activeFilterParam)}),t},e.prototype.setFilterFromUrlParam=function(e,t,i,s){s&&(e.selectedVal=this.$location.search()[t],i.activeFilterParam[t]=this.$location.search()[t])},e}();t.TangGridFilterService=i}(i=t.TangGrid||(t.TangGrid={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.gridServiceName="tangGridService",e.commonModule.service(t.gridServiceName,["$location",t.historyStateServiceName,function(e,t){return new i(e,t)}]);var i=function(){function e(e,t){this.$location=e,this.gridHistoryStateService=t}return e.prototype.initDragOptions=function(e,t){for(var i=this,s=0;s<e.columns.length;s++){var a=e.columns[s];angular.isObject(a.dragOptions)&&(a.dragOptions.position={columnNumber:s,rowNumber:null},a.dragOptions.onAfterDragBegin=function(s){var a=s.$parent.$parent.$parent.gridRow;i.addItemToSelection(a,t,e),s.dragGroup.columns[0].items=t,s.dragGroup.clearSelections();for(var r=0;r<t.length;r++)s.dragGroup.selectedCells[0][r]=!0})}},e.prototype.populateGrid=function(e){this.populateGridRows(e.gridRows,e.gridOptions.gridDataSource.items,e.selections,e.gridOptions),this.handleCheckBoxAllSelection(e.selections,e.gridRows,e.gridOptions,e.checkBoxAll),e.gridOptions.multiSelection&&this.populateCheckBoxes(e,e.gridRows.length)},e.prototype.populateGridRows=function(e,t,i,s){e.length=0;for(var a=0;a<t.length;a++){var r=t[a],o={item:r,itemExistsInSelection:this.itemExistsInSelection(r,i,s.comparator),isRowSelectable:s.isRowSelectable(r)};e.push(o)}return e},e.prototype.selectAllCheckBox=function(e,t,i){for(var s=0;s<e.length;s++)this.addItemToSelection(e[s],t,i)},e.prototype.clearAllCheckBox=function(e,t,i){for(var s=0;s<e.length;s++)this.removeItemFromSelection(e[s],t,i)},e.prototype.clearAllSelections=function(e){for(var t=0;t<e.length;t++){var i=e[t];i.itemExistsInSelection=!1}},e.prototype.addItemToSelection=function(e,t,i){!this.itemExistsInSelection(e.item,t,i.comparator)&&i.isRowSelectable(e.item)&&(t.push(e.item),e.itemExistsInSelection=!0,angular.isFunction(i.selectionSorter)&&t.sort(i.selectionSorter))},e.prototype.removeItemFromSelection=function(e,t,i){this.itemExistsInSelection(e.item,t,i.comparator)&&t.splice(this.itemExistsAtIndex(e.item,t,i.comparator),1)},e.prototype.deselectItemFromGrid=function(e){e.itemExistsInSelection=!1},e.prototype.itemExistsInSelection=function(e,t,i){var s=!1,a=i?i:angular.equals;return t.forEach(function(t,i){a(t,e)&&(s=!0)}),s},e.prototype.itemExistsAtIndex=function(e,t,i){var s=-1,a=i?i:angular.equals;return t.forEach(function(t,i){a(t,e)&&(s=i)}),s},e.prototype.deselectRange=function(e,t,i,s){var a=null,r=null;if(e.startPosition>e.endPosition?(a=e.endPosition,r=e.startPosition):e.startPosition<e.endPosition&&(a=e.startPosition,r=e.endPosition+1),isFinite(a)&&isFinite(r)&&a!=r)for(var o=a;r>o;o++){var n=t[o],l=this.itemExistsAtIndex(n.item,i,s.comparator);l>-1&&(i.splice(l,1),n.itemExistsInSelection=!1)}},e.prototype.selectRange=function(e,t,i,s){var a=null,r=null,o=!1;if(e.startPosition>e.endPosition?(a=e.endPosition,r=e.startPosition+1):e.startPosition<e.endPosition&&(a=e.startPosition,r=e.endPosition+1),isFinite(a)&&isFinite(r)&&a!=r){o=!0;for(var n=a;r>n;n++){var l=t[n];!this.itemExistsInSelection(l.item,i,s.comparator)&&l.isRowSelectable&&(i.push(l.item),l.itemExistsInSelection=!0)}}return o},e.prototype.onRowSelectionChanged=function(e,t,i,s,a,r){s.multiSelection||(i.length=0,this.clearAllSelections(t)),angular.isObject(r)&&this.deselectRange(r,t,i,s);var o=!1;angular.isObject(a)&&(o=this.selectRange(a,t,i,s)),o||(this.itemExistsInSelection(e.item,i,s.comparator)?i.splice(this.itemExistsAtIndex(e.item,i,s.comparator),1):(i.push(e.item),e.itemExistsInSelection=!0)),angular.isFunction(s.selectionSorter)&&i.sort(s.selectionSorter);

},e.prototype.populateCheckBoxes=function(e,t){e.checkBoxes=[];for(var i=0;t>i;i++)e.checkBoxes[i]={selected:!1}},e.prototype.handleCheckBoxAllSelection=function(e,t,i,s){if(0==e.length)return void(s.selected=!1);for(var a=0,r=0,o=[],n=0;n<t.length;n++)t[n].isRowSelectable||o.push(t[n].item);for(var n=0;n<i.gridDataSource.items.length;n++){var l=i.gridDataSource.items[n];this.itemExistsInSelection(l,e,i.comparator)&&a++,this.itemExistsInSelection(l,o,i.comparator)&&r++}s.selected=a==i.gridDataSource.items.length-r?!0:!1},e.prototype.fetchItemsFromUrlParams=function(e){var i=this.gridHistoryStateService.getParamsFromUrl();e.gridDataSource.sortBy=this.$location.search()[t.ServerSortParams.SORT_BY]?i.sortby:e.gridDataSource.sortBy,e.gridDataSource.sortDir=this.$location.search()[t.ServerSortParams.SORT_DIR]?i.sortdir:e.gridDataSource.sortDir,e.gridDataSource.limit=this.$location.search()[t.ServerPagingParams.LIMIT]?i.limit:e.gridDataSource.limit,e.gridDataSource.offset=this.$location.search()[t.ServerPagingParams.OFFSET]?i.offset:e.gridDataSource.offset,e.gridDataSource.fetchItems(i)},e}();t.TangGridService=i}(i=t.TangGrid||(t.TangGrid={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.paginationServiceName="tangGridPaginationService",e.commonModule.service(t.paginationServiceName,[t.historyStateServiceName,t.gridFilterServiceName,function(e,t){return new i(e,t)}]);var i=function(){function e(e,t){this.gridHistoryStateService=e,this.gridFilterService=t}return e.prototype.updatePageable=function(e,t){t.isPageable=e.totalCount>e.limit?!0:!1,this.updatePageableBackward(t,e.offset),this.updatePageableForward(t,e)},e.prototype.updatePageableBackward=function(e,t){e.isPageBackwardDisabled=0==t?!0:!1},e.prototype.updatePageableForward=function(e,t){e.isPageForwardDisabled=t.offset+t.limit>=t.totalCount?!0:!1},e.prototype.setActivePage=function(e,t){angular.forEach(e,function(e,i){e.isActive=e.pageNumber==t?!0:!1})},e.prototype.createPageableItems=function(e,t){for(var i=[],s=e;t>=s;s++){var a={pageNumber:s,isActive:!1};i.push(a)}return i},e.prototype.getOffset=function(e,t){var i=e.pageNumber-1;return i*t.limit},e.prototype.gotoPage=function(e,t,i){var s=this.getOffset(e,i.gridDataSource);this.setPageOffset(s,t,i)},e.prototype.gotoLastPage=function(e,t,i){var s=Math.ceil(t.totalCount/t.limit),a=s-1,r=a*t.limit;this.setPageOffset(r,i,e)},e.prototype.pageForward=function(e,t,i){var s=t.offset+t.limit;this.setPageOffset(s,i,e)},e.prototype.pageBackward=function(e,t,i){var s=t.offset-t.limit;this.setPageOffset(s,i,e)},e.prototype.setPageOffset=function(e,t,i){if(t)this.gridHistoryStateService.setParamOffset(e);else{var s=this.gridFilterService.getActiveFiltersParam(i);i.gridDataSource.setOffset(e,s)}},e.prototype.updatePagination=function(e,t,i,s){var a=Math.ceil(i.offset/i.limit),r=Math.floor(a/s)*s,o=Math.ceil(i.totalCount/i.limit),n=r+s,l=o>n?n:o;e.pageItems=this.createPageableItems(r+1,l),this.setActivePage(e.pageItems,i.offset/i.limit+1),this.updatePageable(i,t)},e}();t.PaginationService=i}(i=t.TangGrid||(t.TangGrid={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.directiveName="bsTangGrid",t.commonModule.directive(i.directiveName,function(){return new a});var s=function(){function e(e,t){this.gridOptions=e,this.selections=t}return e.prototype.getNumRowsDisplayed=function(){return this.gridOptions.gridDataSource?this.gridOptions.gridDataSource.items.length:0},e.prototype.getTotalNumRows=function(){return this.gridOptions.gridDataSource?this.gridOptions.gridDataSource.totalCount:0},e.prototype.getNumRowsSelected=function(){return this.selections.length},e.prototype.onClearSelectionsClick=function(){this.selections.length=0},e}();i.GridSelectionCountHelper=s;var a=function(){function t(){this.restrict="E",this.scope={gridOptions:"=",selections:"=",gridRows:"=?"},this.template=e.Common.Templates.tangGrid,this.controller=["$scope","$location",i.gridServiceName,i.historyStateServiceName,function(t,a,r,o){if(!t.gridOptions)throw"Required gripOptions attribute not specified on <bs-tang-grid> directive.";if(null==t.selections&&(t.selections=[]),angular.isFunction(t.gridRows)||(t.gridRows=[]),t.gridOptions.showBadgeData===!0&&(t.badgeData=new s(t.gridOptions,t.selections)),r.initDragOptions(t.gridOptions,t.selections),t.radioBtns=[],t.gridOptions.autoFetch!==!1){var n=t.$watch("gridOptions.gridDataSource",function(e,i){t.gridOptions.urlHistoryEnabled||t.gridOptions.gridDataSource.fetchItems(),n()},!0);t.gridOptions.urlHistoryEnabled&&(void 0===a.search()[i.ServerSortParams.SORT_BY]&&void 0===a.search()[i.ServerSortParams.SORT_DIR]&&void 0===a.search()[i.ServerPagingParams.LIMIT]&&void 0===a.search()[i.ServerPagingParams.OFFSET]&&(o.setParamFromGridDataSource(t.gridOptions.gridDataSource),a.replace()),r.fetchItemsFromUrlParams(t.gridOptions),t.$on("$routeUpdate",function(){r.fetchItemsFromUrlParams(t.gridOptions)}))}t.gridOptions.noRecordsMessage||(t.gridOptions.noRecordsMessage="No matching records found"),t.lastSelectionRange={startPosition:null,endPosition:null},t.$watch("gridOptions.isRowSelectable",function(){null==t.gridOptions.isRowSelectable&&(t.gridOptions.isRowSelectable=function(e){return!0})}),t.$watch("gridOptions.multiSelection",function(){null==t.gridOptions.multiSelection&&(t.gridOptions.multiSelection=!1)}),t.$watch("gridOptions.showSelectionControl",function(){null==t.gridOptions.showSelectionControl&&(t.gridOptions.showSelectionControl=!0)}),t.$watch("selections",function(e,i){e.length<i.length&&angular.forEach(t.gridRows,function(e,i){r.itemExistsInSelection(e.item,t.selections,t.gridOptions.comparator)||r.deselectItemFromGrid(e)})},!0),t.$watch("gridOptions.gridDataSource.isLoading",function(e,i){1==i&&0==e&&r.populateGrid(t)}),t.gridOptions.gridDataSource&&(t.gridOptions.gridDataSource.forceRefresh=function(){r.populateGrid(t)}),t.onRadioClick=function(e,i){r.onRowSelectionChanged(e,t.gridRows,t.selections,t.gridOptions),i.stopPropagation()},t.onCheckBoxClick=function(e,i,s){t.onRowClicked(e,i,s),s.stopPropagation()},t.onCheckBoxAllChange=function(){1==t.checkBoxAll.selected?r.selectAllCheckBox(t.gridRows,t.selections,t.gridOptions):r.clearAllCheckBox(t.gridRows,t.selections,t.gridOptions)},t.onMouseDown=function(t){t.shiftKey&&e.Compatibility.preventTextSelection()},t.onRowClicked=function(e,i,s){if(t.gridOptions.allowSelection&&t.gridOptions.isRowSelectable(e.item)){var a={endPosition:null,startPosition:null},o=null;t.gridOptions.multiSelection&&(s.shiftKey?(a={endPosition:i,startPosition:t.lastSelectionRange.startPosition},o=t.lastSelectionRange):a={endPosition:i,startPosition:i}),r.onRowSelectionChanged(e,t.gridRows,t.selections,t.gridOptions,a,o),t.lastSelectionRange=a,t.gridOptions.rowClickAllowPropagation||s.stopPropagation()}}}]}return t}();i.Grid=a}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){t.commonModule.directive("bsTangGridHeader",function(){return new s});var s=function(){function t(){this.restrict="A",this.template=e.Common.Templates.tangGridHeader,this.controller=["$scope",i.gridServiceName,function(e,t){e.checkBoxAll={selected:!1},e.$watch("selections",function(){t.handleCheckBoxAllSelection(e.selections,e.gridRows,e.gridOptions,e.checkBoxAll)},!0)}]}return t}();i.HeaderRow=s}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){t.commonModule.directive("bsTangGridHeaderColumn",["$compile",function(e){return new s(e)}]);var s=function(){function t(t){this.restrict="A",this.scope={gridOptions:"=",header:"=",selections:"="},this.template=e.Common.Templates.tangGridHeaderColumn,this.$compile=t,this.controller=["$scope",i.historyStateServiceName,i.gridFilterServiceName,function(e,t,s){e.header&&e.header.cellTemplate&&(e.header.displayName=e.header.cellTemplate),e.sortDirection={isSortAsc:!1,isSortDesc:!1},e.header.filter&&(e.header.filterMenuVisibility=!1),e.$watch("gridOptions.gridDataSource.sortDir",function(){e.gridOptions.gridDataSource.sortDir===i.ServerSortDirection.ASC?(e.sortDirection.isSortAsc=!0,e.sortDirection.isSortDesc=!1):(e.sortDirection.isSortAsc=!1,e.sortDirection.isSortDesc=!0)}),e.onClickSort=function(a,r){if(e.gridOptions.urlHistoryEnabled?t.setParamOffset(0):e.gridOptions.gridDataSource.offset=0,e.gridOptions.gridDataSource.sortDir===i.ServerSortDirection.ASC)if(e.gridOptions.urlHistoryEnabled)t.setSortParam(i.ServerSortParams.SORT_BY,a),t.setSortParam(i.ServerSortParams.SORT_DIR,i.ServerSortDirection.DESC);else{var o=s.getActiveFiltersParam(e.gridOptions);e.gridOptions.gridDataSource.sort(a,!0,o)}else if(e.gridOptions.urlHistoryEnabled)t.setSortParam(i.ServerSortParams.SORT_BY,a),t.setSortParam(i.ServerSortParams.SORT_DIR,i.ServerSortDirection.ASC);else{var o=s.getActiveFiltersParam(e.gridOptions);e.gridOptions.gridDataSource.sort(a,!1,o)}r.preventDefault()}}]}return t}();i.HeaderColumnCell=s}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){t.commonModule.directive("bsTangGridRow",function(){return new s});var s=function(){function t(){this.restrict="A",this.template=e.Common.Templates.tangGridRow,this.link=function(e,t,i){}}return t}();i.Row=s}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){e.commonModule.directive("bsTangGridRowColumn",["$compile",function(e){return new i(e)}]);var i=function(){function e(e){var t=this;this.$compile=e,this.restrict="E",this.scope={gridOptions:"=",column:"=",rowData:"=",rowNumber:"="},this.link=function(e,i,s){var a;if(angular.isDefined(e.rowNumber)&&angular.isDefined(e.column.dragOptions)&&(e.column.dragOptions.position.rowNumber=e.rowNumber),e.column&&e.column.cellTemplate){var r;r="function"==typeof e.column.cellTemplate?e.column.cellTemplate(e.rowData):e.column.cellTemplate,a=t.$compile(r)(e),i.replaceWith(a)}else e.column&&e.column.field&&(a=t.$compile('<span ng-bind="rowData.'+e.column.field+'"></span>')(e),i.replaceWith(a))}}return e}();t.RowCell=i}(i=t.TangGrid||(t.TangGrid={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){t.commonModule.directive("bsTangGridPagination",function(){return new s}),i.MAX_PAGE=10;var s=function(){function t(){this.restrict="E",this.scope={gridOptions:"=",gridDataSource:"=",maxPaginationButtons:"=?",urlHistoryEnabled:"="},this.template=e.Common.Templates.tangGridPagination,this.controller=["$scope",i.paginationServiceName,i.historyStateServiceName,i.gridFilterServiceName,function(e,t,s,a){isFinite(e.maxPaginationButtons)||(e.maxPaginationButtons=i.MAX_PAGE),e.pageableRange={pageItems:[]},e.paginate={isPageBackwardDisabled:!0,isPageForwardDisabled:!0,isPageable:!1},e.$watch("gridDataSource.items",function(){t.updatePagination(e.pageableRange,e.paginate,e.gridDataSource,e.maxPaginationButtons)}),e.$watch("gridDataSource.totalCount",function(i,s){t.updatePagination(e.pageableRange,e.paginate,e.gridDataSource,e.maxPaginationButtons)}),e.$watch("gridDataSource.limit",function(){t.updatePagination(e.pageableRange,e.paginate,e.gridDataSource,e.maxPaginationButtons)}),e.$watch("gridDataSource.offset",function(i,s){t.updatePagination(e.pageableRange,e.paginate,e.gridDataSource,e.maxPaginationButtons)}),e.onFirstPageClick=function(i){t.setPageOffset(0,e.urlHistoryEnabled,e.gridOptions)},e.onPageBackwardClick=function(i){t.pageBackward(e.gridOptions,e.gridDataSource,e.urlHistoryEnabled),i.preventDefault()},e.onLastPageClick=function(i){t.gotoLastPage(e.gridOptions,e.gridDataSource,e.urlHistoryEnabled),i.preventDefault()},e.onPageForwardClick=function(i){t.pageForward(e.gridOptions,e.gridDataSource,e.urlHistoryEnabled),i.preventDefault()},e.onPageToClick=function(i,s){t.gotoPage(i,e.urlHistoryEnabled,e.gridOptions),s.preventDefault()}}]}return t}();i.Pagination=s}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.bsTangGridFilterDirectiveName="bsTangGridFilter",t.commonModule.directive(i.bsTangGridFilterDirectiveName,["$window","$document",function(e,t){return new a(e,t)}]);var s=250,a=function(){function t(t,a){var r=this;this.restrict="E",this.template=e.Common.Templates.tangGridFilter,this.$window=t,this.$document=a,this.controller=["$scope",i.gridFilterServiceName,function(e,t){var i=e.header.filter.filterName;e.filterSelect={selectedVal:""},e.header.filter.activeFilterParam={},e.header.filter.activeFilterParam[i]="",t.setFilterFromUrlParam(e.filterSelect,i,e.header.filter,e.gridOptions.urlHistoryEnabled),e.$on("$routeUpdate",function(){t.setFilterFromUrlParam(e.filterSelect,i,e.header.filter,e.gridOptions.urlHistoryEnabled)}),e.onFilterClick=function(t){e.header.filterMenuVisibility=!e.header.filterMenuVisibility,t.stopPropagation(),t.preventDefault()},e.onFilterMenuCancelClick=function(){e.header.filterMenuVisibility=!1},e.onFilterMenuConfirmClick=function(){e.selections.length=0,t.applyFilter(e,e.gridOptions,e.header)}}],this.link=function(e,t,i){if(e.header&&e.header.filter){var a=function(){e.header.filterMenuVisibility=!1,e.$digest()};r.$document.on("click",a),t.click(function(e){e.stopPropagation()}),e.$watch("header.filterMenuVisibility",function(i,a){if(i===!1)e.filterSelect.selectedVal=e.header.filter.activeFilterParam[e.header.filter.filterName];else{var o=t.find(".bs-tang-grid-filter-toggle")[0],n=t.find(".bs-tang-grid-filter-menu")[0],l=o.getBoundingClientRect();l.left+s>=r.$window.innerWidth&&angular.element(n).css("right","0px")}})}}}return t}();i.TangGridFilterDirective=a}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){var s;!function(i){i.analysisOutputProjectName="bsOutputProject",t.commonModule.directive(i.analysisOutputProjectName,["$document",t.Services.dropDownActionServiceName,function(e,t){return new s(e,t)}]);var s=function(){function i(i,s){var a=this;this.restrict="E",this.scope={properties:"="},this.template=t.Templates.bsOutputProject,this.$document=i,this.dropDownActionService=s,this.controller=["$scope",e.Common.Services.siteNavigationServiceName,function(e,t){e.projectsMenu={isVisible:!1},e.siteNavigationService=t,e.projects=[],a.dropDownActionService.registerDropDown(e.projectsMenu),e.properties&&angular.forEach(e.properties.Items,function(t,i){"Output.Projects"===t.Name&&angular.forEach(t.Items,function(t,i){e.projects.push(t)})}),e.onCloseClick=function(t){e.projectsMenu.isVisible=!1,t.stopPropagation(),t.preventDefault()},e.onMultipleLinkClick=function(t){a.dropDownActionService.hideAllDropDowns(e.projectsMenu),e.projectsMenu.isVisible=!e.projectsMenu.isVisible,t.stopPropagation(),t.preventDefault()}}],this.link=function(e,t,i){var s=function(){e.projectsMenu.isVisible=!1,e.$digest()};a.$document.on("click",s),e.$on("$destroy",function(){a.$document.off("click",s),a.dropDownActionService.unregisterDropDown(e.projectsMenu)})}}return i}();i.OutputProjectDirective=s}(s=i.OutputProject||(i.OutputProject={}))}(s=i.TangGrid||(i.TangGrid={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.launchDirectiveName="bsAppVersionLaunch",t.commonModule.directive(i.launchDirectiveName,[t.Services.BsResourceDictionary.serviceName,function(e){return new s(e)}]);var s=function(){function i(i){this.scope={options:"="},this.template=t.Templates.appVersionLaunch,this.link=function(e,t,i){var s=function(i){if(e&&e.isOpen){var s=t.find(i.target).length>0;if(s)return;e.$apply(function(){return e.isOpen=!1})}};angular.element(document).click(s),e.$on("$destroy",function(){angular.element(document).off("click",s)})},this.controller=["$scope","$filter","$timeout",function(t,i,s){t.onClickLaunchButton=function(){var e=i("appLaunchHref")(t.options.selectedVersion);e&&"#"!=e&&(window.location.href=e)},t.selectItem=function(e){return t.options.selectedVersion&&e&&t.options.selectedVersion.Id===e.Id?void(t.isOpen=!1):void(t.options.selectedVersion=e)},t.getIconClass=function(t){var i=t?t.toLowerCase():"";return i===e.Common.Services.Api.ApplicationStatus.INITIALIZING?"bs-app-dropdown-new-icon":i===e.Common.Services.Api.ApplicationStatus.DISABLED?"bs-app-dropdown-disabled-icon":i===e.Common.Services.Api.ApplicationStatus.DEPRECATED?"bs-app-dropdown-deprecated-icon":i===e.Common.Services.Api.ApplicationStatus.PUBLISHED?"bs-app-dropdown-published-icon":i===e.Common.Services.Api.ApplicationStatus.DEVELOPMENT?"bs-app-dropdown-development-icon":"bs-app-dropdown-default-icon"},t.getStatusDescription=function(e){var s=i("filter")(t.options.applicationMetadata.Statuses,{Name:e},!0);return s.length?s[0].Description:"Not found"},t.isPublished=function(t){return null!=t&&t.toLowerCase()===e.Common.Services.Api.ApplicationStatus.PUBLISHED},t.getVersionsForDropdown=function(){return t.options&&t.options.versions.length>0?t.options.versions:[t.options.selectedVersion]}}]}return i}();i.LaunchDirective=s}(s=i.AppVersion||(i.AppVersion={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.createVersionFormDirectiveName="bsAppVersionForm",e.commonModule.directive(t.createVersionFormDirectiveName,function(){return new i});var i=function(){function t(){this.template=e.Templates.appVersionForm,this.restrict="E",this.scope={options:"="}}return t}();t.CreateVersionFormDirective=i}(i=t.AppVersion||(t.AppVersion={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){t.createVersionModalTriggerDirectiveName="bsAppVersionCreatorDialogTrigger",e.commonModule.directive(t.createVersionModalTriggerDirectiveName,["$q",e.Services.ModalDialog.serviceName,e.Services.Api.apiServiceName,function(e,t,s){return new i(e,t,s)}]);var i=function(){function e(e,t,i){this.restrict="A",this.modalDialog=t,this.scope={options:"="},this.link=function(s,a,r){a.on("click",function(){s.$apply(function(){t.bootstrapConfirm({bodyTemplate:"<bs-app-version-form options='dialogScope.options'></bs-app-version-form>",headerTemplate:"New Version",dialogScope:s,confirmLabel:"Create",cancelLabel:"Cancel",onBeforeConfirmAsync:function(){var t=e.defer();return i.Application.createVersion({Id:s.options.sourceApp.Id,VersionNumber:s.options.newVersionNumber},function(e){t.resolve(e.Response)},function(e){s.options.serverError=e.data.ResponseStatus.Message,t.reject()}),t.promise}}).then(function(e){angular.isFunction(s.options.onSuccess)&&s.options.onSuccess(e)},function(){angular.isFunction(s.options.onFail)&&s.options.onFail()})})})}}return e}();t.CreateVersionModalTriggerDirective=i}(i=t.AppVersion||(t.AppVersion={}))}(i=t.Modals||(t.Modals={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.versionAccordionDirectiveName="bsAppVersionAccordion",t.commonModule.directive(i.versionAccordionDirectiveName,function(){return new s});var s=function(){function i(){this.template=t.Templates.appVersionAccordion,this.restrict="E",this.controller=["$scope","$q","$timeout","$rootScope","$window",t.Services.ModalDialog.serviceName,t.Services.Api.apiServiceName,t.Services.appVersionsGridDataSourceFactoryName,function(t,i,s,a,r,o,n,l){t.newVersionOptions={sourceApp:null,newVersionNumber:null,serverError:null,onSuccess:function(e){r.location.href="/apps/"+e.Id+"/details"}},t.$watchCollection("selections",function(){t.selections&&t.selections.length>0&&(t.newVersionOptions.sourceApp=t.selections[0])}),t.expand=function(i){t.newVersionOptions.sourceApp=null;var s=l.getAppVersionsDataSource(i.Id);s.limit=10,t.expandedApp=i,t.selections=[],t.gridOptions={headers:[{displayName:"Version",field:"VersionNumber",sortable:!0,sortBy:"VersionNumber"},{displayName:"Status",field:"PublishStatus",sortable:!1,sortBy:"PublishStatus"},{displayName:"Date Created",field:"DateCreated",sortable:!0,sortBy:"DateCreated"}],columns:[{field:"VersionNumber",cellTemplate:e.Common.Templates.appVersionCellVersionNumber},{field:"PublishStatus",cellTemplate:e.Common.Templates.appVersionCellStatus},{field:"DateCreated",cellTemplate:e.Common.Templates.appVersionCellDateCreated}],gridDataSource:s,allowSelection:!0,multiSelection:!1}},t.options={sourceApp:null,newVersionNumber:null};var c=n.Application.getMetadata({},function(e){t.statuses=e.Response.Statuses}).$promise,u=n.Application.queryMyApps({sortby:"name",sortdir:"asc",limit:"250"},function(e){t.apps=e.Response.Items}).$promise;i.all([c,u]).then(function(){t.apps.length>0&&t.expand(t.apps[0])})}]}return i}();i.VersionAccordionDirective=s}(s=i.AppVersion||(i.AppVersion={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.trayDirectiveName="bsTray",e.commonModule.directive(t.trayDirectiveName,["$compile",function(e){return new i(e)}]);var i=function(){function t(t){this.restrict="E",this.scope={messages:"=",isExpanded:"=?",attachment:"@",statusSummary:"=",onClickReadMore:"=?",onMouseEnterReadMore:"=?",onMouseLeaveReadMore:"=?",readMoreHref:"=?"},this.$compile=t,this.template=e.Templates.tray,this.controller=["$scope",function(t){t.readMoreHref||(t.readMoreHref="#"),t.onClickReadMore||(t.onClickReadMore=function(){return null}),t.onMouseEnterReadMore||(t.onMouseEnterReadMore=function(){return null}),t.onMouseLeaveReadMore||(t.onMouseLeaveReadMore=function(){return null}),t.$watchCollection("messages",function(i){if(angular.isArray(t.messages)){t.messages.length<1&&(t.isExpanded=!1);for(var s=!1,a=!1,r=0;r<t.messages.length;r++){var o=t.messages[r];if(o.type==e.Interfaces.MessageType.ERROR)return void(t.statusSummary.type=e.Interfaces.MessageType.ERROR);o.type==e.Interfaces.MessageType.WARNING&&(s=!0),o.type==e.Interfaces.MessageType.SUCCESS&&(a=!0)}t.statusSummary.type=s?e.Interfaces.MessageType.WARNING:a?e.Interfaces.MessageType.SUCCESS:e.Interfaces.MessageType.INFO}}),t.toggleTray=function(){t.isExpanded=!t.isExpanded}}],this.link=function(e,i,s){t(i.find(".bs-tray-content ul"))}}return t}();t.TrayDirective=i}(i=t.Tray||(t.Tray={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.trashIconDirectiveName="bsTrashIcon",i.EVENT_TRASHICON_UPDATE="EVENT_TRASHICON_UPDATE",t.commonModule.directive(i.trashIconDirectiveName,function(){return new s});var s=function(){function s(){this.template=e.Common.Templates.trashIcon,this.restrict="E",this.scope={control:"="},this.controller=["$rootScope","$scope",t.Services.ServerConfig.serverConfigServiceName,t.Services.Api.apiServiceName,function(e,t,s,a){t.getTrashCount=function(){var e=a.TrashList.get({},function(){t.trashCount=e.Response.TotalCount.toString()},function(){})},t.getTrashCount(),t.$on(i.EVENT_TRASHICON_UPDATE,function(){t.getTrashCount()})}]}return s}();i.TrashIconDirective=s}(s=i.TrashIcon||(i.TrashIcon={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.previewDirectiveName="bsPreview",t.commonModule.directive(i.previewDirectiveName,["$q",t.Services.BsResourceDictionary.serviceName,t.Services.Api.apiServiceName,t.Services.fileUtilsServiceName,t.Services.Api.Dataset.serviceName,function(e,t,i,a,r){return new s(e,t,i,a,r)}]);var s=function(){function i(t,i,s,a,r){var o=this;this.$q=t,this.resourceDictionary=i,this.api=s,this.datasetApi=r,this.fileUtils=a,this.template=e.Common.Templates.preview,this.restrict="E",this.scope={type:"@",sample:"=?",project:"=?",appresult:"=?",run:"=?",app:"=?",file:"=?",id:"@",isVisible:"=?",parentEntity:"=?",showChartPreview:"=?",view:"@?",datasetFiles:"=?"},this.controller=["$scope","$timeout",function(e,t){if(o.$timeout=t,e.isLoading=!1,!e.type)throw new Error("Can't show a preview directive unless 'type' is specified (run, project, etc.)")}],this.link=function(e,t,i){angular.isDefined(e.isVisible)?e.$watch("isVisible",function(){1!=e.isVisible||e.isInitialized||o.initPreview(e,t)}):o.initPreview(e,t)}}return i.prototype.initPreview=function(e,t){if(!e.isInitialized)switch(e.type){case this.resourceDictionary.app.key:this.initAppPreview(e,t);break;case this.resourceDictionary.run.key:this.initRunPreview(e,t);break;case this.resourceDictionary.project.key:this.initProjectPreview(e,t);break;case this.resourceDictionary.appresult_file.key:this.initFilePreview(e,t);break;case this.resourceDictionary.appresult.key:this.initAppResultPreview(e,t);break;case this.resourceDictionary.sample.key:this.initSamplePreview(e,t);break;case this.resourceDictionary.dataset.key:this.initDatasetPreview(e,t);break;default:throw new Error("Unknown resource type "+e.type)}},i.prototype.initDatasetPreview=function(e,t){switch(e.view){case"files":e.datasetFiles||this.datasetApi.queryFiles({Id:e.id,Limit:100}).then(function(t){e.datasetFiles=t.Items});break;default:throw new Error("Unknown view type "+e.view)}},i.prototype.initRunPreview=function(t,i){var s,a=this;if(t.run){var r=this.$q.defer();s=r.promise,this.onFinishLoading(t),r.resolve()}else t.isLoading=!0,t.run=this.api.Run.get({Id:t.id},function(){a.onFinishLoading(t)}),s=t.run.$promise;var o=t.id?t.id:t.run.Response.Id;t.showChartPreview&&t.run.Response.PlatformName!=e.Common.Interfaces.InstrumentPlatforms.NeoPrep&&(t.isChartVisible=!0,t.isLoadingChart=!0,t.cyclePlot=this.api.Run.getCyclePlot({Id:o,Metric:"Intensity",SurfaceIndex:"0",LaneIndex:"0",ChannelIndex:"4"},function(i){i=i.Response,i&&s.then(function(){var s=".bs-preview-chart";angular.element(s).empty();new e.LineChart(i,{chartContainerSelector:s,width:400,height:300,preserveAspectRatio:"none",margins:{top:20,left:25,right:0,bottom:20}});angular.element(".bs-preview-chart-run-title-"+o).show(),t.isLoadingChart=!1})},function(){t.isLoadingChart=!1,t.isChartVisible=!1}))},i.prototype.initProjectPreview=function(e,t){var i=this;e.project?this.onFinishLoading(e):(e.isLoading=!0,e.project=this.api.Project.get({Id:e.id},function(){return i.onFinishLoading(e)}))},i.prototype.initAppPreview=function(e,t){var i=this;e.app?this.onFinishLoading(e):(e.isLoading=!0,e.app=this.api.Application.get({Id:e.id},function(){return i.onFinishLoading(e)}))},i.prototype.onFinishLoading=function(e){e.isLoading=!1,e.isInitialized=!0},i.prototype.initFilePreview=function(e,i){var s=this;e.showImagePreview=!1,e.showTextPreview=!1,e.showPdfPreview=!1;var a;if(e.file){var r=this.$q.defer();a=r.promise,r.resolve()}else e.isLoading=!0,e.file=this.api.File.get({Id:e.id}),a=e.file.$promise;a.then(function(i){var a=s.fileUtils.getPreviewType(e.file.Response);switch(a){case t.Services.FilePreviewType.Image:e.showImagePreview=!0;break;case t.Services.FilePreviewType.Text:e.showTextPreview=!0;break;case t.Services.FilePreviewType.Pdf:e.showPdfPreview=!0}e.file.Response.ParentAppResult?s.api.AppSession.get({Id:e.file.Response.ParentAppResult.AppSession.Id},function(t){t=t.Response,t&&(e.parentEntity=t,e.parentEntity.ParentProjects=e.file.Response.ParentProjects)}).$promise.then(function(){s.onFinishLoading(e)}):s.onFinishLoading(e)})},i.prototype.initSamplePreview=function(e,t){var i=this;e.sample?this.onFinishLoading(e):(e.isLoading=!0,e.sample=this.api.Sample.get({Id:e.id},function(){return i.onFinishLoading(e)}))},i.prototype.initAppResultPreview=function(e,t){var i=this;e.appresult?this.onFinishLoading(e):(e.isLoading=!0,e.appresult=this.api.AppResult.get({Id:e.id},function(){return i.onFinishLoading(e)}))},i.MAX_FILE_PREVIEW_IN_BYTES=2621440,i}();i.PreviewDirective=s}(s=i.Preview||(i.Preview={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.searchTableDirectiveName="bsSearchTable",t.commonModule.directive(i.searchTableDirectiveName,[t.Services.BsResourceDictionary.serviceName,function(e){return new s(e)}]);var s=function(){function i(i){var s=this;this.resourceDictionary=i,this.restrict="E",this.template=e.Common.Templates.searchTable,this.scope={selections:"=?",baseQuery:"=?",resourceType:"@",gridDataSource:"=?listdata",gridRows:"=?",multiselect:"=?",showSelectionControl:"=?",showSelectAllLabel:"=?",isRowSelectable:"=?",confirmedSelections:"=?",searchFilters:"=?",panelVisible:"=",accordionItems:"=?",rowTemplate:"@?",allowSelection:"=?",dragOptions:"=?",showBadgeData:"=?",showFilters:"=?",showSelectedItemsList:"=?",maxPaginationButtons:"=?"},this.controller=["$scope",t.Services.Search.searchGridDataSourceFactoryName,function(e,a){var r=null,o=null,n=null,l=null,c=null,u=null;if(angular.isDefined(e.showFilters)||(e.showFilters=!0),angular.isDefined(e.showSelectedItemsList)||(e.showSelectedItemsList=!0),e.rowTemplate||(e.rowTemplate="searchResultsRow"),e.searchFilters||(e.searchFilters={activeFilters:[]}),(null===e.allowSelection||void 0===e.allowSelection)&&(e.allowSelection=!0),!s.resourceDictionary.hasOwnProperty(e.resourceType))throw new Error("No search table resource config present for specified resource type '"+e.resourceType+"'.");r=s.resourceDictionary[e.resourceType];var d;if(!r.templates.hasOwnProperty(e.rowTemplate)||!r.templates[e.rowTemplate])throw new Error("Template '"+e.rowTemplate+"' is not present for resource type '"+e.resourceType+"'.");if(d=r.templates[e.rowTemplate],l=[{field:"",displayName:r.displayNamePlural,sortable:!1}],c=[{field:"",cellTemplate:d}],e.dragOptions){c[0].dragOptions=angular.extend({position:{column:0}},e.dragOptions);var p=new t.Services.Matrix.SpreadsheetColumn("","",1048);p.items=e.gridDataSource.items;var m={add:null,canAdd:null,columns:[p],maxRows:1048,name:"",title:"",selectedCells:[[]],persistItemsAfterDragAway:!0,dataType:t.Services.DataType.SEARCH_RESULT_ITEM,clearSelections:function(){m.selectedCells=[[]]},isInvalidDropAttempted:!1};c[0].dragGroup=m}u=i.getComparatorForResource(r),o=i.getIdAccessorForResource(r),n=i.getNameAccessorForResource(r),e.gridDataSource||(e.gridDataSource=a.getSearchList(r)),e.gridDataSource.scope||(e.gridDataSource.scope=r.searchScope),e.selections||(e.selections=[]),e.multiselect=e.multiselect===!0||"true"===e.multiselect?!0:!1,e.gridOptions={autoFetch:!(e.searchFilters.preselections&&e.searchFilters.preselections.length>0),maxPaginationButtons:e.maxPaginationButtons,gridDataSource:e.gridDataSource,allowSelection:e.allowSelection,headers:l,columns:c,limit:50,comparator:u,multiSelection:e.multiselect,showSelectionControl:e.showSelectionControl,showSelectAllLabel:e.showSelectAllLabel,isRowSelectable:e.isRowSelectable,selectionSorter:function(e,t){return e.sortIndex-t.sortIndex},showBadgeData:e.showBadgeData},e.baseQuery&&(e.gridDataSource.baseQuery=e.baseQuery),e.confirmedSelections&&(e.selections.length=0,angular.forEach(e.confirmedSelections,function(t,i){e.selections.push(t)})),e.$watch("panelVisible",function(t,i){e.panelVisible||(e.accordionItems&&e.accordionItems.filters&&(e.accordionItems.filters.isOpen=!1),
e.accordionItems&&e.accordionItems.selections&&(e.accordionItems.selections.isOpen=!1))}),e.$watch("searchFilters.activeFilters",function(t,i){t!=i&&(e.gridDataSource.offset=0,e.gridDataSource.setSearchFilters(e.searchFilters.activeFilters),0===e.searchFilters.activeFilters.length&&e.searchFilters.preselections&&(e.searchFilters.preselections=""))},!0),e.$watch("searchFilters.currentResourceType",function(t,s){if(t){var a=i[t],r=a.searchScope;r!=e.gridDataSource.scope&&(e.gridDataSource.resourceConfig=a,e.gridDataSource.scope=r,e.gridDataSource.fetchItems())}}),e.$watch("selections",function(t,i){e.selectionsDisplay=[];for(var s=0;s<e.selections.length;s++){var a={selection:e.selections[s],name:n(e.selections[s])};e.selectionsDisplay.push(a)}},!0),e.removeItem=function(t){var i=e.selections.indexOf(t);e.selections.splice(i,1)},e.onClosePanelClick=function(){e.panelVisible=!e.panelVisible}}]}return i}();i.SearchTable=s}(s=i.SearchTable||(i.SearchTable={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.accordionDirectiveName="bsAccordion",t.commonModule.directive(i.accordionDirectiveName,[function(){return new s}]);var s=function(){function t(){this.restrict="E",this.transclude=!0,this.template=e.Common.Templates.accordion,this.link=function(e,t){}}return t}();i.AccordionDirective=s,i.accordionItemDirectiveName="bsAccordionItem",t.commonModule.directive(i.accordionItemDirectiveName,[function(){return new r}]);var a=function(){function e(e){this.$scope=e,this.isOpen=this.$scope.isOpen}return e.prototype.toggleCollapse=function(){this.$scope.isOpen=!this.$scope.isOpen},e}();i.AccordionItemCtrl=a;var r=function(){function t(){this.restrict="E",this.template=e.Common.Templates.accordionItem,this.transclude=!0,this.scope={isOpen:"=?"},this.controller=["$scope",a],this.link=function(e,t,i){e.$watch("isOpen",function(i,s){e.isOpen?angular.forEach(t.find("div"),function(e,t){if(angular.element(e).hasClass("bs-accordion-body")&&angular.element(e).addClass("open"),angular.element(e).hasClass("bs-accordion-header")){var i=angular.element(e).find("span");angular.forEach(i,function(e,t){angular.element(e).hasClass("bs-accordion-toggle-arrow")&&(angular.element(e).removeClass("icon-triangle-right"),angular.element(e).addClass("icon-triangle-down"))})}}):angular.forEach(t.find("div"),function(e,t){if(angular.element(e).hasClass("bs-accordion-body")&&angular.element(e).removeClass("open"),angular.element(e).hasClass("bs-accordion-header")){var i=angular.element(e).find("span");angular.forEach(i,function(e,t){angular.element(e).hasClass("bs-accordion-toggle-arrow")&&(angular.element(e).removeClass("icon-triangle-down"),angular.element(e).addClass("icon-triangle-right"))})}})})}}return t}();i.AccordionItemDirective=r,i.accordionHeaderDirectiveName="bsAccordionHeader",t.commonModule.directive(i.accordionHeaderDirectiveName,[function(){return new o}]);var o=function(){function t(){this.restrict="E",this.template=e.Common.Templates.accordionHeader,this.transclude="element",this.replace=!0,this.require="^bsAccordionItem",this.link=function(e,t,i,s){e.onToggleCollapse=function(){s.toggleCollapse()}}}return t}();i.AccordionHeaderDirective=o,i.accordionBodyDirectiveName="bsAccordionBody",t.commonModule.directive(i.accordionBodyDirectiveName,[function(){return new n}]);var n=function(){function t(){this.restrict="E",this.template=e.Common.Templates.accordionBody,this.transclude=!0,this.replace=!0,this.link=function(e,t,i){}}return t}();i.AccordionBodyDirective=n}(s=i.Accordion||(i.Accordion={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.directiveName="bsSearchFilters",t.commonModule.directive(i.directiveName,[t.Services.Api.apiServiceName,t.Services.BsResourceDictionary.serviceName,"$q",t.Services.Search.filterSelectionManagerName,function(e,t,i,a){return new s(e,t,i,a)}]);var s=function(){function i(i,s,a,r){var o=this;this.restrict="E",this.template=e.Common.Templates.searchFilter,this.resourceDictionary=s,this.api=i,this.$q=a,this.filterSelectionManager=r,this.scope={resourceType:"@",searchFilters:"=",baseQuery:"@?",onTrayVisibilityChange:"&?"},this.controller=["$scope",e.Common.Services.Search.searchFilterName,t.Services.currentUserServiceName,function(e,t,i){if(e.isLoading=!0,e.allFilters=[],e.onResourceSelectionChange=function(i){e.searchFilters.currentResourceType=i;var s=o.resourceDictionary[e.searchFilters.currentResourceType];o._initFilters(e,t,s)},e.initResourceTypeSelection=function(){e.desiredResourceType=e.searchFilters.currentResourceType;var i=o.resourceDictionary[e.searchFilters.currentResourceType];o._initFilters(e,t,i)},e.resourceFilterChoices=[{label:"All Items",value:o.resourceDictionary.uiAll.key},{label:o.resourceDictionary.project.displayNamePlural,value:o.resourceDictionary.project.key},{label:o.resourceDictionary.sample.displayNamePlural,value:o.resourceDictionary.sample.key},{label:o.resourceDictionary.appresult_file.displayNamePlural,value:o.resourceDictionary.appresult_file.key},{label:o.resourceDictionary.run.displayNamePlural,value:o.resourceDictionary.run.key},{label:o.resourceDictionary.app.displayNamePlural,value:o.resourceDictionary.app.key},{label:o.resourceDictionary.appsession.displayNamePlural,value:o.resourceDictionary.appsession.key}],"uiAll"===e.resourceType)e.isMixed=!0;else{var s=o.resourceDictionary[e.resourceType];i.getCurrentUser(!1).then(function(i){var a=i.Features.indexOf("LaneQCChecking")>-1;a||(s.searchFilters=s.searchFilters.filter(function(e){return"run-lane-and-qc-status-filter"!==e.id})),o._initFilters(e,t,s)})}e.onFilterChoiceChange=function(t){if(null==t.currentChoice)e.removeFilter(t);else{if("textbox"===t.uiType)if(t.choiceValueAccessor){try{t.currentChoice.value=t.choiceValueAccessor(t.currentChoice.label)}catch(i){}if(!t.currentChoice.value){var s=t.choices.filter(function(e){return e.label===t.currentChoice.label});s.length>0&&(t.currentChoice.value=s[0].value)}}else t.currentChoice.value=t.currentChoice.label;null==t.currentChoice.value?e.removeFilter(t):e.activateFilter(t)}o.filterSelectionManager.updatePreselectionsString(e)},e.removeFilter=function(t){var i=e.searchFilters.activeFilters.indexOf(t);i>-1&&(t.currentChoice=null,e.searchFilters.activeFilters.splice(i,1))},e.activateFilter=function(t){var i=e.searchFilters.activeFilters.indexOf(t);0>i&&e.searchFilters.activeFilters.push(t)},e.toggle=function(){e.isTrayVisible=!e.isTrayVisible;var t=e.onTrayVisibilityChange;angular.isDefined(t)&&e.onTrayVisibilityChange({isTrayVisible:e.isTrayVisible})}}]}return i.prototype._initFilters=function(e,t,i){var s=this;e.searchFilters.activeFilters=[],e.allFilters=[],"uiAll"!=i.key?this.filterSelectionManager.initFilters(e.baseQuery,i,e.allFilters,e.searchFilters.availableFilters).then(function(){return s._onFiltersReady(e)}):e.isLoading=!1},i.prototype._onFiltersReady=function(e){this.filterSelectionManager.setFilterSelections(e),e.isLoading=!1},i}();i.SearchFilterDirective=s}(s=i.SearchFilter||(i.SearchFilter={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.analysisConfirmStopDirectiveName="bsAnalysisConfirmStopModal",t.commonModule.directive(i.analysisConfirmStopDirectiveName,[t.Services.Api.apiServiceName,function(e){return new s(e)}]);var s=function(){function i(i){this.template=e.Common.Templates.analysisConfirmStopModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$rootScope","$routeParams","$window","$location",t.Services.ModalDialog.serviceName,function(e,t,s,a,r,o){e.onCancelClick=function(){o.removeModal()},e.onConfirmClick=function(){e.isStopping=!0,e.errorMessage=null,i.AppSession.stop({Id:e.dialogScope.analysisId},function(t){o.removeModal(),e.dialogScope.onStopSuccessback()},function(t){e.errorMessage=t.data.ResponseStatus.Message}).$promise["finally"](function(){e.isStopping=!1})}}]}return i}();i.AnalysisConfirmStopDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.editAnalysisModalDirectiveName="bsEditAnalysisModal",t.commonModule.directive(i.editAnalysisModalDirectiveName,[function(){return new s}]);var s=function(){function i(){this.template=e.Common.Templates.editAnalysisModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope","$http",t.Services.ModalDialog.serviceName,t.Services.Api.apiServiceName,function(e,t,i,s){e.nameInput=e.dialogScope.analysis.Name,e.onCloseClick=function(){i.removeModal()},e.onSaveClick=function(){e.errorMessage="";{var t={Id:e.dialogScope.analysis.Id,Name:e.nameInput,Status:e.dialogScope.analysis.Status,StatusSummary:e.dialogScope.analysis.StatusSummary};s.AppSession.save(t,function(){e.dialogScope.analysis.Name=t.Name,i.removeModal(),window.location.reload(!0)},function(t){e.errorMessage=t.data.ResponseStatus.Message})}}}]}return i}();i.EditAnalysisModalDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.bioSamplePickerDirectiveName="bsBioSamplePickerModal",t.commonModule.directive(i.bioSamplePickerDirectiveName,function(){return new s});var s=function(){function i(){this.template=e.Common.Templates.bioSamplePickerModal,this.restrict="E",this.scope={dialogScope:"="},this.controller=["$scope",t.Services.ModalDialog.serviceName,t.Services.BioSample.bioSampleGridDataSourceFactoryName,function(e,t,i){var s=i.getBioSampleList();s.limit=25,s.sortBy="DateModified",e.selections=[],e.gridOptions={headers:[{displayName:"Sample ID",field:"UserSampleId",sortable:!0,sortBy:"UserSampleId"},{displayName:"Species",field:"Species",sortable:!1}],columns:[{field:"UserSampleId"},{field:"Species.Name"}],gridDataSource:s,allowSelection:!0,multiSelection:!1},e.onCancelClick=function(){t.removeModal()},e.onSelectClick=function(){e.dialogScope.onSelectCallBack(e.selections),t.removeModal()},e.onNewClick=function(){var i={masterTemplate:"<bs-bio-sample-create-modal dialog-scope='dialogScope'></bs-bio-sample-create-modal>"},s={onSuccessCallBack:e.onCreateSample};t.showModal(i,s)},e.onCreateSample=function(t){var i=[t.Response];e.dialogScope.onSelectCallBack(i)}}]}return i}();i.BioSamplePickerDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.bioSampleCreateDirectiveName="bsBioSampleCreateModal",t.commonModule.directive(i.bioSampleCreateDirectiveName,[t.Services.Api.apiServiceName,function(e){return new s(e)}]);var s=function(){function i(i){this.template=e.Common.Templates.bioSampleCreateModal,this.restrict="E",this.controller=["$scope",t.Services.ModalDialog.serviceName,function(e,t){e.sampleIDPlaceholder="Sample ID",e.sampleNamePlaceholder="Sample Name",e.sampleForm={sampleID:"",sampleName:"",nucleicAcidSelected:"",speciesSelected:null};var s={limit:100},a=i.SpeciesList.get(s,function(){for(var t=[],i=0;i<arguments.length;i++)t[i-0]=arguments[i];e.species=[];for(var s=t[0].Response.Items,r=0;r<a.Response.Items.length;r++)e.species.push(s[r]);e.species.length>0&&(e.sampleForm.speciesSelected=e.species[0]),e.sampleForm.nucleicAcidSelected="DNA"});e.onCloseClick=function(){t.removeModal()},e.onCreateClick=function(){e.errorMessage="";var s=!0;if(e.formSample.sampleID.$error.required&&(s=!1,e.formSample.sampleID.$pristine=!1,e.userHasEnteredText=!0),e.formSample.sampleName.$error.required&&(s=!1,e.formSample.sampleName.$pristine=!1,e.userHasEnteredText=!0),null==e.sampleForm.speciesSelected&&(s=!1,e.formSample.speciesSelected.$pristine=!1,e.userHasEnteredText=!0),s){var a={UserSampleId:e.sampleForm.sampleID,Name:e.sampleForm.sampleName,Species:e.sampleForm.speciesSelected,Project:null,LibraryCount:0,DateModified:null,NucleicAcid:e.sampleForm.nucleicAcidSelected,SpeciesId:e.sampleForm.speciesSelected.Id,ProjectId:null};i.BioSample.save(a,function(i){e.dialogScope.onSuccessCallBack&&e.dialogScope.onSuccessCallBack(i),t.removeModal()},function(t){e.errorMessage=t.data.ResponseStatus.Message})}},e.onSampleIDChange=function(){angular.isDefined(e.sampleForm.sampleID)&&e.sampleForm.sampleID.length>0&&(e.userHasEnteredText=!0)}}]}return i}();i.BioSampleCreateDirective=s}(s=i.Modals||(i.Modals={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.selectionsDataSourceFactoryName="bs.Common.Directives.Chooser.SelectionsDataSourceFactory",t.commonModule.factory(i.selectionsDataSourceFactoryName,[e.Common.Services.Api.apiServiceName,function(e){return new s(e)}]);var s=function(){function e(e){this.publicApi=e}return e.prototype.createSelectionsDataSource=function(){return new a(this.publicApi)},e}();i.SelectionsDataSourceFactory=s;var a=function(){function e(e){this.publicApi=e,this.items=[]}return e.prototype.fetchInitialSelections=function(e,t,i,s){for(var a=this,r=[],o=0;o<e.length;o++){var n=e[o];r.push("Id:"+n)}var l="("+r.join(") OR (")+")",c={limit:100,query:l,scope:t};return this.publicApi.Search.query(c,function(e){for(var t=e.Response.Items,s=0;s<t.length;s++)a.items.push(t[s]);i&&i.apply(a,e)},function(e){s&&s.apply(a,e)}),this.items},e}();i.SelectionsDataSource=a}(s=i.Chooser||(i.Chooser={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.events={CONFIRM:"confirm",CANCEL:"cancel",REQUEST_NEW_PROJECT:"request-new-project",REQUEST_NEW_PROJECT_SUCCESS:"request-new-project-success",REQUEST_NEW_PROJECT_CANCELLED:"request-new-project-cancelled"},i.chooserDialogDirectiveName="bsChooserDialog",t.commonModule.directive(i.chooserDialogDirectiveName,[t.Services.BsResourceDictionary.serviceName,t.Services.Validation.serviceName,t.Services.ModalDialog.serviceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function s(s,a,r){var o=this;this.template=e.Common.Templates.chooserDialog,this.resourceDictionary=s,this.validationRuleDictionary=a,this.restrict="E",this.modalDialog=r,this.scope={dialogScope:"="},this.controller=["$scope","$timeout",t.Services.Search.searchGridDataSourceFactoryName,function(e,t,i){if(!o.resourceDictionary.hasOwnProperty(e.dialogScope.resourceType))throw new Error("No search table resource config present for specified resource type '"+e.dialogScope.resourceType+"'.");var s=o.resourceDictionary[e.dialogScope.resourceType];e.gridDataSource||(e.gridDataSource=i.getSearchList(s)),e.gridDataSource.limit=100,e.gridDataSource.useStrictPaging=!0,e.dialogScope.searchFilters||(e.dialogScope.searchFilters={activeFilters:[]}),e.anyFilters=s.searchFilters.length>0,e.rowSelectableCallback=o._getRowSelectableCallback(e,function(e){return e[s.searchObjectName]}),e.gridDataSource.scope=s.searchScope,e.isResourceCreatable=s.isCreatableInChooser,e.requestNewResource=function(){if(angular.element(document).on("request-new-"+e.dialogScope.resourceType+"-success",function(t,i,s){e.onCreateResourceSuccess(i,s)}).on("request-new-"+e.dialogScope.resourceType+"-cancelled",function(t){e.onCreateResourceCancelled()}).trigger("request-new-"+e.dialogScope.resourceType),e.dialogScope.useInternalCreateDialog===!0){var t={masterTemplate:"<bs-create-"+e.dialogScope.resourceType+'-modal dialog-scope="dialogScope"></bs-create-'+e.dialogScope.resourceType+"-modal>"},i={successCallback:e.onCreateResourceAndConfirm};r.showModal(t,i)}},e.onCreateResourceSuccess=function(t,i){angular.element(document).off("request-new-"+e.dialogScope.resourceType+"-success"),angular.element(document).off("request-new-"+e.dialogScope.resourceType+"-cancelled");var a=o.resourceDictionary.getObjectCreatorForResource(s),r=o.resourceDictionary.getIdAccessorForResource(s),n=a(t,i);e.dialogScope.multiSelect||e.dialogScope.selections.splice(0,e.dialogScope.selections.length),e.dialogScope.selections.push(n),e.gridDataSource.fetchNewlyCreatedResource(t,function(e){return r(e)==t})},e.onCreateResourceCancelled=function(){angular.element(document).off("request-new-"+e.dialogScope.resourceType+"-success"),angular.element(document).off("request-new-"+e.dialogScope.resourceType+"-cancelled")},e.onCreateResourceAndConfirm=function(t){angular.element(document).off("request-new-"+e.dialogScope.resourceType+"-success"),angular.element(document).off("request-new-"+e.dialogScope.resourceType+"-cancelled");var i=o.resourceDictionary.getObjectCreatorForResource(s)(t.Id,t.Name,t.Href);e.dialogScope.selections=[i],o.confirm(e)},e.clickConfirm=function(){o.confirm(e)},e.clickCancel=function(){e.triggerCancel(),o.modalDialog.removeModal()},e.onShowSelectionClick=function(){e.dialogScope.panelVisible&&e.dialogScope.accordionItems.selections.isOpen?e.dialogScope.panelVisible=!1:(e.dialogScope.panelVisible=!0,e.dialogScope.accordionItems.selections.isOpen=!0)},e.onClearSelectionClick=function(){e.dialogScope.selections.length=0},e.onFiltersClick=function(){e.dialogScope.panelVisible&&e.dialogScope.accordionItems.filters.isOpen?e.dialogScope.panelVisible=!1:(e.dialogScope.panelVisible=!0,e.dialogScope.accordionItems.filters.isOpen=!0)}}],this.confirm=function(e){angular.copy(e.dialogScope.selections,e.dialogScope.confirmedSelections),e.triggerConfirm(),o.modalDialog.removeModal()},this.link=function(e,t){t.find(".bs-chooser-search-field").focus(),e.$watch("searchQuery",function(t,i){t!=i&&e.gridDataSource.updateRawSearchQuery(t)}),e.triggerConfirm=function(){for(var s=o.resourceDictionary[e.dialogScope.resourceType],a=o.resourceDictionary.getIdAccessorForResource(s),r=[],n=0;n<e.dialogScope.selections.length;n++)r.push(a(e.dialogScope.selections[n]));t.trigger(i.events.CONFIRM,[r,e.dialogScope.selections])},e.triggerCancel=function(){t.trigger(i.events.CANCEL)}}}return s.prototype._getRowSelectableCallback=function(e,i){var s=this,a=[];if(e.dialogScope.requiredPermissions&&e.dialogScope.requiredPermissions.toLowerCase()==t.Services.Validation.Permissions.OWNER&&a.push(this.validationRuleDictionary[t.Services.Validation.RuleNames.MUST_BE_OWNER]),e.dialogScope.requiredGenomes){var r=e.dialogScope.requiredGenomes.split(",");r.length>0&&a.push(function(e){return s.validationRuleDictionary[t.Services.Validation.RuleNames.MUST_BE_SUPPORTED_GENOME](e,r)})}var o=function(e){for(var t=i(e),s=0;s<a.length;s++){var r=a[s](t);if(!r)return!1}return!0};return o},s}();i.ChooserDialog=s}(s=i.Chooser||(i.Chooser={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.chooserFormControlDirectiveName="bsChooserFormControl",t.commonModule.directive(i.chooserFormControlDirectiveName,[t.Services.BsResourceDictionary.serviceName,i.selectionsDataSourceFactoryName,t.Services.ModalDialog.serviceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function t(t,i,s){var a=this;this.template=e.Common.Templates.chooserFormControl,this.resourceDictionary=t,this.selectionsDataSourceFactory=i,this.modalDialog=s,this.restrict="E",this.scope={selections:"=?",initialSelections:"@?",initialFilterSelections:"@?",baseQuery:"@?",resourceType:"@",multiselect:"@",requiredPermissions:"@?",requiredGenomes:"@?",confirmedSelections:"=?",disabled:"=?",useInternalCreateDialog:"=?"},this.controller=["$scope",function(e){if(!a.resourceDictionary.hasOwnProperty(e.resourceType))throw new Error("No search table resource config present for specified resource type '"+e.resourceType+"'.");angular.isDefined(e.disabled)||(e.disabled=!1);var t,i=a.resourceDictionary[e.resourceType];t=a.selectionsDataSourceFactory.createSelectionsDataSource(),e.selections=[],e.confirmedSelectionIds=[],e.confirmedSelections||(e.confirmedSelections=[]),e.confirmedSelectionViewItems=[];var s=function(){var s=e.initialSelections.split(",");e.confirmedSelections=t.fetchInitialSelections(s,i.searchScope)};e.initialSelections&&s(),e.$watch("initialSelections",function(e,t){e&&e!=t&&s()}),e.searchFilters={activeFilters:[]},e.initialFilterSelections&&"{}"!=e.initialFilterSelections&&(e.searchFilters.preselections=e.initialFilterSelections),e.message=i.chooserMessage,e.showDialog=function(){var t={isVisible:!1,selections:e.selections,resourceType:e.resourceType,multiSelect:e.multiselect,confirmedSelections:e.confirmedSelections,baseQuery:e.baseQuery,message:e.message,requiredPermissions:e.requiredPermissions,requiredGenomes:e.requiredGenomes,panelVisible:e.searchFilters.preselections?!0:!1,accordionItems:{filters:{isOpen:e.searchFilters.preselections?!0:!1},selections:{isOpen:!1}},searchFilters:e.searchFilters,useInternalCreateDialog:e.useInternalCreateDialog},i={masterTemplate:'<bs-chooser-dialog dialog-scope="dialogScope"></bs-chooser-dialog>'};a.modalDialog.showModal(i,t)}}],this.link=function(e,t,i){a.resourceType=e.resourceType,e.$watch("confirmedSelections",function(i,s){if(i!=s){e.confirmedSelectionViewItems=[];for(var r=a.resourceDictionary[e.resourceType],o=a.resourceDictionary.getIdAccessorForResource(r),n=a.resourceDictionary.getNameAccessorForResource(r),l=0;l<e.confirmedSelections.length;l++){var c=e.confirmedSelections[l],u={id:o(c),name:n(c),item:c};e.confirmedSelectionViewItems.push(u)}a._updateDataAttributesAndTriggerEvents(e,t,s)}},!0),e.removeItem=function(t){var i=e.confirmedSelections.indexOf(t.item);e.confirmedSelections.splice(i,1),i=e.confirmedSelectionIds.indexOf(t.item.id),e.confirmedSelectionIds.splice(i,1)},a._updateDataAttributesAndTriggerEvents(e,t,[]),a._bindBaseQueryObserver(e,t)}}return t.prototype._updateDataAttributesAndTriggerEvents=function(e,t,i){var s=this.resourceDictionary[e.resourceType],a=this.resourceDictionary.getIdAccessorForResource(s);e.confirmedSelectionIds=[];for(var r=0;r<e.confirmedSelections.length;r++)e.confirmedSelectionIds.push(a(e.confirmedSelections[r]));t.data("bsSelectionIds",e.confirmedSelectionIds),t.data("bsSelections",e.confirmedSelections),t.trigger("confirm",[e.confirmedSelectionIds,e.confirmedSelections]);var o=[];for(r=0;r<i.length;r++){var n=i[r],l=a(n);e.confirmedSelectionIds.indexOf(l)<0&&o.push(l)}o.length>0&&t.trigger("deselect",[o])},t.prototype._bindBaseQueryObserver=function(e,t){$.fn.hasOwnProperty("attrchange")&&t.attrchange(function(i,s){var a="base-query";if(i.attributeName==a){var r=t.attr(a);if(r!=e.baseQuery){e.baseQuery=r;for(var o=0;o<e.confirmedSelectionViewItems.length;o++)e.removeItem(e.confirmedSelectionViewItems[o]);e.$digest()}}})},t}();i.ChooserFormControl=s}(s=i.Chooser||(i.Chooser={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.chooserTriggerDirectiveName="bsChooserTrigger",e.commonModule.directive(t.chooserTriggerDirectiveName,[e.Services.ModalDialog.serviceName,e.Services.BsResourceDictionary.serviceName,function(e,t){return new i(e,t)}]);var i=function(){function e(e,i){var s=this;this.restrict="A",this.resourceDictionary=i,this.modalDialog=e,this.scope={selections:"=?",initialSelections:"@?",initialFilterSelections:"@?",baseQuery:"@?",resourceType:"@",multiselect:"@?",requiredPermissions:"@?",requiredGenomes:"@?"},this.link=function(e,i){e.selections=[],e.confirmedSelectionIds=[],e.confirmedSelections=[];var a=s.resourceDictionary[e.resourceType];e.message=a.chooserMessage,e.searchFilters={activeFilters:[]},e.initialFilterSelections&&"{}"!=e.initialFilterSelections&&(e.searchFilters.preselections=e.initialFilterSelections),e.trigger=function(){var a={isVisible:!1,selections:e.selections,resourceType:e.resourceType,multiSelect:e.multiselect,confirmedSelections:e.confirmedSelections,confirmedSelectionIds:e.confirmedSelectionIds,baseQuery:e.baseQuery,message:e.message,requiredPermissions:e.requiredPermissions,requiredGenomes:e.requiredGenomes,panelVisible:e.searchFilters.preselections?!0:!1,accordionItems:{filters:{isOpen:e.searchFilters.preselections?!0:!1},selections:{isOpen:!1}},searchFilters:e.searchFilters},r={masterTemplate:'<bs-chooser-dialog dialog-scope="dialogScope"></bs-chooser-dialog>'};s.modalDialog.showModal(r,a);var o=angular.element("bs-chooser-dialog");o.on(t.events.CONFIRM,function(e,s,a){i.trigger(t.events.CONFIRM,[s,a])}),o.on(t.events.CANCEL,function(){return i.trigger(t.events.CANCEL)})},i.on("click",function(){e.trigger()})}}return e}();t.ChooserTriggerDirective=i}(i=t.Chooser||(t.Chooser={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){e.DEFAULT_SEARCH_RESULT_LIMIT=50,e.DEFAULT_ROW_LIMIT=100,e.INVALID_ROW_LIMIT_VALUE="You specified an unsupported value for 'max-rows'. By default, this control supports a maximum of "+e.DEFAULT_ROW_LIMIT+" row.",e.NUM_COLUMNS_MIN=2,e.NUM_COLUMNS_MAX=2,e.NUM_COLUMNS_MIN_NOT_MET="This control requires a minimum column count of "+e.NUM_COLUMNS_MIN+".",e.NUM_COLUMNS_MAX_EXCEEDED="This control supports a maximum column count of "+e.NUM_COLUMNS_MAX+"."}(t=e.GrouperValidation||(e.GrouperValidation={}))}(t=e.Grouper||(e.Grouper={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(i){i.grouperManagerFactoryName="grouperManagerFactory",e.commonModule.factory(i.grouperManagerFactoryName,["$timeout",t.BsResourceDictionary.serviceName,t.Search.searchFilterDictionaryServiceName,t.Search.searchGridDataSourceFactoryName,t.Validation.serviceName,e.Directives.TangGrid.gridServiceName,t.Mappings.dataMappingServiceName,t.ModalDialog.serviceName,function(e,t,i,a,r,o,n,l){return new s(e,t,i,a,r,o,n,l)}]);var s=function(){function e(e,t,i,s,a,r,o,n){this.$timeout=e,this.resourceDictionary=t,this.searchFilterDictionary=i,this.searchGridDataSourceFactory=s,this.validationRuleDictionary=a,this.tangGridService=r,this.mappingService=o,this.modalDialogService=n}return e.prototype.getManager=function(e){var t=new a(this.$timeout,this.resourceDictionary,this.searchFilterDictionary,this.searchGridDataSourceFactory,this.validationRuleDictionary,this.tangGridService,this.mappingService,this.modalDialogService);return t.setOptions(e),t},e}();i.GrouperManagerFactory=s;var a=function(){function e(e,t,i,s,a,r,o,n){this.$timeout=e,this.resourceDictionary=t,this.searchFilterDictionary=i,this.searchGridDataSourceFactory=s,this.validationRuleDictionary=a,this.tangGridService=r,this.mappingService=o,this.modalDialogService=n,this.selections=[],this.gridRows=[],this.isDialogMatrixConfirmable=!0,this.searchFilters={activeFilters:[],availableFilters:[this.searchFilterDictionary.project,this.searchFilterDictionary.genome]}}return e.prototype.initGridDataSource=function(){this.gridDataSource=this.searchGridDataSourceFactory.getSearchList(this.resourceConfig),this.gridDataSource.offset=0,this.gridDataSource.scope=this.searchScopes.join(","),this.gridDataSource.limit=i.GrouperValidation.DEFAULT_SEARCH_RESULT_LIMIT,this.gridDataSource.useStrictPaging=!0},e.prototype.setOptions=function(s){for(var a=this,r=0;r<s.groups.length;r++){var o=s.groups[r];if(0==r)this.resourceConfig=this.resourceDictionary[s.groups[0].resourceType];else if(o.resourceType!=s.groups[0].resourceType){this.resourceConfig=this.resourceDictionary.uiAll;break}}for(this.searchFilters.currentResourceType=this.resourceConfig.key,this.gridDataSource=this.searchGridDataSourceFactory.getSearchList(this.resourceConfig),this.gridDataSource.offset=0,this.searchScopes=[],r=0;r<s.groups.length;r++){o=s.groups[r];var n=this.resourceDictionary[o.resourceType].searchScope;this.searchScopes.indexOf(n)<0&&this.searchScopes.push(n)}if(this.initGridDataSource(),this.message=s.message?s.message:this.resourceConfig.chooserMessage,s.initialFilterSelections&&"{}"!=s.initialFilterSelections&&(this.initialFilterSelections=s.initialFilterSelections,this.searchFilters.preselections=s.initialFilterSelections),s.requiredGenomes&&(this.requiredGenomes=s.requiredGenomes),s.requiredPermissions&&(this.requiredPermissions=s.requiredPermissions),s.baseQuery&&(this.baseQuery=s.baseQuery),s.groups){if(s.groups.length<i.GrouperValidation.NUM_COLUMNS_MIN)throw i.GrouperValidation.NUM_COLUMNS_MIN_NOT_MET;if(s.groups.length>i.GrouperValidation.NUM_COLUMNS_MAX)throw i.GrouperValidation.NUM_COLUMNS_MAX_EXCEEDED;if(isFinite(s.rowLimit)){if(s.rowLimit>i.GrouperValidation.DEFAULT_ROW_LIMIT)throw i.GrouperValidation.INVALID_ROW_LIMIT_VALUE;if(s.rowLimit<1)throw i.GrouperValidation.INVALID_ROW_LIMIT_VALUE}else s.rowLimit=i.GrouperValidation.DEFAULT_ROW_LIMIT;for(var l=[],c=[],u=0;u<s.groups.length;u++){o=s.groups[u];var d=new t.Matrix.SpreadsheetColumn(o.name,o.title,s.rowLimit,!0),p=new t.Matrix.SpreadsheetColumn(o.name,o.title,s.rowLimit,!1,[this._getResourceTypeValidationCallback(o.resourceType)],e.sortRows);angular.isArray(o.items)&&(angular.copy(o.items,d.items),angular.copy(o.items,p.items)),c.push(d),l.push(p)}this.confirmedMatrix=new t.Matrix.DragSpreadsheetDataSource("groups","groups",c,t.DataType.SPREADSHEET_ITEM,s.rowLimit,s.allowUnpairedCells),this.confirmedMatrix.isLocked=!0,this.dialogMatrix=new t.Matrix.DragSpreadsheetDataSource("groups","groups",l,t.DataType.SPREADSHEET_ITEM,s.rowLimit,s.allowUnpairedCells)}angular.isArray(s.errors)&&(this.confirmedMatrix.errors=s.errors,this.dialogMatrix.errors=angular.copy(s.errors,[]),this.updateMatrixErrors()),this.matrixDragOptions={onAfterDrop:function(e){a.selections.length=0,a._refreshGrid()}},this.searchListDragOptions={onAfterDrop:function(e){a.selections.length=0,a._refreshGrid()},dragEnabled:!0,position:null,onBeforeDrop:function(){return null},serviceName:t.DragDrop.dragSpreadsheetServiceName},this.onMatrixItemRemoved=function(){a._refreshGrid()},this.rowSelectableCallback=function(e){var t=a.mappingService.searchResultItemToSpreadsheetItem(e);return!a.dialogMatrix.itemsHash[t.id]}},e.sortRows=function(e,t){var i=e&&angular.isString(e.name)?e.name.trim().toLowerCase():"",s=t&&angular.isString(t.name)?t.name.trim().toLowerCase():"";return i>s?1:s>i?-1:0},e.prototype.showDialog=function(){this.initGridDataSource(),this.dialogMatrix.errors=angular.copy(this.confirmedMatrix.errors,[]),this.dialogMatrix.statusSummary=angular.copy(this.confirmedMatrix.statusSummary,this.dialogMatrix.statusSummary),this.dialogMatrix.updateErrors();var e={manager:this,isVisible:!1},t={masterTemplate:'<bs-grouper-dialog dialog-scope="dialogScope"></bs-grouper-dialog>'};this.modalDialogService.showModal(t,e)},e.prototype.confirm=function(){this.selections.length=0,this.dialogMatrix.clearSelections(),this.dialogMatrix.clearTargets(),this.dialogMatrix.trimTheFat();for(var e=0;e<this.dialogMatrix.columns.length;e++){var t=this.dialogMatrix.columns[e],i=this.confirmedMatrix.columns[e];angular.copy(t.items,i.items),angular.copy(t.nonEmptyItems,i.nonEmptyItems)}angular.copy(this.dialogMatrix.invalidCells,this.confirmedMatrix.invalidCells),this.confirmedMatrix.updateErrors()},e.prototype.cancel=function(){this.selections.length=0,this.dialogMatrix.clearSelections(),this.dialogMatrix.clearTargets();for(var e=0;e<this.dialogMatrix.columns.length;e++){var t=this.dialogMatrix.columns[e],i=this.confirmedMatrix.columns[e];t.removeAll(),t.add(i.items,0)}this.dialogMatrix.resetItemsHash(),this.dialogMatrix.updateErrors()},e.prototype.updateMatrixErrors=function(){this.confirmedMatrix.updateErrors(),this.dialogMatrix.updateErrors()},e.prototype.onClearSelectionClick=function(){this.selections.length=0},e.prototype._getResourceTypeValidationCallback=function(e){return function(t){
return null==t||void 0==t||t.type==e?null:"Items must be of type "+e}},e.prototype._refreshGrid=function(){for(var e=0;e<this.gridRows.length;e++){var t=this.gridRows[e];t.isRowSelectable=this.rowSelectableCallback(t.item)}},e}();i.GrouperManager=a}(i=t.Grouper||(t.Grouper={}))}(t=e.Services||(e.Services={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.grouperDialogDirectiveName="bsGrouperDialog",t.commonModule.directive(i.grouperDialogDirectiveName,[t.Services.ModalDialog.serviceName,function(e){return new s(e)}]);var s=function(){function i(i){var s=this;this.template=e.Common.Templates.grouperDialog,this.restrict="E",this.modalDialog=i,this.scope={dialogScope:"="},this.controller=["$scope",t.Services.ModalDialog.serviceName,function(e,i){e.anyFilters=e.dialogScope.manager.resourceConfig.searchFilters.length>0,e.clickConfirm=function(){e.dialogScope.manager.confirm(),s.modalDialog.removeModal()},e.clickCancel=function(){e.dialogScope.manager.cancel(),s.modalDialog.removeModal()},e.onClearSelectionClick=function(){e.dialogScope.manager.selections.length=0},e.isConfirmEnabled=function(){var i=e.dialogScope.manager.dialogMatrix.errors.filter(function(e){return e.code!=t.Services.Validation.ErrorOrigin.SERVER});return 0==i.length}}],this.link=function(e,t){t.find(".bs-chooser-search-field").focus(),e.$watch("dialogScope.manager.searchQuery",function(t,i){t!=i&&e.dialogScope.manager.gridDataSource.updateRawSearchQuery(t)})}}return i}();i.GrouperDialog=s}(s=i.Grouper||(i.Grouper={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(s){s.grouperFormControlDirectiveName="bsGrouperFormControl",t.commonModule.directive(s.grouperFormControlDirectiveName,[t.Services.BsResourceDictionary.serviceName,i.Chooser.selectionsDataSourceFactoryName,t.Services.ModalDialog.serviceName,function(e,t,i){return new a(e,t,i)}]);var a=function(){function i(i,s,a){var r=this;this.template=e.Common.Templates.grouperFormControl,this.resourceDictionary=i,this.selectionsDataSourceFactory=s,this.modalDialog=a,this.restrict="E",this.scope={selections:"=?",initialSelections:"@?",initialFilterSelections:"@?",baseQuery:"@?",message:"@?",rowLimit:"=",isDisabled:"=?",isReadOnly:"=?",groups:"=",inputFieldId:"@",inputFieldValue:"&",isTrayVisible:"=?",allowUnpairedCells:"=?"},this.controller=["$scope",t.Services.Grouper.grouperManagerFactoryName,function(e,t){angular.isDefined(e.isDisabled)||(e.isDisabled=!1),angular.isDefined(e.isReadOnly)||(e.isReadOnly=!1),angular.isDefined(e.allowUnpairedCells)||(e.allowUnpairedCells=!1),e.errors=[],e.manager=t.getManager({initialFilterSelections:e.initialFilterSelections,groups:e.groups,baseQuery:e.baseQuery,requiredPermissions:e.requiredPermissions,requiredGenomes:e.requiredGenomes,rowLimit:e.rowLimit,errors:e.errors,isTrayVisible:e.isTrayVisible,message:e.message,allowUnpairedCells:e.allowUnpairedCells}),e.isDialogOpen=!1}],this.link=function(e,t,i){r._bindBaseQueryObserver(e,t)}}return i.prototype._bindBaseQueryObserver=function(e,t){$.fn.hasOwnProperty("attrchange")&&t.attrchange(function(i,s){var a="base-query";if(i.attributeName==a){var r=t.attr(a);r!=e.baseQuery&&(e.baseQuery=r,e.manager&&(e.manager.baseQuery=r),e.$digest())}})},i}();s.GrouperFormControl=a}(s=i.Grouper||(i.Grouper={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.scrollWithMe="bsScrollWithMe",e.commonModule.directive(t.scrollWithMe,function(){return new i});var i=function(){function e(){this.restrict="A",this.link=function(e,t,i){e.$watch(function(){return e.$eval(i.bsScrollWithMe)},function(e){if(1==e){var i=t.parent(),s={top:i.scrollTop(),bottom:i.scrollTop()+i.height()},a=t.position().top+i.scrollTop();a<s.top?i.scrollTop(t.is(":first-child")?0:a):a+t.height()>s.bottom&&i.scrollTop(a-i.height()+t.height())}})}}return e}();t.ScrollWithMeDirective=i}(i=t.Typeahead||(t.Typeahead={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.matchDirective="bsTypeaheadMatch",e.commonModule.directive(t.matchDirective,["$compile",function(e){return new i(e)}]);var i=function(){function e(e){var t=this;this.$compile=e,this.restrict="A",this.scope={item:"="},this.link=function(e,i,s){var a=e.item.template;if(!a){var r,o,n=null!=e.item.title&&void 0!=e.item.title?"item.title":"item.value",l=e.item.href;l?(r='<span><a href="{{ item.href }}">{{ ',o=" }}</a></span>"):(r="<span>{{ ",o=" }}</span>"),a=r+n+o}var c=t.$compile(a)(e);i.empty().append(c)}}return e}();t.TypeaheadMatch=i}(i=t.Typeahead||(t.Typeahead={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.typeaheadDirective="bsTypeahead",t.commonModule.directive(i.typeaheadDirective,["$timeout",function(e){return new s(e)}]);var s=function(){function t(i){var s=this;this.$timeout=i,this.template=e.Common.Templates.typeahead,this.restrict="E",this.scope={typeaheadOptions:"="},this.controller=["$scope",function(e){e.highlightPosition=0,e.isUserScrollingWithKeys=!1,e.$watch("typeaheadOptions.inputValue",function(t,i){t!=i&&e.typeaheadOptions.source.fetchMatches(t)}),e.typeaheadOptions.placeholder||(e.typeaheadOptions.placeholder=""),e.$watchCollection("typeaheadOptions.source.matches",function(){if(e.typeaheadOptions.source.matches){for(var t=0,i=0;i<e.typeaheadOptions.source.matches.length;i++){var s=e.typeaheadOptions.source.matches[i];s.selectable&&t++}e.highlightPositionMax=t}}),e.$watch("highlightPositionMax",function(){e.highlightPosition=Math.min(e.highlightPosition,e.highlightPositionMax)}),e.$watch("highlightPosition",function(t){for(var i=0,s=0;s<e.typeaheadOptions.source.matches.length;s++){var a=e.typeaheadOptions.source.matches[s];if(a.selectable&&i++,i==t)return e.typeaheadOptions.highlightedItemValue=a.value,void(e.highlightedItemHref=a.href)}e.typeaheadOptions.highlightedItemValue=null,e.highlightedItemHref=null}),e.isHighlighted=function(t){return t.selectable&&angular.equals(t.value,e.typeaheadOptions.highlightedItemValue)},e.isSelected=function(t){return t.selectable&&angular.equals(t.value,e.typeaheadOptions.selectedItemValue)},e.onClick=function(t){return e.typeaheadOptions.selectedItemValue=t.value},e.onKeyUp=function(t){var i=t.keyCode;switch(i){case 40:t.preventDefault(),s.moveHighlightDown(e);break;case 38:t.preventDefault(),s.moveHighlightUp(e);break;case 27:e.typeaheadOptions.escape&&e.typeaheadOptions.escape();break;case 13:t.preventDefault(),e.highlightedItemHref?window.location.href=e.highlightedItemHref:e.typeaheadOptions.confirm&&e.typeaheadOptions.confirm()}};var t=null,i=null;e.onMaskMousemove=function(s){(s.pageX!=t||s.pageY!=i)&&(t=s.pageX,i=s.pageY,e.isUserScrollingWithKeys=!1)}}],this.link=function(e,i,a){s.$timeout(function(){i.find(".bs-typeahead-input").focus()}),e.onMouseEnter=function(i,a){e._latestMouseEnterEvent=i,s.$timeout(function(){if(e._latestMouseEnterEvent==i&&angular.element(i.currentTarget).is(":hover")){e.highlightPosition=-1;for(var t=0,s=0;s<e.typeaheadOptions.source.matches.length;s++){var r=e.typeaheadOptions.source.matches[s];if(r.selectable&&t++,r==a)return void(e.highlightPosition=t)}}},t.HOVER_PREVIEW_DELAY)}}}return t.prototype.moveHighlightDown=function(e){e.highlightPosition<e.highlightPositionMax&&(e.highlightPosition++,e.isUserScrollingWithKeys=!0)},t.prototype.moveHighlightUp=function(e){e.highlightPosition>0&&(e.highlightPosition--,e.isUserScrollingWithKeys=!0)},t.HOVER_PREVIEW_DELAY=250,t}();i.TypeaheadDirective=s}(s=i.Typeahead||(i.Typeahead={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.searchDialogDirectiveName="bsSearchDialog",t.commonModule.directive(i.searchDialogDirectiveName,[t.Services.BsResourceDictionary.serviceName,t.Services.ModalDialog.serviceName,"$compile",function(e,t,i){return new s(e,t,i)}]);var s=function(){function i(i,s,a){var r=this;this.template=e.Common.Templates.searchDialog,this.resourceDictionary=i,this.restrict="E",this.modalDialog=s,this.$compile=a,this.scope={dialogScope:"="},this.controller=["$scope",t.Services.Search.searchTypeaheadDataSourceFactoryName,function(e,t){e.typeaheadOptions={inputValue:"",inputValueFormControlName:"query",source:t.getNewSource(),escape:function(){r.modalDialog.removeModal()},highlightedItemValue:null,placeholder:"Search BaseSpace..."},e.onSubmit=function(t){t.preventDefault(),e.typeaheadOptions.source.isLoading=!0;var i=angular.element(t.currentTarget),s=i.find("[name='"+e.typeaheadOptions.inputValueFormControlName+"']").val();window.location.href="/search/?query="+s},e.isEmptyMessageVisible=function(){return 0==e.typeaheadOptions.source.isLoading&&e.typeaheadOptions.inputValue&&e.typeaheadOptions.source.matches.length<1}}],this.link=function(e,t,i){e.$watch("typeaheadOptions.highlightedItemValue",function(i){if(null==i)e.isItemHighlighted=!1;else{e.isItemHighlighted=!1;var s=t.find("bs-preview");r.$compile(s)(e),e.isItemHighlighted=!0}})}}return i.prototype.updateTopHit=function(e,t){for(var i=null,s=null,a=0;a<t.length;a++){var r=t[a];(r.Score&&null==i||r.Score>i.Score)&&(i=r,s=i.Type)}var o=this.resourceDictionary[s],n=this.resourceDictionary.getNameAccessorForResource(o);e.tophit={href:"#",name:n(i)}},i}();i.SearchDialog=s}(s=i.SearchDialog||(i.SearchDialog={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.searchDialogTriggerDirectiveName="bsSearchDialogTrigger",e.commonModule.directive(t.searchDialogTriggerDirectiveName,[e.Services.ModalDialog.serviceName,function(e){return new i(e)}]);var i=function(){function e(e){var t=this;this.restrict="A",this.modalDialog=e,this.scope={},this.controller=["$scope","hotkeys",function(e,t){t.add({combo:"ctrl+space",description:"Opens the Search dialog",callback:function(){e.trigger()}}),t.add({combo:"esc",description:"Closes the Search dialog",callback:function(){e.dismiss()}})}],this.link=function(e,i){e.trigger=function(){var e={dismissByOutsideClick:!0},i={masterTemplate:'<bs-search-dialog dialog-scope="dialogScope"></bs-search-dialog>'};t.modalDialog.showModal(i,e)},e.dismiss=function(){t.modalDialog.removeModal()},i.on("click",function(){e.trigger()})}}return e}();t.SearchDialogTriggerDirective=i}(i=t.SearchDialog||(t.SearchDialog={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.progressItemDirective="bsProgressItem",e.commonModule.directive(t.progressItemDirective,["$compile",function(e){return new i(e)}]),e.commonModule.filter("stateEnumToString",function(){return function(t){var i="";switch(t){case e.Interfaces.TaskState.Active:i="Active";break;case e.Interfaces.TaskState.Cancelled:i="Cancelled";break;case e.Interfaces.TaskState.Cancelling:i="Cancelling";break;case e.Interfaces.TaskState.Complete:i="Complete";break;case e.Interfaces.TaskState.Failed:i="Failed";break;case e.Interfaces.TaskState.Paused:i="Paused";break;case e.Interfaces.TaskState.Queued:i="Queued";break;case e.Interfaces.TaskState.Completable:i="Completable";break;case e.Interfaces.TaskState.Completing:i="Completing"}return i}});var i=function(){function t(t){var i=this;this.$compile=t,this.restrict="E",this.transclude=!0,this.scope={task:"="},this.template=e.Templates.progressItem,this.controller=["$scope",function(e){}],this.link=function(t,s,a){t.task&&(i._populateSubtasks(t,s),i._onStateChange(t),t.$watchCollection("task.subtasks",function(e,a){e!=a&&i._populateSubtasks(t,s)}),t.$watch("task.uiConfig",function(e,a){e!=a&&(i._populateSubtasks(t,s),i._onStateChange(t))},!0),t.$watch("task.state",function(){i._onStateChange(t)}),t.isComplete=function(){return t.task.state===e.Interfaces.TaskState.Complete})}}return t.prototype._onStateChange=function(t){if(t.progressBarClasses={failed:t.task.state===e.Interfaces.TaskState.Failed,cancelled:t.task.state===e.Interfaces.TaskState.Cancelled,complete:t.task.state===e.Interfaces.TaskState.Complete},t.progressContainerClasses={},t.listItemClasses={"bs-uploader-list-item-in-progress":t.task.state===e.Interfaces.TaskState.Active,"bs-uploader-list-item":t.task.state===e.Interfaces.TaskState.Complete||t.task.state===e.Interfaces.TaskState.Cancelled||t.task.state===e.Interfaces.TaskState.Cancelling,"bs-uploader-list-item-error":t.task.state===e.Interfaces.TaskState.Failed,"bs-uploader-list-item-pending":t.task.state===e.Interfaces.TaskState.Paused||t.task.state===e.Interfaces.TaskState.Queued},t.canShowCancelButton=!1,t.canShowPauseButton=!1,t.canShowRemoveButton=!1,t.canShowResumeButton=!1,t.canShowProgress=!1,t.task.uiConfig.showCancelOrRemoveButton)switch(t.task.state){case e.Interfaces.TaskState.Active:case e.Interfaces.TaskState.Paused:t.canShowCancelButton=!0,t.canShowRemoveButton=!1;break;case e.Interfaces.TaskState.Cancelled:case e.Interfaces.TaskState.Queued:case e.Interfaces.TaskState.Failed:t.canShowCancelButton=!1,t.canShowRemoveButton=!0;break;default:t.canShowCancelButton=!1,t.canShowRemoveButton=!1}},t.prototype._populateSubtasks=function(e,i){if(e.task.uiConfig.showSubtasks){var s=i.find(t.SUBTASK_LIST_SELECTOR).first(),a=s.find("bs-progress-item");a.remove();for(var r=0;r<e.task.subtasks.length;r++){var o=e.task.subtasks[r],n=angular.element("<bs-progress-item class='bs-subtask' task=task></bs-progress-item>"),l=e.$new(!0);l.task=o,this.$compile(n)(l),s.append(n)}}},t.SUBTASK_LIST_SELECTOR=".bs-subtasks:first",t}();t.ProgressItemDirective=i}(i=t.Progress||(t.Progress={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.fileDropBoxDirective="bsFileDropBox",e.commonModule.directive(t.fileDropBoxDirective,[function(){return new i}]);var i=function(){function t(){this.restrict="E",this.template=e.Templates.fileDropBox,this.transclude=!0,this.scope={onFilesChanged:"=?",isDisabled:"=?"},this.controller=["$scope",function(e){e.onClick=function(e){return angular.element(e.currentTarget.parentElement).find("#files-to-upload").click(),!1},angular.isDefined(e.isDisabled)||(e.isDisabled=!1)}],this.link=function(e,t,i){function s(e){e.stopPropagation(),e.preventDefault()}t.find("#files-to-upload").on("change",function(t){e.onFilesChanged&&!e.isDisabled&&e.onFilesChanged(t.target.files)});var a=t.find(".bs-drag-container"),r=t.find(".bs-drag-mask");a.on("dragenter",function(t){s(t),e.isDisabled||(r.show(),a.addClass("dragover"))}),a.on("dragover",function(e){s(e)}),r.on("dragexit mouseleave",function(t){s(t),e.isDisabled||(r.hide(),a.removeClass("dragover"))}),r.on("drop",function(t){if(s(t),!e.isDisabled){a.removeClass("dragover");var i=t.originalEvent.dataTransfer,o=i.files;e.onFilesChanged&&e.onFilesChanged(o),r.hide()}return!1}),angular.element(document).bind({dragenter:function(e){s(e);var t=e.originalEvent.dataTransfer;try{t.effectAllowed=t.dropEffect="none"}catch(e){}},dragover:function(e){s(e);var t=e.originalEvent.dataTransfer;try{t.effectAllowed=t.dropEffect="none"}catch(e){}}})}}return t}();t.FileDropBoxDirective=i}(i=t.FileDropBox||(t.FileDropBox={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.importerDirectiveName="bsImporter",t.commonModule.directive(i.importerDirectiveName,["$timeout",t.Services.Validation.fileMetadataServiceName,t.Services.BsResourceDictionary.serviceName,t.Services.ModalDialog.serviceName,function(e,t,i,a){return new s(e,t,i,a)}]),i.DROPBOX_FILES_LIMIT=10;var s=function(){function i(s,a,r,o){var n=this;this.fileMetadata=a,this.dict=r,this.$timeout=s,this.template=t.Templates.importer,this.modalDialog=o,this.restrict="E",this.scope={type:"@?",projectId:"@?",onImportComplete:"=?",onImportCancelled:"=?",appSessionId:"@?"},this.controller=["$scope",t.Services.Api.apiServiceName,e.Common.Services.siteNavigationServiceName,function(e,s,a){e.importerOptions={type:e.type,projectId:e.projectId,appSessionId:e.appSessionId,isFileSelectionEnabled:!0,isLoading:!1,isError:!1,selectedFiles:[]},e.isSupported=!("undefined"==typeof File||"undefined"==typeof Blob||"undefined"==typeof FileList||!Blob.prototype.slice),e.selectType=function(t){e.importerOptions.type=t},e.onImportComplete||(e.onImportComplete=function(t){e.importerOptions.isLoading=!0,n._navigateToResource(e,t)}),!e.onImportCancelled&&e.projectId&&(e.onImportCancelled=function(){e.importerOptions.isLoading=!0,window.location.href=a.urlProjectSummary(e.projectId)}),e.importerOptions.appSessionId&&!e.importerOptions.type&&(e.importerOptions.isLoading=!0,s.AppSession.getProperty({Id:e.importerOptions.appSessionId,propertyName:i.IMPORT_TYPE_PROPERTY_NAME},function(t){e.importerOptions.isLoading=!1;var i=t.Response.Content;e.selectType(i)},function(){e.importerOptions.isLoading=!1,e.importerOptions.isError=!0})),e.showFastqDetailsModal=function(){n.modalDialog.bootstrapAlert({headerTemplate:"<h4>Illumina FASTQ file standard</h4>",bodyTemplate:t.Templates.fastqDetailsModalBody})}}],this.link=function(e,t,i,s){e.onRequestFileDialog=function(e){e.preventDefault(),t.find("bs-file-drop-box").find("#files-to-upload").click()},e.dropBoxChanged=function(i){if(i.length<1)return null;var s,a=[],r=[],o=0,l=e.importerOptions.type;if(!e.importerOptions.type){if(s=n.fileMetadata.getImportType(i[0].name),l=s.importType,!s.isValid)return s.isIntended?void n.modalDialog.bootstrapAlert({bodyTemplate:s.message,headerTemplate:"<h4>Invalid file</h4>",confirmLabel:"OK"}):void n.modalDialog.bootstrapAlert({headerTemplate:"<h4>Invalid file</h4>",bodyTemplate:"You may only upload valid gzipped FASTQ files, manifest files, or optionally gzipped VCF files.",confirmLabel:"OK"});a.push(i[0]),o=1,n.$timeout(function(){e.selectType(l)})}for(;o<i.length;){var c=i[o];s=n.fileMetadata.isValidFilename(l,c.name),s.isValid?a.push(c):r.push({file:c,message:s.message?s.message:""}),o++}if(a.length>0&&n.$timeout(function(){return e.importerOptions.selectedFiles=a}),r.length>0){var u="The following files are invalid for an import of type '"+l+"':\n";r.forEach(function(e){u=u+"\n"+e.file.name+(e.message?": "+e.message:"")}),t.data("error",u),n.modalDialog.bootstrapAlert({headerTemplate:"<h4>Invalid file</h4>",bodyTemplate:u})}else t.data("error",null);return null}}}return i.prototype._navigateToResource=function(e,i){var s="";switch(e.importerOptions.type){case t.Services.Import.ImportType.SAMPLE:s=this.dict.sample.uiHrefAccessor({Sample:i.sample});break;case t.Services.Import.ImportType.ANALYSIS:case t.Services.Import.ImportType.MANIFEST:s=this.dict.appsession.uiHrefAccessor({AppSession:i.appSession})}s&&(window.location.href=s)},i.prototype._resetImporter=function(e){e.importerOptions.type=null},i.IMPORT_TYPE_PROPERTY_NAME="import.type",i.IMPORT_TYPE_PROPERTY_DESCRIPTION="Identifies what type of import was being performed (sample, analysis, or manifest).",i.IMPORT_TYPE_PROPERTY_TYPE=t.Services.Api.PropertyType.string,i.IMPORT_VALIDATIONS_PROPERTY_NAME="BaseSpace.Files.Validations",i.IMPORT_VALIDATIONS_TYPE_PROPERTY_FASTQ="BaseSpace.Files.Validations.fastq",i}();i.ImporterDirective=s}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){var i=function(){function t(){var t=this;this.scope={importerOptions:"=?",onImportComplete:"=?",onImportCancelled:"=?",onRequestFileDialog:"="},this.controller=["$scope","$rootScope","$window","$location",function(i,s,a,r){t.initTaskManager(i);var o="This import is incomplete. Any files you've uploaded so far will not be available in BaseSpace until you select 'Complete import'.",n=function(){return i.taskManager.allowNavigateAway()?void 0:o};angular.element(window).on("beforeunload",n);var l=t,c=s.$on("$locationChangeStart",function(e,t,i){var s=n();s&&(e.preventDefault(),l.modalDialog.bootstrapConfirm({bodyTemplate:"<p>"+s+"</p><br /><p>Are you sure you want to leave this page?</p>",headerTemplate:"<h4>Confirm Navigation</h4>",confirmLabel:"Leave this Page",cancelLabel:"Stay on this Page"}).then(function(){c(),$(window).off("beforeunload",n),a.location.href=t}))});i.$on("$destroy",function(){$(window).off("beforeunload",n),c()}),i.$watch("importerOptions.selectedFiles",function(s,a){if(s!=a&&s.length>0){for(var r="",o=0;o<i.importerOptions.selectedFiles.length;o++){var n=i.importerOptions.selectedFiles[o];try{i.taskManager.addFile(n)}catch(l){if(r+=l,0==l.indexOf(e.Services.Import.MAX_FILE_ERROR))break}}r&&t.modalDialog.bootstrapAlert({bodyTemplate:r})}}),i.$watch("taskManager.state",function(e,s){e!=s&&t.listenForCompletion(i)}),i.importerOptions.appSessionId&&(i.importerOptions.isLoading=!0,t.resumeSession(i).then(function(){i.importerOptions.isLoading=!1},function(){i.importerOptions.isLoading=!1,i.importerOptions.isError=!0})),i.$watchCollection("taskManager.reasonsNotCompletable",function(e,s){e!=s&&t.updateFormValidity(i)}),i.$watch("taskManager.finishAsap",function(e,s){e!=s&&(e?i.importerOptions.isFileSelectionEnabled=!1:(i.importerOptions.isFileSelectionEnabled=!0,t.modalDialog.bootstrapAlert({bodyTemplate:"There are problems with the import. Please review the error messages.",headerTemplate:"<h4>Failed import</h4>",confirmLabel:"Ok"})))}),i.clickCancelButton=function(){i.taskManager.allowNavigateAway()?i.taskManager.onRequestCancel():t.modalDialog.bootstrapConfirm({bodyTemplate:"Are you sure you would like to cancel? Cancelling will cancel all uploads for this session.",headerTemplate:"<h4>Cancel import</h4>",confirmLabel:"Yes, cancel this import",cancelLabel:"No, continue importing"}).then(function(){i.importerOptions.isLoading=!0,i.taskManager.onRequestCancel()})},i.isNotCancellable=function(){return!i.taskManager.isCancellable}}]}return t.prototype.initTaskManager=function(e){throw"initTaskManager() must be implemented by inheriting class."},t.prototype.resumeSession=function(e){throw"resumeSession must be implemented by inheriting class."},t.prototype.addFiles=function(e){throw"addFiles must be implemented by inheriting class."},t.prototype.updateFormValidity=function(e){throw"updateFormValidity must be implemented by inheriting class."},t.prototype.listenForCompletion=function(t){switch(t.taskManager.state){case e.Interfaces.TaskState.Complete:t.onImportComplete&&t.onImportComplete(t.taskManager.metadata);break;case e.Interfaces.TaskState.Cancelled:t.onImportCancelled&&t.onImportCancelled()}},t}();t.BaseImportForm=i}(i=t.Import||(t.Import={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.sampleImportFormDirective="bsSampleImportForm",e.commonModule.directive(t.sampleImportFormDirective,["$q","$filter","$timeout",e.Services.Validation.fastqCheckerService,e.Services.ServerConfig.serverConfigServiceName,e.Services.Api.apiServiceName,e.Services.Api.propertyService,e.Services.Import.fileUploaderFactoryName,e.Services.Validation.fileMetadataServiceName,e.Services.ModalDialog.serviceName,function(e,t,s,a,r,o,n,l,c,u){return new i(e,t,s,a,r,o,n,l,c,u)}]);var i=function(t){function i(i,s,a,r,o,n,l,c,u,d){t.call(this),this.$q=i,this.filterService=s,this.$timeout=a,this.fastqCheckerService=r,this.serverConfig=o,this.api=n,this.propertyService=l,this.uploaderFactory=c,this.fileMetadataService=u,this.modalDialog=d,this.restrict="E",this.template=e.Templates.sampleImportForm}return __extends(i,t),i.prototype.updateFormValidity=function(t){if(t.readTwoMissingReadOneMessage?t.readTwoMissingReadOneMessage.length=0:t.readTwoMissingReadOneMessage=[],t.readOneMissingReadTwoMessage?t.readOneMissingReadTwoMessage.length=0:t.readOneMissingReadTwoMessage=[],t.taskManager.reasonsNotCompletable)for(var i=0;i<t.taskManager.reasonsNotCompletable.length;i++){var s=t.taskManager.reasonsNotCompletable[i];s.conflictType===e.Services.Validation.FastqConflictType.ReadOneMissing&&t.readTwoMissingReadOneMessage.push("Please upload the R1 FASTQ that corresponds to '"+s.fileName+"'."),s.conflictType===e.Services.Validation.FastqConflictType.ReadTwoMissing&&t.readOneMissingReadTwoMessage.push("Please upload the R2 FASTQ that corresponds to '"+s.fileName+"'.")}var a=0==t.readTwoMissingReadOneMessage.length,r=0==t.readOneMissingReadTwoMessage.length;t.importForm.readone.$setValidity("read1FileMissing",a),t.importForm.readtwo.$setValidity("read2FileMissing",r)},i.prototype.initTaskManager=function(t){var i=this,s={showSubtasks:!0,showTask:!1,subtaskUIConfig:{showSubtasks:!1,showTask:!0,showCancelOrRemoveButton:!0,subtaskUIConfg:{showSubtasks:!1,showProgress:!0}}};t.sampleNameMaxLength=e.Services.Validation.FastqChecker.MAX_SAMPLE_NAME_LENGTH,t.taskManager=new e.Services.Import.Sample.TaskManager({$q:this.$q,fastqCheckerService:this.fastqCheckerService,serverConfig:this.serverConfig,api:this.api,propertyService:this.propertyService,modalDialogService:this.modalDialog,projectId:t.importerOptions.projectId,uploaderFactory:this.uploaderFactory,uiConfig:s,filterService:this.filterService,$timeout:this.$timeout}),t.showFastqDetailsModal=function(){i.modalDialog.bootstrapAlert({headerTemplate:"<h4>Illumina FASTQ file standard</h4>",bodyTemplate:e.Templates.fastqDetailsModalBody})},t.getRotationDegrees=function(){var i;i=null===t.taskManager.metadata.totalFileSize?0:t.taskManager.metadata.totalFileSize/e.Services.Import.sample.maxFileSize;var s,a;return.5>i?(s=Math.max(360*i,7.5),a=0):(s=180,a=360*i-180),{under180:"rotate("+s+"deg)",over180:"rotate("+a+"deg)"}}},i.prototype.resumeSession=function(e){var t=this,s=this.$q.defer();return this.api.AppSession.get({Id:e.importerOptions.appSessionId},function(a){if(e.taskManager.metadata.appSession=a.Response,"running"!=e.taskManager.metadata.appSession.Status.toLowerCase())throw"You may only resume app sessions that are still in a 'Running' state.";t.api.AppSession.getProperty({Id:e.importerOptions.appSessionId,propertyName:i.IMPORT_SAMPLE_PROPERTY_NAME},function(i){e.importerOptions.isLoading=!1;var a=i.Response.Items[0].Content;e.taskManager.metadata.sample=a,e.taskManager.metadata.appSession.Name=e.taskManager.metadata.sample.Name,a.PreferredBuild&&(e.taskManager.metadata.genome=a.PreferredBuild),t.api.Sample.getFiles({Id:e.taskManager.metadata.sample.Id,Statuses:["complete","pending"]},function(i){var a=i.Response.Items,r=[];r.push(a.forEach(function(i){t.api.File.get({Id:i.Id},function(s){var a=s.Response,r=t.fastqCheckerService.getFastqMetadataValidationProperty(a);"complete"==a.UploadStatus.toLowerCase()&&r?e.taskManager.addUploadedFile(a,r):t.api.File["delete"]({Id:i.Id})},function(){})})),t.$q.all(r).then(function(){e.taskManager.resume(),s.resolve()})},function(e){s.reject(e)})},function(e){s.reject(e)})},function(e){s.reject(e)}),s.promise},i.IMPORT_SAMPLE_PROPERTY_NAME="Output.Samples/Items",i}(t.Import.BaseImportForm);t.SampleImportFormDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(t){function i(e,i,s,a,r,o,n,l,c){t.call(this),this.$q=e,this.filterService=i,this.$timeout=s,this.serverConfig=a,this.api=r,this.propertyService=o,this.uploaderFactory=n,this.fileMetadataService=l,this.modalDialog=c,this.restrict="E",this.$q=e,this.serverConfig=a,this.api=r,this.propertyService=o,this.uploaderFactory=n,this.fileMetadataService=l,this.modalDialog=c}return __extends(i,t),i.prototype.initTaskManager=function(e){this.uiConfig={showSubtasks:!0,showTask:!1,subtaskUIConfig:{showSubtasks:!1,showTask:!0,showCancelOrRemoveButton:!0,subtaskUIConfg:{showSubtasks:!1,showProgress:!0}}},e.appresultNameMaxLength=70},i.prototype.resumeSession=function(t){var i=this,s=this.$q.defer();return this.api.AppSession.get({Id:t.importerOptions.appSessionId},function(a){t.taskManager.metadata.appSession=a.Response;var r=t.taskManager.metadata.appSession.Name.lastIndexOf(t.taskManager.uploadPendingSuffix);if(r>0&&(t.taskManager.metadata.appSession.Name=t.taskManager.metadata.appSession.Name.substring(0,r)),"running"!=t.taskManager.metadata.appSession.Status.toLowerCase())throw"You may only resume app sessions that are still in a 'Running' state.";i.populateForm(t),i.api.AppSession.getProperty({Id:t.importerOptions.appSessionId,propertyName:e.Services.Import.AppResult.OUTPUT_APPRESULTS_PROPERTY_NAME},function(a){t.importerOptions.isLoading=!1;var r=a.Response.Items[0];t.taskManager.metadata.appResult=r,t.taskManager.metadata.appResult.Name=t.taskManager.metadata.appSession.Name,i.api.AppResult.getFiles({Id:t.taskManager.metadata.appResult.Id},function(a){var r=a.Response.Items,o=[];o.push(r.forEach(function(s){i.api.File.get({Id:s.Id,Statuses:["complete","pending"]},function(a){var r=a.Response,o=i._getValidationResult(r),n=null,l=null;o&&o.Type&&(n=e.Services.Validation.getByServerType(o.Type),l={validationType:n,serverValidationResult:o}),"complete"==r.UploadStatus.toLowerCase()&&l?t.taskManager.addUploadedFile(r,l):i.api.File["delete"]({Id:s.Id})},function(){})})),i.$q.all(o).then(function(){t.taskManager.resume(),s.resolve()})},function(e){s.reject(e)})},function(e){s.reject(e)})},function(e){s.reject(e)}),s.promise},i.prototype._getValidationResult=function(e){for(var t=null,i=0;i<e.Properties.Items.length;i++)for(var s=e.Properties.Items[i],a=0;a<this.validationTypes.length;a++){var r=this.validationTypes[a];if(s.Name===r.propertyName)try{t=JSON.parse(s.Content)}catch(o){console.log(o)}}return t},i.prototype.populateForm=function(e){},i}(t.Import.BaseImportForm);t.AppResultImportFormDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.analysisImportFormDirectiveName="bsAnalysisImportForm",e.commonModule.directive(t.analysisImportFormDirectiveName,["$q","$filter","$timeout",e.Services.ServerConfig.serverConfigServiceName,e.Services.Api.apiServiceName,e.Services.Api.propertyService,e.Services.Import.fileUploaderFactoryName,e.Services.Validation.fileMetadataServiceName,e.Services.ModalDialog.serviceName,function(e,t,s,a,r,o,n,l,c){return new i(e,t,s,a,r,o,n,l,c)}]);var i=function(t){function i(i,s,a,r,o,n,l,c,u){t.call(this,i,s,a,r,o,n,l,c,u),this.template=e.Templates.analysisImportForm,this.validationTypes=e.Services.Import.vcf.validationTypes}return __extends(i,t),i.prototype.initTaskManager=function(i){t.prototype.initTaskManager.call(this,i),i.selectedSamples=[],i.initialChooserSelections="",i.$watchCollection("selectedSamples",function(e,t){angular.equals(e,t)||(t&&t.length>e.length&&(i.taskManager.needToRemoveSample=!0),i.taskManager.saveProgress())}),i.taskManager=new e.Services.Import.AppResult.VCF.TaskManager({$q:this.$q,serverConfig:this.serverConfig,api:this.api,propertyService:this.propertyService,modalDialogService:this.modalDialog,projectId:i.importerOptions.projectId,uploaderFactory:this.uploaderFactory,uiConfig:this.uiConfig,filterService:this.filterService,$timeout:this.$timeout},i.selectedSamples),i.getRotationDegrees=function(){var t;t=null===i.taskManager.metadata.totalFileSize?0:i.taskManager.metadata.totalFileSize/e.Services.Import.vcf.maxFileSize;var s,a;return.5>t?(s=Math.max(360*t,7.5),a=0):(s=180,a=360*t-180),{under180:"rotate("+s+"deg)",over180:"rotate("+a+"deg)"}}},i.prototype.populateForm=function(t){for(var i=0;i<t.taskManager.metadata.appSession.Properties.Items.length;i++){var s=t.taskManager.metadata.appSession.Properties.Items[i];if(s.Name===e.Services.Api.PropertyName.INPUT_SAMPLES){
var a=s;return void(t.initialChooserSelections=a.Items.map(function(e){return e.Id}).join(","))}}},i}(t.AppResultImportFormDirective);t.VCFImportFormDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.manifestImportFormDirectiveName="bsManifestImportForm",e.commonModule.directive(t.manifestImportFormDirectiveName,["$q","$filter","$timeout",e.Services.ServerConfig.serverConfigServiceName,e.Services.Api.apiServiceName,e.Services.Api.propertyService,e.Services.Import.fileUploaderFactoryName,e.Services.Validation.fileMetadataServiceName,e.Services.ModalDialog.serviceName,function(e,t,s,a,r,o,n,l,c){return new i(e,t,s,a,r,o,n,l,c)}]);var i=function(t){function i(i,s,a,r,o,n,l,c,u){t.call(this,i,s,a,r,o,n,l,c,u),this.template=e.Templates.manifestImportForm,this.validationTypes=e.Services.Import.manifest.validationTypes}return __extends(i,t),i.prototype.initTaskManager=function(i){t.prototype.initTaskManager.call(this,i),i.selectedSamples=[],i.initialChooserSelections="",i.$watchCollection("selectedSamples",function(e){e&&i.taskManager.saveProgress()}),i.taskManager=new e.Services.Import.AppResult.Manifest.TaskManager({$q:this.$q,serverConfig:this.serverConfig,api:this.api,propertyService:this.propertyService,modalDialogService:this.modalDialog,projectId:i.importerOptions.projectId,uploaderFactory:this.uploaderFactory,uiConfig:this.uiConfig,filterService:this.filterService,$timeout:this.$timeout})},i}(t.AppResultImportFormDirective);t.ManifestImportFormDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.downloaderDirectiveName="bsDownloader",t.commonModule.directive(i.downloaderDirectiveName,["$window",e.Common.Services.ServerConfig.downloaderConfigServiceName,e.Common.Services.ServerConfig.serverConfigServiceName,function(e,t,i){return new s(e,t,i)}]);var s=function(){function t(t,i,s){var a=this;this.template=e.Common.Templates.downloader,this.controller=["$scope",function(e){a.initScopeMethods(e),e.downloadType=a.downloaderConfig.downloadType,e.initSettings(),e.initDownloadMessage()}],this.restrict="E",this.scope={},this.downloaderConfig=i,this.$window=t,this.serverConfig=s}return t.prototype.initScopeMethods=function(e){var t=this;e.initSettings=function(){e.settings={dontShowDownloaderMessage:!1}},e.initDownloadMessage=function(){var i=JSON.parse(localStorage.getItem(t.getStorageKey()));e.settings.dontShowDownloaderMessage=1==i?!0:!1},this.downloaderConfig.altInstallUri&&this.downloaderConfig.altInstallUri.length>0&&(e.showAlternateDownload=!0),e.onInstallDownloaderClick=function(){t.$window.location.href=t.downloaderConfig.installUri},e.onInstallDownloaderAltClick=function(){t.$window.location.href=t.downloaderConfig.altInstallUri},e.onDontShowMessageClicked=function(){e.settings.dontShowDownloaderMessage=!0,localStorage.setItem(t.getStorageKey(),JSON.stringify(!0))},e.onShowMessageClicked=function(){e.settings.dontShowDownloaderMessage=!1,localStorage.removeItem(t.getStorageKey())}},t.prototype.getStorageKey=function(){return localStorage.getItem("dontShowDownloaderMessage"+this.serverConfig.currentUserId)},t}();i.Downloader=s}(s=i.Downloader||(i.Downloader={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.analysisDownloaderDirectiveName="bsAnalysisDownloader",t.commonModule.directive(i.analysisDownloaderDirectiveName,["$window",e.Common.Services.ServerConfig.downloaderConfigServiceName,function(e,t){return new s(e,t)}]);var s=function(){function t(t,i){var s=this;this.template=e.Common.Templates.analysisDownloader,this.controller=["$scope",function(e){s.initScopeMethods(e),e.downloadBtnEnabled=!0,e.initSelection()}],this.restrict="E",this.scope={},this.$window=t,this.downloaderConfig=i}return t.prototype.initScopeMethods=function(e){var t=this;e.initSelection=function(){e.downloadFileTypeFilter="allFiles"},e.onTriggerDownloadUriClick=function(){t.$window.location.href=e.getDownloadPath(e.downloadFileTypeFilter,t.downloaderConfig),e.downloadBtnEnabled=!1},e.getDownloadPath=function(e,t){var i="";switch(e){case"allFiles":i=t.webStartDefaultPath;break;case"vcfFiles":i=t.webStartAppSessionVcfPath;break;case"bamFiles":i=t.webStartAppSessionBamPath}return i}},t}();i.AnalysisDownloader=s}(s=i.Downloader||(i.Downloader={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.runDownloaderDirectiveName="bsRunDownloader",t.commonModule.directive(i.runDownloaderDirectiveName,["$window",e.Common.Services.ServerConfig.downloaderConfigServiceName,function(e,t){return new s(e,t)}]);var s=function(){function t(t,i){var s=this;this.template=e.Common.Templates.runDownloader,this.controller=["$scope",function(e){s.initScopeMethods(e),e.$watch("downloadFileTypeFilter",function(){e.downloadBtnEnabled=!0}),e.downloadBtnEnabled=!0,e.initDownloadOptions(),e.initSelection()}],this.restrict="E",this.scope={},this.$window=t,this.downloaderConfig=i}return t.prototype.initScopeMethods=function(e){var t=this;e.initSelection=function(){e.downloadFileTypeFilter=e.fastqDownloadEnabled?"fastqFiles":"savFiles"},e.initDownloadOptions=function(){e.savInfoUrl=t.downloaderConfig.savInfoUrl,e.runAnalysisUrl=t.downloaderConfig.runAnalysisUrl,e.fastqDownloadEnabled=t.downloaderConfig.fastqDownloadEnabled,e.analysisLinkEnabled=t.downloaderConfig.analysisLinkEnabled},e.onTriggerDownloadUriClick=function(){t.$window.location.href=e.getDownloadPath(e.downloadFileTypeFilter,t.downloaderConfig),e.downloadBtnEnabled=!1},e.getDownloadPath=function(e,t){var i="";switch(e){case"fastqFiles":i=t.webStartDefaultPath;break;case"savFiles":i=t.launchSavUrl}return i}},t}();i.RunDownloader=s}(s=i.Downloader||(i.Downloader={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.projectDownloaderDirectiveName="bsProjectDownloader",t.commonModule.directive(i.projectDownloaderDirectiveName,["$window",e.Common.Services.ServerConfig.downloaderConfigServiceName,function(e,t){return new s(e,t)}]);var s=function(){function t(t,i){var s=this;this.template=e.Common.Templates.projectDownloader,this.controller=["$scope",function(e){e.downloadBtnEnabled=!0,e.onTriggerDownloadUriClick=function(){s.$window.location.href=s.downloaderConfig.webStartDefaultPath,e.downloadBtnEnabled=!1}}],this.restrict="E",this.scope={},this.$window=t,this.downloaderConfig=i}return t}();i.ProjectDownloader=s}(s=i.Downloader||(i.Downloader={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.sampleDownloaderDirectiveName="bsSampleDownloader",t.commonModule.directive(i.sampleDownloaderDirectiveName,["$window",e.Common.Services.ServerConfig.downloaderConfigServiceName,function(e,t){return new s(e,t)}]);var s=function(){function t(t,i){var s=this;this.template=e.Common.Templates.sampleDownloader,this.controller=["$scope",function(e){e.downloadBtnEnabled=!0,e.onTriggerDownloadUriClick=function(){s.$window.location.href=s.downloaderConfig.webStartDefaultPath,e.downloadBtnEnabled=!1}}],this.restrict="E",this.scope={},this.$window=t,this.downloaderConfig=i}return t}();i.SampleDownloader=s}(s=i.Downloader||(i.Downloader={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.draggableDirectiveName="bsDraggable",t.commonModule.directive(i.draggableDirectiveName,["$injector",function(e){return new s(e)}]);var s=function(){function t(t){var i=this;this.$injector=t,this.restrict="A",this.scope={dragOptions:"=",dragGroup:"="},this.link=function(t,s,a){t.dragOptions.serviceName&&(t.dragDropService=i.$injector.get(t.dragOptions.serviceName)),t.$watch("dragOptions.dragEnabled",function(){s.attr("draggable",t.dragOptions.dragEnabled)}),s.on("dragstart",function(a){i.onDragStart(a,t,s),e.Compatibility.unbindDragDropIE()}),s.on("dragend",function(e){i.onDragEnd(e,t,s)}),s.on("mousedown",function(t){e.Compatibility.unbindDragDropIE(),t.shiftKey||e.Compatibility.bindDragDropIE()});var r=t.dragOptions.onBeforeDrop,o=t.dragOptions.onAfterDrop;t.dragOptions.onBeforeDrop=new Function,t.dragOptions.onBeforeDrop=function(e){return r(e?e:t)},t.dragOptions.onAfterDrop=new Function,t.dragOptions.onAfterDrop=function(e){return o(e?e:t)}}}return t.prototype.onDragStart=function(e,t,i){if(angular.isFunction(t.dragOptions.onBeforeDragBegin)&&t.dragOptions.onBeforeDragBegin(t),e.originalEvent.dataTransfer.setData("Text",""),t.dragDropService.registerOrigin(t.dragOptions,t.dragGroup,t),i.addClass("dragged"),angular.isFunction(t.dragOptions.onAfterDragBegin)&&t.dragOptions.onAfterDragBegin(t),angular.isFunction(t.dragOptions.getDragElement)){var s=t.dragOptions.getDragElement(t);if(s){var a=$(s);a.css("position","fixed"),a.css("left",$(window).width()/2),a.css("top",$(window).height()/2),a.css("z-index","-999999"),$("body").append(a);{var r=$("body").find(".payload-container");r.find(".payload")}try{e.originalEvent.dataTransfer.setDragImage(r[0],100,100)}catch(o){}}}},t.prototype.onDragEnd=function(e,t,i){i.removeClass("dragged"),$("body").find(".payload-container").remove(),e.preventDefault()},t}();i.DraggableDirective=s}(s=i.DragDrop||(i.DragDrop={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){t.droppableDirectiveName="bsDroppable",e.commonModule.directive(t.droppableDirectiveName,["$injector",function(e){return new i(e)}]);var i=function(){function t(t){var i=this;this.$injector=t,this.restrict="A",this.scope={dropOptions:"=",dropGroup:"="},this.link=function(s,a,r){s.dropOptions.serviceName&&(s.dragDropService=t.get(s.dropOptions.serviceName)),a.append(e.Templates.dragMask),a.on("dragenter",function(e){i.onDragEnter(e,s,a)}),a.on("dragover",function(e){s.dropGroup.isInvalidDropAttempted||e.preventDefault()}),a.on("dragleave",".drag-mask",function(e){i.onDragLeave(e,s,a)}),a.on("mouseleave",".drag-mask",function(e){i.onDragLeave(e,s,a)}),a.on("drop",".drag-mask",function(e){i.onDrop(e,s,a)})}}return t.prototype.onDragEnter=function(e,t,i){return t.dropGroup.isInvalidDropAttempted?void t.dragDropService.deregisterTarget():(i.find(".drag-mask").show(),i.addClass("drag-intent"),t.dragDropService.registerTarget(t.dropOptions,t.dropGroup,t),e.preventDefault(),e.stopPropagation(),!1)},t.prototype.onDragLeave=function(e,t,i){return t.dropGroup.isInvalidDropAttempted?void t.dragDropService.deregisterTarget():(i.find(".drag-mask").hide(),i.removeClass("drag-intent"),t.dragDropService.deregisterTarget(),e.preventDefault(),e.stopPropagation(),!1)},t.prototype.onDrop=function(e,t,i){return t.dropGroup.isInvalidDropAttempted?void 0:(i.find(".drag-mask").hide(),i.removeClass("drag-intent"),t.dragDropService.drop(),e.preventDefault(),e.stopPropagation(),!1)},t}();t.DroppableDirective=i}(i=t.DragDrop||(t.DragDrop={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s;!function(i){i.dragSpreadsheetDirectiveName="bsDragSpreadsheet",t.commonModule.directive(i.dragSpreadsheetDirectiveName,["$compile",function(e){return new s(e)}]),i.MAX_GHOST_ROWS=25;var s=function(){function s(s){var a=this;this.$compile=s,this.template=t.Templates.dragSpreadsheet,this.restrict="E",this.scope={matrix:"=",onItemRemoved:"=?",onColumnItemsCleared:"=?",dragOptions:"=?",dropOptions:"=?",isTrayVisible:"=?",isResourceLinkEnabled:"=?"},this.controller=["$scope",t.Services.DragDrop.dragSpreadsheetServiceName,function(t,s){angular.isDefined(t.isTrayVisible)||(t.isTrayVisible=!0),angular.isDefined(t.isResourceLinkEnabled)||(t.isResourceLinkEnabled=!1),t.getRowCount=function(){return new Array(t.matrix.getMaxRows())},t.getGhostLimit=function(){return new Array(Math.min(t.matrix.maxRows,i.MAX_GHOST_ROWS))},t.clearCell=function(e,i){t.matrix.clearCell(e,i),angular.isFunction(t.onItemRemoved)&&t.onItemRemoved(e,i)},t.clearColumnCells=function(e){t.matrix.clearColumn(e),angular.isFunction(t.onColumnItemsCleared)&&t.onColumnItemsCleared(t.matrix.columns[e])},t.clickSpreadsheet=function(){t.matrix.clearTargets(),t.matrix.clearSelections(),t.lastSelectionRange=null},t.clickSort=function(e){t.matrix.clearSelections(e),t.matrix.sortColumn(e),t.matrix.updateErrors()},t.onKeyUp=function(e){27==e.keyCode&&(t.matrix.clearSelections(),e.preventDefault())},t.onMouseDown=function(t){t.shiftKey&&e.Compatibility.preventTextSelection()},t.toggleSelected=function(e,i,a,r){if(!t.matrix.isLocked){e.preventDefault(),e.stopPropagation();var o,n=null,l=!1;if(e.shiftKey?(l=!0,o={endPosition:{columnNumber:i,rowNumber:a},startPosition:t.lastSelectionRange.startPosition},n=t.lastSelectionRange):o={endPosition:{columnNumber:i,rowNumber:a},startPosition:{columnNumber:i,rowNumber:a}},n&&s.deselectRange(t.matrix,n,t.dragOptionsMatrix),l&&!angular.equals(o,t.lastSelectionRange))s.selectRange(t.matrix,o,t.dragOptionsMatrix);else{var c=t.matrix.toggleSelected(i,a);t.dragOptionsMatrix[i][a].dragEnabled=c}t.lastSelectionRange=o}},t.dragOptionsMatrix=[],t.dropOptionsMatrix=[],t.initDragDropOptions=function(e,i){angular.isArray(t.dragOptionsMatrix[e])||(t.dragOptionsMatrix[e]=[]),angular.isArray(t.dropOptionsMatrix[e])||(t.dropOptionsMatrix[e]=[]),t.dragOptionsMatrix[e][i]=a._getDragOptions(t,e,i),t.dropOptionsMatrix[e][i]=a._getDropOptions(t,e,i)},t.highlightedInvalidCell={rowNumber:null,columnNumber:null},t.onMouseEnterReadMore=function(e,i,s){t.highlightedInvalidCell.columnNumber=e.data.position.columnNumber,t.highlightedInvalidCell.rowNumber=e.data.position.rowNumber},t.onMouseLeaveReadMore=function(e,i,s){t.highlightedInvalidCell.columnNumber=null,t.highlightedInvalidCell.rowNumber=null},t.isEmptyMessageVisible=function(){return t.matrix.isLocked&&0===t.matrix.getMaxRows()}}],this.link=function(e,t,i){e.onClickReadMore=function(t,i,s){s.preventDefault(),e.scrollToRow(t.data.position.rowNumber)},e.scrollToRow=function(e){var i=t.find(".bs-matrix-col-body li:eq("+e+")").position().top;t.find(".bs-spreadsheet-body").animate({scrollTop:i})}}}return s.prototype._getDragOptions=function(e,i,s){var a=this;return angular.extend({onAfterDrop:function(){},onBeforeDrop:function(){},onAfterDragBegin:function(t){e.matrix.selectedCells[t.dragOptions.position.columnNumber][t.dragOptions.position.rowNumber]||e.matrix.toggleSelected(t.dragOptions.position.columnNumber,t.dragOptions.position.rowNumber)},onDropIntent:function(){return null},getDragElement:function(){var i=a.$compile(t.Templates.grouperDragElement)(e);return e.$digest(),i},dragEnabled:!0,position:{columnNumber:i,rowNumber:s},serviceName:t.Services.DragDrop.dragSpreadsheetServiceName},e.dragOptions?e.dragOptions:{})},s.prototype._getDropOptions=function(e,i,s){return angular.extend({onDrop:function(){return null},onDropIntent:function(e){return null},position:{columnNumber:i,rowNumber:s},serviceName:t.Services.DragDrop.dragSpreadsheetServiceName},e.dropOptions?e.dropOptions:{})},s}();i.DragSpreadsheetDirective=s}(s=i.DragDrop||(i.DragDrop={}))}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.bioSamplePickerName="bsBioSamplePicker",t.commonModule.directive(i.bioSamplePickerName,function(){return new s});var s=function(){function i(){this.template=e.Common.Templates.bioSamplePicker,this.restrict="E",this.scope={biologicalSample:"="},this.controller=["$scope",t.Services.ModalDialog.serviceName,function(e,t){e.onSelectCallBack=function(t){e.biologicalSample=t[0]},e.launchPicker=function(){var i={masterTemplate:"<bs-bio-sample-picker-modal dialog-scope='dialogScope'></bs-bio-sample-picker-modal>"},s={onSelectCallBack:e.onSelectCallBack};t.showModal(i,s)}}]}return i}();i.BioSamplePickerDirective=s}(i=t.Directives||(t.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.stackedBarChartServiceName="bsStackedBarChartSvc",e.commonModule.service(t.stackedBarChartServiceName,[function(){return new i}]);var i=function(){function e(){}return e.prototype.getDefaultOptions=function(){return{segments:[],total:0}},e.prototype.updatePositions=function(e){for(var t=0,i=0;i<e.segments.length;i++){var s=e.segments[i],a=t,r=0,o=i+1===e.segments.length;e.total>0&&(r=s.value/e.total*100),t+=r,s.segmentStyles={left:a+"%",width:r+"%"},s.legendStyles={width:o?"auto":s.segmentStyles.width}}},e}();t.StackedBarChartService=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.stackedBarChartDirective="bsStackedBarChart",e.commonModule.directive(t.stackedBarChartDirective,[t.stackedBarChartServiceName,function(e){return new i(e)}]);var i=function(){function t(t){var i=this;this.stackedBarChartService=t,this.template=e.Templates.stackedBarChart,this.restrict="E",this.scope={options:"=?",showLegend:"=?"},this.controller=["$scope",function(e){e.options=angular.isDefined(e.options)?angular.extend(i.stackedBarChartService.getDefaultOptions(),e.options):i.stackedBarChartService.getDefaultOptions(),angular.isDefined(e.showLegend)||(e.showLegend=!0),i.stackedBarChartService.updatePositions(e.options)}]}return t}();t.StackedBarChartDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.storageTotalsChartDirectiveName="bsStorageTotalsChart",e.commonModule.directive(t.storageTotalsChartDirectiveName,[t.stackedBarChartServiceName,e.Services.Api.apiServiceName,e.Services.currentUserServiceName,"bytesFilter",function(e,t,s,a){return new i(e,t,s,a)}]);var i=function(){function t(t,i,s,a){var r=this;this.stackedBarChartService=t,this.api=i,this.currentUserService=s,this.template=e.Templates.storageTotalsChart,this.bytesFilter=a,this.restrict="E",this.scope={showLegend:"=?",storageStats:"=?",isLoading:"=?"},this.controller=["$scope",function(e){e.options={total:0,segments:[]},angular.isDefined(e.showLegend)||(e.showLegend=!0),angular.isDefined(e.storageStats)&&angular.isDefined(e.hasStorageQuotaCodeFeature)?r.onLoadStorageStats(e):(e.isLoading=!0,r.currentUserService.getCurrentUser(!0).then(function(t){e.hasStorageQuotaCodeFeature=!1,t.Features&&(e.hasStorageQuotaCodeFeature=t.Features.indexOf("StorageQuotaEnabled")>-1),t.StorageStatistics&&(e.storageStats=t.StorageStatistics,r.onLoadStorageStats(e),r.stackedBarChartService.updatePositions(e.options)),e.isLoading=!1}))}]}return t.prototype.onLoadStorageStats=function(e){var t,i,s=[],a=e.storageStats.TotalSize;e.isQuotaPresent=e.hasStorageQuotaCodeFeature&&angular.isNumber(e.storageStats.Quota),e.isQuotaExceeded=!1;var r={value:e.storageStats.TotalOwnedSize+e.storageStats.TotalTrashSize,valueFormatted:this.bytesFilter(e.storageStats.TotalOwnedSize+e.storageStats.TotalTrashSize,2),label:"Owned"},o={value:e.storageStats.TotalSharedSize,valueFormatted:this.bytesFilter(e.storageStats.TotalSharedSize,2),label:"Shared"};if(s.push(r),s.push(o),e.isQuotaPresent)if(e.isQuotaExceeded=a>e.storageStats.Quota,e.isQuotaExceeded){e.amountExceeded=a-e.storageStats.Quota,t=a+e.amountExceeded,i=this.bytesFilter(e.amountExceeded,2);var n={value:e.amountExceeded,valueFormatted:i,label:"Over limit"};s.push(n),e.messageLead="You are "+i+" over your storage limit.",e.shortMessage="You are "+i+" over your storage limit. You only have "+this.bytesFilter(e.storageStats.TotalSize,2)+" subscribed."}else{t=e.storageStats.Quota,e.amountAvailable=e.storageStats.Quota-a,i=this.bytesFilter(e.amountAvailable,2);var l={value:e.amountAvailable,valueFormatted:i,label:"Available"};s.push(l),e.messageLead="You have "+i+" of storage remaining.",e.shortMessage="You are using "+this.bytesFilter(e.storageStats.TotalSize,2)+" of storage; You have "+i+" of storage remaining."}else{var c=this.bytesFilter(e.storageStats.TotalSize,2),u=this.bytesFilter(e.storageStats.TotalOwnedSize+e.storageStats.TotalTrashSize,2),d=this.bytesFilter(e.storageStats.TotalSharedSize,2);e.messageLead="You are using "+c+" of storage.",e.messageSub=u+" is owned by you, and "+d+" is shared.",e.shortMessage="You are using "+c+" of storage; "+d+" of that storage is shared.",t=e.storageStats.TotalSize}e.options.total=t,e.options.segments=s},t}();t.StorageTotalsChartDirective=i}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this.act=e.act,this.isEnabled=e.isEnabled,this.iconClass=e.iconClass?e.iconClass:"",this.label=e.label}return e}();e.Action=t}(t=e.Actions||(e.Actions={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Enabled=0]="Enabled",e[e.Disabled=1]="Disabled",e[e.Auto=2]="Auto"}(e.ActionGroupEnabled||(e.ActionGroupEnabled={}));var t=e.ActionGroupEnabled,i=function(){function e(e){this.enabled=t.Auto,e&&(e.label&&(this.label=e.label),e.items&&(this.items=e.items),e.iconClass&&(this.iconClass=e.iconClass),e.iconTemplate&&(this.iconTemplate=e.iconTemplate))}return e.prototype.isEnabled=function(e){if(this.enabled===t.Enabled)return!0;if(this.enabled===t.Disabled)return!1;for(var i=0;i<this.items.length;i++)if(this.items[i].isEnabled(e))return!0;return!1},e}();e.ActionGroup=i}(t=e.Actions||(e.Actions={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){i.v1AnalysesGridDataSourceFactoryName="analysesGridV1DataSourceFactory",t.commonModule.factory(i.v1AnalysesGridDataSourceFactoryName,[e.Common.Services.Api.AppSession.V1.serviceName,function(e){return new t.Services.TangGrid.V1.V1ApiGridDataSourceFactory(function(t,i,s){return e.query(t,i,s)})}]),i.v2AnalysesGridDataSourceFactoryName="analysesGridV2DataSourceFactory",t.commonModule.factory(i.v2AnalysesGridDataSourceFactoryName,[e.Common.Services.Api.AppSession.V2.serviceName,function(e){return new t.Services.TangGrid.V2.V2ApiGridDataSourceFactory(function(t,i,s){return e.query(t,i,s)})}])}(i=t.Analysis||(t.Analysis={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function t(t,i){this.pageContext=i,this.restrict="E",this.scope={serviceName:"@"},this.template=e.Templates.toolbarDropdown,this.controller=["$scope","$injector",function(e,i){e.action=i.get(e.serviceName),e.sce=t,e.onClick=function(e){e.isEnabled()&&e.act()}}]}return t}();e.commonModule.directive("bsDropdown",["$sce","pageContext",function(e,t){return new i(e,t)}])}(t=e.Dropdown||(e.Dropdown={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(){this.restrict="E",this.replace=!0,this.scope={run:"="},this.controller=["$scope",function(e){var t=e.run,i=t.Status,s=t.SequencingStats;if(s)if(["Running","Paused","Uploading"].indexOf(i)>-1){e.displayMode="running",e.stats=s;var a=s.MaxCycleScored,r=s.NumCyclesIndex1+s.NumCyclesIndex2+s.NumCyclesRead1+s.NumCyclesRead2;e.percentComplete=Math.round(100*a/r)}else e.stats=s;else e.displayMode="nostats"}],this.template='\n<div ng-switch="displayMode">\n    <div ng-switch-when="nostats" style="text-align: center;">--</div>\n    \n    <div ng-switch-when="running" style="text-align: center;">\n        <div class="modal-tooltip top-right" style="display: block;" tabindex="-1">\n            <div class="bs-runs-cycles-container" ng-click="$event.stopPropagation()">\n                <span class="tooltip-text-trigger">\n                    <span>{{ stats.NumCyclesRead1 }}</span><span class="bs-runs-cycles-center">|</span><span class="bs-runs-cycles-right">{{ stats.NumCyclesRead2 }}</span>\n                </span>\n            </div>\n            <div class="tooltip-body">\n                <div class="tooltip-body-container-sm">\n                    <div class="tooltip-header">Cycle Details</div>\n                    <hr class="tooltip-header-underline" />\n                    <dl>\n                        <dt><span>Percent Complete</span></dt><dd><div class="value"><span>{{ percentComplete }}%</span></div></dd>\n                    </dl>\n              </div>\n           </div>\n       </div>\n   </div>\n    \n    <div ng-switch-default class="bs-runs-cycles-container">\n        <span>{{ stats.NumCyclesRead1 }}</span>\n        <span class="bs-runs-cycles-center">|</span>\n        <span class="bs-runs-cycles-right">{{ stats.NumCyclesRead2 }}</span>\n    </div>\n</div>'}return e}();e.commonModule.directive("bsRunCycles",[function(){return new i}])}(t=e.Run||(e.Run={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function t(){this.restrict="E",this.template=e.Templates.toolbar,this.scope={serviceName:"@"},this.controller=["$scope","$injector",function(e,t){e.toolbar=t.get(e.serviceName)}]}return t}();e.commonModule.directive("bsToolbar",[function(){return new i}])}(t=e.Toolbar||(e.Toolbar={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";t.fileInputButtonDirectiveName="bsFileInputButton";var i=function(){function t(){this.restrict="E",this.scope={file:"=",onChange:"&",buttonText:"@",defaultLabelText:"@"},this.link=function(e,t){t.on("change",function(){var i=t[0].querySelector(".bs-file-input-button input[type=file]"),s=i.value.replace("C:\\fakepath\\",""),a=t[0].querySelector(".bs-file-input-label");a.textContent=s,e.file=i.files[0],e.onChange({file:e.file})})},this.template=e.Templates.fileInputButton}return t}();t.FileInputButton=i,e.commonModule.directive(t.fileInputButtonDirectiveName,function(){return new i})}(i=t.FileInputButton||(t.FileInputButton={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){e.launchAppDropDownDirectiveName="bsLaunchAppDropDown",e.commonModule.directive(e.launchAppDropDownDirectiveName,function(){return new t});var t=function(){function t(){this.template=e.Templates.launchAppDropDown,this.restrict="E",this.scope={project:"=?",sample:"=?"},this.controller=["$scope",e.Services.Api.apiServiceName,function(e,t){e.$watch("project.Id",function(i,s){if(i)var a={category:"",resourceType:"project",resourceId:e.project.Id,access:"read",appResultId:"-1",limit:"500"},r=t.ApplicationsList.query(a,function(){e.applicationsList=r})}),e.appDropDownOpen="",e.onAppLaunchMenuClick=function(){e.appDropDownOpen="open"}}]}return t}();e.LaunchAppDropDownDirective=t}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";t.selectionCountBadgeDirectiveName="bsSelectionCountBadge",e.commonModule.directive(t.selectionCountBadgeDirectiveName,function(){return new i});var i=function(){function t(){this.restrict="E",this.template=e.Templates.selectionCountBadge,this.replace=!0,this.scope={badgeData:"="}}return t}();t.SelectionCountBadgeDirective=i}(i=t.selectionCountBadge||(t.selectionCountBadge={}))}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function t(t,i){var s=this;this.restrict="E",this.scope={value:"=",significantDigits:"="},this.template=e.Templates.significantDigitsWithTooltip,this.link=function(e,t,i){var a=e.value;e.title=null;var r=!isNaN(parseFloat(a))&&isFinite(a);if(r){var o=s.numberFilter(a,e.significantDigits),n=o.indexOf(s.$locale.NUMBER_FORMATS.DECIMAL_SEP);if(-1==n)return void(e.value=o);var l=o.substring(0,n),c=(Number(o.substring(n))||"").toString();e.value=l+c.substring(1),e.value.length<a.toString().length&&(e.title=a)}},this.$locale=t,this.numberFilter=i}return t}();t.significantDigitsWithTooltipDirectiveName="bsSignificantDigitsWithTooltip",e.commonModule.directive(t.significantDigitsWithTooltipDirectiveName,["$locale","numberFilter",function(e,t){return new i(e,t)}])}(t=e.Directives||(e.Directives={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s=e.Common.Interfaces.AppSessionStatus;i.appSessionUtilsServiceName="AppSessionUtils",t.commonModule.service(i.appSessionUtilsServiceName,[e.Common.Services.Api.propertyService,function(e){return new a(e)}]);var a=function(){function e(e){this.propertyService=e}return e.prototype.getProjectId=function(e){if(e.Properties&&e.Properties.Items){var t=this.propertyService.getPropertyValue(e.Properties.Items,"Output.Projects");if(angular.isArray(t)&&t.length>0)return t[0].Id}return""},e.prototype.getRunDuration=function(e){var t=e.DateCreated,i=e.DateCompleted,a=e.Status?e.Status:e.ExecutionStatus;return a===s.RUNNING?moment().toDate().getTime()-new Date(t).getTime():(a===s.COMPLETE||a===s.ABORTED)&&t&&i?new Date(i).getTime()-new Date(t).getTime():null},e.prototype.isMultiNode=function(e){if(e.Properties&&e.Properties.Items){var t=this.propertyService.getPropertyValue(e.Properties.Items,"BaseSpace.Private.IsMultiNode");return angular.isString(t)&&"True"===t}return!1},e.prototype.isWorkflow=function(e){return e.Application.Category===t.Interfaces.ApplicationFeatures.WORKFLOW},e}();i.AppSessionUtils=a}(i=t.AppSessions||(t.AppSessions={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function t(){this.restrict="E",this.replace=!0,this.template=e.Templates.appSessionCombinedStatus,this.scope={appSession:"=",position:"@?"},this.controller=["$scope","isNotEmptyStringFilter",function(e,t){e.ngClass={"modal-tooltip":t(e.appSession.StatusSummary)},e.position||(e.position="top-right"),e.ngClass[e.position]=t(e.appSession.StatusSummary)}]}return t}();e.commonModule.directive("bsAppSessionCombinedStatus",[function(){return new i}])}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(t){var i;!function(i){var s=e.Common.Services.BsEnumDictionary;i.changeDeliveryFormDirectiveName="bsUpdateDeliveryForm";var a=function(){function i(){this.scope={options:"="},this.template=t.Templates.updateDeliveryForm,this.restrict="E",this.controller=["$scope",e.Common.Services.bsEnumDictionaryServiceName,function(e,t){var i=t.getValues(s.APP_SESSION_DELIVERY_STATUS_ENUM);e.availableOptions=i.map(function(e){return{value:e,label:t.getDisplayName(s.APP_SESSION_DELIVERY_STATUS_ENUM,e)}})}]}return i}();i.UpdateDeliveryFormDirective=a,t.commonModule.directive(i.changeDeliveryFormDirectiveName,function(){return new a})}(i=t.AppSession||(t.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e,t,i){this.$rootScope=e,this.$q=t,this.appSessionApiService=i,this.modalHeaderTemplate="<h4>Change Delivery Status</h4>",this.modalBodyTemplate="<bs-update-delivery-form options='dialogScope.options' column-header-label='Analysis'></bs-update-delivery-form>"}return e.prototype.areAllDeliveryStatusesAlike=function(e){if(!angular.isArray(e)||0===e.length)return!1;var t=_.pluck(e,"DeliveryStatus");return 1===_.uniq(t).length},e.prototype.saveAllStatuses=function(e,t){for(var i=[],s=0;s<e.selections.length;s++)i.push(this.appSessionApiService.save({Id:e.selections[s].Id},{DeliveryStatus:e.deliveryStatus}));this.$q.all(i).then(function(e){t.resolve(e)},function(i){e.serverError=i.data?i.data.ErrorMessage:"Failed analyses save",
t.reject()})},e.prototype.onDeliveryChanged=function(e){if(e&&e.length>0){var i=e.length>1?e.length+" Analyses delivery statuses changed":"Analysis delivery status changed";toastr.success(i),this.$rootScope.$broadcast(t.DELIVERY_CHANGED_EVENT,e[0].DeliveryStatus)}},e}();t.ChangeDeliveryStrategyService=i,t.changeAppSessionDeliveryStrategyName="changeAppSessionDeliveryStrategy",e.commonModule.service(t.changeAppSessionDeliveryStrategyName,["$rootScope","$q",e.Services.Api.AppSession.V2.serviceName,i])}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.DELIVERY_CHANGED_EVENT="deliveryChanged";var i=function(){function e(e,t){this.$q=e,this.modalDialog=t}return e.prototype.showModal=function(e,t){var i=this;t.areAllDeliveryStatusesAlike=e.areAllDeliveryStatusesAlike(t.selections),this.modalDialog.bootstrapConfirm({bodyTemplate:e.modalBodyTemplate,headerTemplate:e.modalHeaderTemplate,dialogScope:{options:t},ngClass:{"modal-small":!0},confirmLabel:t.areAllDeliveryStatusesAlike?"Save":"OK",showCancelButton:t.areAllDeliveryStatusesAlike,onBeforeConfirmAsync:function(){var s=i.$q.defer();return t.areAllDeliveryStatusesAlike?e.saveAllStatuses(t,s):s.resolve(),s.promise}}).then(function(t){e.onDeliveryChanged(t)},function(){})},e}();t.ChangeDeliveryService=i,t.changeDeliveryServiceName="changeDelivery",e.commonModule.service(t.changeDeliveryServiceName,["$q",e.Services.ModalDialog.serviceName,i])}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=e.Services.ChangeQc,s=function(e){function t(t,i,s){e.call(this,t,i,"Analyses"),this.appSessionApiService=s,this.modalHeaderTemplate="<h4>Change Analysis Status</h4>",this.modalBodyTemplate="<bs-update-qc-status-form options='dialogScope.options' column-header-label='Analysis'></bs-update-qc-status-form>"}return __extends(t,e),t.prototype.saveAllStatuses=function(e,t){for(var i=[],s=0;s<e.selections.length;s++)i.push(this.appSessionApiService.save({Id:e.selections[s].Id},{QcStatus:e.status}));this.$q.all(i).then(function(e){t.resolve(e)},function(i){e.serverError=i.data?i.data.ErrorMessage:"Failed analyses save",t.reject()})},t}(i.AbstractChangeQcStrategy);t.ChangeQcStrategyService=s,t.changeAppSessionQcStrategyName="changeAppSessionQcStrategy",e.commonModule.service(t.changeAppSessionQcStrategyName,["$rootScope","$q",e.Services.Api.AppSession.V2.serviceName,s])}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.cancelAnalysesDirectiveName="bsCancelAnalysesForm";var i=function(){function t(){this.scope={options:"="},this.template=e.Templates.cancelAnalysesForm,this.restrict="E"}return t}();t.CancelAnalysesDirective=i,e.commonModule.directive(t.cancelAnalysesDirectiveName,function(){return new i})}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){var i=function(){function e(e,t,i){this.$rootScope=e,this.$q=t,this.appSessionApiService=i,this.modalHeaderTemplate="<h4>Cancel Analysis</h4>",this.modalBodyTemplate="<bs-cancel-analyses-form options='dialogScope.options'></bs-cancel-analyses-form>"}return e.prototype.cancelAnalysis=function(e,t){for(var i=[],s=0;s<e.selections.length;s++){var a=this.appSessionApiService.stop({Id:e.selections[s].Id.toString()});i.push(a)}this.$q.all(i).then(function(e){t.resolve(e)},function(i){e.serverError=i.data?i.data.ErrorMessage:"Failed to cancel analysis",t.reject()})},e.prototype.onCancelAnalysis=function(e){if(e&&e.length>0){var i=e.length>1?e.length+" Analyses were canceled":"Analysis was canceled";toastr.success(i),this.$rootScope.$broadcast(t.CANCEL_ANALYSIS_EVENT,e[0].ExecutionStatus)}},e}();t.CancelAnalysesStrategyService=i,t.cancelAnalysesStrategyName="cancelAnalysesStrategy",e.commonModule.service(t.cancelAnalysesStrategyName,["$rootScope","$q",e.Services.Api.AppSession.V2.serviceName,i])}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));var bs;!function(e){var t;!function(e){var t;!function(t){t.CANCEL_ANALYSIS_EVENT="analysisCanceled";var i=function(){function e(e,t,i){this.$rootScope=e,this.$q=t,this.modalDialog=i}return e.prototype.showModal=function(e,t){var i=this;this.modalDialog.bootstrapConfirm({bodyTemplate:e.modalBodyTemplate,headerTemplate:e.modalHeaderTemplate,confirmLabel:"Yes",cancelLabel:"No",dialogScope:{options:t},ngClass:{"modal-small":!0},showCancelButton:!0,onBeforeConfirmAsync:function(){var s=i.$q.defer();return e.cancelAnalysis(t,s),s.promise}}).then(function(t){e.onCancelAnalysis(t)},function(){})},e}();t.CancelAnalysesService=i,t.cancelAnalysesServiceName="cancelAnalyses",e.commonModule.service(t.cancelAnalysesServiceName,["$rootScope","$q",e.Services.ModalDialog.serviceName,i])}(t=e.AppSession||(e.AppSession={}))}(t=e.Common||(e.Common={}))}(bs||(bs={}));
//# sourceMappingURL=bs.tang.common.min.js.map
